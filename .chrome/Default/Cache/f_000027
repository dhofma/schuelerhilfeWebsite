(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["vendors~352ca8b2"],{

/***/ "3Kci":
/*!*************************************************************************!*\
  !*** ./node_modules/msal/lib-es6/error/InteractionRequiredAuthError.js ***!
  \*************************************************************************/
/*! exports provided: InteractionRequiredAuthErrorMessage, InteractionRequiredAuthError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"InteractionRequiredAuthErrorMessage\", function() { return InteractionRequiredAuthErrorMessage; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"InteractionRequiredAuthError\", function() { return InteractionRequiredAuthError; });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ \"mrSG\");\n/* harmony import */ var _ServerError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ServerError */ \"JKGV\");\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\n\r\nvar InteractionRequiredAuthErrorMessage = {\r\n    interactionRequired: {\r\n        code: \"interaction_required\"\r\n    },\r\n    consentRequired: {\r\n        code: \"consent_required\"\r\n    },\r\n    loginRequired: {\r\n        code: \"login_required\"\r\n    },\r\n};\r\n/**\r\n * Error thrown when the user is required to perform an interactive token request.\r\n */\r\nvar InteractionRequiredAuthError = /** @class */ (function (_super) {\r\n    tslib__WEBPACK_IMPORTED_MODULE_0__[\"__extends\"](InteractionRequiredAuthError, _super);\r\n    function InteractionRequiredAuthError(errorCode, errorMessage) {\r\n        var _this = _super.call(this, errorCode, errorMessage) || this;\r\n        _this.name = \"InteractionRequiredAuthError\";\r\n        Object.setPrototypeOf(_this, InteractionRequiredAuthError.prototype);\r\n        return _this;\r\n    }\r\n    InteractionRequiredAuthError.isInteractionRequiredError = function (errorString) {\r\n        var interactionRequiredCodes = [\r\n            InteractionRequiredAuthErrorMessage.interactionRequired.code,\r\n            InteractionRequiredAuthErrorMessage.consentRequired.code,\r\n            InteractionRequiredAuthErrorMessage.loginRequired.code\r\n        ];\r\n        return errorString && interactionRequiredCodes.indexOf(errorString) > -1;\r\n    };\r\n    InteractionRequiredAuthError.createLoginRequiredAuthError = function (errorDesc) {\r\n        return new InteractionRequiredAuthError(InteractionRequiredAuthErrorMessage.loginRequired.code, errorDesc);\r\n    };\r\n    InteractionRequiredAuthError.createInteractionRequiredAuthError = function (errorDesc) {\r\n        return new InteractionRequiredAuthError(InteractionRequiredAuthErrorMessage.interactionRequired.code, errorDesc);\r\n    };\r\n    InteractionRequiredAuthError.createConsentRequiredAuthError = function (errorDesc) {\r\n        return new InteractionRequiredAuthError(InteractionRequiredAuthErrorMessage.consentRequired.code, errorDesc);\r\n    };\r\n    return InteractionRequiredAuthError;\r\n}(_ServerError__WEBPACK_IMPORTED_MODULE_1__[\"ServerError\"]));\r\n\r\n//# sourceMappingURL=InteractionRequiredAuthError.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiM0tjaS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tc2FsL2xpYi1lczYvZXJyb3IvSW50ZXJhY3Rpb25SZXF1aXJlZEF1dGhFcnJvci5qcz9kY2E3Il0sInNvdXJjZXNDb250ZW50IjpbIi8qXHJcbiAqIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXHJcbiAqL1xyXG5pbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBTZXJ2ZXJFcnJvciB9IGZyb20gXCIuL1NlcnZlckVycm9yXCI7XHJcbmV4cG9ydCB2YXIgSW50ZXJhY3Rpb25SZXF1aXJlZEF1dGhFcnJvck1lc3NhZ2UgPSB7XHJcbiAgICBpbnRlcmFjdGlvblJlcXVpcmVkOiB7XHJcbiAgICAgICAgY29kZTogXCJpbnRlcmFjdGlvbl9yZXF1aXJlZFwiXHJcbiAgICB9LFxyXG4gICAgY29uc2VudFJlcXVpcmVkOiB7XHJcbiAgICAgICAgY29kZTogXCJjb25zZW50X3JlcXVpcmVkXCJcclxuICAgIH0sXHJcbiAgICBsb2dpblJlcXVpcmVkOiB7XHJcbiAgICAgICAgY29kZTogXCJsb2dpbl9yZXF1aXJlZFwiXHJcbiAgICB9LFxyXG59O1xyXG4vKipcclxuICogRXJyb3IgdGhyb3duIHdoZW4gdGhlIHVzZXIgaXMgcmVxdWlyZWQgdG8gcGVyZm9ybSBhbiBpbnRlcmFjdGl2ZSB0b2tlbiByZXF1ZXN0LlxyXG4gKi9cclxudmFyIEludGVyYWN0aW9uUmVxdWlyZWRBdXRoRXJyb3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhJbnRlcmFjdGlvblJlcXVpcmVkQXV0aEVycm9yLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gSW50ZXJhY3Rpb25SZXF1aXJlZEF1dGhFcnJvcihlcnJvckNvZGUsIGVycm9yTWVzc2FnZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGVycm9yQ29kZSwgZXJyb3JNZXNzYWdlKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLm5hbWUgPSBcIkludGVyYWN0aW9uUmVxdWlyZWRBdXRoRXJyb3JcIjtcclxuICAgICAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YoX3RoaXMsIEludGVyYWN0aW9uUmVxdWlyZWRBdXRoRXJyb3IucHJvdG90eXBlKTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBJbnRlcmFjdGlvblJlcXVpcmVkQXV0aEVycm9yLmlzSW50ZXJhY3Rpb25SZXF1aXJlZEVycm9yID0gZnVuY3Rpb24gKGVycm9yU3RyaW5nKSB7XHJcbiAgICAgICAgdmFyIGludGVyYWN0aW9uUmVxdWlyZWRDb2RlcyA9IFtcclxuICAgICAgICAgICAgSW50ZXJhY3Rpb25SZXF1aXJlZEF1dGhFcnJvck1lc3NhZ2UuaW50ZXJhY3Rpb25SZXF1aXJlZC5jb2RlLFxyXG4gICAgICAgICAgICBJbnRlcmFjdGlvblJlcXVpcmVkQXV0aEVycm9yTWVzc2FnZS5jb25zZW50UmVxdWlyZWQuY29kZSxcclxuICAgICAgICAgICAgSW50ZXJhY3Rpb25SZXF1aXJlZEF1dGhFcnJvck1lc3NhZ2UubG9naW5SZXF1aXJlZC5jb2RlXHJcbiAgICAgICAgXTtcclxuICAgICAgICByZXR1cm4gZXJyb3JTdHJpbmcgJiYgaW50ZXJhY3Rpb25SZXF1aXJlZENvZGVzLmluZGV4T2YoZXJyb3JTdHJpbmcpID4gLTE7XHJcbiAgICB9O1xyXG4gICAgSW50ZXJhY3Rpb25SZXF1aXJlZEF1dGhFcnJvci5jcmVhdGVMb2dpblJlcXVpcmVkQXV0aEVycm9yID0gZnVuY3Rpb24gKGVycm9yRGVzYykge1xyXG4gICAgICAgIHJldHVybiBuZXcgSW50ZXJhY3Rpb25SZXF1aXJlZEF1dGhFcnJvcihJbnRlcmFjdGlvblJlcXVpcmVkQXV0aEVycm9yTWVzc2FnZS5sb2dpblJlcXVpcmVkLmNvZGUsIGVycm9yRGVzYyk7XHJcbiAgICB9O1xyXG4gICAgSW50ZXJhY3Rpb25SZXF1aXJlZEF1dGhFcnJvci5jcmVhdGVJbnRlcmFjdGlvblJlcXVpcmVkQXV0aEVycm9yID0gZnVuY3Rpb24gKGVycm9yRGVzYykge1xyXG4gICAgICAgIHJldHVybiBuZXcgSW50ZXJhY3Rpb25SZXF1aXJlZEF1dGhFcnJvcihJbnRlcmFjdGlvblJlcXVpcmVkQXV0aEVycm9yTWVzc2FnZS5pbnRlcmFjdGlvblJlcXVpcmVkLmNvZGUsIGVycm9yRGVzYyk7XHJcbiAgICB9O1xyXG4gICAgSW50ZXJhY3Rpb25SZXF1aXJlZEF1dGhFcnJvci5jcmVhdGVDb25zZW50UmVxdWlyZWRBdXRoRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3JEZXNjKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBJbnRlcmFjdGlvblJlcXVpcmVkQXV0aEVycm9yKEludGVyYWN0aW9uUmVxdWlyZWRBdXRoRXJyb3JNZXNzYWdlLmNvbnNlbnRSZXF1aXJlZC5jb2RlLCBlcnJvckRlc2MpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBJbnRlcmFjdGlvblJlcXVpcmVkQXV0aEVycm9yO1xyXG59KFNlcnZlckVycm9yKSk7XHJcbmV4cG9ydCB7IEludGVyYWN0aW9uUmVxdWlyZWRBdXRoRXJyb3IgfTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9SW50ZXJhY3Rpb25SZXF1aXJlZEF1dGhFcnJvci5qcy5tYXAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///3Kci\n");

/***/ }),

/***/ "5wbO":
/*!************************************************!*\
  !*** ./node_modules/msal/lib-es6/XHRClient.js ***!
  \************************************************/
/*! exports provided: XhrClient */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* WEBPACK VAR INJECTION */(function(Promise) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"XhrClient\", function() { return XhrClient; });\n/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/Constants */ \"wmgs\");\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\n/**\r\n * XHR client for JSON endpoints\r\n * https://www.npmjs.com/package/async-promise\r\n * @hidden\r\n */\r\nvar XhrClient = /** @class */ (function () {\r\n    function XhrClient() {\r\n    }\r\n    XhrClient.prototype.sendRequestAsync = function (url, method, enableCaching) {\r\n        var _this = this;\r\n        return new Promise(function (resolve, reject) {\r\n            var xhr = new XMLHttpRequest();\r\n            xhr.open(method, url, /* async: */ true);\r\n            if (enableCaching) {\r\n                /*\r\n                 * TODO: (shivb) ensure that this can be cached\r\n                 * xhr.setRequestHeader(\"Cache-Control\", \"Public\");\r\n                 */\r\n            }\r\n            xhr.onload = function () {\r\n                if (xhr.status < 200 || xhr.status >= 300) {\r\n                    reject(_this.handleError(xhr.responseText));\r\n                }\r\n                var jsonResponse;\r\n                try {\r\n                    jsonResponse = JSON.parse(xhr.responseText);\r\n                }\r\n                catch (e) {\r\n                    reject(_this.handleError(xhr.responseText));\r\n                }\r\n                var response = {\r\n                    statusCode: xhr.status,\r\n                    body: jsonResponse\r\n                };\r\n                resolve(response);\r\n            };\r\n            xhr.onerror = function () {\r\n                reject(xhr.status);\r\n            };\r\n            if (method === _utils_Constants__WEBPACK_IMPORTED_MODULE_0__[\"NetworkRequestType\"].GET) {\r\n                xhr.send();\r\n            }\r\n            else {\r\n                throw \"not implemented\";\r\n            }\r\n        });\r\n    };\r\n    XhrClient.prototype.handleError = function (responseText) {\r\n        var jsonResponse;\r\n        try {\r\n            jsonResponse = JSON.parse(responseText);\r\n            if (jsonResponse.error) {\r\n                return jsonResponse.error;\r\n            }\r\n            else {\r\n                throw responseText;\r\n            }\r\n        }\r\n        catch (e) {\r\n            return responseText;\r\n        }\r\n    };\r\n    return XhrClient;\r\n}());\r\n\r\n//# sourceMappingURL=XHRClient.js.map\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! promise-polyfill */ \"B/eG\")[\"default\"]))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNXdiTy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tc2FsL2xpYi1lczYvWEhSQ2xpZW50LmpzP2U3MDYiXSwic291cmNlc0NvbnRlbnQiOlsiLypcclxuICogQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuICovXHJcbmltcG9ydCB7IE5ldHdvcmtSZXF1ZXN0VHlwZSB9IGZyb20gXCIuL3V0aWxzL0NvbnN0YW50c1wiO1xyXG4vKipcclxuICogWEhSIGNsaWVudCBmb3IgSlNPTiBlbmRwb2ludHNcclxuICogaHR0cHM6Ly93d3cubnBtanMuY29tL3BhY2thZ2UvYXN5bmMtcHJvbWlzZVxyXG4gKiBAaGlkZGVuXHJcbiAqL1xyXG52YXIgWGhyQ2xpZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gWGhyQ2xpZW50KCkge1xyXG4gICAgfVxyXG4gICAgWGhyQ2xpZW50LnByb3RvdHlwZS5zZW5kUmVxdWVzdEFzeW5jID0gZnVuY3Rpb24gKHVybCwgbWV0aG9kLCBlbmFibGVDYWNoaW5nKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcbiAgICAgICAgICAgIHhoci5vcGVuKG1ldGhvZCwgdXJsLCAvKiBhc3luYzogKi8gdHJ1ZSk7XHJcbiAgICAgICAgICAgIGlmIChlbmFibGVDYWNoaW5nKSB7XHJcbiAgICAgICAgICAgICAgICAvKlxyXG4gICAgICAgICAgICAgICAgICogVE9ETzogKHNoaXZiKSBlbnN1cmUgdGhhdCB0aGlzIGNhbiBiZSBjYWNoZWRcclxuICAgICAgICAgICAgICAgICAqIHhoci5zZXRSZXF1ZXN0SGVhZGVyKFwiQ2FjaGUtQ29udHJvbFwiLCBcIlB1YmxpY1wiKTtcclxuICAgICAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHhoci5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoeGhyLnN0YXR1cyA8IDIwMCB8fCB4aHIuc3RhdHVzID49IDMwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChfdGhpcy5oYW5kbGVFcnJvcih4aHIucmVzcG9uc2VUZXh0KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB2YXIganNvblJlc3BvbnNlO1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICBqc29uUmVzcG9uc2UgPSBKU09OLnBhcnNlKHhoci5yZXNwb25zZVRleHQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QoX3RoaXMuaGFuZGxlRXJyb3IoeGhyLnJlc3BvbnNlVGV4dCkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1c0NvZGU6IHhoci5zdGF0dXMsXHJcbiAgICAgICAgICAgICAgICAgICAgYm9keToganNvblJlc3BvbnNlXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHhoci5vbmVycm9yID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmVqZWN0KHhoci5zdGF0dXMpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBpZiAobWV0aG9kID09PSBOZXR3b3JrUmVxdWVzdFR5cGUuR0VUKSB7XHJcbiAgICAgICAgICAgICAgICB4aHIuc2VuZCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgXCJub3QgaW1wbGVtZW50ZWRcIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFhockNsaWVudC5wcm90b3R5cGUuaGFuZGxlRXJyb3IgPSBmdW5jdGlvbiAocmVzcG9uc2VUZXh0KSB7XHJcbiAgICAgICAgdmFyIGpzb25SZXNwb25zZTtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBqc29uUmVzcG9uc2UgPSBKU09OLnBhcnNlKHJlc3BvbnNlVGV4dCk7XHJcbiAgICAgICAgICAgIGlmIChqc29uUmVzcG9uc2UuZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBqc29uUmVzcG9uc2UuZXJyb3I7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyByZXNwb25zZVRleHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlVGV4dDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFhockNsaWVudDtcclxufSgpKTtcclxuZXhwb3J0IHsgWGhyQ2xpZW50IH07XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVhIUkNsaWVudC5qcy5tYXAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///5wbO\n");

/***/ }),

/***/ "66Uo":
/*!*************************************************************!*\
  !*** ./node_modules/msal/lib-es6/cache/AccessTokenValue.js ***!
  \*************************************************************/
/*! exports provided: AccessTokenValue */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AccessTokenValue\", function() { return AccessTokenValue; });\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n/**\r\n * @hidden\r\n */\r\nvar AccessTokenValue = /** @class */ (function () {\r\n    function AccessTokenValue(accessToken, idToken, expiresIn, homeAccountIdentifier) {\r\n        this.accessToken = accessToken;\r\n        this.idToken = idToken;\r\n        this.expiresIn = expiresIn;\r\n        this.homeAccountIdentifier = homeAccountIdentifier;\r\n    }\r\n    return AccessTokenValue;\r\n}());\r\n\r\n//# sourceMappingURL=AccessTokenValue.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjZVby5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tc2FsL2xpYi1lczYvY2FjaGUvQWNjZXNzVG9rZW5WYWx1ZS5qcz9lYmE1Il0sInNvdXJjZXNDb250ZW50IjpbIi8qXHJcbiAqIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogQGhpZGRlblxyXG4gKi9cclxudmFyIEFjY2Vzc1Rva2VuVmFsdWUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBBY2Nlc3NUb2tlblZhbHVlKGFjY2Vzc1Rva2VuLCBpZFRva2VuLCBleHBpcmVzSW4sIGhvbWVBY2NvdW50SWRlbnRpZmllcikge1xyXG4gICAgICAgIHRoaXMuYWNjZXNzVG9rZW4gPSBhY2Nlc3NUb2tlbjtcclxuICAgICAgICB0aGlzLmlkVG9rZW4gPSBpZFRva2VuO1xyXG4gICAgICAgIHRoaXMuZXhwaXJlc0luID0gZXhwaXJlc0luO1xyXG4gICAgICAgIHRoaXMuaG9tZUFjY291bnRJZGVudGlmaWVyID0gaG9tZUFjY291bnRJZGVudGlmaWVyO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIEFjY2Vzc1Rva2VuVmFsdWU7XHJcbn0oKSk7XHJcbmV4cG9ydCB7IEFjY2Vzc1Rva2VuVmFsdWUgfTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9QWNjZXNzVG9rZW5WYWx1ZS5qcy5tYXAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///66Uo\n");

/***/ }),

/***/ "7ZR7":
/*!************************************************************!*\
  !*** ./node_modules/msal/lib-es6/error/ClientAuthError.js ***!
  \************************************************************/
/*! exports provided: ClientAuthErrorMessage, ClientAuthError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ClientAuthErrorMessage\", function() { return ClientAuthErrorMessage; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ClientAuthError\", function() { return ClientAuthError; });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ \"mrSG\");\n/* harmony import */ var _AuthError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AuthError */ \"T0bz\");\n/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/StringUtils */ \"Emp/\");\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\n\r\n\r\nvar ClientAuthErrorMessage = {\r\n    multipleCacheAuthorities: {\r\n        code: \"multiple_authorities\",\r\n        desc: \"Multiple authorities found in the cache. Pass authority in the API overload.\"\r\n    },\r\n    endpointResolutionError: {\r\n        code: \"endpoints_resolution_error\",\r\n        desc: \"Error: could not resolve endpoints. Please check network and try again.\"\r\n    },\r\n    popUpWindowError: {\r\n        code: \"popup_window_error\",\r\n        desc: \"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.\"\r\n    },\r\n    tokenRenewalError: {\r\n        code: \"token_renewal_error\",\r\n        desc: \"Token renewal operation failed due to timeout.\"\r\n    },\r\n    invalidIdToken: {\r\n        code: \"invalid_id_token\",\r\n        desc: \"Invalid ID token format.\"\r\n    },\r\n    invalidStateError: {\r\n        code: \"invalid_state_error\",\r\n        desc: \"Invalid state.\"\r\n    },\r\n    nonceMismatchError: {\r\n        code: \"nonce_mismatch_error\",\r\n        desc: \"Nonce is not matching, Nonce received: \"\r\n    },\r\n    loginProgressError: {\r\n        code: \"login_progress_error\",\r\n        desc: \"Login_In_Progress: Error during login call - login is already in progress.\"\r\n    },\r\n    acquireTokenProgressError: {\r\n        code: \"acquiretoken_progress_error\",\r\n        desc: \"AcquireToken_In_Progress: Error during login call - login is already in progress.\"\r\n    },\r\n    userCancelledError: {\r\n        code: \"user_cancelled\",\r\n        desc: \"User cancelled the flow.\"\r\n    },\r\n    callbackError: {\r\n        code: \"callback_error\",\r\n        desc: \"Error occurred in token received callback function.\"\r\n    },\r\n    userLoginRequiredError: {\r\n        code: \"user_login_error\",\r\n        desc: \"User login is required. For silent calls, request must contain either sid or login_hint\"\r\n    },\r\n    userDoesNotExistError: {\r\n        code: \"user_non_existent\",\r\n        desc: \"User object does not exist. Please call a login API.\"\r\n    },\r\n    clientInfoDecodingError: {\r\n        code: \"client_info_decoding_error\",\r\n        desc: \"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause.\"\r\n    },\r\n    clientInfoNotPopulatedError: {\r\n        code: \"client_info_not_populated_error\",\r\n        desc: \"The service did not populate client_info in the response, Please verify with the service team\"\r\n    },\r\n    nullOrEmptyIdToken: {\r\n        code: \"null_or_empty_id_token\",\r\n        desc: \"The idToken is null or empty. Please review the trace to determine the root cause.\"\r\n    },\r\n    idTokenNotParsed: {\r\n        code: \"id_token_parsing_error\",\r\n        desc: \"ID token cannot be parsed. Please review stack trace to determine root cause.\"\r\n    },\r\n    tokenEncodingError: {\r\n        code: \"token_encoding_error\",\r\n        desc: \"The token to be decoded is not encoded correctly.\"\r\n    },\r\n    invalidInteractionType: {\r\n        code: \"invalid_interaction_type\",\r\n        desc: \"The interaction type passed to the handler was incorrect or unknown\"\r\n    },\r\n    cacheParseError: {\r\n        code: \"cannot_parse_cache\",\r\n        desc: \"The cached token key is not a valid JSON and cannot be parsed\"\r\n    },\r\n    blockTokenRequestsInHiddenIframe: {\r\n        code: \"block_token_requests\",\r\n        desc: \"Token calls are blocked in hidden iframes\"\r\n    }\r\n};\r\n/**\r\n * Error thrown when there is an error in the client code running on the browser.\r\n */\r\nvar ClientAuthError = /** @class */ (function (_super) {\r\n    tslib__WEBPACK_IMPORTED_MODULE_0__[\"__extends\"](ClientAuthError, _super);\r\n    function ClientAuthError(errorCode, errorMessage) {\r\n        var _this = _super.call(this, errorCode, errorMessage) || this;\r\n        _this.name = \"ClientAuthError\";\r\n        Object.setPrototypeOf(_this, ClientAuthError.prototype);\r\n        return _this;\r\n    }\r\n    ClientAuthError.createEndpointResolutionError = function (errDetail) {\r\n        var errorMessage = ClientAuthErrorMessage.endpointResolutionError.desc;\r\n        if (errDetail && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__[\"StringUtils\"].isEmpty(errDetail)) {\r\n            errorMessage += \" Details: \" + errDetail;\r\n        }\r\n        return new ClientAuthError(ClientAuthErrorMessage.endpointResolutionError.code, errorMessage);\r\n    };\r\n    ClientAuthError.createMultipleAuthoritiesInCacheError = function (scope) {\r\n        return new ClientAuthError(ClientAuthErrorMessage.multipleCacheAuthorities.code, \"Cache error for scope \" + scope + \": \" + ClientAuthErrorMessage.multipleCacheAuthorities.desc + \".\");\r\n    };\r\n    ClientAuthError.createPopupWindowError = function (errDetail) {\r\n        var errorMessage = ClientAuthErrorMessage.popUpWindowError.desc;\r\n        if (errDetail && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__[\"StringUtils\"].isEmpty(errDetail)) {\r\n            errorMessage += \" Details: \" + errDetail;\r\n        }\r\n        return new ClientAuthError(ClientAuthErrorMessage.popUpWindowError.code, errorMessage);\r\n    };\r\n    ClientAuthError.createTokenRenewalTimeoutError = function () {\r\n        return new ClientAuthError(ClientAuthErrorMessage.tokenRenewalError.code, ClientAuthErrorMessage.tokenRenewalError.desc);\r\n    };\r\n    ClientAuthError.createInvalidIdTokenError = function (idToken) {\r\n        return new ClientAuthError(ClientAuthErrorMessage.invalidIdToken.code, ClientAuthErrorMessage.invalidIdToken.desc + \" Given token: \" + idToken);\r\n    };\r\n    // TODO: Is this not a security flaw to send the user the state expected??\r\n    ClientAuthError.createInvalidStateError = function (invalidState, actualState) {\r\n        return new ClientAuthError(ClientAuthErrorMessage.invalidStateError.code, ClientAuthErrorMessage.invalidStateError.desc + \" \" + invalidState + \", state expected : \" + actualState + \".\");\r\n    };\r\n    // TODO: Is this not a security flaw to send the user the Nonce expected??\r\n    ClientAuthError.createNonceMismatchError = function (invalidNonce, actualNonce) {\r\n        return new ClientAuthError(ClientAuthErrorMessage.nonceMismatchError.code, ClientAuthErrorMessage.nonceMismatchError.desc + \" \" + invalidNonce + \", nonce expected : \" + actualNonce + \".\");\r\n    };\r\n    ClientAuthError.createLoginInProgressError = function () {\r\n        return new ClientAuthError(ClientAuthErrorMessage.loginProgressError.code, ClientAuthErrorMessage.loginProgressError.desc);\r\n    };\r\n    ClientAuthError.createAcquireTokenInProgressError = function () {\r\n        return new ClientAuthError(ClientAuthErrorMessage.acquireTokenProgressError.code, ClientAuthErrorMessage.acquireTokenProgressError.desc);\r\n    };\r\n    ClientAuthError.createUserCancelledError = function () {\r\n        return new ClientAuthError(ClientAuthErrorMessage.userCancelledError.code, ClientAuthErrorMessage.userCancelledError.desc);\r\n    };\r\n    ClientAuthError.createErrorInCallbackFunction = function (errorDesc) {\r\n        return new ClientAuthError(ClientAuthErrorMessage.callbackError.code, ClientAuthErrorMessage.callbackError.desc + \" \" + errorDesc + \".\");\r\n    };\r\n    ClientAuthError.createUserLoginRequiredError = function () {\r\n        return new ClientAuthError(ClientAuthErrorMessage.userLoginRequiredError.code, ClientAuthErrorMessage.userLoginRequiredError.desc);\r\n    };\r\n    ClientAuthError.createUserDoesNotExistError = function () {\r\n        return new ClientAuthError(ClientAuthErrorMessage.userDoesNotExistError.code, ClientAuthErrorMessage.userDoesNotExistError.desc);\r\n    };\r\n    ClientAuthError.createClientInfoDecodingError = function (caughtError) {\r\n        return new ClientAuthError(ClientAuthErrorMessage.clientInfoDecodingError.code, ClientAuthErrorMessage.clientInfoDecodingError.desc + \" Failed with error: \" + caughtError);\r\n    };\r\n    ClientAuthError.createClientInfoNotPopulatedError = function (caughtError) {\r\n        return new ClientAuthError(ClientAuthErrorMessage.clientInfoNotPopulatedError.code, ClientAuthErrorMessage.clientInfoNotPopulatedError.desc + \" Failed with error: \" + caughtError);\r\n    };\r\n    ClientAuthError.createIdTokenNullOrEmptyError = function (invalidRawTokenString) {\r\n        return new ClientAuthError(ClientAuthErrorMessage.nullOrEmptyIdToken.code, ClientAuthErrorMessage.nullOrEmptyIdToken.desc + \" Raw ID Token Value: \" + invalidRawTokenString);\r\n    };\r\n    ClientAuthError.createIdTokenParsingError = function (caughtParsingError) {\r\n        return new ClientAuthError(ClientAuthErrorMessage.idTokenNotParsed.code, ClientAuthErrorMessage.idTokenNotParsed.desc + \" Failed with error: \" + caughtParsingError);\r\n    };\r\n    ClientAuthError.createTokenEncodingError = function (incorrectlyEncodedToken) {\r\n        return new ClientAuthError(ClientAuthErrorMessage.tokenEncodingError.code, ClientAuthErrorMessage.tokenEncodingError.desc + \" Attempted to decode: \" + incorrectlyEncodedToken);\r\n    };\r\n    ClientAuthError.createInvalidInteractionTypeError = function () {\r\n        return new ClientAuthError(ClientAuthErrorMessage.invalidInteractionType.code, ClientAuthErrorMessage.invalidInteractionType.desc);\r\n    };\r\n    ClientAuthError.createCacheParseError = function (key) {\r\n        var errorMessage = \"invalid key: \" + key + \", \" + ClientAuthErrorMessage.cacheParseError.desc;\r\n        return new ClientAuthError(ClientAuthErrorMessage.cacheParseError.code, errorMessage);\r\n    };\r\n    ClientAuthError.createBlockTokenRequestsInHiddenIframeError = function () {\r\n        return new ClientAuthError(ClientAuthErrorMessage.blockTokenRequestsInHiddenIframe.code, ClientAuthErrorMessage.blockTokenRequestsInHiddenIframe.desc);\r\n    };\r\n    return ClientAuthError;\r\n}(_AuthError__WEBPACK_IMPORTED_MODULE_1__[\"AuthError\"]));\r\n\r\n//# sourceMappingURL=ClientAuthError.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiN1pSNy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tc2FsL2xpYi1lczYvZXJyb3IvQ2xpZW50QXV0aEVycm9yLmpzP2VkOTQiXSwic291cmNlc0NvbnRlbnQiOlsiLypcclxuICogQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuICovXHJcbmltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IEF1dGhFcnJvciB9IGZyb20gXCIuL0F1dGhFcnJvclwiO1xyXG5pbXBvcnQgeyBTdHJpbmdVdGlscyB9IGZyb20gXCIuLi91dGlscy9TdHJpbmdVdGlsc1wiO1xyXG5leHBvcnQgdmFyIENsaWVudEF1dGhFcnJvck1lc3NhZ2UgPSB7XHJcbiAgICBtdWx0aXBsZUNhY2hlQXV0aG9yaXRpZXM6IHtcclxuICAgICAgICBjb2RlOiBcIm11bHRpcGxlX2F1dGhvcml0aWVzXCIsXHJcbiAgICAgICAgZGVzYzogXCJNdWx0aXBsZSBhdXRob3JpdGllcyBmb3VuZCBpbiB0aGUgY2FjaGUuIFBhc3MgYXV0aG9yaXR5IGluIHRoZSBBUEkgb3ZlcmxvYWQuXCJcclxuICAgIH0sXHJcbiAgICBlbmRwb2ludFJlc29sdXRpb25FcnJvcjoge1xyXG4gICAgICAgIGNvZGU6IFwiZW5kcG9pbnRzX3Jlc29sdXRpb25fZXJyb3JcIixcclxuICAgICAgICBkZXNjOiBcIkVycm9yOiBjb3VsZCBub3QgcmVzb2x2ZSBlbmRwb2ludHMuIFBsZWFzZSBjaGVjayBuZXR3b3JrIGFuZCB0cnkgYWdhaW4uXCJcclxuICAgIH0sXHJcbiAgICBwb3BVcFdpbmRvd0Vycm9yOiB7XHJcbiAgICAgICAgY29kZTogXCJwb3B1cF93aW5kb3dfZXJyb3JcIixcclxuICAgICAgICBkZXNjOiBcIkVycm9yIG9wZW5pbmcgcG9wdXAgd2luZG93LiBUaGlzIGNhbiBoYXBwZW4gaWYgeW91IGFyZSB1c2luZyBJRSBvciBpZiBwb3B1cHMgYXJlIGJsb2NrZWQgaW4gdGhlIGJyb3dzZXIuXCJcclxuICAgIH0sXHJcbiAgICB0b2tlblJlbmV3YWxFcnJvcjoge1xyXG4gICAgICAgIGNvZGU6IFwidG9rZW5fcmVuZXdhbF9lcnJvclwiLFxyXG4gICAgICAgIGRlc2M6IFwiVG9rZW4gcmVuZXdhbCBvcGVyYXRpb24gZmFpbGVkIGR1ZSB0byB0aW1lb3V0LlwiXHJcbiAgICB9LFxyXG4gICAgaW52YWxpZElkVG9rZW46IHtcclxuICAgICAgICBjb2RlOiBcImludmFsaWRfaWRfdG9rZW5cIixcclxuICAgICAgICBkZXNjOiBcIkludmFsaWQgSUQgdG9rZW4gZm9ybWF0LlwiXHJcbiAgICB9LFxyXG4gICAgaW52YWxpZFN0YXRlRXJyb3I6IHtcclxuICAgICAgICBjb2RlOiBcImludmFsaWRfc3RhdGVfZXJyb3JcIixcclxuICAgICAgICBkZXNjOiBcIkludmFsaWQgc3RhdGUuXCJcclxuICAgIH0sXHJcbiAgICBub25jZU1pc21hdGNoRXJyb3I6IHtcclxuICAgICAgICBjb2RlOiBcIm5vbmNlX21pc21hdGNoX2Vycm9yXCIsXHJcbiAgICAgICAgZGVzYzogXCJOb25jZSBpcyBub3QgbWF0Y2hpbmcsIE5vbmNlIHJlY2VpdmVkOiBcIlxyXG4gICAgfSxcclxuICAgIGxvZ2luUHJvZ3Jlc3NFcnJvcjoge1xyXG4gICAgICAgIGNvZGU6IFwibG9naW5fcHJvZ3Jlc3NfZXJyb3JcIixcclxuICAgICAgICBkZXNjOiBcIkxvZ2luX0luX1Byb2dyZXNzOiBFcnJvciBkdXJpbmcgbG9naW4gY2FsbCAtIGxvZ2luIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3MuXCJcclxuICAgIH0sXHJcbiAgICBhY3F1aXJlVG9rZW5Qcm9ncmVzc0Vycm9yOiB7XHJcbiAgICAgICAgY29kZTogXCJhY3F1aXJldG9rZW5fcHJvZ3Jlc3NfZXJyb3JcIixcclxuICAgICAgICBkZXNjOiBcIkFjcXVpcmVUb2tlbl9Jbl9Qcm9ncmVzczogRXJyb3IgZHVyaW5nIGxvZ2luIGNhbGwgLSBsb2dpbiBpcyBhbHJlYWR5IGluIHByb2dyZXNzLlwiXHJcbiAgICB9LFxyXG4gICAgdXNlckNhbmNlbGxlZEVycm9yOiB7XHJcbiAgICAgICAgY29kZTogXCJ1c2VyX2NhbmNlbGxlZFwiLFxyXG4gICAgICAgIGRlc2M6IFwiVXNlciBjYW5jZWxsZWQgdGhlIGZsb3cuXCJcclxuICAgIH0sXHJcbiAgICBjYWxsYmFja0Vycm9yOiB7XHJcbiAgICAgICAgY29kZTogXCJjYWxsYmFja19lcnJvclwiLFxyXG4gICAgICAgIGRlc2M6IFwiRXJyb3Igb2NjdXJyZWQgaW4gdG9rZW4gcmVjZWl2ZWQgY2FsbGJhY2sgZnVuY3Rpb24uXCJcclxuICAgIH0sXHJcbiAgICB1c2VyTG9naW5SZXF1aXJlZEVycm9yOiB7XHJcbiAgICAgICAgY29kZTogXCJ1c2VyX2xvZ2luX2Vycm9yXCIsXHJcbiAgICAgICAgZGVzYzogXCJVc2VyIGxvZ2luIGlzIHJlcXVpcmVkLiBGb3Igc2lsZW50IGNhbGxzLCByZXF1ZXN0IG11c3QgY29udGFpbiBlaXRoZXIgc2lkIG9yIGxvZ2luX2hpbnRcIlxyXG4gICAgfSxcclxuICAgIHVzZXJEb2VzTm90RXhpc3RFcnJvcjoge1xyXG4gICAgICAgIGNvZGU6IFwidXNlcl9ub25fZXhpc3RlbnRcIixcclxuICAgICAgICBkZXNjOiBcIlVzZXIgb2JqZWN0IGRvZXMgbm90IGV4aXN0LiBQbGVhc2UgY2FsbCBhIGxvZ2luIEFQSS5cIlxyXG4gICAgfSxcclxuICAgIGNsaWVudEluZm9EZWNvZGluZ0Vycm9yOiB7XHJcbiAgICAgICAgY29kZTogXCJjbGllbnRfaW5mb19kZWNvZGluZ19lcnJvclwiLFxyXG4gICAgICAgIGRlc2M6IFwiVGhlIGNsaWVudCBpbmZvIGNvdWxkIG5vdCBiZSBwYXJzZWQvZGVjb2RlZCBjb3JyZWN0bHkuIFBsZWFzZSByZXZpZXcgdGhlIHRyYWNlIHRvIGRldGVybWluZSB0aGUgcm9vdCBjYXVzZS5cIlxyXG4gICAgfSxcclxuICAgIGNsaWVudEluZm9Ob3RQb3B1bGF0ZWRFcnJvcjoge1xyXG4gICAgICAgIGNvZGU6IFwiY2xpZW50X2luZm9fbm90X3BvcHVsYXRlZF9lcnJvclwiLFxyXG4gICAgICAgIGRlc2M6IFwiVGhlIHNlcnZpY2UgZGlkIG5vdCBwb3B1bGF0ZSBjbGllbnRfaW5mbyBpbiB0aGUgcmVzcG9uc2UsIFBsZWFzZSB2ZXJpZnkgd2l0aCB0aGUgc2VydmljZSB0ZWFtXCJcclxuICAgIH0sXHJcbiAgICBudWxsT3JFbXB0eUlkVG9rZW46IHtcclxuICAgICAgICBjb2RlOiBcIm51bGxfb3JfZW1wdHlfaWRfdG9rZW5cIixcclxuICAgICAgICBkZXNjOiBcIlRoZSBpZFRva2VuIGlzIG51bGwgb3IgZW1wdHkuIFBsZWFzZSByZXZpZXcgdGhlIHRyYWNlIHRvIGRldGVybWluZSB0aGUgcm9vdCBjYXVzZS5cIlxyXG4gICAgfSxcclxuICAgIGlkVG9rZW5Ob3RQYXJzZWQ6IHtcclxuICAgICAgICBjb2RlOiBcImlkX3Rva2VuX3BhcnNpbmdfZXJyb3JcIixcclxuICAgICAgICBkZXNjOiBcIklEIHRva2VuIGNhbm5vdCBiZSBwYXJzZWQuIFBsZWFzZSByZXZpZXcgc3RhY2sgdHJhY2UgdG8gZGV0ZXJtaW5lIHJvb3QgY2F1c2UuXCJcclxuICAgIH0sXHJcbiAgICB0b2tlbkVuY29kaW5nRXJyb3I6IHtcclxuICAgICAgICBjb2RlOiBcInRva2VuX2VuY29kaW5nX2Vycm9yXCIsXHJcbiAgICAgICAgZGVzYzogXCJUaGUgdG9rZW4gdG8gYmUgZGVjb2RlZCBpcyBub3QgZW5jb2RlZCBjb3JyZWN0bHkuXCJcclxuICAgIH0sXHJcbiAgICBpbnZhbGlkSW50ZXJhY3Rpb25UeXBlOiB7XHJcbiAgICAgICAgY29kZTogXCJpbnZhbGlkX2ludGVyYWN0aW9uX3R5cGVcIixcclxuICAgICAgICBkZXNjOiBcIlRoZSBpbnRlcmFjdGlvbiB0eXBlIHBhc3NlZCB0byB0aGUgaGFuZGxlciB3YXMgaW5jb3JyZWN0IG9yIHVua25vd25cIlxyXG4gICAgfSxcclxuICAgIGNhY2hlUGFyc2VFcnJvcjoge1xyXG4gICAgICAgIGNvZGU6IFwiY2Fubm90X3BhcnNlX2NhY2hlXCIsXHJcbiAgICAgICAgZGVzYzogXCJUaGUgY2FjaGVkIHRva2VuIGtleSBpcyBub3QgYSB2YWxpZCBKU09OIGFuZCBjYW5ub3QgYmUgcGFyc2VkXCJcclxuICAgIH0sXHJcbiAgICBibG9ja1Rva2VuUmVxdWVzdHNJbkhpZGRlbklmcmFtZToge1xyXG4gICAgICAgIGNvZGU6IFwiYmxvY2tfdG9rZW5fcmVxdWVzdHNcIixcclxuICAgICAgICBkZXNjOiBcIlRva2VuIGNhbGxzIGFyZSBibG9ja2VkIGluIGhpZGRlbiBpZnJhbWVzXCJcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqIEVycm9yIHRocm93biB3aGVuIHRoZXJlIGlzIGFuIGVycm9yIGluIHRoZSBjbGllbnQgY29kZSBydW5uaW5nIG9uIHRoZSBicm93c2VyLlxyXG4gKi9cclxudmFyIENsaWVudEF1dGhFcnJvciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKENsaWVudEF1dGhFcnJvciwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIENsaWVudEF1dGhFcnJvcihlcnJvckNvZGUsIGVycm9yTWVzc2FnZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGVycm9yQ29kZSwgZXJyb3JNZXNzYWdlKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLm5hbWUgPSBcIkNsaWVudEF1dGhFcnJvclwiO1xyXG4gICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihfdGhpcywgQ2xpZW50QXV0aEVycm9yLnByb3RvdHlwZSk7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgQ2xpZW50QXV0aEVycm9yLmNyZWF0ZUVuZHBvaW50UmVzb2x1dGlvbkVycm9yID0gZnVuY3Rpb24gKGVyckRldGFpbCkge1xyXG4gICAgICAgIHZhciBlcnJvck1lc3NhZ2UgPSBDbGllbnRBdXRoRXJyb3JNZXNzYWdlLmVuZHBvaW50UmVzb2x1dGlvbkVycm9yLmRlc2M7XHJcbiAgICAgICAgaWYgKGVyckRldGFpbCAmJiAhU3RyaW5nVXRpbHMuaXNFbXB0eShlcnJEZXRhaWwpKSB7XHJcbiAgICAgICAgICAgIGVycm9yTWVzc2FnZSArPSBcIiBEZXRhaWxzOiBcIiArIGVyckRldGFpbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBDbGllbnRBdXRoRXJyb3IoQ2xpZW50QXV0aEVycm9yTWVzc2FnZS5lbmRwb2ludFJlc29sdXRpb25FcnJvci5jb2RlLCBlcnJvck1lc3NhZ2UpO1xyXG4gICAgfTtcclxuICAgIENsaWVudEF1dGhFcnJvci5jcmVhdGVNdWx0aXBsZUF1dGhvcml0aWVzSW5DYWNoZUVycm9yID0gZnVuY3Rpb24gKHNjb3BlKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBDbGllbnRBdXRoRXJyb3IoQ2xpZW50QXV0aEVycm9yTWVzc2FnZS5tdWx0aXBsZUNhY2hlQXV0aG9yaXRpZXMuY29kZSwgXCJDYWNoZSBlcnJvciBmb3Igc2NvcGUgXCIgKyBzY29wZSArIFwiOiBcIiArIENsaWVudEF1dGhFcnJvck1lc3NhZ2UubXVsdGlwbGVDYWNoZUF1dGhvcml0aWVzLmRlc2MgKyBcIi5cIik7XHJcbiAgICB9O1xyXG4gICAgQ2xpZW50QXV0aEVycm9yLmNyZWF0ZVBvcHVwV2luZG93RXJyb3IgPSBmdW5jdGlvbiAoZXJyRGV0YWlsKSB7XHJcbiAgICAgICAgdmFyIGVycm9yTWVzc2FnZSA9IENsaWVudEF1dGhFcnJvck1lc3NhZ2UucG9wVXBXaW5kb3dFcnJvci5kZXNjO1xyXG4gICAgICAgIGlmIChlcnJEZXRhaWwgJiYgIVN0cmluZ1V0aWxzLmlzRW1wdHkoZXJyRGV0YWlsKSkge1xyXG4gICAgICAgICAgICBlcnJvck1lc3NhZ2UgKz0gXCIgRGV0YWlsczogXCIgKyBlcnJEZXRhaWw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXcgQ2xpZW50QXV0aEVycm9yKENsaWVudEF1dGhFcnJvck1lc3NhZ2UucG9wVXBXaW5kb3dFcnJvci5jb2RlLCBlcnJvck1lc3NhZ2UpO1xyXG4gICAgfTtcclxuICAgIENsaWVudEF1dGhFcnJvci5jcmVhdGVUb2tlblJlbmV3YWxUaW1lb3V0RXJyb3IgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBDbGllbnRBdXRoRXJyb3IoQ2xpZW50QXV0aEVycm9yTWVzc2FnZS50b2tlblJlbmV3YWxFcnJvci5jb2RlLCBDbGllbnRBdXRoRXJyb3JNZXNzYWdlLnRva2VuUmVuZXdhbEVycm9yLmRlc2MpO1xyXG4gICAgfTtcclxuICAgIENsaWVudEF1dGhFcnJvci5jcmVhdGVJbnZhbGlkSWRUb2tlbkVycm9yID0gZnVuY3Rpb24gKGlkVG9rZW4pIHtcclxuICAgICAgICByZXR1cm4gbmV3IENsaWVudEF1dGhFcnJvcihDbGllbnRBdXRoRXJyb3JNZXNzYWdlLmludmFsaWRJZFRva2VuLmNvZGUsIENsaWVudEF1dGhFcnJvck1lc3NhZ2UuaW52YWxpZElkVG9rZW4uZGVzYyArIFwiIEdpdmVuIHRva2VuOiBcIiArIGlkVG9rZW4pO1xyXG4gICAgfTtcclxuICAgIC8vIFRPRE86IElzIHRoaXMgbm90IGEgc2VjdXJpdHkgZmxhdyB0byBzZW5kIHRoZSB1c2VyIHRoZSBzdGF0ZSBleHBlY3RlZD8/XHJcbiAgICBDbGllbnRBdXRoRXJyb3IuY3JlYXRlSW52YWxpZFN0YXRlRXJyb3IgPSBmdW5jdGlvbiAoaW52YWxpZFN0YXRlLCBhY3R1YWxTdGF0ZSkge1xyXG4gICAgICAgIHJldHVybiBuZXcgQ2xpZW50QXV0aEVycm9yKENsaWVudEF1dGhFcnJvck1lc3NhZ2UuaW52YWxpZFN0YXRlRXJyb3IuY29kZSwgQ2xpZW50QXV0aEVycm9yTWVzc2FnZS5pbnZhbGlkU3RhdGVFcnJvci5kZXNjICsgXCIgXCIgKyBpbnZhbGlkU3RhdGUgKyBcIiwgc3RhdGUgZXhwZWN0ZWQgOiBcIiArIGFjdHVhbFN0YXRlICsgXCIuXCIpO1xyXG4gICAgfTtcclxuICAgIC8vIFRPRE86IElzIHRoaXMgbm90IGEgc2VjdXJpdHkgZmxhdyB0byBzZW5kIHRoZSB1c2VyIHRoZSBOb25jZSBleHBlY3RlZD8/XHJcbiAgICBDbGllbnRBdXRoRXJyb3IuY3JlYXRlTm9uY2VNaXNtYXRjaEVycm9yID0gZnVuY3Rpb24gKGludmFsaWROb25jZSwgYWN0dWFsTm9uY2UpIHtcclxuICAgICAgICByZXR1cm4gbmV3IENsaWVudEF1dGhFcnJvcihDbGllbnRBdXRoRXJyb3JNZXNzYWdlLm5vbmNlTWlzbWF0Y2hFcnJvci5jb2RlLCBDbGllbnRBdXRoRXJyb3JNZXNzYWdlLm5vbmNlTWlzbWF0Y2hFcnJvci5kZXNjICsgXCIgXCIgKyBpbnZhbGlkTm9uY2UgKyBcIiwgbm9uY2UgZXhwZWN0ZWQgOiBcIiArIGFjdHVhbE5vbmNlICsgXCIuXCIpO1xyXG4gICAgfTtcclxuICAgIENsaWVudEF1dGhFcnJvci5jcmVhdGVMb2dpbkluUHJvZ3Jlc3NFcnJvciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gbmV3IENsaWVudEF1dGhFcnJvcihDbGllbnRBdXRoRXJyb3JNZXNzYWdlLmxvZ2luUHJvZ3Jlc3NFcnJvci5jb2RlLCBDbGllbnRBdXRoRXJyb3JNZXNzYWdlLmxvZ2luUHJvZ3Jlc3NFcnJvci5kZXNjKTtcclxuICAgIH07XHJcbiAgICBDbGllbnRBdXRoRXJyb3IuY3JlYXRlQWNxdWlyZVRva2VuSW5Qcm9ncmVzc0Vycm9yID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgQ2xpZW50QXV0aEVycm9yKENsaWVudEF1dGhFcnJvck1lc3NhZ2UuYWNxdWlyZVRva2VuUHJvZ3Jlc3NFcnJvci5jb2RlLCBDbGllbnRBdXRoRXJyb3JNZXNzYWdlLmFjcXVpcmVUb2tlblByb2dyZXNzRXJyb3IuZGVzYyk7XHJcbiAgICB9O1xyXG4gICAgQ2xpZW50QXV0aEVycm9yLmNyZWF0ZVVzZXJDYW5jZWxsZWRFcnJvciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gbmV3IENsaWVudEF1dGhFcnJvcihDbGllbnRBdXRoRXJyb3JNZXNzYWdlLnVzZXJDYW5jZWxsZWRFcnJvci5jb2RlLCBDbGllbnRBdXRoRXJyb3JNZXNzYWdlLnVzZXJDYW5jZWxsZWRFcnJvci5kZXNjKTtcclxuICAgIH07XHJcbiAgICBDbGllbnRBdXRoRXJyb3IuY3JlYXRlRXJyb3JJbkNhbGxiYWNrRnVuY3Rpb24gPSBmdW5jdGlvbiAoZXJyb3JEZXNjKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBDbGllbnRBdXRoRXJyb3IoQ2xpZW50QXV0aEVycm9yTWVzc2FnZS5jYWxsYmFja0Vycm9yLmNvZGUsIENsaWVudEF1dGhFcnJvck1lc3NhZ2UuY2FsbGJhY2tFcnJvci5kZXNjICsgXCIgXCIgKyBlcnJvckRlc2MgKyBcIi5cIik7XHJcbiAgICB9O1xyXG4gICAgQ2xpZW50QXV0aEVycm9yLmNyZWF0ZVVzZXJMb2dpblJlcXVpcmVkRXJyb3IgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBDbGllbnRBdXRoRXJyb3IoQ2xpZW50QXV0aEVycm9yTWVzc2FnZS51c2VyTG9naW5SZXF1aXJlZEVycm9yLmNvZGUsIENsaWVudEF1dGhFcnJvck1lc3NhZ2UudXNlckxvZ2luUmVxdWlyZWRFcnJvci5kZXNjKTtcclxuICAgIH07XHJcbiAgICBDbGllbnRBdXRoRXJyb3IuY3JlYXRlVXNlckRvZXNOb3RFeGlzdEVycm9yID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgQ2xpZW50QXV0aEVycm9yKENsaWVudEF1dGhFcnJvck1lc3NhZ2UudXNlckRvZXNOb3RFeGlzdEVycm9yLmNvZGUsIENsaWVudEF1dGhFcnJvck1lc3NhZ2UudXNlckRvZXNOb3RFeGlzdEVycm9yLmRlc2MpO1xyXG4gICAgfTtcclxuICAgIENsaWVudEF1dGhFcnJvci5jcmVhdGVDbGllbnRJbmZvRGVjb2RpbmdFcnJvciA9IGZ1bmN0aW9uIChjYXVnaHRFcnJvcikge1xyXG4gICAgICAgIHJldHVybiBuZXcgQ2xpZW50QXV0aEVycm9yKENsaWVudEF1dGhFcnJvck1lc3NhZ2UuY2xpZW50SW5mb0RlY29kaW5nRXJyb3IuY29kZSwgQ2xpZW50QXV0aEVycm9yTWVzc2FnZS5jbGllbnRJbmZvRGVjb2RpbmdFcnJvci5kZXNjICsgXCIgRmFpbGVkIHdpdGggZXJyb3I6IFwiICsgY2F1Z2h0RXJyb3IpO1xyXG4gICAgfTtcclxuICAgIENsaWVudEF1dGhFcnJvci5jcmVhdGVDbGllbnRJbmZvTm90UG9wdWxhdGVkRXJyb3IgPSBmdW5jdGlvbiAoY2F1Z2h0RXJyb3IpIHtcclxuICAgICAgICByZXR1cm4gbmV3IENsaWVudEF1dGhFcnJvcihDbGllbnRBdXRoRXJyb3JNZXNzYWdlLmNsaWVudEluZm9Ob3RQb3B1bGF0ZWRFcnJvci5jb2RlLCBDbGllbnRBdXRoRXJyb3JNZXNzYWdlLmNsaWVudEluZm9Ob3RQb3B1bGF0ZWRFcnJvci5kZXNjICsgXCIgRmFpbGVkIHdpdGggZXJyb3I6IFwiICsgY2F1Z2h0RXJyb3IpO1xyXG4gICAgfTtcclxuICAgIENsaWVudEF1dGhFcnJvci5jcmVhdGVJZFRva2VuTnVsbE9yRW1wdHlFcnJvciA9IGZ1bmN0aW9uIChpbnZhbGlkUmF3VG9rZW5TdHJpbmcpIHtcclxuICAgICAgICByZXR1cm4gbmV3IENsaWVudEF1dGhFcnJvcihDbGllbnRBdXRoRXJyb3JNZXNzYWdlLm51bGxPckVtcHR5SWRUb2tlbi5jb2RlLCBDbGllbnRBdXRoRXJyb3JNZXNzYWdlLm51bGxPckVtcHR5SWRUb2tlbi5kZXNjICsgXCIgUmF3IElEIFRva2VuIFZhbHVlOiBcIiArIGludmFsaWRSYXdUb2tlblN0cmluZyk7XHJcbiAgICB9O1xyXG4gICAgQ2xpZW50QXV0aEVycm9yLmNyZWF0ZUlkVG9rZW5QYXJzaW5nRXJyb3IgPSBmdW5jdGlvbiAoY2F1Z2h0UGFyc2luZ0Vycm9yKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBDbGllbnRBdXRoRXJyb3IoQ2xpZW50QXV0aEVycm9yTWVzc2FnZS5pZFRva2VuTm90UGFyc2VkLmNvZGUsIENsaWVudEF1dGhFcnJvck1lc3NhZ2UuaWRUb2tlbk5vdFBhcnNlZC5kZXNjICsgXCIgRmFpbGVkIHdpdGggZXJyb3I6IFwiICsgY2F1Z2h0UGFyc2luZ0Vycm9yKTtcclxuICAgIH07XHJcbiAgICBDbGllbnRBdXRoRXJyb3IuY3JlYXRlVG9rZW5FbmNvZGluZ0Vycm9yID0gZnVuY3Rpb24gKGluY29ycmVjdGx5RW5jb2RlZFRva2VuKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBDbGllbnRBdXRoRXJyb3IoQ2xpZW50QXV0aEVycm9yTWVzc2FnZS50b2tlbkVuY29kaW5nRXJyb3IuY29kZSwgQ2xpZW50QXV0aEVycm9yTWVzc2FnZS50b2tlbkVuY29kaW5nRXJyb3IuZGVzYyArIFwiIEF0dGVtcHRlZCB0byBkZWNvZGU6IFwiICsgaW5jb3JyZWN0bHlFbmNvZGVkVG9rZW4pO1xyXG4gICAgfTtcclxuICAgIENsaWVudEF1dGhFcnJvci5jcmVhdGVJbnZhbGlkSW50ZXJhY3Rpb25UeXBlRXJyb3IgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBDbGllbnRBdXRoRXJyb3IoQ2xpZW50QXV0aEVycm9yTWVzc2FnZS5pbnZhbGlkSW50ZXJhY3Rpb25UeXBlLmNvZGUsIENsaWVudEF1dGhFcnJvck1lc3NhZ2UuaW52YWxpZEludGVyYWN0aW9uVHlwZS5kZXNjKTtcclxuICAgIH07XHJcbiAgICBDbGllbnRBdXRoRXJyb3IuY3JlYXRlQ2FjaGVQYXJzZUVycm9yID0gZnVuY3Rpb24gKGtleSkge1xyXG4gICAgICAgIHZhciBlcnJvck1lc3NhZ2UgPSBcImludmFsaWQga2V5OiBcIiArIGtleSArIFwiLCBcIiArIENsaWVudEF1dGhFcnJvck1lc3NhZ2UuY2FjaGVQYXJzZUVycm9yLmRlc2M7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBDbGllbnRBdXRoRXJyb3IoQ2xpZW50QXV0aEVycm9yTWVzc2FnZS5jYWNoZVBhcnNlRXJyb3IuY29kZSwgZXJyb3JNZXNzYWdlKTtcclxuICAgIH07XHJcbiAgICBDbGllbnRBdXRoRXJyb3IuY3JlYXRlQmxvY2tUb2tlblJlcXVlc3RzSW5IaWRkZW5JZnJhbWVFcnJvciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gbmV3IENsaWVudEF1dGhFcnJvcihDbGllbnRBdXRoRXJyb3JNZXNzYWdlLmJsb2NrVG9rZW5SZXF1ZXN0c0luSGlkZGVuSWZyYW1lLmNvZGUsIENsaWVudEF1dGhFcnJvck1lc3NhZ2UuYmxvY2tUb2tlblJlcXVlc3RzSW5IaWRkZW5JZnJhbWUuZGVzYyk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIENsaWVudEF1dGhFcnJvcjtcclxufShBdXRoRXJyb3IpKTtcclxuZXhwb3J0IHsgQ2xpZW50QXV0aEVycm9yIH07XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNsaWVudEF1dGhFcnJvci5qcy5tYXAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///7ZR7\n");

/***/ }),

/***/ "8ImU":
/*!***********************************************!*\
  !*** ./node_modules/msal/lib-es6/ScopeSet.js ***!
  \***********************************************/
/*! exports provided: ScopeSet */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ScopeSet\", function() { return ScopeSet; });\n/* harmony import */ var _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./error/ClientConfigurationError */ \"ZEID\");\n/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/Constants */ \"wmgs\");\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\n\r\nvar ScopeSet = /** @class */ (function () {\r\n    function ScopeSet() {\r\n    }\r\n    /**\r\n     * Check if there are dup scopes in a given request\r\n     *\r\n     * @param cachedScopes\r\n     * @param scopes\r\n     */\r\n    // TODO: Rename this, intersecting scopes isn't a great name for duplicate checker\r\n    ScopeSet.isIntersectingScopes = function (cachedScopes, scopes) {\r\n        var convertedCachedScopes = this.trimAndConvertArrayToLowerCase(cachedScopes.slice());\r\n        var requestScopes = this.trimAndConvertArrayToLowerCase(scopes.slice());\r\n        for (var i = 0; i < requestScopes.length; i++) {\r\n            if (convertedCachedScopes.indexOf(requestScopes[i].toLowerCase()) > -1) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    /**\r\n     * Check if a given scope is present in the request\r\n     *\r\n     * @param cachedScopes\r\n     * @param scopes\r\n     */\r\n    ScopeSet.containsScope = function (cachedScopes, scopes) {\r\n        var convertedCachedScopes = this.trimAndConvertArrayToLowerCase(cachedScopes.slice());\r\n        var requestScopes = this.trimAndConvertArrayToLowerCase(scopes.slice());\r\n        return requestScopes.every(function (value) { return convertedCachedScopes.indexOf(value.toString().toLowerCase()) >= 0; });\r\n    };\r\n    /**\r\n     *  Trims and converts string to lower case\r\n     *\r\n     * @param scopes\r\n     */\r\n    // TODO: Rename this, too generic name for a function that only deals with scopes\r\n    ScopeSet.trimAndConvertToLowerCase = function (scope) {\r\n        return scope.trim().toLowerCase();\r\n    };\r\n    /**\r\n     * Performs trimAndConvertToLowerCase on string array\r\n     * @param scopes\r\n     */\r\n    ScopeSet.trimAndConvertArrayToLowerCase = function (scopes) {\r\n        var _this = this;\r\n        return scopes.map(function (scope) { return _this.trimAndConvertToLowerCase(scope); });\r\n    };\r\n    /**\r\n     * Trims each scope in scopes array\r\n     * @param scopes\r\n     */\r\n    ScopeSet.trimScopes = function (scopes) {\r\n        return scopes.map(function (scope) { return scope.trim(); });\r\n    };\r\n    /**\r\n     * Remove one element from a scope array\r\n     *\r\n     * @param scopes\r\n     * @param scope\r\n     */\r\n    // TODO: Rename this, too generic name for a function that only deals with scopes\r\n    ScopeSet.removeElement = function (scopes, scope) {\r\n        var scopeVal = this.trimAndConvertToLowerCase(scope);\r\n        return scopes.filter(function (value) { return value !== scopeVal; });\r\n    };\r\n    /**\r\n     * Parse the scopes into a formatted scopeList\r\n     * @param scopes\r\n     */\r\n    ScopeSet.parseScope = function (scopes) {\r\n        var scopeList = \"\";\r\n        if (scopes) {\r\n            for (var i = 0; i < scopes.length; ++i) {\r\n                scopeList += (i !== scopes.length - 1) ? scopes[i] + \" \" : scopes[i];\r\n            }\r\n        }\r\n        return scopeList;\r\n    };\r\n    /**\r\n     * @hidden\r\n     *\r\n     * Used to validate the scopes input parameter requested  by the developer.\r\n     * @param {Array<string>} scopes - Developer requested permissions. Not all scopes are guaranteed to be included in the access token returned.\r\n     * @param {boolean} scopesRequired - Boolean indicating whether the scopes array is required or not\r\n     * @ignore\r\n     */\r\n    ScopeSet.validateInputScope = function (scopes, scopesRequired) {\r\n        if (!scopes) {\r\n            if (scopesRequired) {\r\n                throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_0__[\"ClientConfigurationError\"].createScopesRequiredError(scopes);\r\n            }\r\n            else {\r\n                return;\r\n            }\r\n        }\r\n        // Check that scopes is an array object (also throws error if scopes == null)\r\n        if (!Array.isArray(scopes)) {\r\n            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_0__[\"ClientConfigurationError\"].createScopesNonArrayError(scopes);\r\n        }\r\n        // Check that scopes is not an empty array\r\n        if (scopes.length < 1 && scopesRequired) {\r\n            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_0__[\"ClientConfigurationError\"].createEmptyScopesArrayError(scopes.toString());\r\n        }\r\n    };\r\n    /**\r\n     * @hidden\r\n     *\r\n     * Extracts scope value from the state sent with the authentication request.\r\n     * @param {string} state\r\n     * @returns {string} scope.\r\n     * @ignore\r\n     */\r\n    ScopeSet.getScopeFromState = function (state) {\r\n        if (state) {\r\n            var splitIndex = state.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].resourceDelimiter);\r\n            if (splitIndex > -1 && splitIndex + 1 < state.length) {\r\n                return state.substring(splitIndex + 1);\r\n            }\r\n        }\r\n        return \"\";\r\n    };\r\n    /**\r\n     * @ignore\r\n     * Appends extraScopesToConsent if passed\r\n     * @param {@link AuthenticationParameters}\r\n     */\r\n    ScopeSet.appendScopes = function (reqScopes, reqExtraScopesToConsent) {\r\n        if (reqScopes) {\r\n            var convertedExtraScopes = reqExtraScopesToConsent ? this.trimAndConvertArrayToLowerCase(reqExtraScopesToConsent.slice()) : null;\r\n            var convertedReqScopes = this.trimAndConvertArrayToLowerCase(reqScopes.slice());\r\n            return convertedExtraScopes ? convertedReqScopes.concat(convertedExtraScopes) : convertedReqScopes;\r\n        }\r\n        return null;\r\n    };\r\n    // #endregion\r\n    /**\r\n     * @ignore\r\n     * Returns true if the scopes array only contains openid and/or profile\r\n     */\r\n    ScopeSet.onlyContainsOidcScopes = function (scopes) {\r\n        var scopesCount = scopes.length;\r\n        var oidcScopesFound = 0;\r\n        if (scopes.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].openidScope) > -1) {\r\n            oidcScopesFound += 1;\r\n        }\r\n        if (scopes.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].profileScope) > -1) {\r\n            oidcScopesFound += 1;\r\n        }\r\n        return (scopesCount > 0 && scopesCount === oidcScopesFound);\r\n    };\r\n    /**\r\n     * @ignore\r\n     * Returns true if the scopes array only contains openid and/or profile\r\n     */\r\n    ScopeSet.containsAnyOidcScopes = function (scopes) {\r\n        var containsOpenIdScope = scopes.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].openidScope) > -1;\r\n        var containsProfileScope = scopes.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].profileScope) > -1;\r\n        return (containsOpenIdScope || containsProfileScope);\r\n    };\r\n    /**\r\n     * @ignore\r\n     * Returns true if the clientId is the only scope in the array\r\n     */\r\n    ScopeSet.onlyContainsClientId = function (scopes, clientId) {\r\n        // Double negation to force false value returned in case scopes is null\r\n        return !!scopes && (scopes.indexOf(clientId) > -1 && scopes.length === 1);\r\n    };\r\n    /**\r\n     * @ignore\r\n     * Adds missing OIDC scopes to scopes array without duplication. Since STS requires OIDC scopes for\r\n     * all implicit flow requests, 'openid' and 'profile' should always be included in the final request\r\n     */\r\n    ScopeSet.appendDefaultScopes = function (scopes) {\r\n        var extendedScopes = scopes;\r\n        if (extendedScopes.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].openidScope) === -1) {\r\n            extendedScopes.push(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].openidScope);\r\n        }\r\n        if (extendedScopes.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].profileScope) === -1) {\r\n            extendedScopes.push(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].profileScope);\r\n        }\r\n        return extendedScopes;\r\n    };\r\n    /**\r\n     * @ignore\r\n     * Removes present OIDC scopes from scopes array.\r\n     */\r\n    ScopeSet.removeDefaultScopes = function (scopes) {\r\n        return scopes.filter(function (scope) {\r\n            return (scope !== _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].openidScope && scope !== _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].profileScope);\r\n        });\r\n    };\r\n    /**\r\n     * @ignore\r\n     * Removes clientId from scopes array if included as only scope. If it's not the only scope, it is treated as a resource scope.\r\n     * @param scopes Array<string>: Pre-normalized scopes array\r\n     * @param clientId string: The application's clientId that is searched for in the scopes array\r\n     */\r\n    ScopeSet.translateClientIdIfSingleScope = function (scopes, clientId) {\r\n        return this.onlyContainsClientId(scopes, clientId) ? _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].oidcScopes : scopes;\r\n    };\r\n    return ScopeSet;\r\n}());\r\n\r\n//# sourceMappingURL=ScopeSet.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiOEltVS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tc2FsL2xpYi1lczYvU2NvcGVTZXQuanM/ZjA4OSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKi9cclxuaW1wb3J0IHsgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yIH0gZnJvbSBcIi4vZXJyb3IvQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yXCI7XHJcbmltcG9ydCB7IENvbnN0YW50cyB9IGZyb20gXCIuL3V0aWxzL0NvbnN0YW50c1wiO1xyXG52YXIgU2NvcGVTZXQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBTY29wZVNldCgpIHtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQ2hlY2sgaWYgdGhlcmUgYXJlIGR1cCBzY29wZXMgaW4gYSBnaXZlbiByZXF1ZXN0XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGNhY2hlZFNjb3Blc1xyXG4gICAgICogQHBhcmFtIHNjb3Blc1xyXG4gICAgICovXHJcbiAgICAvLyBUT0RPOiBSZW5hbWUgdGhpcywgaW50ZXJzZWN0aW5nIHNjb3BlcyBpc24ndCBhIGdyZWF0IG5hbWUgZm9yIGR1cGxpY2F0ZSBjaGVja2VyXHJcbiAgICBTY29wZVNldC5pc0ludGVyc2VjdGluZ1Njb3BlcyA9IGZ1bmN0aW9uIChjYWNoZWRTY29wZXMsIHNjb3Blcykge1xyXG4gICAgICAgIHZhciBjb252ZXJ0ZWRDYWNoZWRTY29wZXMgPSB0aGlzLnRyaW1BbmRDb252ZXJ0QXJyYXlUb0xvd2VyQ2FzZShjYWNoZWRTY29wZXMuc2xpY2UoKSk7XHJcbiAgICAgICAgdmFyIHJlcXVlc3RTY29wZXMgPSB0aGlzLnRyaW1BbmRDb252ZXJ0QXJyYXlUb0xvd2VyQ2FzZShzY29wZXMuc2xpY2UoKSk7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXF1ZXN0U2NvcGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChjb252ZXJ0ZWRDYWNoZWRTY29wZXMuaW5kZXhPZihyZXF1ZXN0U2NvcGVzW2ldLnRvTG93ZXJDYXNlKCkpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENoZWNrIGlmIGEgZ2l2ZW4gc2NvcGUgaXMgcHJlc2VudCBpbiB0aGUgcmVxdWVzdFxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBjYWNoZWRTY29wZXNcclxuICAgICAqIEBwYXJhbSBzY29wZXNcclxuICAgICAqL1xyXG4gICAgU2NvcGVTZXQuY29udGFpbnNTY29wZSA9IGZ1bmN0aW9uIChjYWNoZWRTY29wZXMsIHNjb3Blcykge1xyXG4gICAgICAgIHZhciBjb252ZXJ0ZWRDYWNoZWRTY29wZXMgPSB0aGlzLnRyaW1BbmRDb252ZXJ0QXJyYXlUb0xvd2VyQ2FzZShjYWNoZWRTY29wZXMuc2xpY2UoKSk7XHJcbiAgICAgICAgdmFyIHJlcXVlc3RTY29wZXMgPSB0aGlzLnRyaW1BbmRDb252ZXJ0QXJyYXlUb0xvd2VyQ2FzZShzY29wZXMuc2xpY2UoKSk7XHJcbiAgICAgICAgcmV0dXJuIHJlcXVlc3RTY29wZXMuZXZlcnkoZnVuY3Rpb24gKHZhbHVlKSB7IHJldHVybiBjb252ZXJ0ZWRDYWNoZWRTY29wZXMuaW5kZXhPZih2YWx1ZS50b1N0cmluZygpLnRvTG93ZXJDYXNlKCkpID49IDA7IH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogIFRyaW1zIGFuZCBjb252ZXJ0cyBzdHJpbmcgdG8gbG93ZXIgY2FzZVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBzY29wZXNcclxuICAgICAqL1xyXG4gICAgLy8gVE9ETzogUmVuYW1lIHRoaXMsIHRvbyBnZW5lcmljIG5hbWUgZm9yIGEgZnVuY3Rpb24gdGhhdCBvbmx5IGRlYWxzIHdpdGggc2NvcGVzXHJcbiAgICBTY29wZVNldC50cmltQW5kQ29udmVydFRvTG93ZXJDYXNlID0gZnVuY3Rpb24gKHNjb3BlKSB7XHJcbiAgICAgICAgcmV0dXJuIHNjb3BlLnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUGVyZm9ybXMgdHJpbUFuZENvbnZlcnRUb0xvd2VyQ2FzZSBvbiBzdHJpbmcgYXJyYXlcclxuICAgICAqIEBwYXJhbSBzY29wZXNcclxuICAgICAqL1xyXG4gICAgU2NvcGVTZXQudHJpbUFuZENvbnZlcnRBcnJheVRvTG93ZXJDYXNlID0gZnVuY3Rpb24gKHNjb3Blcykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIHNjb3Blcy5tYXAoZnVuY3Rpb24gKHNjb3BlKSB7IHJldHVybiBfdGhpcy50cmltQW5kQ29udmVydFRvTG93ZXJDYXNlKHNjb3BlKTsgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBUcmltcyBlYWNoIHNjb3BlIGluIHNjb3BlcyBhcnJheVxyXG4gICAgICogQHBhcmFtIHNjb3Blc1xyXG4gICAgICovXHJcbiAgICBTY29wZVNldC50cmltU2NvcGVzID0gZnVuY3Rpb24gKHNjb3Blcykge1xyXG4gICAgICAgIHJldHVybiBzY29wZXMubWFwKGZ1bmN0aW9uIChzY29wZSkgeyByZXR1cm4gc2NvcGUudHJpbSgpOyB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJlbW92ZSBvbmUgZWxlbWVudCBmcm9tIGEgc2NvcGUgYXJyYXlcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gc2NvcGVzXHJcbiAgICAgKiBAcGFyYW0gc2NvcGVcclxuICAgICAqL1xyXG4gICAgLy8gVE9ETzogUmVuYW1lIHRoaXMsIHRvbyBnZW5lcmljIG5hbWUgZm9yIGEgZnVuY3Rpb24gdGhhdCBvbmx5IGRlYWxzIHdpdGggc2NvcGVzXHJcbiAgICBTY29wZVNldC5yZW1vdmVFbGVtZW50ID0gZnVuY3Rpb24gKHNjb3Blcywgc2NvcGUpIHtcclxuICAgICAgICB2YXIgc2NvcGVWYWwgPSB0aGlzLnRyaW1BbmRDb252ZXJ0VG9Mb3dlckNhc2Uoc2NvcGUpO1xyXG4gICAgICAgIHJldHVybiBzY29wZXMuZmlsdGVyKGZ1bmN0aW9uICh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgIT09IHNjb3BlVmFsOyB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFBhcnNlIHRoZSBzY29wZXMgaW50byBhIGZvcm1hdHRlZCBzY29wZUxpc3RcclxuICAgICAqIEBwYXJhbSBzY29wZXNcclxuICAgICAqL1xyXG4gICAgU2NvcGVTZXQucGFyc2VTY29wZSA9IGZ1bmN0aW9uIChzY29wZXMpIHtcclxuICAgICAgICB2YXIgc2NvcGVMaXN0ID0gXCJcIjtcclxuICAgICAgICBpZiAoc2NvcGVzKSB7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2NvcGVzLmxlbmd0aDsgKytpKSB7XHJcbiAgICAgICAgICAgICAgICBzY29wZUxpc3QgKz0gKGkgIT09IHNjb3Blcy5sZW5ndGggLSAxKSA/IHNjb3Blc1tpXSArIFwiIFwiIDogc2NvcGVzW2ldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBzY29wZUxpc3Q7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaGlkZGVuXHJcbiAgICAgKlxyXG4gICAgICogVXNlZCB0byB2YWxpZGF0ZSB0aGUgc2NvcGVzIGlucHV0IHBhcmFtZXRlciByZXF1ZXN0ZWQgIGJ5IHRoZSBkZXZlbG9wZXIuXHJcbiAgICAgKiBAcGFyYW0ge0FycmF5PHN0cmluZz59IHNjb3BlcyAtIERldmVsb3BlciByZXF1ZXN0ZWQgcGVybWlzc2lvbnMuIE5vdCBhbGwgc2NvcGVzIGFyZSBndWFyYW50ZWVkIHRvIGJlIGluY2x1ZGVkIGluIHRoZSBhY2Nlc3MgdG9rZW4gcmV0dXJuZWQuXHJcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IHNjb3Blc1JlcXVpcmVkIC0gQm9vbGVhbiBpbmRpY2F0aW5nIHdoZXRoZXIgdGhlIHNjb3BlcyBhcnJheSBpcyByZXF1aXJlZCBvciBub3RcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqL1xyXG4gICAgU2NvcGVTZXQudmFsaWRhdGVJbnB1dFNjb3BlID0gZnVuY3Rpb24gKHNjb3Blcywgc2NvcGVzUmVxdWlyZWQpIHtcclxuICAgICAgICBpZiAoIXNjb3Blcykge1xyXG4gICAgICAgICAgICBpZiAoc2NvcGVzUmVxdWlyZWQpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IENsaWVudENvbmZpZ3VyYXRpb25FcnJvci5jcmVhdGVTY29wZXNSZXF1aXJlZEVycm9yKHNjb3Blcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gQ2hlY2sgdGhhdCBzY29wZXMgaXMgYW4gYXJyYXkgb2JqZWN0IChhbHNvIHRocm93cyBlcnJvciBpZiBzY29wZXMgPT0gbnVsbClcclxuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoc2NvcGVzKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBDbGllbnRDb25maWd1cmF0aW9uRXJyb3IuY3JlYXRlU2NvcGVzTm9uQXJyYXlFcnJvcihzY29wZXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBDaGVjayB0aGF0IHNjb3BlcyBpcyBub3QgYW4gZW1wdHkgYXJyYXlcclxuICAgICAgICBpZiAoc2NvcGVzLmxlbmd0aCA8IDEgJiYgc2NvcGVzUmVxdWlyZWQpIHtcclxuICAgICAgICAgICAgdGhyb3cgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yLmNyZWF0ZUVtcHR5U2NvcGVzQXJyYXlFcnJvcihzY29wZXMudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQGhpZGRlblxyXG4gICAgICpcclxuICAgICAqIEV4dHJhY3RzIHNjb3BlIHZhbHVlIGZyb20gdGhlIHN0YXRlIHNlbnQgd2l0aCB0aGUgYXV0aGVudGljYXRpb24gcmVxdWVzdC5cclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzdGF0ZVxyXG4gICAgICogQHJldHVybnMge3N0cmluZ30gc2NvcGUuXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKi9cclxuICAgIFNjb3BlU2V0LmdldFNjb3BlRnJvbVN0YXRlID0gZnVuY3Rpb24gKHN0YXRlKSB7XHJcbiAgICAgICAgaWYgKHN0YXRlKSB7XHJcbiAgICAgICAgICAgIHZhciBzcGxpdEluZGV4ID0gc3RhdGUuaW5kZXhPZihDb25zdGFudHMucmVzb3VyY2VEZWxpbWl0ZXIpO1xyXG4gICAgICAgICAgICBpZiAoc3BsaXRJbmRleCA+IC0xICYmIHNwbGl0SW5kZXggKyAxIDwgc3RhdGUubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RhdGUuc3Vic3RyaW5nKHNwbGl0SW5kZXggKyAxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gXCJcIjtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqIEFwcGVuZHMgZXh0cmFTY29wZXNUb0NvbnNlbnQgaWYgcGFzc2VkXHJcbiAgICAgKiBAcGFyYW0ge0BsaW5rIEF1dGhlbnRpY2F0aW9uUGFyYW1ldGVyc31cclxuICAgICAqL1xyXG4gICAgU2NvcGVTZXQuYXBwZW5kU2NvcGVzID0gZnVuY3Rpb24gKHJlcVNjb3BlcywgcmVxRXh0cmFTY29wZXNUb0NvbnNlbnQpIHtcclxuICAgICAgICBpZiAocmVxU2NvcGVzKSB7XHJcbiAgICAgICAgICAgIHZhciBjb252ZXJ0ZWRFeHRyYVNjb3BlcyA9IHJlcUV4dHJhU2NvcGVzVG9Db25zZW50ID8gdGhpcy50cmltQW5kQ29udmVydEFycmF5VG9Mb3dlckNhc2UocmVxRXh0cmFTY29wZXNUb0NvbnNlbnQuc2xpY2UoKSkgOiBudWxsO1xyXG4gICAgICAgICAgICB2YXIgY29udmVydGVkUmVxU2NvcGVzID0gdGhpcy50cmltQW5kQ29udmVydEFycmF5VG9Mb3dlckNhc2UocmVxU2NvcGVzLnNsaWNlKCkpO1xyXG4gICAgICAgICAgICByZXR1cm4gY29udmVydGVkRXh0cmFTY29wZXMgPyBjb252ZXJ0ZWRSZXFTY29wZXMuY29uY2F0KGNvbnZlcnRlZEV4dHJhU2NvcGVzKSA6IGNvbnZlcnRlZFJlcVNjb3BlcztcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9O1xyXG4gICAgLy8gI2VuZHJlZ2lvblxyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhlIHNjb3BlcyBhcnJheSBvbmx5IGNvbnRhaW5zIG9wZW5pZCBhbmQvb3IgcHJvZmlsZVxyXG4gICAgICovXHJcbiAgICBTY29wZVNldC5vbmx5Q29udGFpbnNPaWRjU2NvcGVzID0gZnVuY3Rpb24gKHNjb3Blcykge1xyXG4gICAgICAgIHZhciBzY29wZXNDb3VudCA9IHNjb3Blcy5sZW5ndGg7XHJcbiAgICAgICAgdmFyIG9pZGNTY29wZXNGb3VuZCA9IDA7XHJcbiAgICAgICAgaWYgKHNjb3Blcy5pbmRleE9mKENvbnN0YW50cy5vcGVuaWRTY29wZSkgPiAtMSkge1xyXG4gICAgICAgICAgICBvaWRjU2NvcGVzRm91bmQgKz0gMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHNjb3Blcy5pbmRleE9mKENvbnN0YW50cy5wcm9maWxlU2NvcGUpID4gLTEpIHtcclxuICAgICAgICAgICAgb2lkY1Njb3Blc0ZvdW5kICs9IDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiAoc2NvcGVzQ291bnQgPiAwICYmIHNjb3Blc0NvdW50ID09PSBvaWRjU2NvcGVzRm91bmQpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSBzY29wZXMgYXJyYXkgb25seSBjb250YWlucyBvcGVuaWQgYW5kL29yIHByb2ZpbGVcclxuICAgICAqL1xyXG4gICAgU2NvcGVTZXQuY29udGFpbnNBbnlPaWRjU2NvcGVzID0gZnVuY3Rpb24gKHNjb3Blcykge1xyXG4gICAgICAgIHZhciBjb250YWluc09wZW5JZFNjb3BlID0gc2NvcGVzLmluZGV4T2YoQ29uc3RhbnRzLm9wZW5pZFNjb3BlKSA+IC0xO1xyXG4gICAgICAgIHZhciBjb250YWluc1Byb2ZpbGVTY29wZSA9IHNjb3Blcy5pbmRleE9mKENvbnN0YW50cy5wcm9maWxlU2NvcGUpID4gLTE7XHJcbiAgICAgICAgcmV0dXJuIChjb250YWluc09wZW5JZFNjb3BlIHx8IGNvbnRhaW5zUHJvZmlsZVNjb3BlKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgY2xpZW50SWQgaXMgdGhlIG9ubHkgc2NvcGUgaW4gdGhlIGFycmF5XHJcbiAgICAgKi9cclxuICAgIFNjb3BlU2V0Lm9ubHlDb250YWluc0NsaWVudElkID0gZnVuY3Rpb24gKHNjb3BlcywgY2xpZW50SWQpIHtcclxuICAgICAgICAvLyBEb3VibGUgbmVnYXRpb24gdG8gZm9yY2UgZmFsc2UgdmFsdWUgcmV0dXJuZWQgaW4gY2FzZSBzY29wZXMgaXMgbnVsbFxyXG4gICAgICAgIHJldHVybiAhIXNjb3BlcyAmJiAoc2NvcGVzLmluZGV4T2YoY2xpZW50SWQpID4gLTEgJiYgc2NvcGVzLmxlbmd0aCA9PT0gMSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiBBZGRzIG1pc3NpbmcgT0lEQyBzY29wZXMgdG8gc2NvcGVzIGFycmF5IHdpdGhvdXQgZHVwbGljYXRpb24uIFNpbmNlIFNUUyByZXF1aXJlcyBPSURDIHNjb3BlcyBmb3JcclxuICAgICAqIGFsbCBpbXBsaWNpdCBmbG93IHJlcXVlc3RzLCAnb3BlbmlkJyBhbmQgJ3Byb2ZpbGUnIHNob3VsZCBhbHdheXMgYmUgaW5jbHVkZWQgaW4gdGhlIGZpbmFsIHJlcXVlc3RcclxuICAgICAqL1xyXG4gICAgU2NvcGVTZXQuYXBwZW5kRGVmYXVsdFNjb3BlcyA9IGZ1bmN0aW9uIChzY29wZXMpIHtcclxuICAgICAgICB2YXIgZXh0ZW5kZWRTY29wZXMgPSBzY29wZXM7XHJcbiAgICAgICAgaWYgKGV4dGVuZGVkU2NvcGVzLmluZGV4T2YoQ29uc3RhbnRzLm9wZW5pZFNjb3BlKSA9PT0gLTEpIHtcclxuICAgICAgICAgICAgZXh0ZW5kZWRTY29wZXMucHVzaChDb25zdGFudHMub3BlbmlkU2NvcGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZXh0ZW5kZWRTY29wZXMuaW5kZXhPZihDb25zdGFudHMucHJvZmlsZVNjb3BlKSA9PT0gLTEpIHtcclxuICAgICAgICAgICAgZXh0ZW5kZWRTY29wZXMucHVzaChDb25zdGFudHMucHJvZmlsZVNjb3BlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGV4dGVuZGVkU2NvcGVzO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICogUmVtb3ZlcyBwcmVzZW50IE9JREMgc2NvcGVzIGZyb20gc2NvcGVzIGFycmF5LlxyXG4gICAgICovXHJcbiAgICBTY29wZVNldC5yZW1vdmVEZWZhdWx0U2NvcGVzID0gZnVuY3Rpb24gKHNjb3Blcykge1xyXG4gICAgICAgIHJldHVybiBzY29wZXMuZmlsdGVyKGZ1bmN0aW9uIChzY29wZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gKHNjb3BlICE9PSBDb25zdGFudHMub3BlbmlkU2NvcGUgJiYgc2NvcGUgIT09IENvbnN0YW50cy5wcm9maWxlU2NvcGUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICogUmVtb3ZlcyBjbGllbnRJZCBmcm9tIHNjb3BlcyBhcnJheSBpZiBpbmNsdWRlZCBhcyBvbmx5IHNjb3BlLiBJZiBpdCdzIG5vdCB0aGUgb25seSBzY29wZSwgaXQgaXMgdHJlYXRlZCBhcyBhIHJlc291cmNlIHNjb3BlLlxyXG4gICAgICogQHBhcmFtIHNjb3BlcyBBcnJheTxzdHJpbmc+OiBQcmUtbm9ybWFsaXplZCBzY29wZXMgYXJyYXlcclxuICAgICAqIEBwYXJhbSBjbGllbnRJZCBzdHJpbmc6IFRoZSBhcHBsaWNhdGlvbidzIGNsaWVudElkIHRoYXQgaXMgc2VhcmNoZWQgZm9yIGluIHRoZSBzY29wZXMgYXJyYXlcclxuICAgICAqL1xyXG4gICAgU2NvcGVTZXQudHJhbnNsYXRlQ2xpZW50SWRJZlNpbmdsZVNjb3BlID0gZnVuY3Rpb24gKHNjb3BlcywgY2xpZW50SWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5vbmx5Q29udGFpbnNDbGllbnRJZChzY29wZXMsIGNsaWVudElkKSA/IENvbnN0YW50cy5vaWRjU2NvcGVzIDogc2NvcGVzO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBTY29wZVNldDtcclxufSgpKTtcclxuZXhwb3J0IHsgU2NvcGVTZXQgfTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9U2NvcGVTZXQuanMubWFwIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///8ImU\n");

/***/ }),

/***/ "GaoF":
/*!*****************************************************************!*\
  !*** ./node_modules/msal/lib-es6/authority/AuthorityFactory.js ***!
  \*****************************************************************/
/*! exports provided: AuthorityFactory */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AuthorityFactory\", function() { return AuthorityFactory; });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ \"mrSG\");\n/* harmony import */ var _Authority__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Authority */ \"bro/\");\n/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/StringUtils */ \"Emp/\");\n/* harmony import */ var _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../error/ClientConfigurationError */ \"ZEID\");\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\n/**\r\n * @hidden\r\n */\r\n\r\n\r\n\r\nvar AuthorityFactory = /** @class */ (function () {\r\n    function AuthorityFactory() {\r\n    }\r\n    AuthorityFactory.saveMetadataFromNetwork = function (authorityInstance, telemetryManager, correlationId) {\r\n        return tslib__WEBPACK_IMPORTED_MODULE_0__[\"__awaiter\"](this, void 0, void 0, function () {\r\n            var metadata;\r\n            return tslib__WEBPACK_IMPORTED_MODULE_0__[\"__generator\"](this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, authorityInstance.resolveEndpointsAsync(telemetryManager, correlationId)];\r\n                    case 1:\r\n                        metadata = _a.sent();\r\n                        this.metadataMap.set(authorityInstance.CanonicalAuthority, metadata);\r\n                        return [2 /*return*/, metadata];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    AuthorityFactory.getMetadata = function (authorityUrl) {\r\n        return this.metadataMap.get(authorityUrl);\r\n    };\r\n    AuthorityFactory.saveMetadataFromConfig = function (authorityUrl, authorityMetadataJson) {\r\n        try {\r\n            if (authorityMetadataJson) {\r\n                var parsedMetadata = JSON.parse(authorityMetadataJson);\r\n                if (!parsedMetadata.authorization_endpoint || !parsedMetadata.end_session_endpoint || !parsedMetadata.issuer) {\r\n                    throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_3__[\"ClientConfigurationError\"].createInvalidAuthorityMetadataError();\r\n                }\r\n                this.metadataMap.set(authorityUrl, {\r\n                    AuthorizationEndpoint: parsedMetadata.authorization_endpoint,\r\n                    EndSessionEndpoint: parsedMetadata.end_session_endpoint,\r\n                    Issuer: parsedMetadata.issuer\r\n                });\r\n            }\r\n        }\r\n        catch (e) {\r\n            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_3__[\"ClientConfigurationError\"].createInvalidAuthorityMetadataError();\r\n        }\r\n    };\r\n    /**\r\n     * Create an authority object of the correct type based on the url\r\n     * Performs basic authority validation - checks to see if the authority is of a valid type (eg aad, b2c)\r\n     */\r\n    AuthorityFactory.CreateInstance = function (authorityUrl, validateAuthority, authorityMetadata) {\r\n        if (_utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__[\"StringUtils\"].isEmpty(authorityUrl)) {\r\n            return null;\r\n        }\r\n        if (authorityMetadata) {\r\n            // todo: log statements\r\n            this.saveMetadataFromConfig(authorityUrl, authorityMetadata);\r\n        }\r\n        return new _Authority__WEBPACK_IMPORTED_MODULE_1__[\"Authority\"](authorityUrl, validateAuthority, this.metadataMap.get(authorityUrl));\r\n    };\r\n    AuthorityFactory.metadataMap = new Map();\r\n    return AuthorityFactory;\r\n}());\r\n\r\n//# sourceMappingURL=AuthorityFactory.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiR2FvRi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tc2FsL2xpYi1lczYvYXV0aG9yaXR5L0F1dGhvcml0eUZhY3RvcnkuanM/MTlhYSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKi9cclxuaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuLyoqXHJcbiAqIEBoaWRkZW5cclxuICovXHJcbmltcG9ydCB7IEF1dGhvcml0eSB9IGZyb20gXCIuL0F1dGhvcml0eVwiO1xyXG5pbXBvcnQgeyBTdHJpbmdVdGlscyB9IGZyb20gXCIuLi91dGlscy9TdHJpbmdVdGlsc1wiO1xyXG5pbXBvcnQgeyBDbGllbnRDb25maWd1cmF0aW9uRXJyb3IgfSBmcm9tIFwiLi4vZXJyb3IvQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yXCI7XHJcbnZhciBBdXRob3JpdHlGYWN0b3J5ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gQXV0aG9yaXR5RmFjdG9yeSgpIHtcclxuICAgIH1cclxuICAgIEF1dGhvcml0eUZhY3Rvcnkuc2F2ZU1ldGFkYXRhRnJvbU5ldHdvcmsgPSBmdW5jdGlvbiAoYXV0aG9yaXR5SW5zdGFuY2UsIHRlbGVtZXRyeU1hbmFnZXIsIGNvcnJlbGF0aW9uSWQpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIG1ldGFkYXRhO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIGF1dGhvcml0eUluc3RhbmNlLnJlc29sdmVFbmRwb2ludHNBc3luYyh0ZWxlbWV0cnlNYW5hZ2VyLCBjb3JyZWxhdGlvbklkKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YSA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXRhZGF0YU1hcC5zZXQoYXV0aG9yaXR5SW5zdGFuY2UuQ2Fub25pY2FsQXV0aG9yaXR5LCBtZXRhZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCBtZXRhZGF0YV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIEF1dGhvcml0eUZhY3RvcnkuZ2V0TWV0YWRhdGEgPSBmdW5jdGlvbiAoYXV0aG9yaXR5VXJsKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMubWV0YWRhdGFNYXAuZ2V0KGF1dGhvcml0eVVybCk7XHJcbiAgICB9O1xyXG4gICAgQXV0aG9yaXR5RmFjdG9yeS5zYXZlTWV0YWRhdGFGcm9tQ29uZmlnID0gZnVuY3Rpb24gKGF1dGhvcml0eVVybCwgYXV0aG9yaXR5TWV0YWRhdGFKc29uKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKGF1dGhvcml0eU1ldGFkYXRhSnNvbikge1xyXG4gICAgICAgICAgICAgICAgdmFyIHBhcnNlZE1ldGFkYXRhID0gSlNPTi5wYXJzZShhdXRob3JpdHlNZXRhZGF0YUpzb24pO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFwYXJzZWRNZXRhZGF0YS5hdXRob3JpemF0aW9uX2VuZHBvaW50IHx8ICFwYXJzZWRNZXRhZGF0YS5lbmRfc2Vzc2lvbl9lbmRwb2ludCB8fCAhcGFyc2VkTWV0YWRhdGEuaXNzdWVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yLmNyZWF0ZUludmFsaWRBdXRob3JpdHlNZXRhZGF0YUVycm9yKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1ldGFkYXRhTWFwLnNldChhdXRob3JpdHlVcmwsIHtcclxuICAgICAgICAgICAgICAgICAgICBBdXRob3JpemF0aW9uRW5kcG9pbnQ6IHBhcnNlZE1ldGFkYXRhLmF1dGhvcml6YXRpb25fZW5kcG9pbnQsXHJcbiAgICAgICAgICAgICAgICAgICAgRW5kU2Vzc2lvbkVuZHBvaW50OiBwYXJzZWRNZXRhZGF0YS5lbmRfc2Vzc2lvbl9lbmRwb2ludCxcclxuICAgICAgICAgICAgICAgICAgICBJc3N1ZXI6IHBhcnNlZE1ldGFkYXRhLmlzc3VlclxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgdGhyb3cgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yLmNyZWF0ZUludmFsaWRBdXRob3JpdHlNZXRhZGF0YUVycm9yKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlIGFuIGF1dGhvcml0eSBvYmplY3Qgb2YgdGhlIGNvcnJlY3QgdHlwZSBiYXNlZCBvbiB0aGUgdXJsXHJcbiAgICAgKiBQZXJmb3JtcyBiYXNpYyBhdXRob3JpdHkgdmFsaWRhdGlvbiAtIGNoZWNrcyB0byBzZWUgaWYgdGhlIGF1dGhvcml0eSBpcyBvZiBhIHZhbGlkIHR5cGUgKGVnIGFhZCwgYjJjKVxyXG4gICAgICovXHJcbiAgICBBdXRob3JpdHlGYWN0b3J5LkNyZWF0ZUluc3RhbmNlID0gZnVuY3Rpb24gKGF1dGhvcml0eVVybCwgdmFsaWRhdGVBdXRob3JpdHksIGF1dGhvcml0eU1ldGFkYXRhKSB7XHJcbiAgICAgICAgaWYgKFN0cmluZ1V0aWxzLmlzRW1wdHkoYXV0aG9yaXR5VXJsKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGF1dGhvcml0eU1ldGFkYXRhKSB7XHJcbiAgICAgICAgICAgIC8vIHRvZG86IGxvZyBzdGF0ZW1lbnRzXHJcbiAgICAgICAgICAgIHRoaXMuc2F2ZU1ldGFkYXRhRnJvbUNvbmZpZyhhdXRob3JpdHlVcmwsIGF1dGhvcml0eU1ldGFkYXRhKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5ldyBBdXRob3JpdHkoYXV0aG9yaXR5VXJsLCB2YWxpZGF0ZUF1dGhvcml0eSwgdGhpcy5tZXRhZGF0YU1hcC5nZXQoYXV0aG9yaXR5VXJsKSk7XHJcbiAgICB9O1xyXG4gICAgQXV0aG9yaXR5RmFjdG9yeS5tZXRhZGF0YU1hcCA9IG5ldyBNYXAoKTtcclxuICAgIHJldHVybiBBdXRob3JpdHlGYWN0b3J5O1xyXG59KCkpO1xyXG5leHBvcnQgeyBBdXRob3JpdHlGYWN0b3J5IH07XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUF1dGhvcml0eUZhY3RvcnkuanMubWFwIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///GaoF\n");

/***/ }),

/***/ "JKGV":
/*!********************************************************!*\
  !*** ./node_modules/msal/lib-es6/error/ServerError.js ***!
  \********************************************************/
/*! exports provided: ServerErrorMessage, ServerError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ServerErrorMessage\", function() { return ServerErrorMessage; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ServerError\", function() { return ServerError; });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ \"mrSG\");\n/* harmony import */ var _AuthError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AuthError */ \"T0bz\");\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\n\r\nvar ServerErrorMessage = {\r\n    serverUnavailable: {\r\n        code: \"server_unavailable\",\r\n        desc: \"Server is temporarily unavailable.\"\r\n    },\r\n    unknownServerError: {\r\n        code: \"unknown_server_error\"\r\n    },\r\n};\r\n/**\r\n * Error thrown when there is an error with the server code, for example, unavailability.\r\n */\r\nvar ServerError = /** @class */ (function (_super) {\r\n    tslib__WEBPACK_IMPORTED_MODULE_0__[\"__extends\"](ServerError, _super);\r\n    function ServerError(errorCode, errorMessage) {\r\n        var _this = _super.call(this, errorCode, errorMessage) || this;\r\n        _this.name = \"ServerError\";\r\n        Object.setPrototypeOf(_this, ServerError.prototype);\r\n        return _this;\r\n    }\r\n    ServerError.createServerUnavailableError = function () {\r\n        return new ServerError(ServerErrorMessage.serverUnavailable.code, ServerErrorMessage.serverUnavailable.desc);\r\n    };\r\n    ServerError.createUnknownServerError = function (errorDesc) {\r\n        return new ServerError(ServerErrorMessage.unknownServerError.code, errorDesc);\r\n    };\r\n    return ServerError;\r\n}(_AuthError__WEBPACK_IMPORTED_MODULE_1__[\"AuthError\"]));\r\n\r\n//# sourceMappingURL=ServerError.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiSktHVi5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tc2FsL2xpYi1lczYvZXJyb3IvU2VydmVyRXJyb3IuanM/MjRhMSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKi9cclxuaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgQXV0aEVycm9yIH0gZnJvbSBcIi4vQXV0aEVycm9yXCI7XHJcbmV4cG9ydCB2YXIgU2VydmVyRXJyb3JNZXNzYWdlID0ge1xyXG4gICAgc2VydmVyVW5hdmFpbGFibGU6IHtcclxuICAgICAgICBjb2RlOiBcInNlcnZlcl91bmF2YWlsYWJsZVwiLFxyXG4gICAgICAgIGRlc2M6IFwiU2VydmVyIGlzIHRlbXBvcmFyaWx5IHVuYXZhaWxhYmxlLlwiXHJcbiAgICB9LFxyXG4gICAgdW5rbm93blNlcnZlckVycm9yOiB7XHJcbiAgICAgICAgY29kZTogXCJ1bmtub3duX3NlcnZlcl9lcnJvclwiXHJcbiAgICB9LFxyXG59O1xyXG4vKipcclxuICogRXJyb3IgdGhyb3duIHdoZW4gdGhlcmUgaXMgYW4gZXJyb3Igd2l0aCB0aGUgc2VydmVyIGNvZGUsIGZvciBleGFtcGxlLCB1bmF2YWlsYWJpbGl0eS5cclxuICovXHJcbnZhciBTZXJ2ZXJFcnJvciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKFNlcnZlckVycm9yLCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gU2VydmVyRXJyb3IoZXJyb3JDb2RlLCBlcnJvck1lc3NhZ2UpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBlcnJvckNvZGUsIGVycm9yTWVzc2FnZSkgfHwgdGhpcztcclxuICAgICAgICBfdGhpcy5uYW1lID0gXCJTZXJ2ZXJFcnJvclwiO1xyXG4gICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihfdGhpcywgU2VydmVyRXJyb3IucHJvdG90eXBlKTtcclxuICAgICAgICByZXR1cm4gX3RoaXM7XHJcbiAgICB9XHJcbiAgICBTZXJ2ZXJFcnJvci5jcmVhdGVTZXJ2ZXJVbmF2YWlsYWJsZUVycm9yID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgU2VydmVyRXJyb3IoU2VydmVyRXJyb3JNZXNzYWdlLnNlcnZlclVuYXZhaWxhYmxlLmNvZGUsIFNlcnZlckVycm9yTWVzc2FnZS5zZXJ2ZXJVbmF2YWlsYWJsZS5kZXNjKTtcclxuICAgIH07XHJcbiAgICBTZXJ2ZXJFcnJvci5jcmVhdGVVbmtub3duU2VydmVyRXJyb3IgPSBmdW5jdGlvbiAoZXJyb3JEZXNjKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBTZXJ2ZXJFcnJvcihTZXJ2ZXJFcnJvck1lc3NhZ2UudW5rbm93blNlcnZlckVycm9yLmNvZGUsIGVycm9yRGVzYyk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIFNlcnZlckVycm9yO1xyXG59KEF1dGhFcnJvcikpO1xyXG5leHBvcnQgeyBTZXJ2ZXJFcnJvciB9O1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1TZXJ2ZXJFcnJvci5qcy5tYXAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///JKGV\n");

/***/ }),

/***/ "O1xl":
/*!******************************************************!*\
  !*** ./node_modules/msal/lib-es6/cache/AuthCache.js ***!
  \******************************************************/
/*! exports provided: AuthCache */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AuthCache\", function() { return AuthCache; });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ \"mrSG\");\n/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/Constants */ \"wmgs\");\n/* harmony import */ var _AccessTokenCacheItem__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./AccessTokenCacheItem */ \"iV3A\");\n/* harmony import */ var _BrowserStorage__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./BrowserStorage */ \"YAWc\");\n/* harmony import */ var _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../utils/RequestUtils */ \"kcKs\");\n/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/StringUtils */ \"Emp/\");\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * @hidden\r\n */\r\nvar AuthCache = /** @class */ (function (_super) {\r\n    tslib__WEBPACK_IMPORTED_MODULE_0__[\"__extends\"](AuthCache, _super);\r\n    function AuthCache(clientId, cacheLocation, storeAuthStateInCookie) {\r\n        var _this = _super.call(this, cacheLocation) || this;\r\n        _this.clientId = clientId;\r\n        // This is hardcoded to true for now. We may make this configurable in the future\r\n        _this.rollbackEnabled = true;\r\n        _this.migrateCacheEntries(storeAuthStateInCookie);\r\n        return _this;\r\n    }\r\n    /**\r\n     * Support roll back to old cache schema until the next major release: true by default now\r\n     * @param storeAuthStateInCookie\r\n     */\r\n    AuthCache.prototype.migrateCacheEntries = function (storeAuthStateInCookie) {\r\n        var _this = this;\r\n        var idTokenKey = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].cachePrefix + \".\" + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"PersistentCacheKeys\"].IDTOKEN;\r\n        var clientInfoKey = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].cachePrefix + \".\" + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"PersistentCacheKeys\"].CLIENT_INFO;\r\n        var errorKey = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].cachePrefix + \".\" + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"ErrorCacheKeys\"].ERROR;\r\n        var errorDescKey = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].cachePrefix + \".\" + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"ErrorCacheKeys\"].ERROR_DESC;\r\n        var idTokenValue = _super.prototype.getItem.call(this, idTokenKey);\r\n        var clientInfoValue = _super.prototype.getItem.call(this, clientInfoKey);\r\n        var errorValue = _super.prototype.getItem.call(this, errorKey);\r\n        var errorDescValue = _super.prototype.getItem.call(this, errorDescKey);\r\n        var values = [idTokenValue, clientInfoValue, errorValue, errorDescValue];\r\n        var keysToMigrate = [_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"PersistentCacheKeys\"].IDTOKEN, _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"PersistentCacheKeys\"].CLIENT_INFO, _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"ErrorCacheKeys\"].ERROR, _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"ErrorCacheKeys\"].ERROR_DESC];\r\n        keysToMigrate.forEach(function (cacheKey, index) { return _this.duplicateCacheEntry(cacheKey, values[index], storeAuthStateInCookie); });\r\n    };\r\n    /**\r\n     * Utility function to help with roll back keys\r\n     * @param newKey\r\n     * @param value\r\n     * @param storeAuthStateInCookie\r\n     */\r\n    AuthCache.prototype.duplicateCacheEntry = function (newKey, value, storeAuthStateInCookie) {\r\n        if (value) {\r\n            this.setItem(newKey, value, storeAuthStateInCookie);\r\n        }\r\n    };\r\n    /**\r\n     * Prepend msal.<client-id> to each key; Skip for any JSON object as Key (defined schemas do not need the key appended: AccessToken Keys or the upcoming schema)\r\n     * @param key\r\n     * @param addInstanceId\r\n     */\r\n    AuthCache.prototype.generateCacheKey = function (key, addInstanceId) {\r\n        try {\r\n            // Defined schemas do not need the key appended\r\n            JSON.parse(key);\r\n            return key;\r\n        }\r\n        catch (e) {\r\n            if (key.indexOf(\"\" + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].cachePrefix) === 0 || key.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].adalIdToken) === 0) {\r\n                return key;\r\n            }\r\n            return addInstanceId ? _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].cachePrefix + \".\" + this.clientId + \".\" + key : _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].cachePrefix + \".\" + key;\r\n        }\r\n    };\r\n    /**\r\n     * Validates that the input cache key contains the account search terms (clientId and homeAccountIdentifier) and\r\n     * then whether or not it contains the \"scopes\", depending on the token type being searched for. With matching account\r\n     * search terms, Access Token search tries to match the \"scopes\" keyword, while Id Token search expects \"scopes\" to not be included.\r\n     * @param key\r\n     * @param clientId\r\n     * @param homeAccountIdentifier\r\n     * @param tokenType\r\n     */\r\n    AuthCache.prototype.matchKeyForType = function (key, clientId, homeAccountIdentifier, tokenType) {\r\n        // All valid token cache item keys are valid JSON objects, ignore keys that aren't\r\n        var parsedKey = _utils_StringUtils__WEBPACK_IMPORTED_MODULE_5__[\"StringUtils\"].validateAndParseJsonCacheKey(key);\r\n        if (!parsedKey) {\r\n            return null;\r\n        }\r\n        // Does the cache item match the request account\r\n        var accountMatches = key.match(clientId) && key.match(homeAccountIdentifier);\r\n        // Does the cache item match the requested token type\r\n        var tokenTypeMatches = false;\r\n        switch (tokenType) {\r\n            case _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"ServerHashParamKeys\"].ACCESS_TOKEN:\r\n                // Cache item is an access token if scopes are included in the cache item key\r\n                tokenTypeMatches = !!key.match(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].scopes);\r\n                break;\r\n            case _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"ServerHashParamKeys\"].ID_TOKEN:\r\n                // Cache may be an ID token if scopes are NOT included in the cache item key\r\n                tokenTypeMatches = !key.match(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].scopes);\r\n                break;\r\n        }\r\n        return (accountMatches && tokenTypeMatches) ? parsedKey : null;\r\n    };\r\n    /**\r\n     * add value to storage\r\n     * @param key\r\n     * @param value\r\n     * @param enableCookieStorage\r\n     */\r\n    AuthCache.prototype.setItem = function (key, value, enableCookieStorage) {\r\n        _super.prototype.setItem.call(this, this.generateCacheKey(key, true), value, enableCookieStorage);\r\n        // Values stored in cookies will have rollback disabled to minimize cookie length\r\n        if (this.rollbackEnabled && !enableCookieStorage) {\r\n            _super.prototype.setItem.call(this, this.generateCacheKey(key, false), value, enableCookieStorage);\r\n        }\r\n    };\r\n    /**\r\n     * get one item by key from storage\r\n     * @param key\r\n     * @param enableCookieStorage\r\n     */\r\n    AuthCache.prototype.getItem = function (key, enableCookieStorage) {\r\n        return _super.prototype.getItem.call(this, this.generateCacheKey(key, true), enableCookieStorage);\r\n    };\r\n    /**\r\n     * remove value from storage\r\n     * @param key\r\n     */\r\n    AuthCache.prototype.removeItem = function (key) {\r\n        _super.prototype.removeItem.call(this, this.generateCacheKey(key, true));\r\n        if (this.rollbackEnabled) {\r\n            _super.prototype.removeItem.call(this, this.generateCacheKey(key, false));\r\n        }\r\n    };\r\n    /**\r\n     * Reset the cache items\r\n     */\r\n    AuthCache.prototype.resetCacheItems = function () {\r\n        var storage = window[this.cacheLocation];\r\n        var key;\r\n        for (key in storage) {\r\n            // Check if key contains msal prefix; For now, we are clearing all cache items created by MSAL.js\r\n            if (storage.hasOwnProperty(key) && (key.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].cachePrefix) !== -1)) {\r\n                _super.prototype.removeItem.call(this, key);\r\n                // TODO: Clear cache based on client id (clarify use cases where this is needed)\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * Reset all temporary cache items\r\n     */\r\n    AuthCache.prototype.resetTempCacheItems = function (state) {\r\n        var _this = this;\r\n        var stateId = state && _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_4__[\"RequestUtils\"].parseLibraryState(state).id;\r\n        var isTokenRenewalInProgress = this.tokenRenewalInProgress(state);\r\n        var storage = window[this.cacheLocation];\r\n        // check state and remove associated cache\r\n        if (stateId && !isTokenRenewalInProgress) {\r\n            Object.keys(storage).forEach(function (key) {\r\n                if (key.indexOf(stateId) !== -1) {\r\n                    _this.removeItem(key);\r\n                    _super.prototype.clearItemCookie.call(_this, key);\r\n                }\r\n            });\r\n        }\r\n        // delete the interaction status cache\r\n        this.removeItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"TemporaryCacheKeys\"].INTERACTION_STATUS);\r\n        this.removeItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"TemporaryCacheKeys\"].REDIRECT_REQUEST);\r\n    };\r\n    /**\r\n     * Set cookies for IE\r\n     * @param cName\r\n     * @param cValue\r\n     * @param expires\r\n     */\r\n    AuthCache.prototype.setItemCookie = function (cName, cValue, expires) {\r\n        _super.prototype.setItemCookie.call(this, this.generateCacheKey(cName, true), cValue, expires);\r\n        if (this.rollbackEnabled) {\r\n            _super.prototype.setItemCookie.call(this, this.generateCacheKey(cName, false), cValue, expires);\r\n        }\r\n    };\r\n    AuthCache.prototype.clearItemCookie = function (cName) {\r\n        _super.prototype.clearItemCookie.call(this, this.generateCacheKey(cName, true));\r\n        if (this.rollbackEnabled) {\r\n            _super.prototype.clearItemCookie.call(this, this.generateCacheKey(cName, false));\r\n        }\r\n    };\r\n    /**\r\n     * get one item by key from cookies\r\n     * @param cName\r\n     */\r\n    AuthCache.prototype.getItemCookie = function (cName) {\r\n        return _super.prototype.getItemCookie.call(this, this.generateCacheKey(cName, true));\r\n    };\r\n    /**\r\n     * Get all tokens of a certain type from the cache\r\n     * @param clientId\r\n     * @param homeAccountIdentifier\r\n     * @param tokenType\r\n     */\r\n    AuthCache.prototype.getAllTokensByType = function (clientId, homeAccountIdentifier, tokenType) {\r\n        var _this = this;\r\n        var results = Object.keys(window[this.cacheLocation]).reduce(function (tokens, key) {\r\n            var matchedTokenKey = _this.matchKeyForType(key, clientId, homeAccountIdentifier, tokenType);\r\n            if (matchedTokenKey) {\r\n                var value = _this.getItem(key);\r\n                if (value) {\r\n                    try {\r\n                        var newAccessTokenCacheItem = new _AccessTokenCacheItem__WEBPACK_IMPORTED_MODULE_2__[\"AccessTokenCacheItem\"](matchedTokenKey, JSON.parse(value));\r\n                        return tokens.concat([newAccessTokenCacheItem]);\r\n                    }\r\n                    catch (err) {\r\n                        // Skip cache items with non-valid JSON values\r\n                        return tokens;\r\n                    }\r\n                }\r\n            }\r\n            return tokens;\r\n        }, []);\r\n        return results;\r\n    };\r\n    /**\r\n     * Get all access tokens in the cache\r\n     * @param clientId\r\n     * @param homeAccountIdentifier\r\n     */\r\n    AuthCache.prototype.getAllAccessTokens = function (clientId, homeAccountIdentifier) {\r\n        return this.getAllTokensByType(clientId, homeAccountIdentifier, _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"ServerHashParamKeys\"].ACCESS_TOKEN);\r\n    };\r\n    /**\r\n     * Get all id tokens in the cache in the form of AccessTokenCacheItem objects so they are\r\n     * in a normalized format and can make use of the existing cached access token validation logic\r\n     */\r\n    AuthCache.prototype.getAllIdTokens = function (clientId, homeAccountIdentifier) {\r\n        return this.getAllTokensByType(clientId, homeAccountIdentifier, _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"ServerHashParamKeys\"].ID_TOKEN);\r\n    };\r\n    /**\r\n     * Get all access and ID tokens in the cache\r\n     * @param clientId\r\n     * @param homeAccountIdentifier\r\n     */\r\n    AuthCache.prototype.getAllTokens = function (clientId, homeAccountIdentifier) {\r\n        var accessTokens = this.getAllAccessTokens(clientId, homeAccountIdentifier);\r\n        var idTokens = this.getAllIdTokens(clientId, homeAccountIdentifier);\r\n        return accessTokens.concat(idTokens);\r\n    };\r\n    /**\r\n     * Return if the token renewal is still in progress\r\n     *\r\n     * @param stateValue\r\n     */\r\n    AuthCache.prototype.tokenRenewalInProgress = function (stateValue) {\r\n        var renewStatus = this.getItem(AuthCache.generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"TemporaryCacheKeys\"].RENEW_STATUS, stateValue));\r\n        return !!(renewStatus && renewStatus === _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].inProgress);\r\n    };\r\n    /**\r\n     * Clear all cookies\r\n     */\r\n    AuthCache.prototype.clearMsalCookie = function (state) {\r\n        var _this = this;\r\n        /*\r\n         * If state is truthy, remove values associated with that request.\r\n         * Otherwise, remove all MSAL cookies.\r\n         */\r\n        if (state) {\r\n            this.clearItemCookie(AuthCache.generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"TemporaryCacheKeys\"].NONCE_IDTOKEN, state));\r\n            this.clearItemCookie(AuthCache.generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"TemporaryCacheKeys\"].STATE_LOGIN, state));\r\n            this.clearItemCookie(AuthCache.generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"TemporaryCacheKeys\"].LOGIN_REQUEST, state));\r\n            this.clearItemCookie(AuthCache.generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"TemporaryCacheKeys\"].STATE_ACQ_TOKEN, state));\r\n        }\r\n        else {\r\n            var cookies = document.cookie.split(\";\");\r\n            cookies.forEach(function (cookieString) {\r\n                var cookieName = cookieString.trim().split(\"=\")[0];\r\n                if (cookieName.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].cachePrefix) > -1) {\r\n                    _super.prototype.clearItemCookie.call(_this, cookieName);\r\n                }\r\n            });\r\n        }\r\n    };\r\n    /**\r\n     * Create acquireTokenAccountKey to cache account object\r\n     * @param accountId\r\n     * @param state\r\n     */\r\n    AuthCache.generateAcquireTokenAccountKey = function (accountId, state) {\r\n        var stateId = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_4__[\"RequestUtils\"].parseLibraryState(state).id;\r\n        return \"\" + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"TemporaryCacheKeys\"].ACQUIRE_TOKEN_ACCOUNT + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].resourceDelimiter + accountId + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].resourceDelimiter + stateId;\r\n    };\r\n    /**\r\n     * Create authorityKey to cache authority\r\n     * @param state\r\n     */\r\n    AuthCache.generateAuthorityKey = function (state) {\r\n        return AuthCache.generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"TemporaryCacheKeys\"].AUTHORITY, state);\r\n    };\r\n    /**\r\n     * Generates the cache key for temporary cache items, using request state\r\n     * @param tempCacheKey Cache key prefix\r\n     * @param state Request state value\r\n     */\r\n    AuthCache.generateTemporaryCacheKey = function (tempCacheKey, state) {\r\n        // Use the state id (a guid), in the interest of shorter key names, which is important for cookies.\r\n        var stateId = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_4__[\"RequestUtils\"].parseLibraryState(state).id;\r\n        return \"\" + tempCacheKey + _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].resourceDelimiter + stateId;\r\n    };\r\n    return AuthCache;\r\n}(_BrowserStorage__WEBPACK_IMPORTED_MODULE_3__[\"BrowserStorage\"]));\r\n\r\n//# sourceMappingURL=AuthCache.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTzF4bC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tc2FsL2xpYi1lczYvY2FjaGUvQXV0aENhY2hlLmpzPzNiNWMiXSwic291cmNlc0NvbnRlbnQiOlsiLypcclxuICogQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuICovXHJcbmltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IENvbnN0YW50cywgUGVyc2lzdGVudENhY2hlS2V5cywgVGVtcG9yYXJ5Q2FjaGVLZXlzLCBFcnJvckNhY2hlS2V5cywgU2VydmVySGFzaFBhcmFtS2V5cyB9IGZyb20gXCIuLi91dGlscy9Db25zdGFudHNcIjtcclxuaW1wb3J0IHsgQWNjZXNzVG9rZW5DYWNoZUl0ZW0gfSBmcm9tIFwiLi9BY2Nlc3NUb2tlbkNhY2hlSXRlbVwiO1xyXG5pbXBvcnQgeyBCcm93c2VyU3RvcmFnZSB9IGZyb20gXCIuL0Jyb3dzZXJTdG9yYWdlXCI7XHJcbmltcG9ydCB7IFJlcXVlc3RVdGlscyB9IGZyb20gXCIuLi91dGlscy9SZXF1ZXN0VXRpbHNcIjtcclxuaW1wb3J0IHsgU3RyaW5nVXRpbHMgfSBmcm9tIFwiLi4vdXRpbHMvU3RyaW5nVXRpbHNcIjtcclxuLyoqXHJcbiAqIEBoaWRkZW5cclxuICovXHJcbnZhciBBdXRoQ2FjaGUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICB0c2xpYl8xLl9fZXh0ZW5kcyhBdXRoQ2FjaGUsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBBdXRoQ2FjaGUoY2xpZW50SWQsIGNhY2hlTG9jYXRpb24sIHN0b3JlQXV0aFN0YXRlSW5Db29raWUpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBjYWNoZUxvY2F0aW9uKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLmNsaWVudElkID0gY2xpZW50SWQ7XHJcbiAgICAgICAgLy8gVGhpcyBpcyBoYXJkY29kZWQgdG8gdHJ1ZSBmb3Igbm93LiBXZSBtYXkgbWFrZSB0aGlzIGNvbmZpZ3VyYWJsZSBpbiB0aGUgZnV0dXJlXHJcbiAgICAgICAgX3RoaXMucm9sbGJhY2tFbmFibGVkID0gdHJ1ZTtcclxuICAgICAgICBfdGhpcy5taWdyYXRlQ2FjaGVFbnRyaWVzKHN0b3JlQXV0aFN0YXRlSW5Db29raWUpO1xyXG4gICAgICAgIHJldHVybiBfdGhpcztcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogU3VwcG9ydCByb2xsIGJhY2sgdG8gb2xkIGNhY2hlIHNjaGVtYSB1bnRpbCB0aGUgbmV4dCBtYWpvciByZWxlYXNlOiB0cnVlIGJ5IGRlZmF1bHQgbm93XHJcbiAgICAgKiBAcGFyYW0gc3RvcmVBdXRoU3RhdGVJbkNvb2tpZVxyXG4gICAgICovXHJcbiAgICBBdXRoQ2FjaGUucHJvdG90eXBlLm1pZ3JhdGVDYWNoZUVudHJpZXMgPSBmdW5jdGlvbiAoc3RvcmVBdXRoU3RhdGVJbkNvb2tpZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGlkVG9rZW5LZXkgPSBDb25zdGFudHMuY2FjaGVQcmVmaXggKyBcIi5cIiArIFBlcnNpc3RlbnRDYWNoZUtleXMuSURUT0tFTjtcclxuICAgICAgICB2YXIgY2xpZW50SW5mb0tleSA9IENvbnN0YW50cy5jYWNoZVByZWZpeCArIFwiLlwiICsgUGVyc2lzdGVudENhY2hlS2V5cy5DTElFTlRfSU5GTztcclxuICAgICAgICB2YXIgZXJyb3JLZXkgPSBDb25zdGFudHMuY2FjaGVQcmVmaXggKyBcIi5cIiArIEVycm9yQ2FjaGVLZXlzLkVSUk9SO1xyXG4gICAgICAgIHZhciBlcnJvckRlc2NLZXkgPSBDb25zdGFudHMuY2FjaGVQcmVmaXggKyBcIi5cIiArIEVycm9yQ2FjaGVLZXlzLkVSUk9SX0RFU0M7XHJcbiAgICAgICAgdmFyIGlkVG9rZW5WYWx1ZSA9IF9zdXBlci5wcm90b3R5cGUuZ2V0SXRlbS5jYWxsKHRoaXMsIGlkVG9rZW5LZXkpO1xyXG4gICAgICAgIHZhciBjbGllbnRJbmZvVmFsdWUgPSBfc3VwZXIucHJvdG90eXBlLmdldEl0ZW0uY2FsbCh0aGlzLCBjbGllbnRJbmZvS2V5KTtcclxuICAgICAgICB2YXIgZXJyb3JWYWx1ZSA9IF9zdXBlci5wcm90b3R5cGUuZ2V0SXRlbS5jYWxsKHRoaXMsIGVycm9yS2V5KTtcclxuICAgICAgICB2YXIgZXJyb3JEZXNjVmFsdWUgPSBfc3VwZXIucHJvdG90eXBlLmdldEl0ZW0uY2FsbCh0aGlzLCBlcnJvckRlc2NLZXkpO1xyXG4gICAgICAgIHZhciB2YWx1ZXMgPSBbaWRUb2tlblZhbHVlLCBjbGllbnRJbmZvVmFsdWUsIGVycm9yVmFsdWUsIGVycm9yRGVzY1ZhbHVlXTtcclxuICAgICAgICB2YXIga2V5c1RvTWlncmF0ZSA9IFtQZXJzaXN0ZW50Q2FjaGVLZXlzLklEVE9LRU4sIFBlcnNpc3RlbnRDYWNoZUtleXMuQ0xJRU5UX0lORk8sIEVycm9yQ2FjaGVLZXlzLkVSUk9SLCBFcnJvckNhY2hlS2V5cy5FUlJPUl9ERVNDXTtcclxuICAgICAgICBrZXlzVG9NaWdyYXRlLmZvckVhY2goZnVuY3Rpb24gKGNhY2hlS2V5LCBpbmRleCkgeyByZXR1cm4gX3RoaXMuZHVwbGljYXRlQ2FjaGVFbnRyeShjYWNoZUtleSwgdmFsdWVzW2luZGV4XSwgc3RvcmVBdXRoU3RhdGVJbkNvb2tpZSk7IH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogVXRpbGl0eSBmdW5jdGlvbiB0byBoZWxwIHdpdGggcm9sbCBiYWNrIGtleXNcclxuICAgICAqIEBwYXJhbSBuZXdLZXlcclxuICAgICAqIEBwYXJhbSB2YWx1ZVxyXG4gICAgICogQHBhcmFtIHN0b3JlQXV0aFN0YXRlSW5Db29raWVcclxuICAgICAqL1xyXG4gICAgQXV0aENhY2hlLnByb3RvdHlwZS5kdXBsaWNhdGVDYWNoZUVudHJ5ID0gZnVuY3Rpb24gKG5ld0tleSwgdmFsdWUsIHN0b3JlQXV0aFN0YXRlSW5Db29raWUpIHtcclxuICAgICAgICBpZiAodmFsdWUpIHtcclxuICAgICAgICAgICAgdGhpcy5zZXRJdGVtKG5ld0tleSwgdmFsdWUsIHN0b3JlQXV0aFN0YXRlSW5Db29raWUpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFByZXBlbmQgbXNhbC48Y2xpZW50LWlkPiB0byBlYWNoIGtleTsgU2tpcCBmb3IgYW55IEpTT04gb2JqZWN0IGFzIEtleSAoZGVmaW5lZCBzY2hlbWFzIGRvIG5vdCBuZWVkIHRoZSBrZXkgYXBwZW5kZWQ6IEFjY2Vzc1Rva2VuIEtleXMgb3IgdGhlIHVwY29taW5nIHNjaGVtYSlcclxuICAgICAqIEBwYXJhbSBrZXlcclxuICAgICAqIEBwYXJhbSBhZGRJbnN0YW5jZUlkXHJcbiAgICAgKi9cclxuICAgIEF1dGhDYWNoZS5wcm90b3R5cGUuZ2VuZXJhdGVDYWNoZUtleSA9IGZ1bmN0aW9uIChrZXksIGFkZEluc3RhbmNlSWQpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAvLyBEZWZpbmVkIHNjaGVtYXMgZG8gbm90IG5lZWQgdGhlIGtleSBhcHBlbmRlZFxyXG4gICAgICAgICAgICBKU09OLnBhcnNlKGtleSk7XHJcbiAgICAgICAgICAgIHJldHVybiBrZXk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIGlmIChrZXkuaW5kZXhPZihcIlwiICsgQ29uc3RhbnRzLmNhY2hlUHJlZml4KSA9PT0gMCB8fCBrZXkuaW5kZXhPZihDb25zdGFudHMuYWRhbElkVG9rZW4pID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ga2V5O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBhZGRJbnN0YW5jZUlkID8gQ29uc3RhbnRzLmNhY2hlUHJlZml4ICsgXCIuXCIgKyB0aGlzLmNsaWVudElkICsgXCIuXCIgKyBrZXkgOiBDb25zdGFudHMuY2FjaGVQcmVmaXggKyBcIi5cIiArIGtleTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBWYWxpZGF0ZXMgdGhhdCB0aGUgaW5wdXQgY2FjaGUga2V5IGNvbnRhaW5zIHRoZSBhY2NvdW50IHNlYXJjaCB0ZXJtcyAoY2xpZW50SWQgYW5kIGhvbWVBY2NvdW50SWRlbnRpZmllcikgYW5kXHJcbiAgICAgKiB0aGVuIHdoZXRoZXIgb3Igbm90IGl0IGNvbnRhaW5zIHRoZSBcInNjb3Blc1wiLCBkZXBlbmRpbmcgb24gdGhlIHRva2VuIHR5cGUgYmVpbmcgc2VhcmNoZWQgZm9yLiBXaXRoIG1hdGNoaW5nIGFjY291bnRcclxuICAgICAqIHNlYXJjaCB0ZXJtcywgQWNjZXNzIFRva2VuIHNlYXJjaCB0cmllcyB0byBtYXRjaCB0aGUgXCJzY29wZXNcIiBrZXl3b3JkLCB3aGlsZSBJZCBUb2tlbiBzZWFyY2ggZXhwZWN0cyBcInNjb3Blc1wiIHRvIG5vdCBiZSBpbmNsdWRlZC5cclxuICAgICAqIEBwYXJhbSBrZXlcclxuICAgICAqIEBwYXJhbSBjbGllbnRJZFxyXG4gICAgICogQHBhcmFtIGhvbWVBY2NvdW50SWRlbnRpZmllclxyXG4gICAgICogQHBhcmFtIHRva2VuVHlwZVxyXG4gICAgICovXHJcbiAgICBBdXRoQ2FjaGUucHJvdG90eXBlLm1hdGNoS2V5Rm9yVHlwZSA9IGZ1bmN0aW9uIChrZXksIGNsaWVudElkLCBob21lQWNjb3VudElkZW50aWZpZXIsIHRva2VuVHlwZSkge1xyXG4gICAgICAgIC8vIEFsbCB2YWxpZCB0b2tlbiBjYWNoZSBpdGVtIGtleXMgYXJlIHZhbGlkIEpTT04gb2JqZWN0cywgaWdub3JlIGtleXMgdGhhdCBhcmVuJ3RcclxuICAgICAgICB2YXIgcGFyc2VkS2V5ID0gU3RyaW5nVXRpbHMudmFsaWRhdGVBbmRQYXJzZUpzb25DYWNoZUtleShrZXkpO1xyXG4gICAgICAgIGlmICghcGFyc2VkS2V5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBEb2VzIHRoZSBjYWNoZSBpdGVtIG1hdGNoIHRoZSByZXF1ZXN0IGFjY291bnRcclxuICAgICAgICB2YXIgYWNjb3VudE1hdGNoZXMgPSBrZXkubWF0Y2goY2xpZW50SWQpICYmIGtleS5tYXRjaChob21lQWNjb3VudElkZW50aWZpZXIpO1xyXG4gICAgICAgIC8vIERvZXMgdGhlIGNhY2hlIGl0ZW0gbWF0Y2ggdGhlIHJlcXVlc3RlZCB0b2tlbiB0eXBlXHJcbiAgICAgICAgdmFyIHRva2VuVHlwZU1hdGNoZXMgPSBmYWxzZTtcclxuICAgICAgICBzd2l0Y2ggKHRva2VuVHlwZSkge1xyXG4gICAgICAgICAgICBjYXNlIFNlcnZlckhhc2hQYXJhbUtleXMuQUNDRVNTX1RPS0VOOlxyXG4gICAgICAgICAgICAgICAgLy8gQ2FjaGUgaXRlbSBpcyBhbiBhY2Nlc3MgdG9rZW4gaWYgc2NvcGVzIGFyZSBpbmNsdWRlZCBpbiB0aGUgY2FjaGUgaXRlbSBrZXlcclxuICAgICAgICAgICAgICAgIHRva2VuVHlwZU1hdGNoZXMgPSAhIWtleS5tYXRjaChDb25zdGFudHMuc2NvcGVzKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFNlcnZlckhhc2hQYXJhbUtleXMuSURfVE9LRU46XHJcbiAgICAgICAgICAgICAgICAvLyBDYWNoZSBtYXkgYmUgYW4gSUQgdG9rZW4gaWYgc2NvcGVzIGFyZSBOT1QgaW5jbHVkZWQgaW4gdGhlIGNhY2hlIGl0ZW0ga2V5XHJcbiAgICAgICAgICAgICAgICB0b2tlblR5cGVNYXRjaGVzID0gIWtleS5tYXRjaChDb25zdGFudHMuc2NvcGVzKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gKGFjY291bnRNYXRjaGVzICYmIHRva2VuVHlwZU1hdGNoZXMpID8gcGFyc2VkS2V5IDogbnVsbDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIGFkZCB2YWx1ZSB0byBzdG9yYWdlXHJcbiAgICAgKiBAcGFyYW0ga2V5XHJcbiAgICAgKiBAcGFyYW0gdmFsdWVcclxuICAgICAqIEBwYXJhbSBlbmFibGVDb29raWVTdG9yYWdlXHJcbiAgICAgKi9cclxuICAgIEF1dGhDYWNoZS5wcm90b3R5cGUuc2V0SXRlbSA9IGZ1bmN0aW9uIChrZXksIHZhbHVlLCBlbmFibGVDb29raWVTdG9yYWdlKSB7XHJcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5zZXRJdGVtLmNhbGwodGhpcywgdGhpcy5nZW5lcmF0ZUNhY2hlS2V5KGtleSwgdHJ1ZSksIHZhbHVlLCBlbmFibGVDb29raWVTdG9yYWdlKTtcclxuICAgICAgICAvLyBWYWx1ZXMgc3RvcmVkIGluIGNvb2tpZXMgd2lsbCBoYXZlIHJvbGxiYWNrIGRpc2FibGVkIHRvIG1pbmltaXplIGNvb2tpZSBsZW5ndGhcclxuICAgICAgICBpZiAodGhpcy5yb2xsYmFja0VuYWJsZWQgJiYgIWVuYWJsZUNvb2tpZVN0b3JhZ2UpIHtcclxuICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5zZXRJdGVtLmNhbGwodGhpcywgdGhpcy5nZW5lcmF0ZUNhY2hlS2V5KGtleSwgZmFsc2UpLCB2YWx1ZSwgZW5hYmxlQ29va2llU3RvcmFnZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogZ2V0IG9uZSBpdGVtIGJ5IGtleSBmcm9tIHN0b3JhZ2VcclxuICAgICAqIEBwYXJhbSBrZXlcclxuICAgICAqIEBwYXJhbSBlbmFibGVDb29raWVTdG9yYWdlXHJcbiAgICAgKi9cclxuICAgIEF1dGhDYWNoZS5wcm90b3R5cGUuZ2V0SXRlbSA9IGZ1bmN0aW9uIChrZXksIGVuYWJsZUNvb2tpZVN0b3JhZ2UpIHtcclxuICAgICAgICByZXR1cm4gX3N1cGVyLnByb3RvdHlwZS5nZXRJdGVtLmNhbGwodGhpcywgdGhpcy5nZW5lcmF0ZUNhY2hlS2V5KGtleSwgdHJ1ZSksIGVuYWJsZUNvb2tpZVN0b3JhZ2UpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogcmVtb3ZlIHZhbHVlIGZyb20gc3RvcmFnZVxyXG4gICAgICogQHBhcmFtIGtleVxyXG4gICAgICovXHJcbiAgICBBdXRoQ2FjaGUucHJvdG90eXBlLnJlbW92ZUl0ZW0gPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5yZW1vdmVJdGVtLmNhbGwodGhpcywgdGhpcy5nZW5lcmF0ZUNhY2hlS2V5KGtleSwgdHJ1ZSkpO1xyXG4gICAgICAgIGlmICh0aGlzLnJvbGxiYWNrRW5hYmxlZCkge1xyXG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLnJlbW92ZUl0ZW0uY2FsbCh0aGlzLCB0aGlzLmdlbmVyYXRlQ2FjaGVLZXkoa2V5LCBmYWxzZSkpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJlc2V0IHRoZSBjYWNoZSBpdGVtc1xyXG4gICAgICovXHJcbiAgICBBdXRoQ2FjaGUucHJvdG90eXBlLnJlc2V0Q2FjaGVJdGVtcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgc3RvcmFnZSA9IHdpbmRvd1t0aGlzLmNhY2hlTG9jYXRpb25dO1xyXG4gICAgICAgIHZhciBrZXk7XHJcbiAgICAgICAgZm9yIChrZXkgaW4gc3RvcmFnZSkge1xyXG4gICAgICAgICAgICAvLyBDaGVjayBpZiBrZXkgY29udGFpbnMgbXNhbCBwcmVmaXg7IEZvciBub3csIHdlIGFyZSBjbGVhcmluZyBhbGwgY2FjaGUgaXRlbXMgY3JlYXRlZCBieSBNU0FMLmpzXHJcbiAgICAgICAgICAgIGlmIChzdG9yYWdlLmhhc093blByb3BlcnR5KGtleSkgJiYgKGtleS5pbmRleE9mKENvbnN0YW50cy5jYWNoZVByZWZpeCkgIT09IC0xKSkge1xyXG4gICAgICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5yZW1vdmVJdGVtLmNhbGwodGhpcywga2V5KTtcclxuICAgICAgICAgICAgICAgIC8vIFRPRE86IENsZWFyIGNhY2hlIGJhc2VkIG9uIGNsaWVudCBpZCAoY2xhcmlmeSB1c2UgY2FzZXMgd2hlcmUgdGhpcyBpcyBuZWVkZWQpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXNldCBhbGwgdGVtcG9yYXJ5IGNhY2hlIGl0ZW1zXHJcbiAgICAgKi9cclxuICAgIEF1dGhDYWNoZS5wcm90b3R5cGUucmVzZXRUZW1wQ2FjaGVJdGVtcyA9IGZ1bmN0aW9uIChzdGF0ZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHN0YXRlSWQgPSBzdGF0ZSAmJiBSZXF1ZXN0VXRpbHMucGFyc2VMaWJyYXJ5U3RhdGUoc3RhdGUpLmlkO1xyXG4gICAgICAgIHZhciBpc1Rva2VuUmVuZXdhbEluUHJvZ3Jlc3MgPSB0aGlzLnRva2VuUmVuZXdhbEluUHJvZ3Jlc3Moc3RhdGUpO1xyXG4gICAgICAgIHZhciBzdG9yYWdlID0gd2luZG93W3RoaXMuY2FjaGVMb2NhdGlvbl07XHJcbiAgICAgICAgLy8gY2hlY2sgc3RhdGUgYW5kIHJlbW92ZSBhc3NvY2lhdGVkIGNhY2hlXHJcbiAgICAgICAgaWYgKHN0YXRlSWQgJiYgIWlzVG9rZW5SZW5ld2FsSW5Qcm9ncmVzcykge1xyXG4gICAgICAgICAgICBPYmplY3Qua2V5cyhzdG9yYWdlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgICAgIGlmIChrZXkuaW5kZXhPZihzdGF0ZUlkKSAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5yZW1vdmVJdGVtKGtleSk7XHJcbiAgICAgICAgICAgICAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5jbGVhckl0ZW1Db29raWUuY2FsbChfdGhpcywga2V5KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGRlbGV0ZSB0aGUgaW50ZXJhY3Rpb24gc3RhdHVzIGNhY2hlXHJcbiAgICAgICAgdGhpcy5yZW1vdmVJdGVtKFRlbXBvcmFyeUNhY2hlS2V5cy5JTlRFUkFDVElPTl9TVEFUVVMpO1xyXG4gICAgICAgIHRoaXMucmVtb3ZlSXRlbShUZW1wb3JhcnlDYWNoZUtleXMuUkVESVJFQ1RfUkVRVUVTVCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBTZXQgY29va2llcyBmb3IgSUVcclxuICAgICAqIEBwYXJhbSBjTmFtZVxyXG4gICAgICogQHBhcmFtIGNWYWx1ZVxyXG4gICAgICogQHBhcmFtIGV4cGlyZXNcclxuICAgICAqL1xyXG4gICAgQXV0aENhY2hlLnByb3RvdHlwZS5zZXRJdGVtQ29va2llID0gZnVuY3Rpb24gKGNOYW1lLCBjVmFsdWUsIGV4cGlyZXMpIHtcclxuICAgICAgICBfc3VwZXIucHJvdG90eXBlLnNldEl0ZW1Db29raWUuY2FsbCh0aGlzLCB0aGlzLmdlbmVyYXRlQ2FjaGVLZXkoY05hbWUsIHRydWUpLCBjVmFsdWUsIGV4cGlyZXMpO1xyXG4gICAgICAgIGlmICh0aGlzLnJvbGxiYWNrRW5hYmxlZCkge1xyXG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLnNldEl0ZW1Db29raWUuY2FsbCh0aGlzLCB0aGlzLmdlbmVyYXRlQ2FjaGVLZXkoY05hbWUsIGZhbHNlKSwgY1ZhbHVlLCBleHBpcmVzKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgQXV0aENhY2hlLnByb3RvdHlwZS5jbGVhckl0ZW1Db29raWUgPSBmdW5jdGlvbiAoY05hbWUpIHtcclxuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmNsZWFySXRlbUNvb2tpZS5jYWxsKHRoaXMsIHRoaXMuZ2VuZXJhdGVDYWNoZUtleShjTmFtZSwgdHJ1ZSkpO1xyXG4gICAgICAgIGlmICh0aGlzLnJvbGxiYWNrRW5hYmxlZCkge1xyXG4gICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLmNsZWFySXRlbUNvb2tpZS5jYWxsKHRoaXMsIHRoaXMuZ2VuZXJhdGVDYWNoZUtleShjTmFtZSwgZmFsc2UpKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBnZXQgb25lIGl0ZW0gYnkga2V5IGZyb20gY29va2llc1xyXG4gICAgICogQHBhcmFtIGNOYW1lXHJcbiAgICAgKi9cclxuICAgIEF1dGhDYWNoZS5wcm90b3R5cGUuZ2V0SXRlbUNvb2tpZSA9IGZ1bmN0aW9uIChjTmFtZSkge1xyXG4gICAgICAgIHJldHVybiBfc3VwZXIucHJvdG90eXBlLmdldEl0ZW1Db29raWUuY2FsbCh0aGlzLCB0aGlzLmdlbmVyYXRlQ2FjaGVLZXkoY05hbWUsIHRydWUpKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEdldCBhbGwgdG9rZW5zIG9mIGEgY2VydGFpbiB0eXBlIGZyb20gdGhlIGNhY2hlXHJcbiAgICAgKiBAcGFyYW0gY2xpZW50SWRcclxuICAgICAqIEBwYXJhbSBob21lQWNjb3VudElkZW50aWZpZXJcclxuICAgICAqIEBwYXJhbSB0b2tlblR5cGVcclxuICAgICAqL1xyXG4gICAgQXV0aENhY2hlLnByb3RvdHlwZS5nZXRBbGxUb2tlbnNCeVR5cGUgPSBmdW5jdGlvbiAoY2xpZW50SWQsIGhvbWVBY2NvdW50SWRlbnRpZmllciwgdG9rZW5UeXBlKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgcmVzdWx0cyA9IE9iamVjdC5rZXlzKHdpbmRvd1t0aGlzLmNhY2hlTG9jYXRpb25dKS5yZWR1Y2UoZnVuY3Rpb24gKHRva2Vucywga2V5KSB7XHJcbiAgICAgICAgICAgIHZhciBtYXRjaGVkVG9rZW5LZXkgPSBfdGhpcy5tYXRjaEtleUZvclR5cGUoa2V5LCBjbGllbnRJZCwgaG9tZUFjY291bnRJZGVudGlmaWVyLCB0b2tlblR5cGUpO1xyXG4gICAgICAgICAgICBpZiAobWF0Y2hlZFRva2VuS2V5KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBfdGhpcy5nZXRJdGVtKGtleSk7XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3QWNjZXNzVG9rZW5DYWNoZUl0ZW0gPSBuZXcgQWNjZXNzVG9rZW5DYWNoZUl0ZW0obWF0Y2hlZFRva2VuS2V5LCBKU09OLnBhcnNlKHZhbHVlKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0b2tlbnMuY29uY2F0KFtuZXdBY2Nlc3NUb2tlbkNhY2hlSXRlbV0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNraXAgY2FjaGUgaXRlbXMgd2l0aCBub24tdmFsaWQgSlNPTiB2YWx1ZXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRva2VucztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRva2VucztcclxuICAgICAgICB9LCBbXSk7XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdHM7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgYWxsIGFjY2VzcyB0b2tlbnMgaW4gdGhlIGNhY2hlXHJcbiAgICAgKiBAcGFyYW0gY2xpZW50SWRcclxuICAgICAqIEBwYXJhbSBob21lQWNjb3VudElkZW50aWZpZXJcclxuICAgICAqL1xyXG4gICAgQXV0aENhY2hlLnByb3RvdHlwZS5nZXRBbGxBY2Nlc3NUb2tlbnMgPSBmdW5jdGlvbiAoY2xpZW50SWQsIGhvbWVBY2NvdW50SWRlbnRpZmllcikge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldEFsbFRva2Vuc0J5VHlwZShjbGllbnRJZCwgaG9tZUFjY291bnRJZGVudGlmaWVyLCBTZXJ2ZXJIYXNoUGFyYW1LZXlzLkFDQ0VTU19UT0tFTik7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgYWxsIGlkIHRva2VucyBpbiB0aGUgY2FjaGUgaW4gdGhlIGZvcm0gb2YgQWNjZXNzVG9rZW5DYWNoZUl0ZW0gb2JqZWN0cyBzbyB0aGV5IGFyZVxyXG4gICAgICogaW4gYSBub3JtYWxpemVkIGZvcm1hdCBhbmQgY2FuIG1ha2UgdXNlIG9mIHRoZSBleGlzdGluZyBjYWNoZWQgYWNjZXNzIHRva2VuIHZhbGlkYXRpb24gbG9naWNcclxuICAgICAqL1xyXG4gICAgQXV0aENhY2hlLnByb3RvdHlwZS5nZXRBbGxJZFRva2VucyA9IGZ1bmN0aW9uIChjbGllbnRJZCwgaG9tZUFjY291bnRJZGVudGlmaWVyKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QWxsVG9rZW5zQnlUeXBlKGNsaWVudElkLCBob21lQWNjb3VudElkZW50aWZpZXIsIFNlcnZlckhhc2hQYXJhbUtleXMuSURfVE9LRU4pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogR2V0IGFsbCBhY2Nlc3MgYW5kIElEIHRva2VucyBpbiB0aGUgY2FjaGVcclxuICAgICAqIEBwYXJhbSBjbGllbnRJZFxyXG4gICAgICogQHBhcmFtIGhvbWVBY2NvdW50SWRlbnRpZmllclxyXG4gICAgICovXHJcbiAgICBBdXRoQ2FjaGUucHJvdG90eXBlLmdldEFsbFRva2VucyA9IGZ1bmN0aW9uIChjbGllbnRJZCwgaG9tZUFjY291bnRJZGVudGlmaWVyKSB7XHJcbiAgICAgICAgdmFyIGFjY2Vzc1Rva2VucyA9IHRoaXMuZ2V0QWxsQWNjZXNzVG9rZW5zKGNsaWVudElkLCBob21lQWNjb3VudElkZW50aWZpZXIpO1xyXG4gICAgICAgIHZhciBpZFRva2VucyA9IHRoaXMuZ2V0QWxsSWRUb2tlbnMoY2xpZW50SWQsIGhvbWVBY2NvdW50SWRlbnRpZmllcik7XHJcbiAgICAgICAgcmV0dXJuIGFjY2Vzc1Rva2Vucy5jb25jYXQoaWRUb2tlbnMpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJuIGlmIHRoZSB0b2tlbiByZW5ld2FsIGlzIHN0aWxsIGluIHByb2dyZXNzXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHN0YXRlVmFsdWVcclxuICAgICAqL1xyXG4gICAgQXV0aENhY2hlLnByb3RvdHlwZS50b2tlblJlbmV3YWxJblByb2dyZXNzID0gZnVuY3Rpb24gKHN0YXRlVmFsdWUpIHtcclxuICAgICAgICB2YXIgcmVuZXdTdGF0dXMgPSB0aGlzLmdldEl0ZW0oQXV0aENhY2hlLmdlbmVyYXRlVGVtcG9yYXJ5Q2FjaGVLZXkoVGVtcG9yYXJ5Q2FjaGVLZXlzLlJFTkVXX1NUQVRVUywgc3RhdGVWYWx1ZSkpO1xyXG4gICAgICAgIHJldHVybiAhIShyZW5ld1N0YXR1cyAmJiByZW5ld1N0YXR1cyA9PT0gQ29uc3RhbnRzLmluUHJvZ3Jlc3MpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ2xlYXIgYWxsIGNvb2tpZXNcclxuICAgICAqL1xyXG4gICAgQXV0aENhY2hlLnByb3RvdHlwZS5jbGVhck1zYWxDb29raWUgPSBmdW5jdGlvbiAoc3RhdGUpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIC8qXHJcbiAgICAgICAgICogSWYgc3RhdGUgaXMgdHJ1dGh5LCByZW1vdmUgdmFsdWVzIGFzc29jaWF0ZWQgd2l0aCB0aGF0IHJlcXVlc3QuXHJcbiAgICAgICAgICogT3RoZXJ3aXNlLCByZW1vdmUgYWxsIE1TQUwgY29va2llcy5cclxuICAgICAgICAgKi9cclxuICAgICAgICBpZiAoc3RhdGUpIHtcclxuICAgICAgICAgICAgdGhpcy5jbGVhckl0ZW1Db29raWUoQXV0aENhY2hlLmdlbmVyYXRlVGVtcG9yYXJ5Q2FjaGVLZXkoVGVtcG9yYXJ5Q2FjaGVLZXlzLk5PTkNFX0lEVE9LRU4sIHN0YXRlKSk7XHJcbiAgICAgICAgICAgIHRoaXMuY2xlYXJJdGVtQ29va2llKEF1dGhDYWNoZS5nZW5lcmF0ZVRlbXBvcmFyeUNhY2hlS2V5KFRlbXBvcmFyeUNhY2hlS2V5cy5TVEFURV9MT0dJTiwgc3RhdGUpKTtcclxuICAgICAgICAgICAgdGhpcy5jbGVhckl0ZW1Db29raWUoQXV0aENhY2hlLmdlbmVyYXRlVGVtcG9yYXJ5Q2FjaGVLZXkoVGVtcG9yYXJ5Q2FjaGVLZXlzLkxPR0lOX1JFUVVFU1QsIHN0YXRlKSk7XHJcbiAgICAgICAgICAgIHRoaXMuY2xlYXJJdGVtQ29va2llKEF1dGhDYWNoZS5nZW5lcmF0ZVRlbXBvcmFyeUNhY2hlS2V5KFRlbXBvcmFyeUNhY2hlS2V5cy5TVEFURV9BQ1FfVE9LRU4sIHN0YXRlKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgY29va2llcyA9IGRvY3VtZW50LmNvb2tpZS5zcGxpdChcIjtcIik7XHJcbiAgICAgICAgICAgIGNvb2tpZXMuZm9yRWFjaChmdW5jdGlvbiAoY29va2llU3RyaW5nKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY29va2llTmFtZSA9IGNvb2tpZVN0cmluZy50cmltKCkuc3BsaXQoXCI9XCIpWzBdO1xyXG4gICAgICAgICAgICAgICAgaWYgKGNvb2tpZU5hbWUuaW5kZXhPZihDb25zdGFudHMuY2FjaGVQcmVmaXgpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICBfc3VwZXIucHJvdG90eXBlLmNsZWFySXRlbUNvb2tpZS5jYWxsKF90aGlzLCBjb29raWVOYW1lKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlIGFjcXVpcmVUb2tlbkFjY291bnRLZXkgdG8gY2FjaGUgYWNjb3VudCBvYmplY3RcclxuICAgICAqIEBwYXJhbSBhY2NvdW50SWRcclxuICAgICAqIEBwYXJhbSBzdGF0ZVxyXG4gICAgICovXHJcbiAgICBBdXRoQ2FjaGUuZ2VuZXJhdGVBY3F1aXJlVG9rZW5BY2NvdW50S2V5ID0gZnVuY3Rpb24gKGFjY291bnRJZCwgc3RhdGUpIHtcclxuICAgICAgICB2YXIgc3RhdGVJZCA9IFJlcXVlc3RVdGlscy5wYXJzZUxpYnJhcnlTdGF0ZShzdGF0ZSkuaWQ7XHJcbiAgICAgICAgcmV0dXJuIFwiXCIgKyBUZW1wb3JhcnlDYWNoZUtleXMuQUNRVUlSRV9UT0tFTl9BQ0NPVU5UICsgQ29uc3RhbnRzLnJlc291cmNlRGVsaW1pdGVyICsgYWNjb3VudElkICsgQ29uc3RhbnRzLnJlc291cmNlRGVsaW1pdGVyICsgc3RhdGVJZDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZSBhdXRob3JpdHlLZXkgdG8gY2FjaGUgYXV0aG9yaXR5XHJcbiAgICAgKiBAcGFyYW0gc3RhdGVcclxuICAgICAqL1xyXG4gICAgQXV0aENhY2hlLmdlbmVyYXRlQXV0aG9yaXR5S2V5ID0gZnVuY3Rpb24gKHN0YXRlKSB7XHJcbiAgICAgICAgcmV0dXJuIEF1dGhDYWNoZS5nZW5lcmF0ZVRlbXBvcmFyeUNhY2hlS2V5KFRlbXBvcmFyeUNhY2hlS2V5cy5BVVRIT1JJVFksIHN0YXRlKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEdlbmVyYXRlcyB0aGUgY2FjaGUga2V5IGZvciB0ZW1wb3JhcnkgY2FjaGUgaXRlbXMsIHVzaW5nIHJlcXVlc3Qgc3RhdGVcclxuICAgICAqIEBwYXJhbSB0ZW1wQ2FjaGVLZXkgQ2FjaGUga2V5IHByZWZpeFxyXG4gICAgICogQHBhcmFtIHN0YXRlIFJlcXVlc3Qgc3RhdGUgdmFsdWVcclxuICAgICAqL1xyXG4gICAgQXV0aENhY2hlLmdlbmVyYXRlVGVtcG9yYXJ5Q2FjaGVLZXkgPSBmdW5jdGlvbiAodGVtcENhY2hlS2V5LCBzdGF0ZSkge1xyXG4gICAgICAgIC8vIFVzZSB0aGUgc3RhdGUgaWQgKGEgZ3VpZCksIGluIHRoZSBpbnRlcmVzdCBvZiBzaG9ydGVyIGtleSBuYW1lcywgd2hpY2ggaXMgaW1wb3J0YW50IGZvciBjb29raWVzLlxyXG4gICAgICAgIHZhciBzdGF0ZUlkID0gUmVxdWVzdFV0aWxzLnBhcnNlTGlicmFyeVN0YXRlKHN0YXRlKS5pZDtcclxuICAgICAgICByZXR1cm4gXCJcIiArIHRlbXBDYWNoZUtleSArIENvbnN0YW50cy5yZXNvdXJjZURlbGltaXRlciArIHN0YXRlSWQ7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEF1dGhDYWNoZTtcclxufShCcm93c2VyU3RvcmFnZSkpO1xyXG5leHBvcnQgeyBBdXRoQ2FjaGUgfTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9QXV0aENhY2hlLmpzLm1hcCJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///O1xl\n");

/***/ }),

/***/ "T0bz":
/*!******************************************************!*\
  !*** ./node_modules/msal/lib-es6/error/AuthError.js ***!
  \******************************************************/
/*! exports provided: AuthErrorMessage, AuthError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AuthErrorMessage\", function() { return AuthErrorMessage; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AuthError\", function() { return AuthError; });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ \"mrSG\");\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\nvar AuthErrorMessage = {\r\n    unexpectedError: {\r\n        code: \"unexpected_error\",\r\n        desc: \"Unexpected error in authentication.\"\r\n    },\r\n    noWindowObjectError: {\r\n        code: \"no_window_object\",\r\n        desc: \"No window object available. Details:\"\r\n    }\r\n};\r\n/**\r\n * General error class thrown by the MSAL.js library.\r\n */\r\nvar AuthError = /** @class */ (function (_super) {\r\n    tslib__WEBPACK_IMPORTED_MODULE_0__[\"__extends\"](AuthError, _super);\r\n    function AuthError(errorCode, errorMessage) {\r\n        var _this = _super.call(this, errorMessage) || this;\r\n        Object.setPrototypeOf(_this, AuthError.prototype);\r\n        _this.errorCode = errorCode;\r\n        _this.errorMessage = errorMessage;\r\n        _this.name = \"AuthError\";\r\n        return _this;\r\n    }\r\n    AuthError.createUnexpectedError = function (errDesc) {\r\n        return new AuthError(AuthErrorMessage.unexpectedError.code, AuthErrorMessage.unexpectedError.desc + \": \" + errDesc);\r\n    };\r\n    AuthError.createNoWindowObjectError = function (errDesc) {\r\n        return new AuthError(AuthErrorMessage.noWindowObjectError.code, AuthErrorMessage.noWindowObjectError.desc + \" \" + errDesc);\r\n    };\r\n    return AuthError;\r\n}(Error));\r\n\r\n//# sourceMappingURL=AuthError.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVDBiei5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tc2FsL2xpYi1lczYvZXJyb3IvQXV0aEVycm9yLmpzPzRmNDYiXSwic291cmNlc0NvbnRlbnQiOlsiLypcclxuICogQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuICovXHJcbmltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmV4cG9ydCB2YXIgQXV0aEVycm9yTWVzc2FnZSA9IHtcclxuICAgIHVuZXhwZWN0ZWRFcnJvcjoge1xyXG4gICAgICAgIGNvZGU6IFwidW5leHBlY3RlZF9lcnJvclwiLFxyXG4gICAgICAgIGRlc2M6IFwiVW5leHBlY3RlZCBlcnJvciBpbiBhdXRoZW50aWNhdGlvbi5cIlxyXG4gICAgfSxcclxuICAgIG5vV2luZG93T2JqZWN0RXJyb3I6IHtcclxuICAgICAgICBjb2RlOiBcIm5vX3dpbmRvd19vYmplY3RcIixcclxuICAgICAgICBkZXNjOiBcIk5vIHdpbmRvdyBvYmplY3QgYXZhaWxhYmxlLiBEZXRhaWxzOlwiXHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiBHZW5lcmFsIGVycm9yIGNsYXNzIHRocm93biBieSB0aGUgTVNBTC5qcyBsaWJyYXJ5LlxyXG4gKi9cclxudmFyIEF1dGhFcnJvciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKEF1dGhFcnJvciwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIEF1dGhFcnJvcihlcnJvckNvZGUsIGVycm9yTWVzc2FnZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGVycm9yTWVzc2FnZSkgfHwgdGhpcztcclxuICAgICAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YoX3RoaXMsIEF1dGhFcnJvci5wcm90b3R5cGUpO1xyXG4gICAgICAgIF90aGlzLmVycm9yQ29kZSA9IGVycm9yQ29kZTtcclxuICAgICAgICBfdGhpcy5lcnJvck1lc3NhZ2UgPSBlcnJvck1lc3NhZ2U7XHJcbiAgICAgICAgX3RoaXMubmFtZSA9IFwiQXV0aEVycm9yXCI7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgQXV0aEVycm9yLmNyZWF0ZVVuZXhwZWN0ZWRFcnJvciA9IGZ1bmN0aW9uIChlcnJEZXNjKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBBdXRoRXJyb3IoQXV0aEVycm9yTWVzc2FnZS51bmV4cGVjdGVkRXJyb3IuY29kZSwgQXV0aEVycm9yTWVzc2FnZS51bmV4cGVjdGVkRXJyb3IuZGVzYyArIFwiOiBcIiArIGVyckRlc2MpO1xyXG4gICAgfTtcclxuICAgIEF1dGhFcnJvci5jcmVhdGVOb1dpbmRvd09iamVjdEVycm9yID0gZnVuY3Rpb24gKGVyckRlc2MpIHtcclxuICAgICAgICByZXR1cm4gbmV3IEF1dGhFcnJvcihBdXRoRXJyb3JNZXNzYWdlLm5vV2luZG93T2JqZWN0RXJyb3IuY29kZSwgQXV0aEVycm9yTWVzc2FnZS5ub1dpbmRvd09iamVjdEVycm9yLmRlc2MgKyBcIiBcIiArIGVyckRlc2MpO1xyXG4gICAgfTtcclxuICAgIHJldHVybiBBdXRoRXJyb3I7XHJcbn0oRXJyb3IpKTtcclxuZXhwb3J0IHsgQXV0aEVycm9yIH07XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUF1dGhFcnJvci5qcy5tYXAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///T0bz\n");

/***/ }),

/***/ "TeXa":
/*!***********************************************************!*\
  !*** ./node_modules/msal/lib-es6/cache/AccessTokenKey.js ***!
  \***********************************************************/
/*! exports provided: AccessTokenKey */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AccessTokenKey\", function() { return AccessTokenKey; });\n/* harmony import */ var _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/CryptoUtils */ \"jUVH\");\n/* harmony import */ var _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../utils/UrlUtils */ \"JB7q\");\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\n\r\n/**\r\n * @hidden\r\n */\r\nvar AccessTokenKey = /** @class */ (function () {\r\n    function AccessTokenKey(authority, clientId, scopes, uid, utid) {\r\n        this.authority = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_1__[\"UrlUtils\"].CanonicalizeUri(authority);\r\n        this.clientId = clientId;\r\n        this.scopes = scopes;\r\n        this.homeAccountIdentifier = _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__[\"CryptoUtils\"].base64Encode(uid) + \".\" + _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__[\"CryptoUtils\"].base64Encode(utid);\r\n    }\r\n    return AccessTokenKey;\r\n}());\r\n\r\n//# sourceMappingURL=AccessTokenKey.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGVYYS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tc2FsL2xpYi1lczYvY2FjaGUvQWNjZXNzVG9rZW5LZXkuanM/NGRlNSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKi9cclxuaW1wb3J0IHsgQ3J5cHRvVXRpbHMgfSBmcm9tIFwiLi4vdXRpbHMvQ3J5cHRvVXRpbHNcIjtcclxuaW1wb3J0IHsgVXJsVXRpbHMgfSBmcm9tIFwiLi4vdXRpbHMvVXJsVXRpbHNcIjtcclxuLyoqXHJcbiAqIEBoaWRkZW5cclxuICovXHJcbnZhciBBY2Nlc3NUb2tlbktleSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEFjY2Vzc1Rva2VuS2V5KGF1dGhvcml0eSwgY2xpZW50SWQsIHNjb3BlcywgdWlkLCB1dGlkKSB7XHJcbiAgICAgICAgdGhpcy5hdXRob3JpdHkgPSBVcmxVdGlscy5DYW5vbmljYWxpemVVcmkoYXV0aG9yaXR5KTtcclxuICAgICAgICB0aGlzLmNsaWVudElkID0gY2xpZW50SWQ7XHJcbiAgICAgICAgdGhpcy5zY29wZXMgPSBzY29wZXM7XHJcbiAgICAgICAgdGhpcy5ob21lQWNjb3VudElkZW50aWZpZXIgPSBDcnlwdG9VdGlscy5iYXNlNjRFbmNvZGUodWlkKSArIFwiLlwiICsgQ3J5cHRvVXRpbHMuYmFzZTY0RW5jb2RlKHV0aWQpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIEFjY2Vzc1Rva2VuS2V5O1xyXG59KCkpO1xyXG5leHBvcnQgeyBBY2Nlc3NUb2tlbktleSB9O1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1BY2Nlc3NUb2tlbktleS5qcy5tYXAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///TeXa\n");

/***/ }),

/***/ "YAWc":
/*!***********************************************************!*\
  !*** ./node_modules/msal/lib-es6/cache/BrowserStorage.js ***!
  \***********************************************************/
/*! exports provided: BrowserStorage */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BrowserStorage\", function() { return BrowserStorage; });\n/* harmony import */ var _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../error/ClientConfigurationError */ \"ZEID\");\n/* harmony import */ var _error_AuthError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../error/AuthError */ \"T0bz\");\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\n\r\n/**\r\n * @hidden\r\n */\r\nvar BrowserStorage = /** @class */ (function () {\r\n    function BrowserStorage(cacheLocation) {\r\n        if (!window) {\r\n            throw _error_AuthError__WEBPACK_IMPORTED_MODULE_1__[\"AuthError\"].createNoWindowObjectError(\"Browser storage class could not find window object\");\r\n        }\r\n        var storageSupported = typeof window[cacheLocation] !== \"undefined\" && window[cacheLocation] != null;\r\n        if (!storageSupported) {\r\n            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_0__[\"ClientConfigurationError\"].createStorageNotSupportedError(cacheLocation);\r\n        }\r\n        this.cacheLocation = cacheLocation;\r\n    }\r\n    /**\r\n     * add value to storage\r\n     * @param key\r\n     * @param value\r\n     * @param enableCookieStorage\r\n     */\r\n    BrowserStorage.prototype.setItem = function (key, value, enableCookieStorage) {\r\n        window[this.cacheLocation].setItem(key, value);\r\n        if (enableCookieStorage) {\r\n            this.setItemCookie(key, value);\r\n        }\r\n    };\r\n    /**\r\n     * get one item by key from storage\r\n     * @param key\r\n     * @param enableCookieStorage\r\n     */\r\n    BrowserStorage.prototype.getItem = function (key, enableCookieStorage) {\r\n        if (enableCookieStorage && this.getItemCookie(key)) {\r\n            return this.getItemCookie(key);\r\n        }\r\n        return window[this.cacheLocation].getItem(key);\r\n    };\r\n    /**\r\n     * remove value from storage\r\n     * @param key\r\n     */\r\n    BrowserStorage.prototype.removeItem = function (key) {\r\n        return window[this.cacheLocation].removeItem(key);\r\n    };\r\n    /**\r\n     * clear storage (remove all items from it)\r\n     */\r\n    BrowserStorage.prototype.clear = function () {\r\n        return window[this.cacheLocation].clear();\r\n    };\r\n    /**\r\n     * add value to cookies\r\n     * @param cName\r\n     * @param cValue\r\n     * @param expires\r\n     */\r\n    BrowserStorage.prototype.setItemCookie = function (cName, cValue, expires) {\r\n        var cookieStr = cName + \"=\" + cValue + \";path=/;\";\r\n        if (expires) {\r\n            var expireTime = this.getCookieExpirationTime(expires);\r\n            cookieStr += \"expires=\" + expireTime + \";\";\r\n        }\r\n        document.cookie = cookieStr;\r\n    };\r\n    /**\r\n     * get one item by key from cookies\r\n     * @param cName\r\n     */\r\n    BrowserStorage.prototype.getItemCookie = function (cName) {\r\n        var name = cName + \"=\";\r\n        var ca = document.cookie.split(\";\");\r\n        for (var i = 0; i < ca.length; i++) {\r\n            var c = ca[i];\r\n            while (c.charAt(0) === \" \") {\r\n                c = c.substring(1);\r\n            }\r\n            if (c.indexOf(name) === 0) {\r\n                return c.substring(name.length, c.length);\r\n            }\r\n        }\r\n        return \"\";\r\n    };\r\n    /**\r\n     * Clear an item in the cookies by key\r\n     * @param cName\r\n     */\r\n    BrowserStorage.prototype.clearItemCookie = function (cName) {\r\n        this.setItemCookie(cName, \"\", -1);\r\n    };\r\n    /**\r\n     * Get cookie expiration time\r\n     * @param cookieLifeDays\r\n     */\r\n    BrowserStorage.prototype.getCookieExpirationTime = function (cookieLifeDays) {\r\n        var today = new Date();\r\n        var expr = new Date(today.getTime() + cookieLifeDays * 24 * 60 * 60 * 1000);\r\n        return expr.toUTCString();\r\n    };\r\n    return BrowserStorage;\r\n}());\r\n\r\n//# sourceMappingURL=BrowserStorage.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiWUFXYy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tc2FsL2xpYi1lczYvY2FjaGUvQnJvd3NlclN0b3JhZ2UuanM/NjAwNSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKi9cclxuaW1wb3J0IHsgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yIH0gZnJvbSBcIi4uL2Vycm9yL0NsaWVudENvbmZpZ3VyYXRpb25FcnJvclwiO1xyXG5pbXBvcnQgeyBBdXRoRXJyb3IgfSBmcm9tIFwiLi4vZXJyb3IvQXV0aEVycm9yXCI7XHJcbi8qKlxyXG4gKiBAaGlkZGVuXHJcbiAqL1xyXG52YXIgQnJvd3NlclN0b3JhZ2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICBmdW5jdGlvbiBCcm93c2VyU3RvcmFnZShjYWNoZUxvY2F0aW9uKSB7XHJcbiAgICAgICAgaWYgKCF3aW5kb3cpIHtcclxuICAgICAgICAgICAgdGhyb3cgQXV0aEVycm9yLmNyZWF0ZU5vV2luZG93T2JqZWN0RXJyb3IoXCJCcm93c2VyIHN0b3JhZ2UgY2xhc3MgY291bGQgbm90IGZpbmQgd2luZG93IG9iamVjdFwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHN0b3JhZ2VTdXBwb3J0ZWQgPSB0eXBlb2Ygd2luZG93W2NhY2hlTG9jYXRpb25dICE9PSBcInVuZGVmaW5lZFwiICYmIHdpbmRvd1tjYWNoZUxvY2F0aW9uXSAhPSBudWxsO1xyXG4gICAgICAgIGlmICghc3RvcmFnZVN1cHBvcnRlZCkge1xyXG4gICAgICAgICAgICB0aHJvdyBDbGllbnRDb25maWd1cmF0aW9uRXJyb3IuY3JlYXRlU3RvcmFnZU5vdFN1cHBvcnRlZEVycm9yKGNhY2hlTG9jYXRpb24pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNhY2hlTG9jYXRpb24gPSBjYWNoZUxvY2F0aW9uO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBhZGQgdmFsdWUgdG8gc3RvcmFnZVxyXG4gICAgICogQHBhcmFtIGtleVxyXG4gICAgICogQHBhcmFtIHZhbHVlXHJcbiAgICAgKiBAcGFyYW0gZW5hYmxlQ29va2llU3RvcmFnZVxyXG4gICAgICovXHJcbiAgICBCcm93c2VyU3RvcmFnZS5wcm90b3R5cGUuc2V0SXRlbSA9IGZ1bmN0aW9uIChrZXksIHZhbHVlLCBlbmFibGVDb29raWVTdG9yYWdlKSB7XHJcbiAgICAgICAgd2luZG93W3RoaXMuY2FjaGVMb2NhdGlvbl0uc2V0SXRlbShrZXksIHZhbHVlKTtcclxuICAgICAgICBpZiAoZW5hYmxlQ29va2llU3RvcmFnZSkge1xyXG4gICAgICAgICAgICB0aGlzLnNldEl0ZW1Db29raWUoa2V5LCB2YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogZ2V0IG9uZSBpdGVtIGJ5IGtleSBmcm9tIHN0b3JhZ2VcclxuICAgICAqIEBwYXJhbSBrZXlcclxuICAgICAqIEBwYXJhbSBlbmFibGVDb29raWVTdG9yYWdlXHJcbiAgICAgKi9cclxuICAgIEJyb3dzZXJTdG9yYWdlLnByb3RvdHlwZS5nZXRJdGVtID0gZnVuY3Rpb24gKGtleSwgZW5hYmxlQ29va2llU3RvcmFnZSkge1xyXG4gICAgICAgIGlmIChlbmFibGVDb29raWVTdG9yYWdlICYmIHRoaXMuZ2V0SXRlbUNvb2tpZShrZXkpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldEl0ZW1Db29raWUoa2V5KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHdpbmRvd1t0aGlzLmNhY2hlTG9jYXRpb25dLmdldEl0ZW0oa2V5KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIHJlbW92ZSB2YWx1ZSBmcm9tIHN0b3JhZ2VcclxuICAgICAqIEBwYXJhbSBrZXlcclxuICAgICAqL1xyXG4gICAgQnJvd3NlclN0b3JhZ2UucHJvdG90eXBlLnJlbW92ZUl0ZW0gPSBmdW5jdGlvbiAoa2V5KSB7XHJcbiAgICAgICAgcmV0dXJuIHdpbmRvd1t0aGlzLmNhY2hlTG9jYXRpb25dLnJlbW92ZUl0ZW0oa2V5KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIGNsZWFyIHN0b3JhZ2UgKHJlbW92ZSBhbGwgaXRlbXMgZnJvbSBpdClcclxuICAgICAqL1xyXG4gICAgQnJvd3NlclN0b3JhZ2UucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB3aW5kb3dbdGhpcy5jYWNoZUxvY2F0aW9uXS5jbGVhcigpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogYWRkIHZhbHVlIHRvIGNvb2tpZXNcclxuICAgICAqIEBwYXJhbSBjTmFtZVxyXG4gICAgICogQHBhcmFtIGNWYWx1ZVxyXG4gICAgICogQHBhcmFtIGV4cGlyZXNcclxuICAgICAqL1xyXG4gICAgQnJvd3NlclN0b3JhZ2UucHJvdG90eXBlLnNldEl0ZW1Db29raWUgPSBmdW5jdGlvbiAoY05hbWUsIGNWYWx1ZSwgZXhwaXJlcykge1xyXG4gICAgICAgIHZhciBjb29raWVTdHIgPSBjTmFtZSArIFwiPVwiICsgY1ZhbHVlICsgXCI7cGF0aD0vO1wiO1xyXG4gICAgICAgIGlmIChleHBpcmVzKSB7XHJcbiAgICAgICAgICAgIHZhciBleHBpcmVUaW1lID0gdGhpcy5nZXRDb29raWVFeHBpcmF0aW9uVGltZShleHBpcmVzKTtcclxuICAgICAgICAgICAgY29va2llU3RyICs9IFwiZXhwaXJlcz1cIiArIGV4cGlyZVRpbWUgKyBcIjtcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZG9jdW1lbnQuY29va2llID0gY29va2llU3RyO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogZ2V0IG9uZSBpdGVtIGJ5IGtleSBmcm9tIGNvb2tpZXNcclxuICAgICAqIEBwYXJhbSBjTmFtZVxyXG4gICAgICovXHJcbiAgICBCcm93c2VyU3RvcmFnZS5wcm90b3R5cGUuZ2V0SXRlbUNvb2tpZSA9IGZ1bmN0aW9uIChjTmFtZSkge1xyXG4gICAgICAgIHZhciBuYW1lID0gY05hbWUgKyBcIj1cIjtcclxuICAgICAgICB2YXIgY2EgPSBkb2N1bWVudC5jb29raWUuc3BsaXQoXCI7XCIpO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2EubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdmFyIGMgPSBjYVtpXTtcclxuICAgICAgICAgICAgd2hpbGUgKGMuY2hhckF0KDApID09PSBcIiBcIikge1xyXG4gICAgICAgICAgICAgICAgYyA9IGMuc3Vic3RyaW5nKDEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjLmluZGV4T2YobmFtZSkgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjLnN1YnN0cmluZyhuYW1lLmxlbmd0aCwgYy5sZW5ndGgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBcIlwiO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQ2xlYXIgYW4gaXRlbSBpbiB0aGUgY29va2llcyBieSBrZXlcclxuICAgICAqIEBwYXJhbSBjTmFtZVxyXG4gICAgICovXHJcbiAgICBCcm93c2VyU3RvcmFnZS5wcm90b3R5cGUuY2xlYXJJdGVtQ29va2llID0gZnVuY3Rpb24gKGNOYW1lKSB7XHJcbiAgICAgICAgdGhpcy5zZXRJdGVtQ29va2llKGNOYW1lLCBcIlwiLCAtMSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgY29va2llIGV4cGlyYXRpb24gdGltZVxyXG4gICAgICogQHBhcmFtIGNvb2tpZUxpZmVEYXlzXHJcbiAgICAgKi9cclxuICAgIEJyb3dzZXJTdG9yYWdlLnByb3RvdHlwZS5nZXRDb29raWVFeHBpcmF0aW9uVGltZSA9IGZ1bmN0aW9uIChjb29raWVMaWZlRGF5cykge1xyXG4gICAgICAgIHZhciB0b2RheSA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgdmFyIGV4cHIgPSBuZXcgRGF0ZSh0b2RheS5nZXRUaW1lKCkgKyBjb29raWVMaWZlRGF5cyAqIDI0ICogNjAgKiA2MCAqIDEwMDApO1xyXG4gICAgICAgIHJldHVybiBleHByLnRvVVRDU3RyaW5nKCk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEJyb3dzZXJTdG9yYWdlO1xyXG59KCkpO1xyXG5leHBvcnQgeyBCcm93c2VyU3RvcmFnZSB9O1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1Ccm93c2VyU3RvcmFnZS5qcy5tYXAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///YAWc\n");

/***/ }),

/***/ "ZEID":
/*!*********************************************************************!*\
  !*** ./node_modules/msal/lib-es6/error/ClientConfigurationError.js ***!
  \*********************************************************************/
/*! exports provided: ClientConfigurationErrorMessage, ClientConfigurationError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ClientConfigurationErrorMessage\", function() { return ClientConfigurationErrorMessage; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ClientConfigurationError\", function() { return ClientConfigurationError; });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ \"mrSG\");\n/* harmony import */ var _ClientAuthError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ClientAuthError */ \"7ZR7\");\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\n\r\nvar ClientConfigurationErrorMessage = {\r\n    configurationNotSet: {\r\n        code: \"no_config_set\",\r\n        desc: \"Configuration has not been set. Please call the UserAgentApplication constructor with a valid Configuration object.\"\r\n    },\r\n    storageNotSupported: {\r\n        code: \"storage_not_supported\",\r\n        desc: \"The value for the cacheLocation is not supported.\"\r\n    },\r\n    noRedirectCallbacksSet: {\r\n        code: \"no_redirect_callbacks\",\r\n        desc: \"No redirect callbacks have been set. Please call handleRedirectCallback() with the appropriate function arguments before continuing. \" +\r\n            \"More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics.\"\r\n    },\r\n    invalidCallbackObject: {\r\n        code: \"invalid_callback_object\",\r\n        desc: \"The object passed for the callback was invalid. \" +\r\n            \"More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics.\"\r\n    },\r\n    scopesRequired: {\r\n        code: \"scopes_required\",\r\n        desc: \"Scopes are required to obtain an access token.\"\r\n    },\r\n    emptyScopes: {\r\n        code: \"empty_input_scopes_error\",\r\n        desc: \"Scopes cannot be passed as empty array.\"\r\n    },\r\n    nonArrayScopes: {\r\n        code: \"nonarray_input_scopes_error\",\r\n        desc: \"Scopes cannot be passed as non-array.\"\r\n    },\r\n    invalidPrompt: {\r\n        code: \"invalid_prompt_value\",\r\n        desc: \"Supported prompt values are 'login', 'select_account', 'consent' and 'none'\",\r\n    },\r\n    invalidAuthorityType: {\r\n        code: \"invalid_authority_type\",\r\n        desc: \"The given authority is not a valid type of authority supported by MSAL. Please see here for valid authorities: <insert URL here>.\"\r\n    },\r\n    authorityUriInsecure: {\r\n        code: \"authority_uri_insecure\",\r\n        desc: \"Authority URIs must use https.\"\r\n    },\r\n    authorityUriInvalidPath: {\r\n        code: \"authority_uri_invalid_path\",\r\n        desc: \"Given authority URI is invalid.\"\r\n    },\r\n    unsupportedAuthorityValidation: {\r\n        code: \"unsupported_authority_validation\",\r\n        desc: \"The authority validation is not supported for this authority type.\"\r\n    },\r\n    untrustedAuthority: {\r\n        code: \"untrusted_authority\",\r\n        desc: \"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter or set validateAuthority=false.\"\r\n    },\r\n    b2cAuthorityUriInvalidPath: {\r\n        code: \"b2c_authority_uri_invalid_path\",\r\n        desc: \"The given URI for the B2C authority is invalid.\"\r\n    },\r\n    b2cKnownAuthoritiesNotSet: {\r\n        code: \"b2c_known_authorities_not_set\",\r\n        desc: \"Must set known authorities when validateAuthority is set to True and using B2C\"\r\n    },\r\n    claimsRequestParsingError: {\r\n        code: \"claims_request_parsing_error\",\r\n        desc: \"Could not parse the given claims request object.\"\r\n    },\r\n    emptyRequestError: {\r\n        code: \"empty_request_error\",\r\n        desc: \"Request object is required.\"\r\n    },\r\n    invalidCorrelationIdError: {\r\n        code: \"invalid_guid_sent_as_correlationId\",\r\n        desc: \"Please set the correlationId as a valid guid\"\r\n    },\r\n    telemetryConfigError: {\r\n        code: \"telemetry_config_error\",\r\n        desc: \"Telemetry config is not configured with required values\"\r\n    },\r\n    ssoSilentError: {\r\n        code: \"sso_silent_error\",\r\n        desc: \"request must contain either sid or login_hint\"\r\n    },\r\n    invalidAuthorityMetadataError: {\r\n        code: \"authority_metadata_error\",\r\n        desc: \"Invalid authorityMetadata. Must be a JSON object containing authorization_endpoint, end_session_endpoint, and issuer fields.\"\r\n    }\r\n};\r\n/**\r\n * Error thrown when there is an error in configuration of the .js library.\r\n */\r\nvar ClientConfigurationError = /** @class */ (function (_super) {\r\n    tslib__WEBPACK_IMPORTED_MODULE_0__[\"__extends\"](ClientConfigurationError, _super);\r\n    function ClientConfigurationError(errorCode, errorMessage) {\r\n        var _this = _super.call(this, errorCode, errorMessage) || this;\r\n        _this.name = \"ClientConfigurationError\";\r\n        Object.setPrototypeOf(_this, ClientConfigurationError.prototype);\r\n        return _this;\r\n    }\r\n    ClientConfigurationError.createNoSetConfigurationError = function () {\r\n        return new ClientConfigurationError(ClientConfigurationErrorMessage.configurationNotSet.code, \"\" + ClientConfigurationErrorMessage.configurationNotSet.desc);\r\n    };\r\n    ClientConfigurationError.createStorageNotSupportedError = function (givenCacheLocation) {\r\n        return new ClientConfigurationError(ClientConfigurationErrorMessage.storageNotSupported.code, ClientConfigurationErrorMessage.storageNotSupported.desc + \" Given location: \" + givenCacheLocation);\r\n    };\r\n    ClientConfigurationError.createRedirectCallbacksNotSetError = function () {\r\n        return new ClientConfigurationError(ClientConfigurationErrorMessage.noRedirectCallbacksSet.code, ClientConfigurationErrorMessage.noRedirectCallbacksSet.desc);\r\n    };\r\n    ClientConfigurationError.createInvalidCallbackObjectError = function (callbackObject) {\r\n        return new ClientConfigurationError(ClientConfigurationErrorMessage.invalidCallbackObject.code, ClientConfigurationErrorMessage.invalidCallbackObject.desc + \" Given value for callback function: \" + callbackObject);\r\n    };\r\n    ClientConfigurationError.createEmptyScopesArrayError = function (scopesValue) {\r\n        return new ClientConfigurationError(ClientConfigurationErrorMessage.emptyScopes.code, ClientConfigurationErrorMessage.emptyScopes.desc + \" Given value: \" + scopesValue + \".\");\r\n    };\r\n    ClientConfigurationError.createScopesNonArrayError = function (scopesValue) {\r\n        return new ClientConfigurationError(ClientConfigurationErrorMessage.nonArrayScopes.code, ClientConfigurationErrorMessage.nonArrayScopes.desc + \" Given value: \" + scopesValue + \".\");\r\n    };\r\n    ClientConfigurationError.createScopesRequiredError = function (scopesValue) {\r\n        return new ClientConfigurationError(ClientConfigurationErrorMessage.scopesRequired.code, ClientConfigurationErrorMessage.scopesRequired.desc + \" Given value: \" + scopesValue);\r\n    };\r\n    ClientConfigurationError.createInvalidPromptError = function (promptValue) {\r\n        return new ClientConfigurationError(ClientConfigurationErrorMessage.invalidPrompt.code, ClientConfigurationErrorMessage.invalidPrompt.desc + \" Given value: \" + promptValue);\r\n    };\r\n    ClientConfigurationError.createClaimsRequestParsingError = function (claimsRequestParseError) {\r\n        return new ClientConfigurationError(ClientConfigurationErrorMessage.claimsRequestParsingError.code, ClientConfigurationErrorMessage.claimsRequestParsingError.desc + \" Given value: \" + claimsRequestParseError);\r\n    };\r\n    ClientConfigurationError.createEmptyRequestError = function () {\r\n        var _a = ClientConfigurationErrorMessage.emptyRequestError, code = _a.code, desc = _a.desc;\r\n        return new ClientConfigurationError(code, desc);\r\n    };\r\n    ClientConfigurationError.createInvalidCorrelationIdError = function () {\r\n        return new ClientConfigurationError(ClientConfigurationErrorMessage.invalidCorrelationIdError.code, ClientConfigurationErrorMessage.invalidCorrelationIdError.desc);\r\n    };\r\n    ClientConfigurationError.createKnownAuthoritiesNotSetError = function () {\r\n        return new ClientConfigurationError(ClientConfigurationErrorMessage.b2cKnownAuthoritiesNotSet.code, ClientConfigurationErrorMessage.b2cKnownAuthoritiesNotSet.desc);\r\n    };\r\n    ClientConfigurationError.createInvalidAuthorityTypeError = function () {\r\n        return new ClientConfigurationError(ClientConfigurationErrorMessage.invalidAuthorityType.code, ClientConfigurationErrorMessage.invalidAuthorityType.desc);\r\n    };\r\n    ClientConfigurationError.createUntrustedAuthorityError = function (host) {\r\n        return new ClientConfigurationError(ClientConfigurationErrorMessage.untrustedAuthority.code, ClientConfigurationErrorMessage.untrustedAuthority.desc + \" Provided Authority: \" + host);\r\n    };\r\n    ClientConfigurationError.createTelemetryConfigError = function (config) {\r\n        var _a = ClientConfigurationErrorMessage.telemetryConfigError, code = _a.code, desc = _a.desc;\r\n        var requiredKeys = {\r\n            applicationName: \"string\",\r\n            applicationVersion: \"string\",\r\n            telemetryEmitter: \"function\"\r\n        };\r\n        var missingKeys = Object.keys(requiredKeys)\r\n            .reduce(function (keys, key) {\r\n            return config[key] ? keys : keys.concat([key + \" (\" + requiredKeys[key] + \")\"]);\r\n        }, []);\r\n        return new ClientConfigurationError(code, desc + \" mising values: \" + missingKeys.join(\",\"));\r\n    };\r\n    ClientConfigurationError.createSsoSilentError = function () {\r\n        return new ClientConfigurationError(ClientConfigurationErrorMessage.ssoSilentError.code, ClientConfigurationErrorMessage.ssoSilentError.desc);\r\n    };\r\n    ClientConfigurationError.createInvalidAuthorityMetadataError = function () {\r\n        return new ClientConfigurationError(ClientConfigurationErrorMessage.invalidAuthorityMetadataError.code, ClientConfigurationErrorMessage.invalidAuthorityMetadataError.desc);\r\n    };\r\n    return ClientConfigurationError;\r\n}(_ClientAuthError__WEBPACK_IMPORTED_MODULE_1__[\"ClientAuthError\"]));\r\n\r\n//# sourceMappingURL=ClientConfigurationError.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiWkVJRC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tc2FsL2xpYi1lczYvZXJyb3IvQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yLmpzPzY0NDIiXSwic291cmNlc0NvbnRlbnQiOlsiLypcclxuICogQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuICovXHJcbmltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSBcInRzbGliXCI7XHJcbmltcG9ydCB7IENsaWVudEF1dGhFcnJvciB9IGZyb20gXCIuL0NsaWVudEF1dGhFcnJvclwiO1xyXG5leHBvcnQgdmFyIENsaWVudENvbmZpZ3VyYXRpb25FcnJvck1lc3NhZ2UgPSB7XHJcbiAgICBjb25maWd1cmF0aW9uTm90U2V0OiB7XHJcbiAgICAgICAgY29kZTogXCJub19jb25maWdfc2V0XCIsXHJcbiAgICAgICAgZGVzYzogXCJDb25maWd1cmF0aW9uIGhhcyBub3QgYmVlbiBzZXQuIFBsZWFzZSBjYWxsIHRoZSBVc2VyQWdlbnRBcHBsaWNhdGlvbiBjb25zdHJ1Y3RvciB3aXRoIGEgdmFsaWQgQ29uZmlndXJhdGlvbiBvYmplY3QuXCJcclxuICAgIH0sXHJcbiAgICBzdG9yYWdlTm90U3VwcG9ydGVkOiB7XHJcbiAgICAgICAgY29kZTogXCJzdG9yYWdlX25vdF9zdXBwb3J0ZWRcIixcclxuICAgICAgICBkZXNjOiBcIlRoZSB2YWx1ZSBmb3IgdGhlIGNhY2hlTG9jYXRpb24gaXMgbm90IHN1cHBvcnRlZC5cIlxyXG4gICAgfSxcclxuICAgIG5vUmVkaXJlY3RDYWxsYmFja3NTZXQ6IHtcclxuICAgICAgICBjb2RlOiBcIm5vX3JlZGlyZWN0X2NhbGxiYWNrc1wiLFxyXG4gICAgICAgIGRlc2M6IFwiTm8gcmVkaXJlY3QgY2FsbGJhY2tzIGhhdmUgYmVlbiBzZXQuIFBsZWFzZSBjYWxsIGhhbmRsZVJlZGlyZWN0Q2FsbGJhY2soKSB3aXRoIHRoZSBhcHByb3ByaWF0ZSBmdW5jdGlvbiBhcmd1bWVudHMgYmVmb3JlIGNvbnRpbnVpbmcuIFwiICtcclxuICAgICAgICAgICAgXCJNb3JlIGluZm9ybWF0aW9uIGlzIGF2YWlsYWJsZSBoZXJlOiBodHRwczovL2dpdGh1Yi5jb20vQXp1cmVBRC9taWNyb3NvZnQtYXV0aGVudGljYXRpb24tbGlicmFyeS1mb3ItanMvd2lraS9NU0FMLWJhc2ljcy5cIlxyXG4gICAgfSxcclxuICAgIGludmFsaWRDYWxsYmFja09iamVjdDoge1xyXG4gICAgICAgIGNvZGU6IFwiaW52YWxpZF9jYWxsYmFja19vYmplY3RcIixcclxuICAgICAgICBkZXNjOiBcIlRoZSBvYmplY3QgcGFzc2VkIGZvciB0aGUgY2FsbGJhY2sgd2FzIGludmFsaWQuIFwiICtcclxuICAgICAgICAgICAgXCJNb3JlIGluZm9ybWF0aW9uIGlzIGF2YWlsYWJsZSBoZXJlOiBodHRwczovL2dpdGh1Yi5jb20vQXp1cmVBRC9taWNyb3NvZnQtYXV0aGVudGljYXRpb24tbGlicmFyeS1mb3ItanMvd2lraS9NU0FMLWJhc2ljcy5cIlxyXG4gICAgfSxcclxuICAgIHNjb3Blc1JlcXVpcmVkOiB7XHJcbiAgICAgICAgY29kZTogXCJzY29wZXNfcmVxdWlyZWRcIixcclxuICAgICAgICBkZXNjOiBcIlNjb3BlcyBhcmUgcmVxdWlyZWQgdG8gb2J0YWluIGFuIGFjY2VzcyB0b2tlbi5cIlxyXG4gICAgfSxcclxuICAgIGVtcHR5U2NvcGVzOiB7XHJcbiAgICAgICAgY29kZTogXCJlbXB0eV9pbnB1dF9zY29wZXNfZXJyb3JcIixcclxuICAgICAgICBkZXNjOiBcIlNjb3BlcyBjYW5ub3QgYmUgcGFzc2VkIGFzIGVtcHR5IGFycmF5LlwiXHJcbiAgICB9LFxyXG4gICAgbm9uQXJyYXlTY29wZXM6IHtcclxuICAgICAgICBjb2RlOiBcIm5vbmFycmF5X2lucHV0X3Njb3Blc19lcnJvclwiLFxyXG4gICAgICAgIGRlc2M6IFwiU2NvcGVzIGNhbm5vdCBiZSBwYXNzZWQgYXMgbm9uLWFycmF5LlwiXHJcbiAgICB9LFxyXG4gICAgaW52YWxpZFByb21wdDoge1xyXG4gICAgICAgIGNvZGU6IFwiaW52YWxpZF9wcm9tcHRfdmFsdWVcIixcclxuICAgICAgICBkZXNjOiBcIlN1cHBvcnRlZCBwcm9tcHQgdmFsdWVzIGFyZSAnbG9naW4nLCAnc2VsZWN0X2FjY291bnQnLCAnY29uc2VudCcgYW5kICdub25lJ1wiLFxyXG4gICAgfSxcclxuICAgIGludmFsaWRBdXRob3JpdHlUeXBlOiB7XHJcbiAgICAgICAgY29kZTogXCJpbnZhbGlkX2F1dGhvcml0eV90eXBlXCIsXHJcbiAgICAgICAgZGVzYzogXCJUaGUgZ2l2ZW4gYXV0aG9yaXR5IGlzIG5vdCBhIHZhbGlkIHR5cGUgb2YgYXV0aG9yaXR5IHN1cHBvcnRlZCBieSBNU0FMLiBQbGVhc2Ugc2VlIGhlcmUgZm9yIHZhbGlkIGF1dGhvcml0aWVzOiA8aW5zZXJ0IFVSTCBoZXJlPi5cIlxyXG4gICAgfSxcclxuICAgIGF1dGhvcml0eVVyaUluc2VjdXJlOiB7XHJcbiAgICAgICAgY29kZTogXCJhdXRob3JpdHlfdXJpX2luc2VjdXJlXCIsXHJcbiAgICAgICAgZGVzYzogXCJBdXRob3JpdHkgVVJJcyBtdXN0IHVzZSBodHRwcy5cIlxyXG4gICAgfSxcclxuICAgIGF1dGhvcml0eVVyaUludmFsaWRQYXRoOiB7XHJcbiAgICAgICAgY29kZTogXCJhdXRob3JpdHlfdXJpX2ludmFsaWRfcGF0aFwiLFxyXG4gICAgICAgIGRlc2M6IFwiR2l2ZW4gYXV0aG9yaXR5IFVSSSBpcyBpbnZhbGlkLlwiXHJcbiAgICB9LFxyXG4gICAgdW5zdXBwb3J0ZWRBdXRob3JpdHlWYWxpZGF0aW9uOiB7XHJcbiAgICAgICAgY29kZTogXCJ1bnN1cHBvcnRlZF9hdXRob3JpdHlfdmFsaWRhdGlvblwiLFxyXG4gICAgICAgIGRlc2M6IFwiVGhlIGF1dGhvcml0eSB2YWxpZGF0aW9uIGlzIG5vdCBzdXBwb3J0ZWQgZm9yIHRoaXMgYXV0aG9yaXR5IHR5cGUuXCJcclxuICAgIH0sXHJcbiAgICB1bnRydXN0ZWRBdXRob3JpdHk6IHtcclxuICAgICAgICBjb2RlOiBcInVudHJ1c3RlZF9hdXRob3JpdHlcIixcclxuICAgICAgICBkZXNjOiBcIlRoZSBwcm92aWRlZCBhdXRob3JpdHkgaXMgbm90IGEgdHJ1c3RlZCBhdXRob3JpdHkuIFBsZWFzZSBpbmNsdWRlIHRoaXMgYXV0aG9yaXR5IGluIHRoZSBrbm93bkF1dGhvcml0aWVzIGNvbmZpZyBwYXJhbWV0ZXIgb3Igc2V0IHZhbGlkYXRlQXV0aG9yaXR5PWZhbHNlLlwiXHJcbiAgICB9LFxyXG4gICAgYjJjQXV0aG9yaXR5VXJpSW52YWxpZFBhdGg6IHtcclxuICAgICAgICBjb2RlOiBcImIyY19hdXRob3JpdHlfdXJpX2ludmFsaWRfcGF0aFwiLFxyXG4gICAgICAgIGRlc2M6IFwiVGhlIGdpdmVuIFVSSSBmb3IgdGhlIEIyQyBhdXRob3JpdHkgaXMgaW52YWxpZC5cIlxyXG4gICAgfSxcclxuICAgIGIyY0tub3duQXV0aG9yaXRpZXNOb3RTZXQ6IHtcclxuICAgICAgICBjb2RlOiBcImIyY19rbm93bl9hdXRob3JpdGllc19ub3Rfc2V0XCIsXHJcbiAgICAgICAgZGVzYzogXCJNdXN0IHNldCBrbm93biBhdXRob3JpdGllcyB3aGVuIHZhbGlkYXRlQXV0aG9yaXR5IGlzIHNldCB0byBUcnVlIGFuZCB1c2luZyBCMkNcIlxyXG4gICAgfSxcclxuICAgIGNsYWltc1JlcXVlc3RQYXJzaW5nRXJyb3I6IHtcclxuICAgICAgICBjb2RlOiBcImNsYWltc19yZXF1ZXN0X3BhcnNpbmdfZXJyb3JcIixcclxuICAgICAgICBkZXNjOiBcIkNvdWxkIG5vdCBwYXJzZSB0aGUgZ2l2ZW4gY2xhaW1zIHJlcXVlc3Qgb2JqZWN0LlwiXHJcbiAgICB9LFxyXG4gICAgZW1wdHlSZXF1ZXN0RXJyb3I6IHtcclxuICAgICAgICBjb2RlOiBcImVtcHR5X3JlcXVlc3RfZXJyb3JcIixcclxuICAgICAgICBkZXNjOiBcIlJlcXVlc3Qgb2JqZWN0IGlzIHJlcXVpcmVkLlwiXHJcbiAgICB9LFxyXG4gICAgaW52YWxpZENvcnJlbGF0aW9uSWRFcnJvcjoge1xyXG4gICAgICAgIGNvZGU6IFwiaW52YWxpZF9ndWlkX3NlbnRfYXNfY29ycmVsYXRpb25JZFwiLFxyXG4gICAgICAgIGRlc2M6IFwiUGxlYXNlIHNldCB0aGUgY29ycmVsYXRpb25JZCBhcyBhIHZhbGlkIGd1aWRcIlxyXG4gICAgfSxcclxuICAgIHRlbGVtZXRyeUNvbmZpZ0Vycm9yOiB7XHJcbiAgICAgICAgY29kZTogXCJ0ZWxlbWV0cnlfY29uZmlnX2Vycm9yXCIsXHJcbiAgICAgICAgZGVzYzogXCJUZWxlbWV0cnkgY29uZmlnIGlzIG5vdCBjb25maWd1cmVkIHdpdGggcmVxdWlyZWQgdmFsdWVzXCJcclxuICAgIH0sXHJcbiAgICBzc29TaWxlbnRFcnJvcjoge1xyXG4gICAgICAgIGNvZGU6IFwic3NvX3NpbGVudF9lcnJvclwiLFxyXG4gICAgICAgIGRlc2M6IFwicmVxdWVzdCBtdXN0IGNvbnRhaW4gZWl0aGVyIHNpZCBvciBsb2dpbl9oaW50XCJcclxuICAgIH0sXHJcbiAgICBpbnZhbGlkQXV0aG9yaXR5TWV0YWRhdGFFcnJvcjoge1xyXG4gICAgICAgIGNvZGU6IFwiYXV0aG9yaXR5X21ldGFkYXRhX2Vycm9yXCIsXHJcbiAgICAgICAgZGVzYzogXCJJbnZhbGlkIGF1dGhvcml0eU1ldGFkYXRhLiBNdXN0IGJlIGEgSlNPTiBvYmplY3QgY29udGFpbmluZyBhdXRob3JpemF0aW9uX2VuZHBvaW50LCBlbmRfc2Vzc2lvbl9lbmRwb2ludCwgYW5kIGlzc3VlciBmaWVsZHMuXCJcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqIEVycm9yIHRocm93biB3aGVuIHRoZXJlIGlzIGFuIGVycm9yIGluIGNvbmZpZ3VyYXRpb24gb2YgdGhlIC5qcyBsaWJyYXJ5LlxyXG4gKi9cclxudmFyIENsaWVudENvbmZpZ3VyYXRpb25FcnJvciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIHRzbGliXzEuX19leHRlbmRzKENsaWVudENvbmZpZ3VyYXRpb25FcnJvciwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIENsaWVudENvbmZpZ3VyYXRpb25FcnJvcihlcnJvckNvZGUsIGVycm9yTWVzc2FnZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIGVycm9yQ29kZSwgZXJyb3JNZXNzYWdlKSB8fCB0aGlzO1xyXG4gICAgICAgIF90aGlzLm5hbWUgPSBcIkNsaWVudENvbmZpZ3VyYXRpb25FcnJvclwiO1xyXG4gICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihfdGhpcywgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yLnByb3RvdHlwZSk7XHJcbiAgICAgICAgcmV0dXJuIF90aGlzO1xyXG4gICAgfVxyXG4gICAgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yLmNyZWF0ZU5vU2V0Q29uZmlndXJhdGlvbkVycm9yID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yKENsaWVudENvbmZpZ3VyYXRpb25FcnJvck1lc3NhZ2UuY29uZmlndXJhdGlvbk5vdFNldC5jb2RlLCBcIlwiICsgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yTWVzc2FnZS5jb25maWd1cmF0aW9uTm90U2V0LmRlc2MpO1xyXG4gICAgfTtcclxuICAgIENsaWVudENvbmZpZ3VyYXRpb25FcnJvci5jcmVhdGVTdG9yYWdlTm90U3VwcG9ydGVkRXJyb3IgPSBmdW5jdGlvbiAoZ2l2ZW5DYWNoZUxvY2F0aW9uKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBDbGllbnRDb25maWd1cmF0aW9uRXJyb3IoQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yTWVzc2FnZS5zdG9yYWdlTm90U3VwcG9ydGVkLmNvZGUsIENsaWVudENvbmZpZ3VyYXRpb25FcnJvck1lc3NhZ2Uuc3RvcmFnZU5vdFN1cHBvcnRlZC5kZXNjICsgXCIgR2l2ZW4gbG9jYXRpb246IFwiICsgZ2l2ZW5DYWNoZUxvY2F0aW9uKTtcclxuICAgIH07XHJcbiAgICBDbGllbnRDb25maWd1cmF0aW9uRXJyb3IuY3JlYXRlUmVkaXJlY3RDYWxsYmFja3NOb3RTZXRFcnJvciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gbmV3IENsaWVudENvbmZpZ3VyYXRpb25FcnJvcihDbGllbnRDb25maWd1cmF0aW9uRXJyb3JNZXNzYWdlLm5vUmVkaXJlY3RDYWxsYmFja3NTZXQuY29kZSwgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yTWVzc2FnZS5ub1JlZGlyZWN0Q2FsbGJhY2tzU2V0LmRlc2MpO1xyXG4gICAgfTtcclxuICAgIENsaWVudENvbmZpZ3VyYXRpb25FcnJvci5jcmVhdGVJbnZhbGlkQ2FsbGJhY2tPYmplY3RFcnJvciA9IGZ1bmN0aW9uIChjYWxsYmFja09iamVjdCkge1xyXG4gICAgICAgIHJldHVybiBuZXcgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yKENsaWVudENvbmZpZ3VyYXRpb25FcnJvck1lc3NhZ2UuaW52YWxpZENhbGxiYWNrT2JqZWN0LmNvZGUsIENsaWVudENvbmZpZ3VyYXRpb25FcnJvck1lc3NhZ2UuaW52YWxpZENhbGxiYWNrT2JqZWN0LmRlc2MgKyBcIiBHaXZlbiB2YWx1ZSBmb3IgY2FsbGJhY2sgZnVuY3Rpb246IFwiICsgY2FsbGJhY2tPYmplY3QpO1xyXG4gICAgfTtcclxuICAgIENsaWVudENvbmZpZ3VyYXRpb25FcnJvci5jcmVhdGVFbXB0eVNjb3Blc0FycmF5RXJyb3IgPSBmdW5jdGlvbiAoc2NvcGVzVmFsdWUpIHtcclxuICAgICAgICByZXR1cm4gbmV3IENsaWVudENvbmZpZ3VyYXRpb25FcnJvcihDbGllbnRDb25maWd1cmF0aW9uRXJyb3JNZXNzYWdlLmVtcHR5U2NvcGVzLmNvZGUsIENsaWVudENvbmZpZ3VyYXRpb25FcnJvck1lc3NhZ2UuZW1wdHlTY29wZXMuZGVzYyArIFwiIEdpdmVuIHZhbHVlOiBcIiArIHNjb3Blc1ZhbHVlICsgXCIuXCIpO1xyXG4gICAgfTtcclxuICAgIENsaWVudENvbmZpZ3VyYXRpb25FcnJvci5jcmVhdGVTY29wZXNOb25BcnJheUVycm9yID0gZnVuY3Rpb24gKHNjb3Blc1ZhbHVlKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBDbGllbnRDb25maWd1cmF0aW9uRXJyb3IoQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yTWVzc2FnZS5ub25BcnJheVNjb3Blcy5jb2RlLCBDbGllbnRDb25maWd1cmF0aW9uRXJyb3JNZXNzYWdlLm5vbkFycmF5U2NvcGVzLmRlc2MgKyBcIiBHaXZlbiB2YWx1ZTogXCIgKyBzY29wZXNWYWx1ZSArIFwiLlwiKTtcclxuICAgIH07XHJcbiAgICBDbGllbnRDb25maWd1cmF0aW9uRXJyb3IuY3JlYXRlU2NvcGVzUmVxdWlyZWRFcnJvciA9IGZ1bmN0aW9uIChzY29wZXNWYWx1ZSkge1xyXG4gICAgICAgIHJldHVybiBuZXcgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yKENsaWVudENvbmZpZ3VyYXRpb25FcnJvck1lc3NhZ2Uuc2NvcGVzUmVxdWlyZWQuY29kZSwgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yTWVzc2FnZS5zY29wZXNSZXF1aXJlZC5kZXNjICsgXCIgR2l2ZW4gdmFsdWU6IFwiICsgc2NvcGVzVmFsdWUpO1xyXG4gICAgfTtcclxuICAgIENsaWVudENvbmZpZ3VyYXRpb25FcnJvci5jcmVhdGVJbnZhbGlkUHJvbXB0RXJyb3IgPSBmdW5jdGlvbiAocHJvbXB0VmFsdWUpIHtcclxuICAgICAgICByZXR1cm4gbmV3IENsaWVudENvbmZpZ3VyYXRpb25FcnJvcihDbGllbnRDb25maWd1cmF0aW9uRXJyb3JNZXNzYWdlLmludmFsaWRQcm9tcHQuY29kZSwgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yTWVzc2FnZS5pbnZhbGlkUHJvbXB0LmRlc2MgKyBcIiBHaXZlbiB2YWx1ZTogXCIgKyBwcm9tcHRWYWx1ZSk7XHJcbiAgICB9O1xyXG4gICAgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yLmNyZWF0ZUNsYWltc1JlcXVlc3RQYXJzaW5nRXJyb3IgPSBmdW5jdGlvbiAoY2xhaW1zUmVxdWVzdFBhcnNlRXJyb3IpIHtcclxuICAgICAgICByZXR1cm4gbmV3IENsaWVudENvbmZpZ3VyYXRpb25FcnJvcihDbGllbnRDb25maWd1cmF0aW9uRXJyb3JNZXNzYWdlLmNsYWltc1JlcXVlc3RQYXJzaW5nRXJyb3IuY29kZSwgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yTWVzc2FnZS5jbGFpbXNSZXF1ZXN0UGFyc2luZ0Vycm9yLmRlc2MgKyBcIiBHaXZlbiB2YWx1ZTogXCIgKyBjbGFpbXNSZXF1ZXN0UGFyc2VFcnJvcik7XHJcbiAgICB9O1xyXG4gICAgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yLmNyZWF0ZUVtcHR5UmVxdWVzdEVycm9yID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBfYSA9IENsaWVudENvbmZpZ3VyYXRpb25FcnJvck1lc3NhZ2UuZW1wdHlSZXF1ZXN0RXJyb3IsIGNvZGUgPSBfYS5jb2RlLCBkZXNjID0gX2EuZGVzYztcclxuICAgICAgICByZXR1cm4gbmV3IENsaWVudENvbmZpZ3VyYXRpb25FcnJvcihjb2RlLCBkZXNjKTtcclxuICAgIH07XHJcbiAgICBDbGllbnRDb25maWd1cmF0aW9uRXJyb3IuY3JlYXRlSW52YWxpZENvcnJlbGF0aW9uSWRFcnJvciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gbmV3IENsaWVudENvbmZpZ3VyYXRpb25FcnJvcihDbGllbnRDb25maWd1cmF0aW9uRXJyb3JNZXNzYWdlLmludmFsaWRDb3JyZWxhdGlvbklkRXJyb3IuY29kZSwgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yTWVzc2FnZS5pbnZhbGlkQ29ycmVsYXRpb25JZEVycm9yLmRlc2MpO1xyXG4gICAgfTtcclxuICAgIENsaWVudENvbmZpZ3VyYXRpb25FcnJvci5jcmVhdGVLbm93bkF1dGhvcml0aWVzTm90U2V0RXJyb3IgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBDbGllbnRDb25maWd1cmF0aW9uRXJyb3IoQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yTWVzc2FnZS5iMmNLbm93bkF1dGhvcml0aWVzTm90U2V0LmNvZGUsIENsaWVudENvbmZpZ3VyYXRpb25FcnJvck1lc3NhZ2UuYjJjS25vd25BdXRob3JpdGllc05vdFNldC5kZXNjKTtcclxuICAgIH07XHJcbiAgICBDbGllbnRDb25maWd1cmF0aW9uRXJyb3IuY3JlYXRlSW52YWxpZEF1dGhvcml0eVR5cGVFcnJvciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gbmV3IENsaWVudENvbmZpZ3VyYXRpb25FcnJvcihDbGllbnRDb25maWd1cmF0aW9uRXJyb3JNZXNzYWdlLmludmFsaWRBdXRob3JpdHlUeXBlLmNvZGUsIENsaWVudENvbmZpZ3VyYXRpb25FcnJvck1lc3NhZ2UuaW52YWxpZEF1dGhvcml0eVR5cGUuZGVzYyk7XHJcbiAgICB9O1xyXG4gICAgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yLmNyZWF0ZVVudHJ1c3RlZEF1dGhvcml0eUVycm9yID0gZnVuY3Rpb24gKGhvc3QpIHtcclxuICAgICAgICByZXR1cm4gbmV3IENsaWVudENvbmZpZ3VyYXRpb25FcnJvcihDbGllbnRDb25maWd1cmF0aW9uRXJyb3JNZXNzYWdlLnVudHJ1c3RlZEF1dGhvcml0eS5jb2RlLCBDbGllbnRDb25maWd1cmF0aW9uRXJyb3JNZXNzYWdlLnVudHJ1c3RlZEF1dGhvcml0eS5kZXNjICsgXCIgUHJvdmlkZWQgQXV0aG9yaXR5OiBcIiArIGhvc3QpO1xyXG4gICAgfTtcclxuICAgIENsaWVudENvbmZpZ3VyYXRpb25FcnJvci5jcmVhdGVUZWxlbWV0cnlDb25maWdFcnJvciA9IGZ1bmN0aW9uIChjb25maWcpIHtcclxuICAgICAgICB2YXIgX2EgPSBDbGllbnRDb25maWd1cmF0aW9uRXJyb3JNZXNzYWdlLnRlbGVtZXRyeUNvbmZpZ0Vycm9yLCBjb2RlID0gX2EuY29kZSwgZGVzYyA9IF9hLmRlc2M7XHJcbiAgICAgICAgdmFyIHJlcXVpcmVkS2V5cyA9IHtcclxuICAgICAgICAgICAgYXBwbGljYXRpb25OYW1lOiBcInN0cmluZ1wiLFxyXG4gICAgICAgICAgICBhcHBsaWNhdGlvblZlcnNpb246IFwic3RyaW5nXCIsXHJcbiAgICAgICAgICAgIHRlbGVtZXRyeUVtaXR0ZXI6IFwiZnVuY3Rpb25cIlxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIG1pc3NpbmdLZXlzID0gT2JqZWN0LmtleXMocmVxdWlyZWRLZXlzKVxyXG4gICAgICAgICAgICAucmVkdWNlKGZ1bmN0aW9uIChrZXlzLCBrZXkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNvbmZpZ1trZXldID8ga2V5cyA6IGtleXMuY29uY2F0KFtrZXkgKyBcIiAoXCIgKyByZXF1aXJlZEtleXNba2V5XSArIFwiKVwiXSk7XHJcbiAgICAgICAgfSwgW10pO1xyXG4gICAgICAgIHJldHVybiBuZXcgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yKGNvZGUsIGRlc2MgKyBcIiBtaXNpbmcgdmFsdWVzOiBcIiArIG1pc3NpbmdLZXlzLmpvaW4oXCIsXCIpKTtcclxuICAgIH07XHJcbiAgICBDbGllbnRDb25maWd1cmF0aW9uRXJyb3IuY3JlYXRlU3NvU2lsZW50RXJyb3IgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBDbGllbnRDb25maWd1cmF0aW9uRXJyb3IoQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yTWVzc2FnZS5zc29TaWxlbnRFcnJvci5jb2RlLCBDbGllbnRDb25maWd1cmF0aW9uRXJyb3JNZXNzYWdlLnNzb1NpbGVudEVycm9yLmRlc2MpO1xyXG4gICAgfTtcclxuICAgIENsaWVudENvbmZpZ3VyYXRpb25FcnJvci5jcmVhdGVJbnZhbGlkQXV0aG9yaXR5TWV0YWRhdGFFcnJvciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gbmV3IENsaWVudENvbmZpZ3VyYXRpb25FcnJvcihDbGllbnRDb25maWd1cmF0aW9uRXJyb3JNZXNzYWdlLmludmFsaWRBdXRob3JpdHlNZXRhZGF0YUVycm9yLmNvZGUsIENsaWVudENvbmZpZ3VyYXRpb25FcnJvck1lc3NhZ2UuaW52YWxpZEF1dGhvcml0eU1ldGFkYXRhRXJyb3IuZGVzYyk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIENsaWVudENvbmZpZ3VyYXRpb25FcnJvcjtcclxufShDbGllbnRBdXRoRXJyb3IpKTtcclxuZXhwb3J0IHsgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yIH07XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUNsaWVudENvbmZpZ3VyYXRpb25FcnJvci5qcy5tYXAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///ZEID\n");

/***/ }),

/***/ "ZES5":
/*!***********************************************************!*\
  !*** ./node_modules/msal/lib-es6/UserAgentApplication.js ***!
  \***********************************************************/
/*! exports provided: UserAgentApplication */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* WEBPACK VAR INJECTION */(function(Promise) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"UserAgentApplication\", function() { return UserAgentApplication; });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ \"mrSG\");\n/* harmony import */ var _cache_AccessTokenKey__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./cache/AccessTokenKey */ \"TeXa\");\n/* harmony import */ var _cache_AccessTokenValue__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./cache/AccessTokenValue */ \"66Uo\");\n/* harmony import */ var _ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ServerRequestParameters */ \"z2Jz\");\n/* harmony import */ var _authority_Authority__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./authority/Authority */ \"bro/\");\n/* harmony import */ var _ClientInfo__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./ClientInfo */ \"2Lt5\");\n/* harmony import */ var _IdToken__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./IdToken */ \"yRtI\");\n/* harmony import */ var _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./cache/AuthCache */ \"O1xl\");\n/* harmony import */ var _Account__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./Account */ \"2Sq9\");\n/* harmony import */ var _ScopeSet__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./ScopeSet */ \"8ImU\");\n/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./utils/StringUtils */ \"Emp/\");\n/* harmony import */ var _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./utils/WindowUtils */ \"6CUc\");\n/* harmony import */ var _utils_TokenUtils__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./utils/TokenUtils */ \"Jv1r\");\n/* harmony import */ var _utils_TimeUtils__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./utils/TimeUtils */ \"G1Z1\");\n/* harmony import */ var _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./utils/UrlUtils */ \"JB7q\");\n/* harmony import */ var _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./utils/RequestUtils */ \"kcKs\");\n/* harmony import */ var _utils_ResponseUtils__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./utils/ResponseUtils */ \"mp9i\");\n/* harmony import */ var _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./authority/AuthorityFactory */ \"GaoF\");\n/* harmony import */ var _Configuration__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./Configuration */ \"WRS4\");\n/* harmony import */ var _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./error/ClientConfigurationError */ \"ZEID\");\n/* harmony import */ var _error_AuthError__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./error/AuthError */ \"T0bz\");\n/* harmony import */ var _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./error/ClientAuthError */ \"7ZR7\");\n/* harmony import */ var _error_ServerError__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./error/ServerError */ \"JKGV\");\n/* harmony import */ var _error_InteractionRequiredAuthError__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./error/InteractionRequiredAuthError */ \"3Kci\");\n/* harmony import */ var _AuthResponse__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./AuthResponse */ \"d2+l\");\n/* harmony import */ var _telemetry_TelemetryManager__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./telemetry/TelemetryManager */ \"03G2\");\n/* harmony import */ var _telemetry_ApiEvent__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./telemetry/ApiEvent */ \"F+3F\");\n/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./utils/Constants */ \"wmgs\");\n/* harmony import */ var _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./utils/CryptoUtils */ \"jUVH\");\n/* harmony import */ var _authority_TrustedAuthority__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./authority/TrustedAuthority */ \"wwyH\");\n/* harmony import */ var _utils_AuthCacheUtils__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./utils/AuthCacheUtils */ \"c6fL\");\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// default authority\r\nvar DEFAULT_AUTHORITY = \"https://login.microsoftonline.com/common\";\r\n/**\r\n * UserAgentApplication class\r\n *\r\n * Object Instance that the developer can use to make loginXX OR acquireTokenXX functions\r\n */\r\nvar UserAgentApplication = /** @class */ (function () {\r\n    /**\r\n     * @constructor\r\n     * Constructor for the UserAgentApplication used to instantiate the UserAgentApplication object\r\n     *\r\n     * Important attributes in the Configuration object for auth are:\r\n     * - clientID: the application ID of your application.\r\n     * You can obtain one by registering your application with our Application registration portal : https://portal.azure.com/#blade/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/RegisteredAppsPreview\r\n     * - authority: the authority URL for your application.\r\n     *\r\n     * In Azure AD, authority is a URL indicating the Azure active directory that MSAL uses to obtain tokens.\r\n     * It is of the form https://login.microsoftonline.com/&lt;Enter_the_Tenant_Info_Here&gt;.\r\n     * If your application supports Accounts in one organizational directory, replace \"Enter_the_Tenant_Info_Here\" value with the Tenant Id or Tenant name (for example, contoso.microsoft.com).\r\n     * If your application supports Accounts in any organizational directory, replace \"Enter_the_Tenant_Info_Here\" value with organizations.\r\n     * If your application supports Accounts in any organizational directory and personal Microsoft accounts, replace \"Enter_the_Tenant_Info_Here\" value with common.\r\n     * To restrict support to Personal Microsoft accounts only, replace \"Enter_the_Tenant_Info_Here\" value with consumers.\r\n     *\r\n     *\r\n     * In Azure B2C, authority is of the form https://&lt;instance&gt;/tfp/&lt;tenant&gt;/&lt;policyName&gt;/\r\n     *\r\n     * @param {@link (Configuration:type)} configuration object for the MSAL UserAgentApplication instance\r\n     */\r\n    function UserAgentApplication(configuration) {\r\n        // callbacks for token/error\r\n        this.authResponseCallback = null;\r\n        this.tokenReceivedCallback = null;\r\n        this.errorReceivedCallback = null;\r\n        // Set the Configuration\r\n        this.config = Object(_Configuration__WEBPACK_IMPORTED_MODULE_18__[\"buildConfiguration\"])(configuration);\r\n        this.logger = this.config.system.logger;\r\n        this.clientId = this.config.auth.clientId;\r\n        this.inCookie = this.config.cache.storeAuthStateInCookie;\r\n        this.telemetryManager = this.getTelemetryManagerFromConfig(this.config.system.telemetry, this.clientId);\r\n        _authority_TrustedAuthority__WEBPACK_IMPORTED_MODULE_29__[\"TrustedAuthority\"].setTrustedAuthoritiesFromConfig(this.config.auth.validateAuthority, this.config.auth.knownAuthorities);\r\n        _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__[\"AuthorityFactory\"].saveMetadataFromConfig(this.config.auth.authority, this.config.auth.authorityMetadata);\r\n        // if no authority is passed, set the default: \"https://login.microsoftonline.com/common\"\r\n        this.authority = this.config.auth.authority || DEFAULT_AUTHORITY;\r\n        // cache keys msal - typescript throws an error if any value other than \"localStorage\" or \"sessionStorage\" is passed\r\n        this.cacheStorage = new _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__[\"AuthCache\"](this.clientId, this.config.cache.cacheLocation, this.inCookie);\r\n        // Initialize window handling code\r\n        window.activeRenewals = {};\r\n        window.renewStates = [];\r\n        window.callbackMappedToRenewStates = {};\r\n        window.promiseMappedToRenewStates = {};\r\n        window.msal = this;\r\n        var urlHash = window.location.hash;\r\n        var urlContainsHash = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__[\"UrlUtils\"].urlContainsHash(urlHash);\r\n        // check if back button is pressed\r\n        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__[\"WindowUtils\"].checkIfBackButtonIsPressed(this.cacheStorage);\r\n        // On the server 302 - Redirect, handle this\r\n        if (urlContainsHash) {\r\n            var stateInfo = this.getResponseState(urlHash);\r\n            if (stateInfo.method === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].interactionTypeRedirect) {\r\n                this.handleRedirectAuthenticationResponse(urlHash);\r\n            }\r\n        }\r\n    }\r\n    Object.defineProperty(UserAgentApplication.prototype, \"authority\", {\r\n        /**\r\n         * Method to manage the authority URL.\r\n         *\r\n         * @returns {string} authority\r\n         */\r\n        get: function () {\r\n            return this.authorityInstance.CanonicalAuthority;\r\n        },\r\n        /**\r\n         * setter for the authority URL\r\n         * @param {string} authority\r\n         */\r\n        // If the developer passes an authority, create an instance\r\n        set: function (val) {\r\n            this.authorityInstance = _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__[\"AuthorityFactory\"].CreateInstance(val, this.config.auth.validateAuthority);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Get the current authority instance from the MSAL configuration object\r\n     *\r\n     * @returns {@link Authority} authority instance\r\n     */\r\n    UserAgentApplication.prototype.getAuthorityInstance = function () {\r\n        return this.authorityInstance;\r\n    };\r\n    UserAgentApplication.prototype.handleRedirectCallback = function (authOrTokenCallback, errorReceivedCallback) {\r\n        if (!authOrTokenCallback) {\r\n            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_19__[\"ClientConfigurationError\"].createInvalidCallbackObjectError(authOrTokenCallback);\r\n        }\r\n        // Set callbacks\r\n        if (errorReceivedCallback) {\r\n            this.tokenReceivedCallback = authOrTokenCallback;\r\n            this.errorReceivedCallback = errorReceivedCallback;\r\n            this.logger.warning(\"This overload for callback is deprecated - please change the format of the callbacks to a single callback as shown: (err: AuthError, response: AuthResponse).\");\r\n        }\r\n        else {\r\n            this.authResponseCallback = authOrTokenCallback;\r\n        }\r\n        if (this.redirectError) {\r\n            this.authErrorHandler(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].interactionTypeRedirect, this.redirectError, this.redirectResponse);\r\n        }\r\n        else if (this.redirectResponse) {\r\n            this.authResponseHandler(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].interactionTypeRedirect, this.redirectResponse);\r\n        }\r\n    };\r\n    /**\r\n     * Public API to verify if the URL contains the hash with known properties\r\n     * @param hash\r\n     */\r\n    UserAgentApplication.prototype.urlContainsHash = function (hash) {\r\n        this.logger.verbose(\"UrlContainsHash has been called\");\r\n        return _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__[\"UrlUtils\"].urlContainsHash(hash);\r\n    };\r\n    UserAgentApplication.prototype.authResponseHandler = function (interactionType, response, resolve) {\r\n        this.logger.verbose(\"AuthResponseHandler has been called\");\r\n        if (interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].interactionTypeRedirect) {\r\n            this.logger.verbose(\"Interaction type is redirect\");\r\n            if (this.errorReceivedCallback) {\r\n                this.logger.verbose(\"Two callbacks were provided to handleRedirectCallback, calling success callback with response\");\r\n                this.tokenReceivedCallback(response);\r\n            }\r\n            else if (this.authResponseCallback) {\r\n                this.logger.verbose(\"One callback was provided to handleRedirectCallback, calling authResponseCallback with response\");\r\n                this.authResponseCallback(null, response);\r\n            }\r\n        }\r\n        else if (interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].interactionTypePopup) {\r\n            this.logger.verbose(\"Interaction type is popup, resolving\");\r\n            resolve(response);\r\n        }\r\n        else {\r\n            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__[\"ClientAuthError\"].createInvalidInteractionTypeError();\r\n        }\r\n    };\r\n    UserAgentApplication.prototype.authErrorHandler = function (interactionType, authErr, response, reject) {\r\n        this.logger.verbose(\"AuthErrorHandler has been called\");\r\n        // set interaction_status to complete\r\n        this.cacheStorage.removeItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"TemporaryCacheKeys\"].INTERACTION_STATUS);\r\n        if (interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].interactionTypeRedirect) {\r\n            this.logger.verbose(\"Interaction type is redirect\");\r\n            if (this.errorReceivedCallback) {\r\n                this.logger.verbose(\"Two callbacks were provided to handleRedirectCallback, calling error callback\");\r\n                this.errorReceivedCallback(authErr, response.accountState);\r\n            }\r\n            else if (this.authResponseCallback) {\r\n                this.logger.verbose(\"One callback was provided to handleRedirectCallback, calling authResponseCallback with error\");\r\n                this.authResponseCallback(authErr, response);\r\n            }\r\n            else {\r\n                this.logger.verbose(\"handleRedirectCallback has not been called and no callbacks are registered, throwing error\");\r\n                throw authErr;\r\n            }\r\n        }\r\n        else if (interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].interactionTypePopup) {\r\n            this.logger.verbose(\"Interaction type is popup, rejecting\");\r\n            reject(authErr);\r\n        }\r\n        else {\r\n            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__[\"ClientAuthError\"].createInvalidInteractionTypeError();\r\n        }\r\n    };\r\n    // #endregion\r\n    /**\r\n     * Use when initiating the login process by redirecting the user's browser to the authorization endpoint.\r\n     * @param {@link (AuthenticationParameters:type)}\r\n     */\r\n    UserAgentApplication.prototype.loginRedirect = function (userRequest) {\r\n        this.logger.verbose(\"LoginRedirect has been called\");\r\n        // validate request\r\n        var request = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__[\"RequestUtils\"].validateRequest(userRequest, true, this.clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].interactionTypeRedirect);\r\n        this.acquireTokenInteractive(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].interactionTypeRedirect, true, request, null, null);\r\n    };\r\n    /**\r\n     * Use when you want to obtain an access_token for your API by redirecting the user's browser window to the authorization endpoint.\r\n     * @param {@link (AuthenticationParameters:type)}\r\n     *\r\n     * To renew idToken, please pass clientId as the only scope in the Authentication Parameters\r\n     */\r\n    UserAgentApplication.prototype.acquireTokenRedirect = function (userRequest) {\r\n        this.logger.verbose(\"AcquireTokenRedirect has been called\");\r\n        // validate request\r\n        var request = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__[\"RequestUtils\"].validateRequest(userRequest, false, this.clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].interactionTypeRedirect);\r\n        this.acquireTokenInteractive(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].interactionTypeRedirect, false, request, null, null);\r\n    };\r\n    /**\r\n     * Use when initiating the login process via opening a popup window in the user's browser\r\n     *\r\n     * @param {@link (AuthenticationParameters:type)}\r\n     *\r\n     * @returns {Promise.<AuthResponse>} - a promise that is fulfilled when this function has completed, or rejected if an error was raised. Returns the {@link AuthResponse} object\r\n     */\r\n    UserAgentApplication.prototype.loginPopup = function (userRequest) {\r\n        var _this = this;\r\n        this.logger.verbose(\"LoginPopup has been called\");\r\n        // validate request\r\n        var request = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__[\"RequestUtils\"].validateRequest(userRequest, true, this.clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].interactionTypePopup);\r\n        var apiEvent = this.telemetryManager.createAndStartApiEvent(request.correlationId, _telemetry_ApiEvent__WEBPACK_IMPORTED_MODULE_26__[\"API_EVENT_IDENTIFIER\"].LoginPopup);\r\n        return new Promise(function (resolve, reject) {\r\n            _this.acquireTokenInteractive(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].interactionTypePopup, true, request, resolve, reject);\r\n        })\r\n            .then(function (resp) {\r\n            _this.logger.verbose(\"Successfully logged in\");\r\n            _this.telemetryManager.stopAndFlushApiEvent(request.correlationId, apiEvent, true);\r\n            return resp;\r\n        })\r\n            .catch(function (error) {\r\n            _this.cacheStorage.resetTempCacheItems(request.state);\r\n            _this.telemetryManager.stopAndFlushApiEvent(request.correlationId, apiEvent, false, error.errorCode);\r\n            throw error;\r\n        });\r\n    };\r\n    /**\r\n     * Use when you want to obtain an access_token for your API via opening a popup window in the user's browser\r\n     * @param {@link AuthenticationParameters}\r\n     *\r\n     * To renew idToken, please pass clientId as the only scope in the Authentication Parameters\r\n     * @returns {Promise.<AuthResponse>} - a promise that is fulfilled when this function has completed, or rejected if an error was raised. Returns the {@link AuthResponse} object\r\n     */\r\n    UserAgentApplication.prototype.acquireTokenPopup = function (userRequest) {\r\n        var _this = this;\r\n        this.logger.verbose(\"AcquireTokenPopup has been called\");\r\n        // validate request\r\n        var request = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__[\"RequestUtils\"].validateRequest(userRequest, false, this.clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].interactionTypePopup);\r\n        var apiEvent = this.telemetryManager.createAndStartApiEvent(request.correlationId, _telemetry_ApiEvent__WEBPACK_IMPORTED_MODULE_26__[\"API_EVENT_IDENTIFIER\"].AcquireTokenPopup);\r\n        return new Promise(function (resolve, reject) {\r\n            _this.acquireTokenInteractive(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].interactionTypePopup, false, request, resolve, reject);\r\n        })\r\n            .then(function (resp) {\r\n            _this.logger.verbose(\"Successfully acquired token\");\r\n            _this.telemetryManager.stopAndFlushApiEvent(request.correlationId, apiEvent, true);\r\n            return resp;\r\n        })\r\n            .catch(function (error) {\r\n            _this.cacheStorage.resetTempCacheItems(request.state);\r\n            _this.telemetryManager.stopAndFlushApiEvent(request.correlationId, apiEvent, false, error.errorCode);\r\n            throw error;\r\n        });\r\n    };\r\n    // #region Acquire Token\r\n    /**\r\n     * Use when initiating the login process or when you want to obtain an access_token for your API,\r\n     * either by redirecting the user's browser window to the authorization endpoint or via opening a popup window in the user's browser.\r\n     * @param {@link (AuthenticationParameters:type)}\r\n     *\r\n     * To renew idToken, please pass clientId as the only scope in the Authentication Parameters\r\n     */\r\n    UserAgentApplication.prototype.acquireTokenInteractive = function (interactionType, isLoginCall, request, resolve, reject) {\r\n        var _this = this;\r\n        this.logger.verbose(\"AcquireTokenInteractive has been called\");\r\n        // block the request if made from the hidden iframe\r\n        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__[\"WindowUtils\"].blockReloadInHiddenIframes();\r\n        var interactionProgress = this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"TemporaryCacheKeys\"].INTERACTION_STATUS);\r\n        if (interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].interactionTypeRedirect) {\r\n            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"TemporaryCacheKeys\"].REDIRECT_REQUEST, \"\" + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].inProgress + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].resourceDelimiter + request.state);\r\n        }\r\n        // If already in progress, do not proceed\r\n        if (interactionProgress === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].inProgress) {\r\n            var thrownError = isLoginCall ? _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__[\"ClientAuthError\"].createLoginInProgressError() : _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__[\"ClientAuthError\"].createAcquireTokenInProgressError();\r\n            var stateOnlyResponse = Object(_AuthResponse__WEBPACK_IMPORTED_MODULE_24__[\"buildResponseStateOnly\"])(this.getAccountState(request.state));\r\n            this.cacheStorage.resetTempCacheItems(request.state);\r\n            this.authErrorHandler(interactionType, thrownError, stateOnlyResponse, reject);\r\n            return;\r\n        }\r\n        // Get the account object if a session exists\r\n        var account;\r\n        if (request && request.account && !isLoginCall) {\r\n            account = request.account;\r\n            this.logger.verbose(\"Account set from request\");\r\n        }\r\n        else {\r\n            account = this.getAccount();\r\n            this.logger.verbose(\"Account set from MSAL Cache\");\r\n        }\r\n        // If no session exists, prompt the user to login.\r\n        if (!account && !_ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__[\"ServerRequestParameters\"].isSSOParam(request)) {\r\n            if (isLoginCall) {\r\n                // extract ADAL id_token if exists\r\n                var adalIdToken = this.extractADALIdToken();\r\n                // silent login if ADAL id_token is retrieved successfully - SSO\r\n                if (adalIdToken && !request.scopes) {\r\n                    this.logger.info(\"ADAL's idToken exists. Extracting login information from ADAL's idToken\");\r\n                    var tokenRequest = this.buildIDTokenRequest(request);\r\n                    this.silentLogin = true;\r\n                    this.acquireTokenSilent(tokenRequest).then(function (response) {\r\n                        _this.silentLogin = false;\r\n                        _this.logger.info(\"Unified cache call is successful\");\r\n                        _this.authResponseHandler(interactionType, response, resolve);\r\n                        return;\r\n                    }, function (error) {\r\n                        _this.silentLogin = false;\r\n                        _this.logger.error(\"Error occurred during unified cache ATS: \" + error);\r\n                        // proceed to login since ATS failed\r\n                        _this.acquireTokenHelper(null, interactionType, isLoginCall, request, resolve, reject);\r\n                    });\r\n                }\r\n                // No ADAL token found, proceed to login\r\n                else {\r\n                    this.logger.verbose(\"Login call but no token found, proceed to login\");\r\n                    this.acquireTokenHelper(null, interactionType, isLoginCall, request, resolve, reject);\r\n                }\r\n            }\r\n            // AcquireToken call, but no account or context given, so throw error\r\n            else {\r\n                this.logger.verbose(\"AcquireToken call, no context or account given\");\r\n                this.logger.info(\"User login is required\");\r\n                var stateOnlyResponse = Object(_AuthResponse__WEBPACK_IMPORTED_MODULE_24__[\"buildResponseStateOnly\"])(this.getAccountState(request.state));\r\n                this.cacheStorage.resetTempCacheItems(request.state);\r\n                this.authErrorHandler(interactionType, _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__[\"ClientAuthError\"].createUserLoginRequiredError(), stateOnlyResponse, reject);\r\n                return;\r\n            }\r\n        }\r\n        // User session exists\r\n        else {\r\n            this.logger.verbose(\"User session exists, login not required\");\r\n            this.acquireTokenHelper(account, interactionType, isLoginCall, request, resolve, reject);\r\n        }\r\n    };\r\n    /**\r\n     * @hidden\r\n     * @ignore\r\n     * Helper function to acquireToken\r\n     *\r\n     */\r\n    UserAgentApplication.prototype.acquireTokenHelper = function (account, interactionType, isLoginCall, request, resolve, reject) {\r\n        return tslib__WEBPACK_IMPORTED_MODULE_0__[\"__awaiter\"](this, void 0, void 0, function () {\r\n            var requestSignature, serverAuthenticationRequest, acquireTokenAuthority, popUpWindow, responseType, loginStartPage, urlNavigate, hash, error_1, navigate, err_1;\r\n            return tslib__WEBPACK_IMPORTED_MODULE_0__[\"__generator\"](this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        this.logger.verbose(\"AcquireTokenHelper has been called\");\r\n                        this.logger.verbose(\"Interaction type: \" + interactionType + \". isLoginCall: \" + isLoginCall);\r\n                        // Track the acquireToken progress\r\n                        this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"TemporaryCacheKeys\"].INTERACTION_STATUS, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].inProgress);\r\n                        requestSignature = request.scopes ? request.scopes.join(\" \").toLowerCase() : _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].oidcScopes.join(\" \");\r\n                        this.logger.verbosePii(\"Request signature: \" + requestSignature);\r\n                        acquireTokenAuthority = (request && request.authority) ? _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__[\"AuthorityFactory\"].CreateInstance(request.authority, this.config.auth.validateAuthority, request.authorityMetadata) : this.authorityInstance;\r\n                        _a.label = 1;\r\n                    case 1:\r\n                        _a.trys.push([1, 11, , 12]);\r\n                        if (!!acquireTokenAuthority.hasCachedMetadata()) return [3 /*break*/, 3];\r\n                        this.logger.verbose(\"No cached metadata for authority\");\r\n                        return [4 /*yield*/, _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__[\"AuthorityFactory\"].saveMetadataFromNetwork(acquireTokenAuthority, this.telemetryManager, request.correlationId)];\r\n                    case 2:\r\n                        _a.sent();\r\n                        return [3 /*break*/, 4];\r\n                    case 3:\r\n                        this.logger.verbose(\"Cached metadata found for authority\");\r\n                        _a.label = 4;\r\n                    case 4:\r\n                        responseType = isLoginCall ? _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ResponseTypes\"].id_token : this.getTokenType(account, request.scopes);\r\n                        loginStartPage = request.redirectStartPage || window.location.href;\r\n                        serverAuthenticationRequest = new _ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__[\"ServerRequestParameters\"](acquireTokenAuthority, this.clientId, responseType, this.getRedirectUri(request && request.redirectUri), request.scopes, request.state, request.correlationId);\r\n                        this.logger.verbose(\"Finished building server authentication request\");\r\n                        this.updateCacheEntries(serverAuthenticationRequest, account, isLoginCall, loginStartPage);\r\n                        this.logger.verbose(\"Updating cache entries\");\r\n                        // populate QueryParameters (sid/login_hint) and any other extraQueryParameters set by the developer\r\n                        serverAuthenticationRequest.populateQueryParams(account, request);\r\n                        this.logger.verbose(\"Query parameters populated from account\");\r\n                        urlNavigate = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__[\"UrlUtils\"].createNavigateUrl(serverAuthenticationRequest) + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].response_mode_fragment;\r\n                        // set state in cache\r\n                        if (interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].interactionTypeRedirect) {\r\n                            if (!isLoginCall) {\r\n                                this.cacheStorage.setItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__[\"AuthCache\"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"TemporaryCacheKeys\"].STATE_ACQ_TOKEN, request.state), serverAuthenticationRequest.state, this.inCookie);\r\n                                this.logger.verbose(\"State cached for redirect\");\r\n                                this.logger.verbosePii(\"State cached: \" + serverAuthenticationRequest.state);\r\n                            }\r\n                            else {\r\n                                this.logger.verbose(\"Interaction type redirect but login call is true. State not cached\");\r\n                            }\r\n                        }\r\n                        else if (interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].interactionTypePopup) {\r\n                            window.renewStates.push(serverAuthenticationRequest.state);\r\n                            window.requestType = isLoginCall ? _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].login : _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].renewToken;\r\n                            this.logger.verbose(\"State saved to window\");\r\n                            this.logger.verbosePii(\"State saved: \" + serverAuthenticationRequest.state);\r\n                            // Register callback to capture results from server\r\n                            this.registerCallback(serverAuthenticationRequest.state, requestSignature, resolve, reject);\r\n                        }\r\n                        else {\r\n                            this.logger.verbose(\"Invalid interaction error. State not cached\");\r\n                            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__[\"ClientAuthError\"].createInvalidInteractionTypeError();\r\n                        }\r\n                        if (!(interactionType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].interactionTypePopup)) return [3 /*break*/, 9];\r\n                        this.logger.verbose(\"Interaction type is popup. Generating popup window\");\r\n                        // Generate a popup window\r\n                        try {\r\n                            popUpWindow = this.openPopup(urlNavigate, \"msal\", _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].popUpWidth, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].popUpHeight);\r\n                            // Push popup window handle onto stack for tracking\r\n                            _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__[\"WindowUtils\"].trackPopup(popUpWindow);\r\n                        }\r\n                        catch (e) {\r\n                            this.logger.info(_error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__[\"ClientAuthErrorMessage\"].popUpWindowError.code + \":\" + _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__[\"ClientAuthErrorMessage\"].popUpWindowError.desc);\r\n                            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ErrorCacheKeys\"].ERROR, _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__[\"ClientAuthErrorMessage\"].popUpWindowError.code);\r\n                            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ErrorCacheKeys\"].ERROR_DESC, _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__[\"ClientAuthErrorMessage\"].popUpWindowError.desc);\r\n                            if (reject) {\r\n                                reject(_error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__[\"ClientAuthError\"].createPopupWindowError());\r\n                                return [2 /*return*/];\r\n                            }\r\n                        }\r\n                        if (!popUpWindow) return [3 /*break*/, 8];\r\n                        _a.label = 5;\r\n                    case 5:\r\n                        _a.trys.push([5, 7, , 8]);\r\n                        return [4 /*yield*/, _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__[\"WindowUtils\"].monitorPopupForHash(popUpWindow, this.config.system.loadFrameTimeout, urlNavigate, this.logger)];\r\n                    case 6:\r\n                        hash = _a.sent();\r\n                        this.handleAuthenticationResponse(hash);\r\n                        // Request completed successfully, set to completed\r\n                        this.cacheStorage.removeItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"TemporaryCacheKeys\"].INTERACTION_STATUS);\r\n                        this.logger.info(\"Closing popup window\");\r\n                        // TODO: Check how this can be extracted for any framework specific code?\r\n                        if (this.config.framework.isAngular) {\r\n                            this.broadcast(\"msal:popUpHashChanged\", hash);\r\n                        }\r\n                        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__[\"WindowUtils\"].closePopups();\r\n                        return [3 /*break*/, 8];\r\n                    case 7:\r\n                        error_1 = _a.sent();\r\n                        if (reject) {\r\n                            reject(error_1);\r\n                        }\r\n                        if (this.config.framework.isAngular) {\r\n                            this.broadcast(\"msal:popUpClosed\", error_1.errorCode + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].resourceDelimiter + error_1.errorMessage);\r\n                        }\r\n                        else {\r\n                            // Request failed, set to canceled\r\n                            this.cacheStorage.removeItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"TemporaryCacheKeys\"].INTERACTION_STATUS);\r\n                            popUpWindow.close();\r\n                        }\r\n                        return [3 /*break*/, 8];\r\n                    case 8: return [3 /*break*/, 10];\r\n                    case 9:\r\n                        // If onRedirectNavigate is implemented, invoke it and provide urlNavigate\r\n                        if (request.onRedirectNavigate) {\r\n                            this.logger.verbose(\"Invoking onRedirectNavigate callback\");\r\n                            navigate = request.onRedirectNavigate(urlNavigate);\r\n                            // Returning false from onRedirectNavigate will stop navigation\r\n                            if (navigate !== false) {\r\n                                this.logger.verbose(\"onRedirectNavigate did not return false, navigating\");\r\n                                this.navigateWindow(urlNavigate);\r\n                            }\r\n                            else {\r\n                                this.logger.verbose(\"onRedirectNavigate returned false, stopping navigation\");\r\n                            }\r\n                        }\r\n                        else {\r\n                            // Otherwise, perform navigation\r\n                            this.logger.verbose(\"Navigating window to urlNavigate\");\r\n                            this.navigateWindow(urlNavigate);\r\n                        }\r\n                        _a.label = 10;\r\n                    case 10: return [3 /*break*/, 12];\r\n                    case 11:\r\n                        err_1 = _a.sent();\r\n                        this.logger.error(err_1);\r\n                        this.cacheStorage.resetTempCacheItems(request.state);\r\n                        this.authErrorHandler(interactionType, _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__[\"ClientAuthError\"].createEndpointResolutionError(err_1.toString), Object(_AuthResponse__WEBPACK_IMPORTED_MODULE_24__[\"buildResponseStateOnly\"])(request.state), reject);\r\n                        if (popUpWindow) {\r\n                            popUpWindow.close();\r\n                        }\r\n                        return [3 /*break*/, 12];\r\n                    case 12: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * API interfacing idToken request when applications already have a session/hint acquired by authorization client applications\r\n     * @param request\r\n     */\r\n    UserAgentApplication.prototype.ssoSilent = function (request) {\r\n        this.logger.verbose(\"ssoSilent has been called\");\r\n        // throw an error on an empty request\r\n        if (!request) {\r\n            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_19__[\"ClientConfigurationError\"].createEmptyRequestError();\r\n        }\r\n        // throw an error on no hints passed\r\n        if (!request.sid && !request.loginHint) {\r\n            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_19__[\"ClientConfigurationError\"].createSsoSilentError();\r\n        }\r\n        return this.acquireTokenSilent(tslib__WEBPACK_IMPORTED_MODULE_0__[\"__assign\"]({}, request, { scopes: _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].oidcScopes }));\r\n    };\r\n    /**\r\n     * Use this function to obtain a token before every call to the API / resource provider\r\n     *\r\n     * MSAL return's a cached token when available\r\n     * Or it send's a request to the STS to obtain a new token using a hidden iframe.\r\n     *\r\n     * @param {@link AuthenticationParameters}\r\n     *\r\n     * To renew idToken, please pass clientId as the only scope in the Authentication Parameters\r\n     * @returns {Promise.<AuthResponse>} - a promise that is fulfilled when this function has completed, or rejected if an error was raised. Returns the {@link AuthResponse} object\r\n     *\r\n     */\r\n    UserAgentApplication.prototype.acquireTokenSilent = function (userRequest) {\r\n        var _this = this;\r\n        this.logger.verbose(\"AcquireTokenSilent has been called\");\r\n        // validate the request\r\n        var request = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__[\"RequestUtils\"].validateRequest(userRequest, false, this.clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].interactionTypeSilent);\r\n        var apiEvent = this.telemetryManager.createAndStartApiEvent(request.correlationId, _telemetry_ApiEvent__WEBPACK_IMPORTED_MODULE_26__[\"API_EVENT_IDENTIFIER\"].AcquireTokenSilent);\r\n        var requestSignature = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__[\"RequestUtils\"].createRequestSignature(request);\r\n        return new Promise(function (resolve, reject) { return tslib__WEBPACK_IMPORTED_MODULE_0__[\"__awaiter\"](_this, void 0, void 0, function () {\r\n            var scope, account, adalIdToken, responseType, serverAuthenticationRequest, adalIdTokenObject, userContainedClaims, authErr, cacheResultResponse, logMessage, err_2;\r\n            return tslib__WEBPACK_IMPORTED_MODULE_0__[\"__generator\"](this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        // block the request if made from the hidden iframe\r\n                        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__[\"WindowUtils\"].blockReloadInHiddenIframes();\r\n                        scope = request.scopes.join(\" \").toLowerCase();\r\n                        this.logger.verbosePii(\"Serialized scopes: \" + scope);\r\n                        if (request.account) {\r\n                            account = request.account;\r\n                            this.logger.verbose(\"Account set from request\");\r\n                        }\r\n                        else {\r\n                            account = this.getAccount();\r\n                            this.logger.verbose(\"Account set from MSAL Cache\");\r\n                        }\r\n                        adalIdToken = this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].adalIdToken);\r\n                        // In the event of no account being passed in the config, no session id, and no pre-existing adalIdToken, user will need to log in\r\n                        if (!account && !(request.sid || request.loginHint) && _utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__[\"StringUtils\"].isEmpty(adalIdToken)) {\r\n                            this.logger.info(\"User login is required\");\r\n                            // The promise rejects with a UserLoginRequiredError, which should be caught and user should be prompted to log in interactively\r\n                            return [2 /*return*/, reject(_error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__[\"ClientAuthError\"].createUserLoginRequiredError())];\r\n                        }\r\n                        responseType = this.getTokenType(account, request.scopes);\r\n                        this.logger.verbose(\"Response type: \" + responseType);\r\n                        serverAuthenticationRequest = new _ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__[\"ServerRequestParameters\"](_authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__[\"AuthorityFactory\"].CreateInstance(request.authority, this.config.auth.validateAuthority, request.authorityMetadata), this.clientId, responseType, this.getRedirectUri(request.redirectUri), request.scopes, request.state, request.correlationId);\r\n                        this.logger.verbose(\"Finished building server authentication request\");\r\n                        // populate QueryParameters (sid/login_hint) and any other extraQueryParameters set by the developer\r\n                        if (_ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__[\"ServerRequestParameters\"].isSSOParam(request) || account) {\r\n                            serverAuthenticationRequest.populateQueryParams(account, request, null, true);\r\n                            this.logger.verbose(\"Query parameters populated from existing SSO or account\");\r\n                        }\r\n                        // if user didn't pass login_hint/sid and adal's idtoken is present, extract the login_hint from the adalIdToken\r\n                        else if (!account && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__[\"StringUtils\"].isEmpty(adalIdToken)) {\r\n                            adalIdTokenObject = _utils_TokenUtils__WEBPACK_IMPORTED_MODULE_12__[\"TokenUtils\"].extractIdToken(adalIdToken);\r\n                            this.logger.verbose(\"ADAL's idToken exists. Extracting login information from ADAL's idToken to populate query parameters\");\r\n                            serverAuthenticationRequest.populateQueryParams(account, null, adalIdTokenObject, true);\r\n                        }\r\n                        else {\r\n                            this.logger.verbose(\"No additional query parameters added\");\r\n                        }\r\n                        userContainedClaims = request.claimsRequest || serverAuthenticationRequest.claimsValue;\r\n                        // If request.forceRefresh is set to true, force a request for a new token instead of getting it from the cache\r\n                        if (!userContainedClaims && !request.forceRefresh) {\r\n                            try {\r\n                                cacheResultResponse = this.getCachedToken(serverAuthenticationRequest, account);\r\n                            }\r\n                            catch (e) {\r\n                                authErr = e;\r\n                            }\r\n                        }\r\n                        if (!cacheResultResponse) return [3 /*break*/, 1];\r\n                        this.logger.verbose(\"Token found in cache lookup\");\r\n                        this.logger.verbosePii(\"Scopes found: \" + JSON.stringify(cacheResultResponse.scopes));\r\n                        resolve(cacheResultResponse);\r\n                        return [2 /*return*/, null];\r\n                    case 1:\r\n                        if (!authErr) return [3 /*break*/, 2];\r\n                        this.logger.infoPii(authErr.errorCode + \":\" + authErr.errorMessage);\r\n                        reject(authErr);\r\n                        return [2 /*return*/, null];\r\n                    case 2:\r\n                        logMessage = void 0;\r\n                        if (userContainedClaims) {\r\n                            logMessage = \"Skipped cache lookup since claims were given\";\r\n                        }\r\n                        else if (request.forceRefresh) {\r\n                            logMessage = \"Skipped cache lookup since request.forceRefresh option was set to true\";\r\n                        }\r\n                        else {\r\n                            logMessage = \"No valid token found in cache lookup\";\r\n                        }\r\n                        this.logger.verbose(logMessage);\r\n                        // Cache result can return null if cache is empty. In that case, set authority to default value if no authority is passed to the API.\r\n                        if (!serverAuthenticationRequest.authorityInstance) {\r\n                            serverAuthenticationRequest.authorityInstance = request.authority ?\r\n                                _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__[\"AuthorityFactory\"].CreateInstance(request.authority, this.config.auth.validateAuthority, request.authorityMetadata)\r\n                                : this.authorityInstance;\r\n                        }\r\n                        this.logger.verbosePii(\"Authority instance: \" + serverAuthenticationRequest.authority);\r\n                        _a.label = 3;\r\n                    case 3:\r\n                        _a.trys.push([3, 7, , 8]);\r\n                        if (!!serverAuthenticationRequest.authorityInstance.hasCachedMetadata()) return [3 /*break*/, 5];\r\n                        this.logger.verbose(\"No cached metadata for authority\");\r\n                        return [4 /*yield*/, _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__[\"AuthorityFactory\"].saveMetadataFromNetwork(serverAuthenticationRequest.authorityInstance, this.telemetryManager, request.correlationId)];\r\n                    case 4:\r\n                        _a.sent();\r\n                        this.logger.verbose(\"Authority has been updated with endpoint discovery response\");\r\n                        return [3 /*break*/, 6];\r\n                    case 5:\r\n                        this.logger.verbose(\"Cached metadata found for authority\");\r\n                        _a.label = 6;\r\n                    case 6:\r\n                        /*\r\n                         * refresh attempt with iframe\r\n                         * Already renewing for this scope, callback when we get the token.\r\n                         */\r\n                        if (window.activeRenewals[requestSignature]) {\r\n                            this.logger.verbose(\"Renewing token in progress. Registering callback\");\r\n                            // Active renewals contains the state for each renewal.\r\n                            this.registerCallback(window.activeRenewals[requestSignature], requestSignature, resolve, reject);\r\n                        }\r\n                        else {\r\n                            if (request.scopes && _ScopeSet__WEBPACK_IMPORTED_MODULE_9__[\"ScopeSet\"].onlyContainsOidcScopes(request.scopes)) {\r\n                                /*\r\n                                 * App uses idToken to send to api endpoints\r\n                                 * Default scope is tracked as OIDC scopes to store this token\r\n                                 */\r\n                                this.logger.verbose(\"OpenID Connect scopes only, renewing idToken\");\r\n                                this.silentLogin = true;\r\n                                this.renewIdToken(requestSignature, resolve, reject, account, serverAuthenticationRequest);\r\n                            }\r\n                            else {\r\n                                // renew access token\r\n                                this.logger.verbose(\"Renewing access token\");\r\n                                this.renewToken(requestSignature, resolve, reject, account, serverAuthenticationRequest);\r\n                            }\r\n                        }\r\n                        return [3 /*break*/, 8];\r\n                    case 7:\r\n                        err_2 = _a.sent();\r\n                        this.logger.error(err_2);\r\n                        reject(_error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__[\"ClientAuthError\"].createEndpointResolutionError(err_2.toString()));\r\n                        return [2 /*return*/, null];\r\n                    case 8: return [2 /*return*/];\r\n                }\r\n            });\r\n        }); })\r\n            .then(function (res) {\r\n            _this.logger.verbose(\"Successfully acquired token\");\r\n            _this.telemetryManager.stopAndFlushApiEvent(request.correlationId, apiEvent, true);\r\n            return res;\r\n        })\r\n            .catch(function (error) {\r\n            _this.cacheStorage.resetTempCacheItems(request.state);\r\n            _this.telemetryManager.stopAndFlushApiEvent(request.correlationId, apiEvent, false, error.errorCode);\r\n            throw error;\r\n        });\r\n    };\r\n    // #endregion\r\n    // #region Popup Window Creation\r\n    /**\r\n     * @hidden\r\n     *\r\n     * Configures popup window for login.\r\n     *\r\n     * @param urlNavigate\r\n     * @param title\r\n     * @param popUpWidth\r\n     * @param popUpHeight\r\n     * @ignore\r\n     * @hidden\r\n     */\r\n    UserAgentApplication.prototype.openPopup = function (urlNavigate, title, popUpWidth, popUpHeight) {\r\n        this.logger.verbose(\"OpenPopup has been called\");\r\n        try {\r\n            /**\r\n             * adding winLeft and winTop to account for dual monitor\r\n             * using screenLeft and screenTop for IE8 and earlier\r\n             */\r\n            var winLeft = window.screenLeft ? window.screenLeft : window.screenX;\r\n            var winTop = window.screenTop ? window.screenTop : window.screenY;\r\n            /**\r\n             * window.innerWidth displays browser window\"s height and width excluding toolbars\r\n             * using document.documentElement.clientWidth for IE8 and earlier\r\n             */\r\n            var width = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;\r\n            var height = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;\r\n            var left = ((width / 2) - (popUpWidth / 2)) + winLeft;\r\n            var top_1 = ((height / 2) - (popUpHeight / 2)) + winTop;\r\n            // open the window\r\n            var popupWindow = window.open(urlNavigate, title, \"width=\" + popUpWidth + \", height=\" + popUpHeight + \", top=\" + top_1 + \", left=\" + left + \", scrollbars=yes\");\r\n            if (!popupWindow) {\r\n                throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__[\"ClientAuthError\"].createPopupWindowError();\r\n            }\r\n            if (popupWindow.focus) {\r\n                popupWindow.focus();\r\n            }\r\n            return popupWindow;\r\n        }\r\n        catch (e) {\r\n            this.cacheStorage.removeItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"TemporaryCacheKeys\"].INTERACTION_STATUS);\r\n            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__[\"ClientAuthError\"].createPopupWindowError(e.toString());\r\n        }\r\n    };\r\n    // #endregion\r\n    // #region Iframe Management\r\n    /**\r\n     * @hidden\r\n     * Calling _loadFrame but with a timeout to signal failure in loadframeStatus. Callbacks are left.\r\n     * registered when network errors occur and subsequent token requests for same resource are registered to the pending request.\r\n     * @ignore\r\n     */\r\n    UserAgentApplication.prototype.loadIframeTimeout = function (urlNavigate, frameName, requestSignature) {\r\n        return tslib__WEBPACK_IMPORTED_MODULE_0__[\"__awaiter\"](this, void 0, void 0, function () {\r\n            var expectedState, iframe, _a, hash, error_2;\r\n            return tslib__WEBPACK_IMPORTED_MODULE_0__[\"__generator\"](this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        expectedState = window.activeRenewals[requestSignature];\r\n                        this.logger.verbosePii(\"Set loading state to pending for: \" + requestSignature + \":\" + expectedState);\r\n                        this.cacheStorage.setItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__[\"AuthCache\"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"TemporaryCacheKeys\"].RENEW_STATUS, expectedState), _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].inProgress);\r\n                        if (!this.config.system.navigateFrameWait) return [3 /*break*/, 2];\r\n                        return [4 /*yield*/, _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__[\"WindowUtils\"].loadFrame(urlNavigate, frameName, this.config.system.navigateFrameWait, this.logger)];\r\n                    case 1:\r\n                        _a = _b.sent();\r\n                        return [3 /*break*/, 3];\r\n                    case 2:\r\n                        _a = _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__[\"WindowUtils\"].loadFrameSync(urlNavigate, frameName, this.logger);\r\n                        _b.label = 3;\r\n                    case 3:\r\n                        iframe = _a;\r\n                        _b.label = 4;\r\n                    case 4:\r\n                        _b.trys.push([4, 6, , 7]);\r\n                        return [4 /*yield*/, _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__[\"WindowUtils\"].monitorIframeForHash(iframe.contentWindow, this.config.system.loadFrameTimeout, urlNavigate, this.logger)];\r\n                    case 5:\r\n                        hash = _b.sent();\r\n                        if (hash) {\r\n                            this.handleAuthenticationResponse(hash);\r\n                        }\r\n                        return [3 /*break*/, 7];\r\n                    case 6:\r\n                        error_2 = _b.sent();\r\n                        if (this.cacheStorage.getItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__[\"AuthCache\"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"TemporaryCacheKeys\"].RENEW_STATUS, expectedState)) === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].inProgress) {\r\n                            // fail the iframe session if it's in pending state\r\n                            this.logger.verbose(\"Loading frame has timed out after: \" + (this.config.system.loadFrameTimeout / 1000) + \" seconds for scope/authority \" + requestSignature + \":\" + expectedState);\r\n                            // Error after timeout\r\n                            if (expectedState && window.callbackMappedToRenewStates[expectedState]) {\r\n                                window.callbackMappedToRenewStates[expectedState](null, error_2);\r\n                            }\r\n                            this.cacheStorage.removeItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__[\"AuthCache\"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"TemporaryCacheKeys\"].RENEW_STATUS, expectedState));\r\n                        }\r\n                        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__[\"WindowUtils\"].removeHiddenIframe(iframe);\r\n                        throw error_2;\r\n                    case 7:\r\n                        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__[\"WindowUtils\"].removeHiddenIframe(iframe);\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    // #endregion\r\n    // #region General Helpers\r\n    /**\r\n     * @hidden\r\n     * Used to redirect the browser to the STS authorization endpoint\r\n     * @param {string} urlNavigate - URL of the authorization endpoint\r\n     */\r\n    UserAgentApplication.prototype.navigateWindow = function (urlNavigate, popupWindow) {\r\n        // Navigate if valid URL\r\n        if (urlNavigate && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__[\"StringUtils\"].isEmpty(urlNavigate)) {\r\n            var navigateWindow = popupWindow ? popupWindow : window;\r\n            var logMessage = popupWindow ? \"Navigated Popup window to:\" + urlNavigate : \"Navigate to:\" + urlNavigate;\r\n            this.logger.infoPii(logMessage);\r\n            navigateWindow.location.assign(urlNavigate);\r\n        }\r\n        else {\r\n            this.logger.info(\"Navigate url is empty\");\r\n            throw _error_AuthError__WEBPACK_IMPORTED_MODULE_20__[\"AuthError\"].createUnexpectedError(\"Navigate url is empty\");\r\n        }\r\n    };\r\n    /**\r\n     * @hidden\r\n     * Used to add the developer requested callback to the array of callbacks for the specified scopes. The updated array is stored on the window object\r\n     * @param {string} expectedState - Unique state identifier (guid).\r\n     * @param {string} scope - Developer requested permissions. Not all scopes are guaranteed to be included in the access token returned.\r\n     * @param {Function} resolve - The resolve function of the promise object.\r\n     * @param {Function} reject - The reject function of the promise object.\r\n     * @ignore\r\n     */\r\n    UserAgentApplication.prototype.registerCallback = function (expectedState, requestSignature, resolve, reject) {\r\n        var _this = this;\r\n        // track active renewals\r\n        window.activeRenewals[requestSignature] = expectedState;\r\n        // initialize callbacks mapped array\r\n        if (!window.promiseMappedToRenewStates[expectedState]) {\r\n            window.promiseMappedToRenewStates[expectedState] = [];\r\n        }\r\n        // indexing on the current state, push the callback params to callbacks mapped\r\n        window.promiseMappedToRenewStates[expectedState].push({ resolve: resolve, reject: reject });\r\n        // Store the server response in the current window??\r\n        if (!window.callbackMappedToRenewStates[expectedState]) {\r\n            window.callbackMappedToRenewStates[expectedState] = function (response, error) {\r\n                // reset active renewals\r\n                window.activeRenewals[requestSignature] = null;\r\n                // for all promiseMappedtoRenewStates for a given 'state' - call the reject/resolve with error/token respectively\r\n                for (var i = 0; i < window.promiseMappedToRenewStates[expectedState].length; ++i) {\r\n                    try {\r\n                        if (error) {\r\n                            window.promiseMappedToRenewStates[expectedState][i].reject(error);\r\n                        }\r\n                        else if (response) {\r\n                            window.promiseMappedToRenewStates[expectedState][i].resolve(response);\r\n                        }\r\n                        else {\r\n                            _this.cacheStorage.resetTempCacheItems(expectedState);\r\n                            throw _error_AuthError__WEBPACK_IMPORTED_MODULE_20__[\"AuthError\"].createUnexpectedError(\"Error and response are both null\");\r\n                        }\r\n                    }\r\n                    catch (e) {\r\n                        _this.logger.warning(e);\r\n                    }\r\n                }\r\n                // reset\r\n                window.promiseMappedToRenewStates[expectedState] = null;\r\n                window.callbackMappedToRenewStates[expectedState] = null;\r\n            };\r\n        }\r\n    };\r\n    // #endregion\r\n    // #region Logout\r\n    /**\r\n     * Use to log out the current user, and redirect the user to the postLogoutRedirectUri.\r\n     * Default behaviour is to redirect the user to `window.location.href`.\r\n     */\r\n    UserAgentApplication.prototype.logout = function (correlationId) {\r\n        this.logger.verbose(\"Logout has been called\");\r\n        this.logoutAsync(correlationId);\r\n    };\r\n    /**\r\n     * Async version of logout(). Use to log out the current user.\r\n     * @param correlationId Request correlationId\r\n     */\r\n    UserAgentApplication.prototype.logoutAsync = function (correlationId) {\r\n        return tslib__WEBPACK_IMPORTED_MODULE_0__[\"__awaiter\"](this, void 0, void 0, function () {\r\n            var requestCorrelationId, apiEvent, correlationIdParam, postLogoutQueryParam, urlNavigate, error_3;\r\n            return tslib__WEBPACK_IMPORTED_MODULE_0__[\"__generator\"](this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        requestCorrelationId = correlationId || _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_28__[\"CryptoUtils\"].createNewGuid();\r\n                        apiEvent = this.telemetryManager.createAndStartApiEvent(requestCorrelationId, _telemetry_ApiEvent__WEBPACK_IMPORTED_MODULE_26__[\"API_EVENT_IDENTIFIER\"].Logout);\r\n                        this.clearCache();\r\n                        this.account = null;\r\n                        _a.label = 1;\r\n                    case 1:\r\n                        _a.trys.push([1, 5, , 6]);\r\n                        if (!!this.authorityInstance.hasCachedMetadata()) return [3 /*break*/, 3];\r\n                        this.logger.verbose(\"No cached metadata for authority\");\r\n                        return [4 /*yield*/, _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__[\"AuthorityFactory\"].saveMetadataFromNetwork(this.authorityInstance, this.telemetryManager, correlationId)];\r\n                    case 2:\r\n                        _a.sent();\r\n                        return [3 /*break*/, 4];\r\n                    case 3:\r\n                        this.logger.verbose(\"Cached metadata found for authority\");\r\n                        _a.label = 4;\r\n                    case 4:\r\n                        correlationIdParam = \"client-request-id=\" + requestCorrelationId;\r\n                        postLogoutQueryParam = void 0;\r\n                        if (this.getPostLogoutRedirectUri()) {\r\n                            postLogoutQueryParam = \"&post_logout_redirect_uri=\" + encodeURIComponent(this.getPostLogoutRedirectUri());\r\n                            this.logger.verbose(\"redirectUri found and set\");\r\n                        }\r\n                        else {\r\n                            postLogoutQueryParam = \"\";\r\n                            this.logger.verbose(\"No redirectUri set for app. postLogoutQueryParam is empty\");\r\n                        }\r\n                        urlNavigate = void 0;\r\n                        if (this.authorityInstance.EndSessionEndpoint) {\r\n                            urlNavigate = this.authorityInstance.EndSessionEndpoint + \"?\" + correlationIdParam + postLogoutQueryParam;\r\n                            this.logger.verbose(\"EndSessionEndpoint found and urlNavigate set\");\r\n                            this.logger.verbosePii(\"urlNavigate set to: \" + this.authorityInstance.EndSessionEndpoint);\r\n                        }\r\n                        else {\r\n                            urlNavigate = this.authority + \"oauth2/v2.0/logout?\" + correlationIdParam + postLogoutQueryParam;\r\n                            this.logger.verbose(\"No endpoint, urlNavigate set to default\");\r\n                        }\r\n                        this.telemetryManager.stopAndFlushApiEvent(requestCorrelationId, apiEvent, true);\r\n                        this.logger.verbose(\"Navigating window to urlNavigate\");\r\n                        this.navigateWindow(urlNavigate);\r\n                        return [3 /*break*/, 6];\r\n                    case 5:\r\n                        error_3 = _a.sent();\r\n                        this.telemetryManager.stopAndFlushApiEvent(requestCorrelationId, apiEvent, false, error_3.errorCode);\r\n                        return [3 /*break*/, 6];\r\n                    case 6: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * @hidden\r\n     * Clear all access tokens and ID tokens in the cache.\r\n     * @ignore\r\n     */\r\n    UserAgentApplication.prototype.clearCache = function () {\r\n        this.logger.verbose(\"Clearing cache\");\r\n        window.renewStates = [];\r\n        var tokenCacheItems = this.cacheStorage.getAllTokens(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].homeAccountIdentifier);\r\n        for (var i = 0; i < tokenCacheItems.length; i++) {\r\n            this.cacheStorage.removeItem(JSON.stringify(tokenCacheItems[i].key));\r\n        }\r\n        this.cacheStorage.resetCacheItems();\r\n        this.cacheStorage.clearMsalCookie();\r\n        this.logger.verbose(\"Cache cleared\");\r\n    };\r\n    /**\r\n     * @hidden\r\n     * Clear a given access token from the cache.\r\n     *\r\n     * @param accessToken\r\n     */\r\n    UserAgentApplication.prototype.clearCacheForScope = function (accessToken) {\r\n        this.logger.verbose(\"Clearing access token from cache\");\r\n        var accessTokenItems = this.cacheStorage.getAllAccessTokens(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].homeAccountIdentifier);\r\n        for (var i = 0; i < accessTokenItems.length; i++) {\r\n            var token = accessTokenItems[i];\r\n            if (token.value.accessToken === accessToken) {\r\n                this.cacheStorage.removeItem(JSON.stringify(token.key));\r\n                this.logger.verbosePii(\"Access token removed: \" + token.key);\r\n            }\r\n        }\r\n    };\r\n    // #endregion\r\n    // #region Response\r\n    /**\r\n     * @hidden\r\n     * @ignore\r\n     * Checks if the redirect response is received from the STS. In case of redirect, the url fragment has either id_token, access_token or error.\r\n     * @param {string} hash - Hash passed from redirect page.\r\n     * @returns {Boolean} - true if response contains id_token, access_token or error, false otherwise.\r\n     */\r\n    UserAgentApplication.prototype.isCallback = function (hash) {\r\n        this.logger.info(\"isCallback will be deprecated in favor of urlContainsHash in MSAL.js v2.0.\");\r\n        this.logger.verbose(\"isCallback has been called\");\r\n        return _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__[\"UrlUtils\"].urlContainsHash(hash);\r\n    };\r\n    /**\r\n     * @hidden\r\n     * Used to call the constructor callback with the token/error\r\n     * @param {string} [hash=window.location.hash] - Hash fragment of Url.\r\n     */\r\n    UserAgentApplication.prototype.processCallBack = function (hash, stateInfo, parentCallback) {\r\n        this.logger.info(\"ProcessCallBack has been called. Processing callback from redirect response\");\r\n        // get the state info from the hash\r\n        if (!stateInfo) {\r\n            this.logger.verbose(\"StateInfo is null, getting stateInfo from hash\");\r\n            stateInfo = this.getResponseState(hash);\r\n        }\r\n        var response;\r\n        var authErr;\r\n        // Save the token info from the hash\r\n        try {\r\n            response = this.saveTokenFromHash(hash, stateInfo);\r\n        }\r\n        catch (err) {\r\n            authErr = err;\r\n        }\r\n        try {\r\n            // Clear the cookie in the hash\r\n            this.cacheStorage.clearMsalCookie(stateInfo.state);\r\n            var accountState = this.getAccountState(stateInfo.state);\r\n            if (response) {\r\n                if ((stateInfo.requestType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].renewToken) || response.accessToken) {\r\n                    if (window.parent !== window) {\r\n                        this.logger.verbose(\"Window is in iframe, acquiring token silently\");\r\n                    }\r\n                    else {\r\n                        this.logger.verbose(\"Acquiring token interactive in progress\");\r\n                    }\r\n                    this.logger.verbose(\"Response tokenType set to \" + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ACCESS_TOKEN);\r\n                    response.tokenType = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ACCESS_TOKEN;\r\n                }\r\n                else if (stateInfo.requestType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].login) {\r\n                    this.logger.verbose(\"Response tokenType set to \" + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ID_TOKEN);\r\n                    response.tokenType = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ID_TOKEN;\r\n                }\r\n                if (!parentCallback) {\r\n                    this.logger.verbose(\"Setting redirectResponse\");\r\n                    this.redirectResponse = response;\r\n                    return;\r\n                }\r\n            }\r\n            else if (!parentCallback) {\r\n                this.logger.verbose(\"Response is null, setting redirectResponse with state\");\r\n                this.redirectResponse = Object(_AuthResponse__WEBPACK_IMPORTED_MODULE_24__[\"buildResponseStateOnly\"])(accountState);\r\n                this.redirectError = authErr;\r\n                this.cacheStorage.resetTempCacheItems(stateInfo.state);\r\n                return;\r\n            }\r\n            this.logger.verbose(\"Calling callback provided to processCallback\");\r\n            parentCallback(response, authErr);\r\n        }\r\n        catch (err) {\r\n            this.logger.error(\"Error occurred in token received callback function: \" + err);\r\n            throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__[\"ClientAuthError\"].createErrorInCallbackFunction(err.toString());\r\n        }\r\n    };\r\n    /**\r\n     * @hidden\r\n     * This method must be called for processing the response received from the STS if using popups or iframes. It extracts the hash, processes the token or error\r\n     * information and saves it in the cache. It then resolves the promises with the result.\r\n     * @param {string} [hash=window.location.hash] - Hash fragment of Url.\r\n     */\r\n    UserAgentApplication.prototype.handleAuthenticationResponse = function (hash) {\r\n        this.logger.verbose(\"HandleAuthenticationResponse has been called\");\r\n        // retrieve the hash\r\n        var locationHash = hash || window.location.hash;\r\n        // if (window.parent !== window), by using self, window.parent becomes equal to window in getResponseState method specifically\r\n        var stateInfo = this.getResponseState(locationHash);\r\n        this.logger.verbose(\"Obtained state from response\");\r\n        var tokenResponseCallback = window.callbackMappedToRenewStates[stateInfo.state];\r\n        this.processCallBack(locationHash, stateInfo, tokenResponseCallback);\r\n    };\r\n    /**\r\n     * @hidden\r\n     * This method must be called for processing the response received from the STS when using redirect flows. It extracts the hash, processes the token or error\r\n     * information and saves it in the cache. The result can then be accessed by user registered callbacks.\r\n     * @param {string} [hash=window.location.hash] - Hash fragment of Url.\r\n     */\r\n    UserAgentApplication.prototype.handleRedirectAuthenticationResponse = function (hash) {\r\n        this.logger.info(\"Returned from redirect url\");\r\n        this.logger.verbose(\"HandleRedirectAuthenticationResponse has been called\");\r\n        // clear hash from window\r\n        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__[\"WindowUtils\"].clearUrlFragment();\r\n        this.logger.verbose(\"Window.location.hash cleared\");\r\n        // if (window.parent !== window), by using self, window.parent becomes equal to window in getResponseState method specifically\r\n        var stateInfo = this.getResponseState(hash);\r\n        // if set to navigate to loginRequest page post login\r\n        if (this.config.auth.navigateToLoginRequestUrl && window.parent === window) {\r\n            this.logger.verbose(\"Window.parent is equal to window, not in popup or iframe. Navigation to login request url after login turned on\");\r\n            var loginRequestUrl = this.cacheStorage.getItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__[\"AuthCache\"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"TemporaryCacheKeys\"].LOGIN_REQUEST, stateInfo.state), this.inCookie);\r\n            // Redirect to home page if login request url is null (real null or the string null)\r\n            if (!loginRequestUrl || loginRequestUrl === \"null\") {\r\n                this.logger.error(\"Unable to get valid login request url from cache, redirecting to home page\");\r\n                window.location.assign(\"/\");\r\n                return;\r\n            }\r\n            else {\r\n                this.logger.verbose(\"Valid login request url obtained from cache\");\r\n                var currentUrl = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__[\"UrlUtils\"].removeHashFromUrl(window.location.href);\r\n                var finalRedirectUrl = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__[\"UrlUtils\"].removeHashFromUrl(loginRequestUrl);\r\n                if (currentUrl !== finalRedirectUrl) {\r\n                    this.logger.verbose(\"Current url is not login request url, navigating\");\r\n                    this.logger.verbosePii(\"CurrentUrl: \" + currentUrl + \", finalRedirectUrl: \" + finalRedirectUrl);\r\n                    window.location.assign(\"\" + finalRedirectUrl + hash);\r\n                    return;\r\n                }\r\n                else {\r\n                    this.logger.verbose(\"Current url matches login request url\");\r\n                    var loginRequestUrlComponents = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__[\"UrlUtils\"].GetUrlComponents(loginRequestUrl);\r\n                    if (loginRequestUrlComponents.Hash) {\r\n                        this.logger.verbose(\"Login request url contains hash, resetting non-msal hash\");\r\n                        window.location.hash = loginRequestUrlComponents.Hash;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        else if (!this.config.auth.navigateToLoginRequestUrl) {\r\n            this.logger.verbose(\"Default navigation to start page after login turned off\");\r\n        }\r\n        this.processCallBack(hash, stateInfo, null);\r\n    };\r\n    /**\r\n     * @hidden\r\n     * Creates a stateInfo object from the URL fragment and returns it.\r\n     * @param {string} hash  -  Hash passed from redirect page\r\n     * @returns {TokenResponse} an object created from the redirect response from AAD comprising of the keys - parameters, requestType, stateMatch, stateResponse and valid.\r\n     * @ignore\r\n     */\r\n    UserAgentApplication.prototype.getResponseState = function (hash) {\r\n        this.logger.verbose(\"GetResponseState has been called\");\r\n        var parameters = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__[\"UrlUtils\"].deserializeHash(hash);\r\n        var stateResponse;\r\n        if (!parameters) {\r\n            throw _error_AuthError__WEBPACK_IMPORTED_MODULE_20__[\"AuthError\"].createUnexpectedError(\"Hash was not parsed correctly.\");\r\n        }\r\n        if (parameters.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].STATE)) {\r\n            this.logger.verbose(\"Hash contains state. Creating stateInfo object\");\r\n            var parsedState = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__[\"RequestUtils\"].parseLibraryState(parameters.state);\r\n            stateResponse = {\r\n                requestType: _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].unknown,\r\n                state: parameters.state,\r\n                timestamp: parsedState.ts,\r\n                method: parsedState.method,\r\n                stateMatch: false\r\n            };\r\n        }\r\n        else {\r\n            throw _error_AuthError__WEBPACK_IMPORTED_MODULE_20__[\"AuthError\"].createUnexpectedError(\"Hash does not contain state.\");\r\n        }\r\n        /*\r\n         * async calls can fire iframe and login request at the same time if developer does not use the API as expected\r\n         * incoming callback needs to be looked up to find the request type\r\n         */\r\n        // loginRedirect\r\n        if (stateResponse.state === this.cacheStorage.getItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__[\"AuthCache\"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"TemporaryCacheKeys\"].STATE_LOGIN, stateResponse.state), this.inCookie) || stateResponse.state === this.silentAuthenticationState) {\r\n            this.logger.verbose(\"State matches cached state, setting requestType to login\");\r\n            stateResponse.requestType = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].login;\r\n            stateResponse.stateMatch = true;\r\n            return stateResponse;\r\n        }\r\n        // acquireTokenRedirect\r\n        else if (stateResponse.state === this.cacheStorage.getItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__[\"AuthCache\"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"TemporaryCacheKeys\"].STATE_ACQ_TOKEN, stateResponse.state), this.inCookie)) {\r\n            this.logger.verbose(\"State matches cached state, setting requestType to renewToken\");\r\n            stateResponse.requestType = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].renewToken;\r\n            stateResponse.stateMatch = true;\r\n            return stateResponse;\r\n        }\r\n        // external api requests may have many renewtoken requests for different resource\r\n        if (!stateResponse.stateMatch) {\r\n            this.logger.verbose(\"State does not match cached state, setting requestType to type from window\");\r\n            stateResponse.requestType = window.requestType;\r\n            var statesInParentContext = window.renewStates;\r\n            for (var i = 0; i < statesInParentContext.length; i++) {\r\n                if (statesInParentContext[i] === stateResponse.state) {\r\n                    this.logger.verbose(\"Matching state found for request\");\r\n                    stateResponse.stateMatch = true;\r\n                    break;\r\n                }\r\n            }\r\n            if (!stateResponse.stateMatch) {\r\n                this.logger.verbose(\"Matching state not found for request\");\r\n            }\r\n        }\r\n        return stateResponse;\r\n    };\r\n    // #endregion\r\n    // #region Token Processing (Extract to TokenProcessing.ts)\r\n    /**\r\n     * @hidden\r\n     * Used to get token for the specified set of scopes from the cache\r\n     * @param {@link ServerRequestParameters} - Request sent to the STS to obtain an id_token/access_token\r\n     * @param {Account} account - Account for which the scopes were requested\r\n     */\r\n    UserAgentApplication.prototype.getCachedToken = function (serverAuthenticationRequest, account) {\r\n        this.logger.verbose(\"GetCachedToken has been called\");\r\n        var scopes = serverAuthenticationRequest.scopes;\r\n        /**\r\n         * Id Token should be returned in every acquireTokenSilent call. The only exception is a response_type = token\r\n         * request when a valid ID Token is not present in the cache.\r\n         */\r\n        var idToken = this.getCachedIdToken(serverAuthenticationRequest, account);\r\n        var authResponse = this.getCachedAccessToken(serverAuthenticationRequest, account, scopes);\r\n        var accountState = this.getAccountState(serverAuthenticationRequest.state);\r\n        return _utils_ResponseUtils__WEBPACK_IMPORTED_MODULE_16__[\"ResponseUtils\"].buildAuthResponse(idToken, authResponse, serverAuthenticationRequest, account, scopes, accountState);\r\n    };\r\n    /**\r\n     * @hidden\r\n     *\r\n     * Uses passed in authority to further filter an array of tokenCacheItems until only the token being searched for remains, then returns that tokenCacheItem.\r\n     * This method will throw if authority filtering still yields multiple matching tokens and will return null if not tokens match the authority passed in.\r\n     *\r\n     * @param authority\r\n     * @param tokenCacheItems\r\n     * @param request\r\n     * @param requestScopes\r\n     * @param tokenType\r\n     */\r\n    UserAgentApplication.prototype.getTokenCacheItemByAuthority = function (authority, tokenCacheItems, requestScopes, tokenType) {\r\n        var _this = this;\r\n        var filteredAuthorityItems;\r\n        if (_utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__[\"UrlUtils\"].isCommonAuthority(authority) || _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__[\"UrlUtils\"].isOrganizationsAuthority(authority)) {\r\n            filteredAuthorityItems = _utils_AuthCacheUtils__WEBPACK_IMPORTED_MODULE_30__[\"AuthCacheUtils\"].filterTokenCacheItemsByDomain(tokenCacheItems, _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__[\"UrlUtils\"].GetUrlComponents(authority).HostNameAndPort);\r\n        }\r\n        else {\r\n            filteredAuthorityItems = _utils_AuthCacheUtils__WEBPACK_IMPORTED_MODULE_30__[\"AuthCacheUtils\"].filterTokenCacheItemsByAuthority(tokenCacheItems, authority);\r\n        }\r\n        if (filteredAuthorityItems.length === 1) {\r\n            return filteredAuthorityItems[0];\r\n        }\r\n        else if (filteredAuthorityItems.length > 1) {\r\n            this.logger.warning(\"Multiple matching tokens found. Cleaning cache and requesting a new token.\");\r\n            filteredAuthorityItems.forEach(function (accessTokenCacheItem) {\r\n                _this.cacheStorage.removeItem(JSON.stringify(accessTokenCacheItem.key));\r\n            });\r\n            return null;\r\n        }\r\n        else {\r\n            this.logger.verbose(\"No matching tokens of type \" + tokenType + \" found\");\r\n            return null;\r\n        }\r\n    };\r\n    /**\r\n     *\r\n     * @hidden\r\n     *\r\n     * Searches the token cache for an ID Token that matches the request parameter and returns it as an IdToken object.\r\n     *\r\n     * @param serverAuthenticationRequest\r\n     * @param account\r\n     */\r\n    UserAgentApplication.prototype.getCachedIdToken = function (serverAuthenticationRequest, account) {\r\n        this.logger.verbose(\"Getting all cached tokens of type ID Token\");\r\n        var idTokenCacheItems = this.cacheStorage.getAllIdTokens(this.clientId, account ? account.homeAccountIdentifier : null);\r\n        var matchAuthority = serverAuthenticationRequest.authority || this.authority;\r\n        var idTokenCacheItem = this.getTokenCacheItemByAuthority(matchAuthority, idTokenCacheItems, null, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ID_TOKEN);\r\n        if (idTokenCacheItem) {\r\n            this.logger.verbose(\"Evaluating ID token found\");\r\n            var idTokenIsStillValid = this.evaluateTokenExpiration(idTokenCacheItem);\r\n            if (idTokenIsStillValid) {\r\n                this.logger.verbose(\"ID token expiration is within offset, using ID token found in cache\");\r\n                var idTokenValue = idTokenCacheItem.value;\r\n                if (idTokenValue) {\r\n                    this.logger.verbose(\"ID Token found in cache is valid and unexpired\");\r\n                }\r\n                else {\r\n                    this.logger.verbose(\"ID Token found in cache is invalid\");\r\n                }\r\n                return (idTokenValue) ? new _IdToken__WEBPACK_IMPORTED_MODULE_6__[\"IdToken\"](idTokenValue.idToken) : null;\r\n            }\r\n            else {\r\n                this.logger.verbose(\"Cached ID token is expired, removing from cache\");\r\n                this.cacheStorage.removeItem(JSON.stringify(idTokenCacheItem.key));\r\n                return null;\r\n            }\r\n        }\r\n        else {\r\n            this.logger.verbose(\"No tokens found\");\r\n            return null;\r\n        }\r\n    };\r\n    /**\r\n     *\r\n     * @hidden\r\n     *\r\n     * Searches the token cache for an access token that matches the request parameters and returns it as an AuthResponse.\r\n     *\r\n     * @param serverAuthenticationRequest\r\n     * @param account\r\n     * @param scopes\r\n     */\r\n    UserAgentApplication.prototype.getCachedAccessToken = function (serverAuthenticationRequest, account, scopes) {\r\n        this.logger.verbose(\"Getting all cached tokens of type Access Token\");\r\n        var tokenCacheItems = this.cacheStorage.getAllAccessTokens(this.clientId, account ? account.homeAccountIdentifier : null);\r\n        var scopeFilteredTokenCacheItems = _utils_AuthCacheUtils__WEBPACK_IMPORTED_MODULE_30__[\"AuthCacheUtils\"].filterTokenCacheItemsByScope(tokenCacheItems, scopes);\r\n        var matchAuthority = serverAuthenticationRequest.authority || this.authority;\r\n        // serverAuthenticationRequest.authority can only be common or organizations if not null\r\n        var accessTokenCacheItem = this.getTokenCacheItemByAuthority(matchAuthority, scopeFilteredTokenCacheItems, scopes, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ACCESS_TOKEN);\r\n        if (!accessTokenCacheItem) {\r\n            this.logger.verbose(\"No matching token found when filtering by scope and authority\");\r\n            var authorityList = this.getUniqueAuthority(tokenCacheItems, \"authority\");\r\n            if (authorityList.length > 1) {\r\n                throw _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__[\"ClientAuthError\"].createMultipleAuthoritiesInCacheError(scopes.toString());\r\n            }\r\n            this.logger.verbose(\"Single authority used, setting authorityInstance\");\r\n            serverAuthenticationRequest.authorityInstance = _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__[\"AuthorityFactory\"].CreateInstance(authorityList[0], this.config.auth.validateAuthority);\r\n            return null;\r\n        }\r\n        else {\r\n            serverAuthenticationRequest.authorityInstance = _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__[\"AuthorityFactory\"].CreateInstance(accessTokenCacheItem.key.authority, this.config.auth.validateAuthority);\r\n            this.logger.verbose(\"Evaluating access token found\");\r\n            var tokenIsStillValid = this.evaluateTokenExpiration(accessTokenCacheItem);\r\n            // The response value will stay null if token retrieved from the cache is expired, otherwise it will be populated with said token's data\r\n            if (tokenIsStillValid) {\r\n                this.logger.verbose(\"Access token expiration is within offset, using access token found in cache\");\r\n                if (!account) {\r\n                    account = this.getAccount();\r\n                    if (!account) {\r\n                        throw _error_AuthError__WEBPACK_IMPORTED_MODULE_20__[\"AuthError\"].createUnexpectedError(\"Account should not be null here.\");\r\n                    }\r\n                }\r\n                var aState = this.getAccountState(serverAuthenticationRequest.state);\r\n                var response = {\r\n                    uniqueId: \"\",\r\n                    tenantId: \"\",\r\n                    tokenType: _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ACCESS_TOKEN,\r\n                    idToken: null,\r\n                    idTokenClaims: null,\r\n                    accessToken: accessTokenCacheItem.value.accessToken,\r\n                    scopes: accessTokenCacheItem.key.scopes.split(\" \"),\r\n                    expiresOn: new Date(Number(accessTokenCacheItem.value.expiresIn) * 1000),\r\n                    account: account,\r\n                    accountState: aState,\r\n                    fromCache: true\r\n                };\r\n                return response;\r\n            }\r\n            else {\r\n                this.logger.verbose(\"Access token expired, removing from cache\");\r\n                this.cacheStorage.removeItem(JSON.stringify(accessTokenCacheItem.key));\r\n                return null;\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * Returns true if the token passed in is within the acceptable expiration time offset, false if it is expired.\r\n     * @param tokenCacheItem\r\n     * @param serverAuthenticationRequest\r\n     */\r\n    UserAgentApplication.prototype.evaluateTokenExpiration = function (tokenCacheItem) {\r\n        var expiration = Number(tokenCacheItem.value.expiresIn);\r\n        return _utils_TokenUtils__WEBPACK_IMPORTED_MODULE_12__[\"TokenUtils\"].validateExpirationIsWithinOffset(expiration, this.config.system.tokenRenewalOffsetSeconds);\r\n    };\r\n    /**\r\n     * @hidden\r\n     * Used to get a unique list of authorities from the cache\r\n     * @param {Array<AccessTokenCacheItem>}  accessTokenCacheItems - accessTokenCacheItems saved in the cache\r\n     * @ignore\r\n     */\r\n    UserAgentApplication.prototype.getUniqueAuthority = function (accessTokenCacheItems, property) {\r\n        this.logger.verbose(\"GetUniqueAuthority has been called\");\r\n        var authorityList = [];\r\n        var flags = [];\r\n        accessTokenCacheItems.forEach(function (element) {\r\n            if (element.key.hasOwnProperty(property) && (flags.indexOf(element.key[property]) === -1)) {\r\n                flags.push(element.key[property]);\r\n                authorityList.push(element.key[property]);\r\n            }\r\n        });\r\n        return authorityList;\r\n    };\r\n    /**\r\n     * @hidden\r\n     * Check if ADAL id_token exists and return if exists.\r\n     *\r\n     */\r\n    UserAgentApplication.prototype.extractADALIdToken = function () {\r\n        this.logger.verbose(\"ExtractADALIdToken has been called\");\r\n        var adalIdToken = this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].adalIdToken);\r\n        return (!_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__[\"StringUtils\"].isEmpty(adalIdToken)) ? _utils_TokenUtils__WEBPACK_IMPORTED_MODULE_12__[\"TokenUtils\"].extractIdToken(adalIdToken) : null;\r\n    };\r\n    /**\r\n     * @hidden\r\n     * Acquires access token using a hidden iframe.\r\n     * @ignore\r\n     */\r\n    UserAgentApplication.prototype.renewToken = function (requestSignature, resolve, reject, account, serverAuthenticationRequest) {\r\n        this.logger.verbose(\"RenewToken has been called\");\r\n        this.logger.verbosePii(\"RenewToken scope and authority: \" + requestSignature);\r\n        var frameName = _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__[\"WindowUtils\"].generateFrameName(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"FramePrefix\"].TOKEN_FRAME, requestSignature);\r\n        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__[\"WindowUtils\"].addHiddenIFrame(frameName, this.logger);\r\n        this.updateCacheEntries(serverAuthenticationRequest, account, false);\r\n        this.logger.verbosePii(\"RenewToken expected state: \" + serverAuthenticationRequest.state);\r\n        // Build urlNavigate with \"prompt=none\" and navigate to URL in hidden iFrame\r\n        var urlNavigate = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__[\"UrlUtils\"].urlRemoveQueryStringParameter(_utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__[\"UrlUtils\"].createNavigateUrl(serverAuthenticationRequest), _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].prompt) + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].prompt_none + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].response_mode_fragment;\r\n        window.renewStates.push(serverAuthenticationRequest.state);\r\n        window.requestType = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].renewToken;\r\n        this.logger.verbose(\"Set window.renewState and requestType\");\r\n        this.registerCallback(serverAuthenticationRequest.state, requestSignature, resolve, reject);\r\n        this.logger.infoPii(\"Navigate to: \" + urlNavigate);\r\n        this.loadIframeTimeout(urlNavigate, frameName, requestSignature).catch(function (error) { return reject(error); });\r\n    };\r\n    /**\r\n     * @hidden\r\n     * Renews idtoken for app's own backend when clientId is passed as a single scope in the scopes array.\r\n     * @ignore\r\n     */\r\n    UserAgentApplication.prototype.renewIdToken = function (requestSignature, resolve, reject, account, serverAuthenticationRequest) {\r\n        this.logger.info(\"RenewIdToken has been called\");\r\n        var frameName = _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__[\"WindowUtils\"].generateFrameName(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"FramePrefix\"].ID_TOKEN_FRAME, requestSignature);\r\n        _utils_WindowUtils__WEBPACK_IMPORTED_MODULE_11__[\"WindowUtils\"].addHiddenIFrame(frameName, this.logger);\r\n        this.updateCacheEntries(serverAuthenticationRequest, account, false);\r\n        this.logger.verbose(\"RenewIdToken expected state: \" + serverAuthenticationRequest.state);\r\n        // Build urlNavigate with \"prompt=none\" and navigate to URL in hidden iFrame\r\n        var urlNavigate = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__[\"UrlUtils\"].urlRemoveQueryStringParameter(_utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__[\"UrlUtils\"].createNavigateUrl(serverAuthenticationRequest), _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].prompt) + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].prompt_none + _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].response_mode_fragment;\r\n        if (this.silentLogin) {\r\n            this.logger.verbose(\"Silent login is true, set silentAuthenticationState\");\r\n            window.requestType = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].login;\r\n            this.silentAuthenticationState = serverAuthenticationRequest.state;\r\n        }\r\n        else {\r\n            this.logger.verbose(\"Not silent login, set window.renewState and requestType\");\r\n            window.requestType = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].renewToken;\r\n            window.renewStates.push(serverAuthenticationRequest.state);\r\n        }\r\n        // note: scope here is clientId\r\n        this.registerCallback(serverAuthenticationRequest.state, requestSignature, resolve, reject);\r\n        this.logger.infoPii(\"Navigate to:\\\" \" + urlNavigate);\r\n        this.loadIframeTimeout(urlNavigate, frameName, requestSignature).catch(function (error) { return reject(error); });\r\n    };\r\n    /**\r\n     * @hidden\r\n     *\r\n     * This method builds an Access Token Cache item and saves it to the cache, returning the original\r\n     * AuthResponse augmented with a parsed expiresOn attribute.\r\n     *\r\n     * @param response The AuthResponse object that contains the token to be saved\r\n     * @param authority The authority under which the ID token will be cached\r\n     * @param scopes The scopes to be added to the cache item key (undefined for ID token cache items)\r\n     * @param clientInfo Client Info object that is used to generate the homeAccountIdentifier\r\n     * @param expiration Token expiration timestamp\r\n     */\r\n    UserAgentApplication.prototype.saveToken = function (response, authority, scopes, clientInfo, expiration) {\r\n        var accessTokenKey = new _cache_AccessTokenKey__WEBPACK_IMPORTED_MODULE_1__[\"AccessTokenKey\"](authority, this.clientId, scopes, clientInfo.uid, clientInfo.utid);\r\n        var accessTokenValue = new _cache_AccessTokenValue__WEBPACK_IMPORTED_MODULE_2__[\"AccessTokenValue\"](response.accessToken, response.idToken.rawIdToken, expiration.toString(), clientInfo.encodeClientInfo());\r\n        this.cacheStorage.setItem(JSON.stringify(accessTokenKey), JSON.stringify(accessTokenValue));\r\n        if (expiration) {\r\n            this.logger.verbose(\"New expiration set for token\");\r\n            response.expiresOn = new Date(expiration * 1000);\r\n        }\r\n        else {\r\n            this.logger.error(\"Could not parse expiresIn parameter for access token\");\r\n        }\r\n        return response;\r\n    };\r\n    /**\r\n     * @hidden\r\n     *\r\n     * This method sets up the elements of an ID Token cache item and calls saveToken to save it in\r\n     * Access Token Cache item format for the client application to use.\r\n     *\r\n     * @param response The AuthResponse object that will be used to build the cache item\r\n     * @param authority The authority under which the ID token will be cached\r\n     * @param parameters The response's Hash Params, which contain the ID token returned from the server\r\n     * @param clientInfo Client Info object that is used to generate the homeAccountIdentifier\r\n     * @param idTokenObj ID Token object from which the ID token's expiration is extracted\r\n     */\r\n    /* tslint:disable:no-string-literal */\r\n    UserAgentApplication.prototype.saveIdToken = function (response, authority, parameters, clientInfo, idTokenObj) {\r\n        this.logger.verbose(\"SaveIdToken has been called\");\r\n        var idTokenResponse = tslib__WEBPACK_IMPORTED_MODULE_0__[\"__assign\"]({}, response);\r\n        // Scopes are undefined so they don't show up in ID token cache key\r\n        var scopes;\r\n        idTokenResponse.scopes = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].oidcScopes;\r\n        idTokenResponse.accessToken = parameters[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ID_TOKEN];\r\n        var expiration = Number(idTokenObj.expiration);\r\n        // Set ID Token item in cache\r\n        this.logger.verbose(\"Saving ID token to cache\");\r\n        return this.saveToken(idTokenResponse, authority, scopes, clientInfo, expiration);\r\n    };\r\n    /**\r\n     * @hidden\r\n     *\r\n     * This method sets up the elements of an Access Token cache item and calls saveToken to save it to the cache\r\n     *\r\n     * @param response The AuthResponse object that will be used to build the cache item\r\n     * @param authority The authority under which the access token will be cached\r\n     * @param parameters The response's Hash Params, which contain the access token returned from the server\r\n     * @param clientInfo Client Info object that is used to generate the homeAccountIdentifier\r\n     */\r\n    /* tslint:disable:no-string-literal */\r\n    UserAgentApplication.prototype.saveAccessToken = function (response, authority, parameters, clientInfo) {\r\n        this.logger.verbose(\"SaveAccessToken has been called\");\r\n        var accessTokenResponse = tslib__WEBPACK_IMPORTED_MODULE_0__[\"__assign\"]({}, response);\r\n        // read the scopes\r\n        var scope = parameters[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].SCOPE];\r\n        var consentedScopes = scope.split(\" \");\r\n        // retrieve all access tokens from the cache, remove the dup scopes\r\n        var accessTokenCacheItems = this.cacheStorage.getAllAccessTokens(this.clientId, authority);\r\n        this.logger.verbose(\"Retrieving all access tokens from cache and removing duplicates\");\r\n        for (var i = 0; i < accessTokenCacheItems.length; i++) {\r\n            var accessTokenCacheItem = accessTokenCacheItems[i];\r\n            if (accessTokenCacheItem.key.homeAccountIdentifier === response.account.homeAccountIdentifier) {\r\n                var cachedScopes = accessTokenCacheItem.key.scopes.split(\" \");\r\n                if (_ScopeSet__WEBPACK_IMPORTED_MODULE_9__[\"ScopeSet\"].isIntersectingScopes(cachedScopes, consentedScopes)) {\r\n                    this.cacheStorage.removeItem(JSON.stringify(accessTokenCacheItem.key));\r\n                }\r\n            }\r\n        }\r\n        accessTokenResponse.accessToken = parameters[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ACCESS_TOKEN];\r\n        accessTokenResponse.scopes = consentedScopes;\r\n        var expiresIn = _utils_TimeUtils__WEBPACK_IMPORTED_MODULE_13__[\"TimeUtils\"].parseExpiresIn(parameters[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].EXPIRES_IN]);\r\n        var parsedState = _utils_RequestUtils__WEBPACK_IMPORTED_MODULE_15__[\"RequestUtils\"].parseLibraryState(parameters[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].STATE]);\r\n        var expiration = parsedState.ts + expiresIn;\r\n        this.logger.verbose(\"Saving access token to cache\");\r\n        return this.saveToken(accessTokenResponse, authority, scope, clientInfo, expiration);\r\n    };\r\n    /**\r\n     * @hidden\r\n     * Saves token or error received in the response from AAD in the cache. In case of id_token, it also creates the account object.\r\n     * @ignore\r\n     */\r\n    UserAgentApplication.prototype.saveTokenFromHash = function (hash, stateInfo) {\r\n        this.logger.verbose(\"SaveTokenFromHash has been called\");\r\n        this.logger.info(\"State status: \" + stateInfo.stateMatch + \"; Request type: \" + stateInfo.requestType);\r\n        var response = {\r\n            uniqueId: \"\",\r\n            tenantId: \"\",\r\n            tokenType: \"\",\r\n            idToken: null,\r\n            idTokenClaims: null,\r\n            accessToken: null,\r\n            scopes: [],\r\n            expiresOn: null,\r\n            account: null,\r\n            accountState: \"\",\r\n            fromCache: false\r\n        };\r\n        var error;\r\n        var hashParams = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__[\"UrlUtils\"].deserializeHash(hash);\r\n        var authorityKey = \"\";\r\n        var acquireTokenAccountKey = \"\";\r\n        var idTokenObj = null;\r\n        // If server returns an error\r\n        if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ERROR_DESCRIPTION) || hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ERROR)) {\r\n            this.logger.verbose(\"Server returned an error\");\r\n            this.logger.infoPii(\"Error : \" + hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ERROR] + \"; Error description: \" + hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ERROR_DESCRIPTION]);\r\n            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ErrorCacheKeys\"].ERROR, hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ERROR]);\r\n            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ErrorCacheKeys\"].ERROR_DESC, hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ERROR_DESCRIPTION]);\r\n            // login\r\n            if (stateInfo.requestType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].login) {\r\n                this.logger.verbose(\"RequestType is login, caching login error, generating authorityKey\");\r\n                this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ErrorCacheKeys\"].LOGIN_ERROR, hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ERROR_DESCRIPTION] + \":\" + hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ERROR]);\r\n                authorityKey = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__[\"AuthCache\"].generateAuthorityKey(stateInfo.state);\r\n            }\r\n            // acquireToken\r\n            if (stateInfo.requestType === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].renewToken) {\r\n                this.logger.verbose(\"RequestType is renewToken, generating acquireTokenAccountKey\");\r\n                authorityKey = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__[\"AuthCache\"].generateAuthorityKey(stateInfo.state);\r\n                var account = this.getAccount();\r\n                var accountId = void 0;\r\n                if (account && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__[\"StringUtils\"].isEmpty(account.homeAccountIdentifier)) {\r\n                    accountId = account.homeAccountIdentifier;\r\n                    this.logger.verbose(\"AccountId is set\");\r\n                }\r\n                else {\r\n                    accountId = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].no_account;\r\n                    this.logger.verbose(\"AccountId is set as no_account\");\r\n                }\r\n                acquireTokenAccountKey = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__[\"AuthCache\"].generateAcquireTokenAccountKey(accountId, stateInfo.state);\r\n            }\r\n            var _a = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ERROR, hashErr = hashParams[_a], _b = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ERROR_DESCRIPTION, hashErrDesc = hashParams[_b];\r\n            if (_error_InteractionRequiredAuthError__WEBPACK_IMPORTED_MODULE_23__[\"InteractionRequiredAuthError\"].isInteractionRequiredError(hashErr) ||\r\n                _error_InteractionRequiredAuthError__WEBPACK_IMPORTED_MODULE_23__[\"InteractionRequiredAuthError\"].isInteractionRequiredError(hashErrDesc)) {\r\n                error = new _error_InteractionRequiredAuthError__WEBPACK_IMPORTED_MODULE_23__[\"InteractionRequiredAuthError\"](hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ERROR], hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ERROR_DESCRIPTION]);\r\n            }\r\n            else {\r\n                error = new _error_ServerError__WEBPACK_IMPORTED_MODULE_22__[\"ServerError\"](hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ERROR], hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ERROR_DESCRIPTION]);\r\n            }\r\n        }\r\n        // If the server returns \"Success\"\r\n        else {\r\n            this.logger.verbose(\"Server returns success\");\r\n            // Verify the state from redirect and record tokens to storage if exists\r\n            if (stateInfo.stateMatch) {\r\n                this.logger.info(\"State is right\");\r\n                if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].SESSION_STATE)) {\r\n                    this.logger.verbose(\"Fragment has session state, caching\");\r\n                    this.cacheStorage.setItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__[\"AuthCache\"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"TemporaryCacheKeys\"].SESSION_STATE, stateInfo.state), hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].SESSION_STATE]);\r\n                }\r\n                response.accountState = this.getAccountState(stateInfo.state);\r\n                var clientInfo = void 0;\r\n                // Process access_token\r\n                if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ACCESS_TOKEN)) {\r\n                    this.logger.info(\"Fragment has access token\");\r\n                    response.accessToken = hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ACCESS_TOKEN];\r\n                    if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].SCOPE)) {\r\n                        response.scopes = hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].SCOPE].split(\" \");\r\n                    }\r\n                    // retrieve the id_token from response if present\r\n                    if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ID_TOKEN)) {\r\n                        this.logger.verbose(\"Fragment has id_token\");\r\n                        idTokenObj = new _IdToken__WEBPACK_IMPORTED_MODULE_6__[\"IdToken\"](hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ID_TOKEN]);\r\n                    }\r\n                    else {\r\n                        this.logger.verbose(\"No idToken on fragment, getting idToken from cache\");\r\n                        idTokenObj = new _IdToken__WEBPACK_IMPORTED_MODULE_6__[\"IdToken\"](this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"PersistentCacheKeys\"].IDTOKEN));\r\n                    }\r\n                    response = _utils_ResponseUtils__WEBPACK_IMPORTED_MODULE_16__[\"ResponseUtils\"].setResponseIdToken(response, idTokenObj);\r\n                    // set authority\r\n                    var authority = this.populateAuthority(stateInfo.state, this.inCookie, this.cacheStorage, idTokenObj);\r\n                    this.logger.verbose(\"Got authority from cache\");\r\n                    // retrieve client_info - if it is not found, generate the uid and utid from idToken\r\n                    if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].CLIENT_INFO)) {\r\n                        this.logger.verbose(\"Fragment has clientInfo\");\r\n                        clientInfo = new _ClientInfo__WEBPACK_IMPORTED_MODULE_5__[\"ClientInfo\"](hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].CLIENT_INFO], authority);\r\n                    }\r\n                    else if (this.authorityInstance.AuthorityType === _authority_Authority__WEBPACK_IMPORTED_MODULE_4__[\"AuthorityType\"].Adfs) {\r\n                        clientInfo = _ClientInfo__WEBPACK_IMPORTED_MODULE_5__[\"ClientInfo\"].createClientInfoFromIdToken(idTokenObj, authority);\r\n                    }\r\n                    else {\r\n                        this.logger.warning(\"ClientInfo not received in the response from AAD\");\r\n                    }\r\n                    response.account = _Account__WEBPACK_IMPORTED_MODULE_8__[\"Account\"].createAccount(idTokenObj, clientInfo);\r\n                    this.logger.verbose(\"Account object created from response\");\r\n                    var accountKey = void 0;\r\n                    if (response.account && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__[\"StringUtils\"].isEmpty(response.account.homeAccountIdentifier)) {\r\n                        this.logger.verbose(\"AccountKey set\");\r\n                        accountKey = response.account.homeAccountIdentifier;\r\n                    }\r\n                    else {\r\n                        this.logger.verbose(\"AccountKey set as no_account\");\r\n                        accountKey = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].no_account;\r\n                    }\r\n                    acquireTokenAccountKey = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__[\"AuthCache\"].generateAcquireTokenAccountKey(accountKey, stateInfo.state);\r\n                    var acquireTokenAccountKey_noaccount = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__[\"AuthCache\"].generateAcquireTokenAccountKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].no_account, stateInfo.state);\r\n                    this.logger.verbose(\"AcquireTokenAccountKey generated\");\r\n                    var cachedAccount = this.cacheStorage.getItem(acquireTokenAccountKey);\r\n                    var acquireTokenAccount = void 0;\r\n                    // Check with the account in the Cache\r\n                    if (!_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__[\"StringUtils\"].isEmpty(cachedAccount)) {\r\n                        acquireTokenAccount = JSON.parse(cachedAccount);\r\n                        this.logger.verbose(\"AcquireToken request account retrieved from cache\");\r\n                        if (response.account && acquireTokenAccount && _Account__WEBPACK_IMPORTED_MODULE_8__[\"Account\"].compareAccounts(response.account, acquireTokenAccount)) {\r\n                            response = this.saveAccessToken(response, authority, hashParams, clientInfo);\r\n                            this.logger.info(\"The user object received in the response is the same as the one passed in the acquireToken request\");\r\n                        }\r\n                        else {\r\n                            this.logger.warning(\"The account object created from the response is not the same as the one passed in the acquireToken request\");\r\n                        }\r\n                    }\r\n                    else if (!_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__[\"StringUtils\"].isEmpty(this.cacheStorage.getItem(acquireTokenAccountKey_noaccount))) {\r\n                        this.logger.verbose(\"No acquireToken account retrieved from cache\");\r\n                        response = this.saveAccessToken(response, authority, hashParams, clientInfo);\r\n                    }\r\n                }\r\n                // Process id_token\r\n                if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ID_TOKEN)) {\r\n                    this.logger.info(\"Fragment has idToken\");\r\n                    // set the idToken\r\n                    idTokenObj = new _IdToken__WEBPACK_IMPORTED_MODULE_6__[\"IdToken\"](hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ID_TOKEN]);\r\n                    // set authority\r\n                    var authority = this.populateAuthority(stateInfo.state, this.inCookie, this.cacheStorage, idTokenObj);\r\n                    response = _utils_ResponseUtils__WEBPACK_IMPORTED_MODULE_16__[\"ResponseUtils\"].setResponseIdToken(response, idTokenObj);\r\n                    if (hashParams.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].CLIENT_INFO)) {\r\n                        this.logger.verbose(\"Fragment has clientInfo\");\r\n                        clientInfo = new _ClientInfo__WEBPACK_IMPORTED_MODULE_5__[\"ClientInfo\"](hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].CLIENT_INFO], authority);\r\n                    }\r\n                    else if (this.authorityInstance.AuthorityType === _authority_Authority__WEBPACK_IMPORTED_MODULE_4__[\"AuthorityType\"].Adfs) {\r\n                        clientInfo = _ClientInfo__WEBPACK_IMPORTED_MODULE_5__[\"ClientInfo\"].createClientInfoFromIdToken(idTokenObj, authority);\r\n                    }\r\n                    else {\r\n                        this.logger.warning(\"ClientInfo not received in the response from AAD\");\r\n                    }\r\n                    this.account = _Account__WEBPACK_IMPORTED_MODULE_8__[\"Account\"].createAccount(idTokenObj, clientInfo);\r\n                    response.account = this.account;\r\n                    this.logger.verbose(\"Account object created from response\");\r\n                    if (idTokenObj && idTokenObj.nonce) {\r\n                        this.logger.verbose(\"IdToken has nonce\");\r\n                        // check nonce integrity if idToken has nonce - throw an error if not matched\r\n                        var cachedNonce = this.cacheStorage.getItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__[\"AuthCache\"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"TemporaryCacheKeys\"].NONCE_IDTOKEN, stateInfo.state), this.inCookie);\r\n                        if (idTokenObj.nonce !== cachedNonce) {\r\n                            this.account = null;\r\n                            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ErrorCacheKeys\"].LOGIN_ERROR, \"Nonce Mismatch. Expected Nonce: \" + cachedNonce + \",\" + \"Actual Nonce: \" + idTokenObj.nonce);\r\n                            this.logger.error(\"Nonce Mismatch. Expected Nonce: \" + cachedNonce + \", Actual Nonce: \" + idTokenObj.nonce);\r\n                            error = _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__[\"ClientAuthError\"].createNonceMismatchError(cachedNonce, idTokenObj.nonce);\r\n                        }\r\n                        // Save the token\r\n                        else {\r\n                            this.logger.verbose(\"Nonce matches, saving idToken to cache\");\r\n                            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"PersistentCacheKeys\"].IDTOKEN, hashParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ServerHashParamKeys\"].ID_TOKEN], this.inCookie);\r\n                            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"PersistentCacheKeys\"].CLIENT_INFO, clientInfo.encodeClientInfo(), this.inCookie);\r\n                            // Save idToken as access token item for app itself\r\n                            this.saveIdToken(response, authority, hashParams, clientInfo, idTokenObj);\r\n                        }\r\n                    }\r\n                    else {\r\n                        this.logger.verbose(\"No idToken or no nonce. Cache key for Authority set as state\");\r\n                        authorityKey = stateInfo.state;\r\n                        acquireTokenAccountKey = stateInfo.state;\r\n                        this.logger.error(\"Invalid id_token received in the response\");\r\n                        error = _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__[\"ClientAuthError\"].createInvalidIdTokenError(idTokenObj);\r\n                        this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ErrorCacheKeys\"].ERROR, error.errorCode);\r\n                        this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ErrorCacheKeys\"].ERROR_DESC, error.errorMessage);\r\n                    }\r\n                }\r\n            }\r\n            // State mismatch - unexpected/invalid state\r\n            else {\r\n                this.logger.verbose(\"State mismatch\");\r\n                authorityKey = stateInfo.state;\r\n                acquireTokenAccountKey = stateInfo.state;\r\n                var expectedState = this.cacheStorage.getItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__[\"AuthCache\"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"TemporaryCacheKeys\"].STATE_LOGIN, stateInfo.state), this.inCookie);\r\n                this.logger.error(\"State Mismatch. Expected State: \" + expectedState + \", Actual State: \" + stateInfo.state);\r\n                error = _error_ClientAuthError__WEBPACK_IMPORTED_MODULE_21__[\"ClientAuthError\"].createInvalidStateError(stateInfo.state, expectedState);\r\n                this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ErrorCacheKeys\"].ERROR, error.errorCode);\r\n                this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"ErrorCacheKeys\"].ERROR_DESC, error.errorMessage);\r\n            }\r\n        }\r\n        // Set status to completed\r\n        this.cacheStorage.removeItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__[\"AuthCache\"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"TemporaryCacheKeys\"].RENEW_STATUS, stateInfo.state));\r\n        this.cacheStorage.resetTempCacheItems(stateInfo.state);\r\n        this.logger.verbose(\"Status set to complete, temporary cache cleared\");\r\n        // this is required if navigateToLoginRequestUrl=false\r\n        if (this.inCookie) {\r\n            this.logger.verbose(\"InCookie is true, setting authorityKey in cookie\");\r\n            this.cacheStorage.setItemCookie(authorityKey, \"\", -1);\r\n            this.cacheStorage.clearMsalCookie(stateInfo.state);\r\n        }\r\n        if (error) {\r\n            // Error case, set status to cancelled\r\n            throw error;\r\n        }\r\n        if (!response) {\r\n            throw _error_AuthError__WEBPACK_IMPORTED_MODULE_20__[\"AuthError\"].createUnexpectedError(\"Response is null\");\r\n        }\r\n        return response;\r\n    };\r\n    /**\r\n     * Set Authority when saving Token from the hash\r\n     * @param state\r\n     * @param inCookie\r\n     * @param cacheStorage\r\n     * @param idTokenObj\r\n     * @param response\r\n     */\r\n    UserAgentApplication.prototype.populateAuthority = function (state, inCookie, cacheStorage, idTokenObj) {\r\n        this.logger.verbose(\"PopulateAuthority has been called\");\r\n        var authorityKey = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__[\"AuthCache\"].generateAuthorityKey(state);\r\n        var cachedAuthority = cacheStorage.getItem(authorityKey, inCookie);\r\n        // retrieve the authority from cache and replace with tenantID\r\n        return _utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__[\"StringUtils\"].isEmpty(cachedAuthority) ? cachedAuthority : _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__[\"UrlUtils\"].replaceTenantPath(cachedAuthority, idTokenObj.tenantId);\r\n    };\r\n    /* tslint:enable:no-string-literal */\r\n    // #endregion\r\n    // #region Account\r\n    /**\r\n     * Returns the signed in account\r\n     * (the account object is created at the time of successful login)\r\n     * or null when no state is found\r\n     * @returns {@link Account} - the account object stored in MSAL\r\n     */\r\n    UserAgentApplication.prototype.getAccount = function () {\r\n        // if a session already exists, get the account from the session\r\n        if (this.account) {\r\n            return this.account;\r\n        }\r\n        // frame is used to get idToken and populate the account for the given session\r\n        var rawIdToken = this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"PersistentCacheKeys\"].IDTOKEN, this.inCookie);\r\n        var rawClientInfo = this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"PersistentCacheKeys\"].CLIENT_INFO, this.inCookie);\r\n        if (!_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__[\"StringUtils\"].isEmpty(rawIdToken) && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__[\"StringUtils\"].isEmpty(rawClientInfo)) {\r\n            var idToken = new _IdToken__WEBPACK_IMPORTED_MODULE_6__[\"IdToken\"](rawIdToken);\r\n            var clientInfo = new _ClientInfo__WEBPACK_IMPORTED_MODULE_5__[\"ClientInfo\"](rawClientInfo, \"\");\r\n            this.account = _Account__WEBPACK_IMPORTED_MODULE_8__[\"Account\"].createAccount(idToken, clientInfo);\r\n            return this.account;\r\n        }\r\n        // if login not yet done, return null\r\n        return null;\r\n    };\r\n    /**\r\n     * @hidden\r\n     *\r\n     * Extracts state value from the accountState sent with the authentication request.\r\n     * @returns {string} scope.\r\n     * @ignore\r\n     */\r\n    UserAgentApplication.prototype.getAccountState = function (state) {\r\n        if (state) {\r\n            var splitIndex = state.indexOf(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].resourceDelimiter);\r\n            if (splitIndex > -1 && splitIndex + 1 < state.length) {\r\n                return state.substring(splitIndex + 1);\r\n            }\r\n        }\r\n        return state;\r\n    };\r\n    /**\r\n     * Use to get a list of unique accounts in MSAL cache based on homeAccountIdentifier.\r\n     *\r\n     * @param {@link Array<Account>} Account - all unique accounts in MSAL cache.\r\n     */\r\n    UserAgentApplication.prototype.getAllAccounts = function () {\r\n        var accounts = [];\r\n        var accessTokenCacheItems = this.cacheStorage.getAllAccessTokens(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].clientId, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].homeAccountIdentifier);\r\n        for (var i = 0; i < accessTokenCacheItems.length; i++) {\r\n            var idToken = new _IdToken__WEBPACK_IMPORTED_MODULE_6__[\"IdToken\"](accessTokenCacheItems[i].value.idToken);\r\n            var clientInfo = new _ClientInfo__WEBPACK_IMPORTED_MODULE_5__[\"ClientInfo\"](accessTokenCacheItems[i].value.homeAccountIdentifier, \"\");\r\n            var account = _Account__WEBPACK_IMPORTED_MODULE_8__[\"Account\"].createAccount(idToken, clientInfo);\r\n            accounts.push(account);\r\n        }\r\n        return this.getUniqueAccounts(accounts);\r\n    };\r\n    /**\r\n     * @hidden\r\n     *\r\n     * Used to filter accounts based on homeAccountIdentifier\r\n     * @param {Array<Account>}  Accounts - accounts saved in the cache\r\n     * @ignore\r\n     */\r\n    UserAgentApplication.prototype.getUniqueAccounts = function (accounts) {\r\n        if (!accounts || accounts.length <= 1) {\r\n            return accounts;\r\n        }\r\n        var flags = [];\r\n        var uniqueAccounts = [];\r\n        for (var index = 0; index < accounts.length; ++index) {\r\n            if (accounts[index].homeAccountIdentifier && flags.indexOf(accounts[index].homeAccountIdentifier) === -1) {\r\n                flags.push(accounts[index].homeAccountIdentifier);\r\n                uniqueAccounts.push(accounts[index]);\r\n            }\r\n        }\r\n        return uniqueAccounts;\r\n    };\r\n    // #endregion\r\n    // #region Angular\r\n    /**\r\n     * @hidden\r\n     *\r\n     * Broadcast messages - Used only for Angular?  *\r\n     * @param eventName\r\n     * @param data\r\n     */\r\n    UserAgentApplication.prototype.broadcast = function (eventName, data) {\r\n        var evt = new CustomEvent(eventName, { detail: data });\r\n        window.dispatchEvent(evt);\r\n    };\r\n    /**\r\n     * @hidden\r\n     *\r\n     * Helper function to retrieve the cached token\r\n     *\r\n     * @param scopes\r\n     * @param {@link Account} account\r\n     * @param state\r\n     * @return {@link AuthResponse} AuthResponse\r\n     */\r\n    UserAgentApplication.prototype.getCachedTokenInternal = function (scopes, account, state, correlationId) {\r\n        // Get the current session's account object\r\n        var accountObject = account || this.getAccount();\r\n        if (!accountObject) {\r\n            return null;\r\n        }\r\n        // Construct AuthenticationRequest based on response type; set \"redirectUri\" from the \"request\" which makes this call from Angular - for this.getRedirectUri()\r\n        var newAuthority = this.authorityInstance ? this.authorityInstance : _authority_AuthorityFactory__WEBPACK_IMPORTED_MODULE_17__[\"AuthorityFactory\"].CreateInstance(this.authority, this.config.auth.validateAuthority);\r\n        var responseType = this.getTokenType(accountObject, scopes);\r\n        var serverAuthenticationRequest = new _ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__[\"ServerRequestParameters\"](newAuthority, this.clientId, responseType, this.getRedirectUri(), scopes, state, correlationId);\r\n        // get cached token\r\n        return this.getCachedToken(serverAuthenticationRequest, account);\r\n    };\r\n    /**\r\n     * @hidden\r\n     *\r\n     * Get scopes for the Endpoint - Used in Angular to track protected and unprotected resources without interaction from the developer app\r\n     * Note: Please check if we need to set the \"redirectUri\" from the \"request\" which makes this call from Angular - for this.getRedirectUri()\r\n     *\r\n     * @param endpoint\r\n     */\r\n    UserAgentApplication.prototype.getScopesForEndpoint = function (endpoint) {\r\n        // if user specified list of unprotectedResources, no need to send token to these endpoints, return null.\r\n        if (this.config.framework.unprotectedResources.length > 0) {\r\n            for (var i = 0; i < this.config.framework.unprotectedResources.length; i++) {\r\n                if (endpoint.indexOf(this.config.framework.unprotectedResources[i]) > -1) {\r\n                    return null;\r\n                }\r\n            }\r\n        }\r\n        // process all protected resources and send the matched one\r\n        if (this.config.framework.protectedResourceMap.size > 0) {\r\n            for (var _i = 0, _a = Array.from(this.config.framework.protectedResourceMap.keys()); _i < _a.length; _i++) {\r\n                var key = _a[_i];\r\n                // configEndpoint is like /api/Todo requested endpoint can be /api/Todo/1\r\n                if (endpoint.indexOf(key) > -1) {\r\n                    return this.config.framework.protectedResourceMap.get(key);\r\n                }\r\n            }\r\n        }\r\n        /*\r\n         * default resource will be clientid if nothing specified\r\n         * App will use idtoken for calls to itself\r\n         * check if it's staring from http or https, needs to match with app host\r\n         */\r\n        if (endpoint.indexOf(\"http://\") > -1 || endpoint.indexOf(\"https://\") > -1) {\r\n            if (_utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__[\"UrlUtils\"].getHostFromUri(endpoint) === _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__[\"UrlUtils\"].getHostFromUri(this.getRedirectUri())) {\r\n                return new Array(this.clientId);\r\n            }\r\n        }\r\n        else {\r\n            /*\r\n             * in angular level, the url for $http interceptor call could be relative url,\r\n             * if it's relative call, we'll treat it as app backend call.\r\n             */\r\n            return new Array(this.clientId);\r\n        }\r\n        // if not the app's own backend or not a domain listed in the endpoints structure\r\n        return null;\r\n    };\r\n    /**\r\n     * Return boolean flag to developer to help inform if login is in progress\r\n     * @returns {boolean} true/false\r\n     */\r\n    UserAgentApplication.prototype.getLoginInProgress = function () {\r\n        return this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"TemporaryCacheKeys\"].INTERACTION_STATUS) === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].inProgress;\r\n    };\r\n    /**\r\n     * @hidden\r\n     * @ignore\r\n     *\r\n     * @param loginInProgress\r\n     */\r\n    UserAgentApplication.prototype.setInteractionInProgress = function (inProgress) {\r\n        if (inProgress) {\r\n            this.cacheStorage.setItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"TemporaryCacheKeys\"].INTERACTION_STATUS, _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].inProgress);\r\n        }\r\n        else {\r\n            this.cacheStorage.removeItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"TemporaryCacheKeys\"].INTERACTION_STATUS);\r\n        }\r\n    };\r\n    /**\r\n     * @hidden\r\n     * @ignore\r\n     *\r\n     * @param loginInProgress\r\n     */\r\n    UserAgentApplication.prototype.setloginInProgress = function (loginInProgress) {\r\n        this.setInteractionInProgress(loginInProgress);\r\n    };\r\n    /**\r\n     * @hidden\r\n     * @ignore\r\n     *\r\n     * returns the status of acquireTokenInProgress\r\n     */\r\n    UserAgentApplication.prototype.getAcquireTokenInProgress = function () {\r\n        return this.cacheStorage.getItem(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"TemporaryCacheKeys\"].INTERACTION_STATUS) === _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].inProgress;\r\n    };\r\n    /**\r\n     * @hidden\r\n     * @ignore\r\n     *\r\n     * @param acquireTokenInProgress\r\n     */\r\n    UserAgentApplication.prototype.setAcquireTokenInProgress = function (acquireTokenInProgress) {\r\n        this.setInteractionInProgress(acquireTokenInProgress);\r\n    };\r\n    /**\r\n     * @hidden\r\n     * @ignore\r\n     *\r\n     * returns the logger handle\r\n     */\r\n    UserAgentApplication.prototype.getLogger = function () {\r\n        return this.logger;\r\n    };\r\n    /**\r\n     * Sets the logger callback.\r\n     * @param logger Logger callback\r\n     */\r\n    UserAgentApplication.prototype.setLogger = function (logger) {\r\n        this.logger = logger;\r\n    };\r\n    // #endregion\r\n    // #region Getters and Setters\r\n    /**\r\n     * Use to get the redirect uri configured in MSAL or null.\r\n     * Evaluates redirectUri if its a function, otherwise simply returns its value.\r\n     *\r\n     * @returns {string} redirect URL\r\n     */\r\n    UserAgentApplication.prototype.getRedirectUri = function (reqRedirectUri) {\r\n        if (reqRedirectUri) {\r\n            return reqRedirectUri;\r\n        }\r\n        else if (typeof this.config.auth.redirectUri === \"function\") {\r\n            return this.config.auth.redirectUri();\r\n        }\r\n        return this.config.auth.redirectUri;\r\n    };\r\n    /**\r\n     * Use to get the post logout redirect uri configured in MSAL or null.\r\n     * Evaluates postLogoutredirectUri if its a function, otherwise simply returns its value.\r\n     *\r\n     * @returns {string} post logout redirect URL\r\n     */\r\n    UserAgentApplication.prototype.getPostLogoutRedirectUri = function () {\r\n        if (typeof this.config.auth.postLogoutRedirectUri === \"function\") {\r\n            return this.config.auth.postLogoutRedirectUri();\r\n        }\r\n        return this.config.auth.postLogoutRedirectUri;\r\n    };\r\n    /**\r\n     * Use to get the current {@link Configuration} object in MSAL\r\n     *\r\n     * @returns {@link Configuration}\r\n     */\r\n    UserAgentApplication.prototype.getCurrentConfiguration = function () {\r\n        if (!this.config) {\r\n            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_19__[\"ClientConfigurationError\"].createNoSetConfigurationError();\r\n        }\r\n        return this.config;\r\n    };\r\n    /**\r\n     * @ignore\r\n     *\r\n     * Utils function to create the Authentication\r\n     * @param {@link account} account object\r\n     * @param scopes\r\n     *\r\n     * @returns {string} token type: token, id_token or id_token token\r\n     *\r\n     */\r\n    UserAgentApplication.prototype.getTokenType = function (accountObject, scopes) {\r\n        var accountsMatch = _Account__WEBPACK_IMPORTED_MODULE_8__[\"Account\"].compareAccounts(accountObject, this.getAccount());\r\n        return _ServerRequestParameters__WEBPACK_IMPORTED_MODULE_3__[\"ServerRequestParameters\"].determineResponseType(accountsMatch, scopes);\r\n    };\r\n    /**\r\n     * @hidden\r\n     * @ignore\r\n     *\r\n     * Sets the cachekeys for and stores the account information in cache\r\n     * @param account\r\n     * @param state\r\n     * @hidden\r\n     */\r\n    UserAgentApplication.prototype.setAccountCache = function (account, state) {\r\n        // Cache acquireTokenAccountKey\r\n        var accountId = account ? this.getAccountId(account) : _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].no_account;\r\n        var acquireTokenAccountKey = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__[\"AuthCache\"].generateAcquireTokenAccountKey(accountId, state);\r\n        this.cacheStorage.setItem(acquireTokenAccountKey, JSON.stringify(account));\r\n    };\r\n    /**\r\n     * @hidden\r\n     * @ignore\r\n     *\r\n     * Sets the cacheKey for and stores the authority information in cache\r\n     * @param state\r\n     * @param authority\r\n     * @hidden\r\n     */\r\n    UserAgentApplication.prototype.setAuthorityCache = function (state, authority) {\r\n        // Cache authorityKey\r\n        var authorityKey = _cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__[\"AuthCache\"].generateAuthorityKey(state);\r\n        this.cacheStorage.setItem(authorityKey, _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_14__[\"UrlUtils\"].CanonicalizeUri(authority), this.inCookie);\r\n    };\r\n    /**\r\n     * Updates account, authority, and nonce in cache\r\n     * @param serverAuthenticationRequest\r\n     * @param account\r\n     * @hidden\r\n     * @ignore\r\n     */\r\n    UserAgentApplication.prototype.updateCacheEntries = function (serverAuthenticationRequest, account, isLoginCall, loginStartPage) {\r\n        // Cache Request Originator Page\r\n        if (loginStartPage) {\r\n            this.cacheStorage.setItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__[\"AuthCache\"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"TemporaryCacheKeys\"].LOGIN_REQUEST, serverAuthenticationRequest.state), loginStartPage, this.inCookie);\r\n        }\r\n        // Cache account and authority\r\n        if (isLoginCall) {\r\n            // Cache the state\r\n            this.cacheStorage.setItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__[\"AuthCache\"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"TemporaryCacheKeys\"].STATE_LOGIN, serverAuthenticationRequest.state), serverAuthenticationRequest.state, this.inCookie);\r\n        }\r\n        else {\r\n            this.setAccountCache(account, serverAuthenticationRequest.state);\r\n        }\r\n        // Cache authorityKey\r\n        this.setAuthorityCache(serverAuthenticationRequest.state, serverAuthenticationRequest.authority);\r\n        // Cache nonce\r\n        this.cacheStorage.setItem(_cache_AuthCache__WEBPACK_IMPORTED_MODULE_7__[\"AuthCache\"].generateTemporaryCacheKey(_utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"TemporaryCacheKeys\"].NONCE_IDTOKEN, serverAuthenticationRequest.state), serverAuthenticationRequest.nonce, this.inCookie);\r\n    };\r\n    /**\r\n     * Returns the unique identifier for the logged in account\r\n     * @param account\r\n     * @hidden\r\n     * @ignore\r\n     */\r\n    UserAgentApplication.prototype.getAccountId = function (account) {\r\n        // return `${account.accountIdentifier}` + Constants.resourceDelimiter + `${account.homeAccountIdentifier}`;\r\n        var accountId;\r\n        if (!_utils_StringUtils__WEBPACK_IMPORTED_MODULE_10__[\"StringUtils\"].isEmpty(account.homeAccountIdentifier)) {\r\n            accountId = account.homeAccountIdentifier;\r\n        }\r\n        else {\r\n            accountId = _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].no_account;\r\n        }\r\n        return accountId;\r\n    };\r\n    /**\r\n     * @ignore\r\n     * @param extraQueryParameters\r\n     *\r\n     * Construct 'tokenRequest' from the available data in adalIdToken\r\n     */\r\n    UserAgentApplication.prototype.buildIDTokenRequest = function (request) {\r\n        var tokenRequest = {\r\n            scopes: _utils_Constants__WEBPACK_IMPORTED_MODULE_27__[\"Constants\"].oidcScopes,\r\n            authority: this.authority,\r\n            account: this.getAccount(),\r\n            extraQueryParameters: request.extraQueryParameters,\r\n            correlationId: request.correlationId\r\n        };\r\n        return tokenRequest;\r\n    };\r\n    /**\r\n     * @ignore\r\n     * @param config\r\n     * @param clientId\r\n     *\r\n     * Construct TelemetryManager from Configuration\r\n     */\r\n    UserAgentApplication.prototype.getTelemetryManagerFromConfig = function (config, clientId) {\r\n        if (!config) { // if unset\r\n            return _telemetry_TelemetryManager__WEBPACK_IMPORTED_MODULE_25__[\"default\"].getTelemetrymanagerStub(clientId, this.logger);\r\n        }\r\n        // if set then validate\r\n        var applicationName = config.applicationName, applicationVersion = config.applicationVersion, telemetryEmitter = config.telemetryEmitter;\r\n        if (!applicationName || !applicationVersion || !telemetryEmitter) {\r\n            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_19__[\"ClientConfigurationError\"].createTelemetryConfigError(config);\r\n        }\r\n        // if valid then construct\r\n        var telemetryPlatform = {\r\n            applicationName: applicationName,\r\n            applicationVersion: applicationVersion\r\n        };\r\n        var telemetryManagerConfig = {\r\n            platform: telemetryPlatform,\r\n            clientId: clientId\r\n        };\r\n        return new _telemetry_TelemetryManager__WEBPACK_IMPORTED_MODULE_25__[\"default\"](telemetryManagerConfig, telemetryEmitter, this.logger);\r\n    };\r\n    return UserAgentApplication;\r\n}());\r\n\r\n//# sourceMappingURL=UserAgentApplication.js.map\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! promise-polyfill */ \"B/eG\")[\"default\"]))//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiWkVTNS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tc2FsL2xpYi1lczYvVXNlckFnZW50QXBwbGljYXRpb24uanM/NjQ0NCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKi9cclxuaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgQWNjZXNzVG9rZW5LZXkgfSBmcm9tIFwiLi9jYWNoZS9BY2Nlc3NUb2tlbktleVwiO1xyXG5pbXBvcnQgeyBBY2Nlc3NUb2tlblZhbHVlIH0gZnJvbSBcIi4vY2FjaGUvQWNjZXNzVG9rZW5WYWx1ZVwiO1xyXG5pbXBvcnQgeyBTZXJ2ZXJSZXF1ZXN0UGFyYW1ldGVycyB9IGZyb20gXCIuL1NlcnZlclJlcXVlc3RQYXJhbWV0ZXJzXCI7XHJcbmltcG9ydCB7IEF1dGhvcml0eVR5cGUgfSBmcm9tIFwiLi9hdXRob3JpdHkvQXV0aG9yaXR5XCI7XHJcbmltcG9ydCB7IENsaWVudEluZm8gfSBmcm9tIFwiLi9DbGllbnRJbmZvXCI7XHJcbmltcG9ydCB7IElkVG9rZW4gfSBmcm9tIFwiLi9JZFRva2VuXCI7XHJcbmltcG9ydCB7IEF1dGhDYWNoZSB9IGZyb20gXCIuL2NhY2hlL0F1dGhDYWNoZVwiO1xyXG5pbXBvcnQgeyBBY2NvdW50IH0gZnJvbSBcIi4vQWNjb3VudFwiO1xyXG5pbXBvcnQgeyBTY29wZVNldCB9IGZyb20gXCIuL1Njb3BlU2V0XCI7XHJcbmltcG9ydCB7IFN0cmluZ1V0aWxzIH0gZnJvbSBcIi4vdXRpbHMvU3RyaW5nVXRpbHNcIjtcclxuaW1wb3J0IHsgV2luZG93VXRpbHMgfSBmcm9tIFwiLi91dGlscy9XaW5kb3dVdGlsc1wiO1xyXG5pbXBvcnQgeyBUb2tlblV0aWxzIH0gZnJvbSBcIi4vdXRpbHMvVG9rZW5VdGlsc1wiO1xyXG5pbXBvcnQgeyBUaW1lVXRpbHMgfSBmcm9tIFwiLi91dGlscy9UaW1lVXRpbHNcIjtcclxuaW1wb3J0IHsgVXJsVXRpbHMgfSBmcm9tIFwiLi91dGlscy9VcmxVdGlsc1wiO1xyXG5pbXBvcnQgeyBSZXF1ZXN0VXRpbHMgfSBmcm9tIFwiLi91dGlscy9SZXF1ZXN0VXRpbHNcIjtcclxuaW1wb3J0IHsgUmVzcG9uc2VVdGlscyB9IGZyb20gXCIuL3V0aWxzL1Jlc3BvbnNlVXRpbHNcIjtcclxuaW1wb3J0IHsgQXV0aG9yaXR5RmFjdG9yeSB9IGZyb20gXCIuL2F1dGhvcml0eS9BdXRob3JpdHlGYWN0b3J5XCI7XHJcbmltcG9ydCB7IGJ1aWxkQ29uZmlndXJhdGlvbiB9IGZyb20gXCIuL0NvbmZpZ3VyYXRpb25cIjtcclxuaW1wb3J0IHsgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yIH0gZnJvbSBcIi4vZXJyb3IvQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yXCI7XHJcbmltcG9ydCB7IEF1dGhFcnJvciB9IGZyb20gXCIuL2Vycm9yL0F1dGhFcnJvclwiO1xyXG5pbXBvcnQgeyBDbGllbnRBdXRoRXJyb3IsIENsaWVudEF1dGhFcnJvck1lc3NhZ2UgfSBmcm9tIFwiLi9lcnJvci9DbGllbnRBdXRoRXJyb3JcIjtcclxuaW1wb3J0IHsgU2VydmVyRXJyb3IgfSBmcm9tIFwiLi9lcnJvci9TZXJ2ZXJFcnJvclwiO1xyXG5pbXBvcnQgeyBJbnRlcmFjdGlvblJlcXVpcmVkQXV0aEVycm9yIH0gZnJvbSBcIi4vZXJyb3IvSW50ZXJhY3Rpb25SZXF1aXJlZEF1dGhFcnJvclwiO1xyXG5pbXBvcnQgeyBidWlsZFJlc3BvbnNlU3RhdGVPbmx5IH0gZnJvbSBcIi4vQXV0aFJlc3BvbnNlXCI7XHJcbmltcG9ydCBUZWxlbWV0cnlNYW5hZ2VyIGZyb20gXCIuL3RlbGVtZXRyeS9UZWxlbWV0cnlNYW5hZ2VyXCI7XHJcbmltcG9ydCB7IEFQSV9FVkVOVF9JREVOVElGSUVSIH0gZnJvbSBcIi4vdGVsZW1ldHJ5L0FwaUV2ZW50XCI7XHJcbmltcG9ydCB7IENvbnN0YW50cywgU2VydmVySGFzaFBhcmFtS2V5cywgUmVzcG9uc2VUeXBlcywgVGVtcG9yYXJ5Q2FjaGVLZXlzLCBQZXJzaXN0ZW50Q2FjaGVLZXlzLCBFcnJvckNhY2hlS2V5cywgRnJhbWVQcmVmaXggfSBmcm9tIFwiLi91dGlscy9Db25zdGFudHNcIjtcclxuaW1wb3J0IHsgQ3J5cHRvVXRpbHMgfSBmcm9tIFwiLi91dGlscy9DcnlwdG9VdGlsc1wiO1xyXG5pbXBvcnQgeyBUcnVzdGVkQXV0aG9yaXR5IH0gZnJvbSBcIi4vYXV0aG9yaXR5L1RydXN0ZWRBdXRob3JpdHlcIjtcclxuaW1wb3J0IHsgQXV0aENhY2hlVXRpbHMgfSBmcm9tIFwiLi91dGlscy9BdXRoQ2FjaGVVdGlsc1wiO1xyXG4vLyBkZWZhdWx0IGF1dGhvcml0eVxyXG52YXIgREVGQVVMVF9BVVRIT1JJVFkgPSBcImh0dHBzOi8vbG9naW4ubWljcm9zb2Z0b25saW5lLmNvbS9jb21tb25cIjtcclxuLyoqXHJcbiAqIFVzZXJBZ2VudEFwcGxpY2F0aW9uIGNsYXNzXHJcbiAqXHJcbiAqIE9iamVjdCBJbnN0YW5jZSB0aGF0IHRoZSBkZXZlbG9wZXIgY2FuIHVzZSB0byBtYWtlIGxvZ2luWFggT1IgYWNxdWlyZVRva2VuWFggZnVuY3Rpb25zXHJcbiAqL1xyXG52YXIgVXNlckFnZW50QXBwbGljYXRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XHJcbiAgICAvKipcclxuICAgICAqIEBjb25zdHJ1Y3RvclxyXG4gICAgICogQ29uc3RydWN0b3IgZm9yIHRoZSBVc2VyQWdlbnRBcHBsaWNhdGlvbiB1c2VkIHRvIGluc3RhbnRpYXRlIHRoZSBVc2VyQWdlbnRBcHBsaWNhdGlvbiBvYmplY3RcclxuICAgICAqXHJcbiAgICAgKiBJbXBvcnRhbnQgYXR0cmlidXRlcyBpbiB0aGUgQ29uZmlndXJhdGlvbiBvYmplY3QgZm9yIGF1dGggYXJlOlxyXG4gICAgICogLSBjbGllbnRJRDogdGhlIGFwcGxpY2F0aW9uIElEIG9mIHlvdXIgYXBwbGljYXRpb24uXHJcbiAgICAgKiBZb3UgY2FuIG9idGFpbiBvbmUgYnkgcmVnaXN0ZXJpbmcgeW91ciBhcHBsaWNhdGlvbiB3aXRoIG91ciBBcHBsaWNhdGlvbiByZWdpc3RyYXRpb24gcG9ydGFsIDogaHR0cHM6Ly9wb3J0YWwuYXp1cmUuY29tLyNibGFkZS9NaWNyb3NvZnRfQUFEX0lBTS9BY3RpdmVEaXJlY3RvcnlNZW51QmxhZGUvUmVnaXN0ZXJlZEFwcHNQcmV2aWV3XHJcbiAgICAgKiAtIGF1dGhvcml0eTogdGhlIGF1dGhvcml0eSBVUkwgZm9yIHlvdXIgYXBwbGljYXRpb24uXHJcbiAgICAgKlxyXG4gICAgICogSW4gQXp1cmUgQUQsIGF1dGhvcml0eSBpcyBhIFVSTCBpbmRpY2F0aW5nIHRoZSBBenVyZSBhY3RpdmUgZGlyZWN0b3J5IHRoYXQgTVNBTCB1c2VzIHRvIG9idGFpbiB0b2tlbnMuXHJcbiAgICAgKiBJdCBpcyBvZiB0aGUgZm9ybSBodHRwczovL2xvZ2luLm1pY3Jvc29mdG9ubGluZS5jb20vJmx0O0VudGVyX3RoZV9UZW5hbnRfSW5mb19IZXJlJmd0Oy5cclxuICAgICAqIElmIHlvdXIgYXBwbGljYXRpb24gc3VwcG9ydHMgQWNjb3VudHMgaW4gb25lIG9yZ2FuaXphdGlvbmFsIGRpcmVjdG9yeSwgcmVwbGFjZSBcIkVudGVyX3RoZV9UZW5hbnRfSW5mb19IZXJlXCIgdmFsdWUgd2l0aCB0aGUgVGVuYW50IElkIG9yIFRlbmFudCBuYW1lIChmb3IgZXhhbXBsZSwgY29udG9zby5taWNyb3NvZnQuY29tKS5cclxuICAgICAqIElmIHlvdXIgYXBwbGljYXRpb24gc3VwcG9ydHMgQWNjb3VudHMgaW4gYW55IG9yZ2FuaXphdGlvbmFsIGRpcmVjdG9yeSwgcmVwbGFjZSBcIkVudGVyX3RoZV9UZW5hbnRfSW5mb19IZXJlXCIgdmFsdWUgd2l0aCBvcmdhbml6YXRpb25zLlxyXG4gICAgICogSWYgeW91ciBhcHBsaWNhdGlvbiBzdXBwb3J0cyBBY2NvdW50cyBpbiBhbnkgb3JnYW5pemF0aW9uYWwgZGlyZWN0b3J5IGFuZCBwZXJzb25hbCBNaWNyb3NvZnQgYWNjb3VudHMsIHJlcGxhY2UgXCJFbnRlcl90aGVfVGVuYW50X0luZm9fSGVyZVwiIHZhbHVlIHdpdGggY29tbW9uLlxyXG4gICAgICogVG8gcmVzdHJpY3Qgc3VwcG9ydCB0byBQZXJzb25hbCBNaWNyb3NvZnQgYWNjb3VudHMgb25seSwgcmVwbGFjZSBcIkVudGVyX3RoZV9UZW5hbnRfSW5mb19IZXJlXCIgdmFsdWUgd2l0aCBjb25zdW1lcnMuXHJcbiAgICAgKlxyXG4gICAgICpcclxuICAgICAqIEluIEF6dXJlIEIyQywgYXV0aG9yaXR5IGlzIG9mIHRoZSBmb3JtIGh0dHBzOi8vJmx0O2luc3RhbmNlJmd0Oy90ZnAvJmx0O3RlbmFudCZndDsvJmx0O3BvbGljeU5hbWUmZ3Q7L1xyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7QGxpbmsgKENvbmZpZ3VyYXRpb246dHlwZSl9IGNvbmZpZ3VyYXRpb24gb2JqZWN0IGZvciB0aGUgTVNBTCBVc2VyQWdlbnRBcHBsaWNhdGlvbiBpbnN0YW5jZVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBVc2VyQWdlbnRBcHBsaWNhdGlvbihjb25maWd1cmF0aW9uKSB7XHJcbiAgICAgICAgLy8gY2FsbGJhY2tzIGZvciB0b2tlbi9lcnJvclxyXG4gICAgICAgIHRoaXMuYXV0aFJlc3BvbnNlQ2FsbGJhY2sgPSBudWxsO1xyXG4gICAgICAgIHRoaXMudG9rZW5SZWNlaXZlZENhbGxiYWNrID0gbnVsbDtcclxuICAgICAgICB0aGlzLmVycm9yUmVjZWl2ZWRDYWxsYmFjayA9IG51bGw7XHJcbiAgICAgICAgLy8gU2V0IHRoZSBDb25maWd1cmF0aW9uXHJcbiAgICAgICAgdGhpcy5jb25maWcgPSBidWlsZENvbmZpZ3VyYXRpb24oY29uZmlndXJhdGlvbik7XHJcbiAgICAgICAgdGhpcy5sb2dnZXIgPSB0aGlzLmNvbmZpZy5zeXN0ZW0ubG9nZ2VyO1xyXG4gICAgICAgIHRoaXMuY2xpZW50SWQgPSB0aGlzLmNvbmZpZy5hdXRoLmNsaWVudElkO1xyXG4gICAgICAgIHRoaXMuaW5Db29raWUgPSB0aGlzLmNvbmZpZy5jYWNoZS5zdG9yZUF1dGhTdGF0ZUluQ29va2llO1xyXG4gICAgICAgIHRoaXMudGVsZW1ldHJ5TWFuYWdlciA9IHRoaXMuZ2V0VGVsZW1ldHJ5TWFuYWdlckZyb21Db25maWcodGhpcy5jb25maWcuc3lzdGVtLnRlbGVtZXRyeSwgdGhpcy5jbGllbnRJZCk7XHJcbiAgICAgICAgVHJ1c3RlZEF1dGhvcml0eS5zZXRUcnVzdGVkQXV0aG9yaXRpZXNGcm9tQ29uZmlnKHRoaXMuY29uZmlnLmF1dGgudmFsaWRhdGVBdXRob3JpdHksIHRoaXMuY29uZmlnLmF1dGgua25vd25BdXRob3JpdGllcyk7XHJcbiAgICAgICAgQXV0aG9yaXR5RmFjdG9yeS5zYXZlTWV0YWRhdGFGcm9tQ29uZmlnKHRoaXMuY29uZmlnLmF1dGguYXV0aG9yaXR5LCB0aGlzLmNvbmZpZy5hdXRoLmF1dGhvcml0eU1ldGFkYXRhKTtcclxuICAgICAgICAvLyBpZiBubyBhdXRob3JpdHkgaXMgcGFzc2VkLCBzZXQgdGhlIGRlZmF1bHQ6IFwiaHR0cHM6Ly9sb2dpbi5taWNyb3NvZnRvbmxpbmUuY29tL2NvbW1vblwiXHJcbiAgICAgICAgdGhpcy5hdXRob3JpdHkgPSB0aGlzLmNvbmZpZy5hdXRoLmF1dGhvcml0eSB8fCBERUZBVUxUX0FVVEhPUklUWTtcclxuICAgICAgICAvLyBjYWNoZSBrZXlzIG1zYWwgLSB0eXBlc2NyaXB0IHRocm93cyBhbiBlcnJvciBpZiBhbnkgdmFsdWUgb3RoZXIgdGhhbiBcImxvY2FsU3RvcmFnZVwiIG9yIFwic2Vzc2lvblN0b3JhZ2VcIiBpcyBwYXNzZWRcclxuICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZSA9IG5ldyBBdXRoQ2FjaGUodGhpcy5jbGllbnRJZCwgdGhpcy5jb25maWcuY2FjaGUuY2FjaGVMb2NhdGlvbiwgdGhpcy5pbkNvb2tpZSk7XHJcbiAgICAgICAgLy8gSW5pdGlhbGl6ZSB3aW5kb3cgaGFuZGxpbmcgY29kZVxyXG4gICAgICAgIHdpbmRvdy5hY3RpdmVSZW5ld2FscyA9IHt9O1xyXG4gICAgICAgIHdpbmRvdy5yZW5ld1N0YXRlcyA9IFtdO1xyXG4gICAgICAgIHdpbmRvdy5jYWxsYmFja01hcHBlZFRvUmVuZXdTdGF0ZXMgPSB7fTtcclxuICAgICAgICB3aW5kb3cucHJvbWlzZU1hcHBlZFRvUmVuZXdTdGF0ZXMgPSB7fTtcclxuICAgICAgICB3aW5kb3cubXNhbCA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHVybEhhc2ggPSB3aW5kb3cubG9jYXRpb24uaGFzaDtcclxuICAgICAgICB2YXIgdXJsQ29udGFpbnNIYXNoID0gVXJsVXRpbHMudXJsQ29udGFpbnNIYXNoKHVybEhhc2gpO1xyXG4gICAgICAgIC8vIGNoZWNrIGlmIGJhY2sgYnV0dG9uIGlzIHByZXNzZWRcclxuICAgICAgICBXaW5kb3dVdGlscy5jaGVja0lmQmFja0J1dHRvbklzUHJlc3NlZCh0aGlzLmNhY2hlU3RvcmFnZSk7XHJcbiAgICAgICAgLy8gT24gdGhlIHNlcnZlciAzMDIgLSBSZWRpcmVjdCwgaGFuZGxlIHRoaXNcclxuICAgICAgICBpZiAodXJsQ29udGFpbnNIYXNoKSB7XHJcbiAgICAgICAgICAgIHZhciBzdGF0ZUluZm8gPSB0aGlzLmdldFJlc3BvbnNlU3RhdGUodXJsSGFzaCk7XHJcbiAgICAgICAgICAgIGlmIChzdGF0ZUluZm8ubWV0aG9kID09PSBDb25zdGFudHMuaW50ZXJhY3Rpb25UeXBlUmVkaXJlY3QpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlUmVkaXJlY3RBdXRoZW50aWNhdGlvblJlc3BvbnNlKHVybEhhc2gpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFVzZXJBZ2VudEFwcGxpY2F0aW9uLnByb3RvdHlwZSwgXCJhdXRob3JpdHlcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIE1ldGhvZCB0byBtYW5hZ2UgdGhlIGF1dGhvcml0eSBVUkwuXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBhdXRob3JpdHlcclxuICAgICAgICAgKi9cclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXV0aG9yaXR5SW5zdGFuY2UuQ2Fub25pY2FsQXV0aG9yaXR5O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogc2V0dGVyIGZvciB0aGUgYXV0aG9yaXR5IFVSTFxyXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhdXRob3JpdHlcclxuICAgICAgICAgKi9cclxuICAgICAgICAvLyBJZiB0aGUgZGV2ZWxvcGVyIHBhc3NlcyBhbiBhdXRob3JpdHksIGNyZWF0ZSBhbiBpbnN0YW5jZVxyXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbCkge1xyXG4gICAgICAgICAgICB0aGlzLmF1dGhvcml0eUluc3RhbmNlID0gQXV0aG9yaXR5RmFjdG9yeS5DcmVhdGVJbnN0YW5jZSh2YWwsIHRoaXMuY29uZmlnLmF1dGgudmFsaWRhdGVBdXRob3JpdHkpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgdGhlIGN1cnJlbnQgYXV0aG9yaXR5IGluc3RhbmNlIGZyb20gdGhlIE1TQUwgY29uZmlndXJhdGlvbiBvYmplY3RcclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJucyB7QGxpbmsgQXV0aG9yaXR5fSBhdXRob3JpdHkgaW5zdGFuY2VcclxuICAgICAqL1xyXG4gICAgVXNlckFnZW50QXBwbGljYXRpb24ucHJvdG90eXBlLmdldEF1dGhvcml0eUluc3RhbmNlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmF1dGhvcml0eUluc3RhbmNlO1xyXG4gICAgfTtcclxuICAgIFVzZXJBZ2VudEFwcGxpY2F0aW9uLnByb3RvdHlwZS5oYW5kbGVSZWRpcmVjdENhbGxiYWNrID0gZnVuY3Rpb24gKGF1dGhPclRva2VuQ2FsbGJhY2ssIGVycm9yUmVjZWl2ZWRDYWxsYmFjaykge1xyXG4gICAgICAgIGlmICghYXV0aE9yVG9rZW5DYWxsYmFjaykge1xyXG4gICAgICAgICAgICB0aHJvdyBDbGllbnRDb25maWd1cmF0aW9uRXJyb3IuY3JlYXRlSW52YWxpZENhbGxiYWNrT2JqZWN0RXJyb3IoYXV0aE9yVG9rZW5DYWxsYmFjayk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFNldCBjYWxsYmFja3NcclxuICAgICAgICBpZiAoZXJyb3JSZWNlaXZlZENhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgIHRoaXMudG9rZW5SZWNlaXZlZENhbGxiYWNrID0gYXV0aE9yVG9rZW5DYWxsYmFjaztcclxuICAgICAgICAgICAgdGhpcy5lcnJvclJlY2VpdmVkQ2FsbGJhY2sgPSBlcnJvclJlY2VpdmVkQ2FsbGJhY2s7XHJcbiAgICAgICAgICAgIHRoaXMubG9nZ2VyLndhcm5pbmcoXCJUaGlzIG92ZXJsb2FkIGZvciBjYWxsYmFjayBpcyBkZXByZWNhdGVkIC0gcGxlYXNlIGNoYW5nZSB0aGUgZm9ybWF0IG9mIHRoZSBjYWxsYmFja3MgdG8gYSBzaW5nbGUgY2FsbGJhY2sgYXMgc2hvd246IChlcnI6IEF1dGhFcnJvciwgcmVzcG9uc2U6IEF1dGhSZXNwb25zZSkuXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5hdXRoUmVzcG9uc2VDYWxsYmFjayA9IGF1dGhPclRva2VuQ2FsbGJhY2s7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnJlZGlyZWN0RXJyb3IpIHtcclxuICAgICAgICAgICAgdGhpcy5hdXRoRXJyb3JIYW5kbGVyKENvbnN0YW50cy5pbnRlcmFjdGlvblR5cGVSZWRpcmVjdCwgdGhpcy5yZWRpcmVjdEVycm9yLCB0aGlzLnJlZGlyZWN0UmVzcG9uc2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0aGlzLnJlZGlyZWN0UmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgdGhpcy5hdXRoUmVzcG9uc2VIYW5kbGVyKENvbnN0YW50cy5pbnRlcmFjdGlvblR5cGVSZWRpcmVjdCwgdGhpcy5yZWRpcmVjdFJlc3BvbnNlKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBQdWJsaWMgQVBJIHRvIHZlcmlmeSBpZiB0aGUgVVJMIGNvbnRhaW5zIHRoZSBoYXNoIHdpdGgga25vd24gcHJvcGVydGllc1xyXG4gICAgICogQHBhcmFtIGhhc2hcclxuICAgICAqL1xyXG4gICAgVXNlckFnZW50QXBwbGljYXRpb24ucHJvdG90eXBlLnVybENvbnRhaW5zSGFzaCA9IGZ1bmN0aW9uIChoYXNoKSB7XHJcbiAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIlVybENvbnRhaW5zSGFzaCBoYXMgYmVlbiBjYWxsZWRcIik7XHJcbiAgICAgICAgcmV0dXJuIFVybFV0aWxzLnVybENvbnRhaW5zSGFzaChoYXNoKTtcclxuICAgIH07XHJcbiAgICBVc2VyQWdlbnRBcHBsaWNhdGlvbi5wcm90b3R5cGUuYXV0aFJlc3BvbnNlSGFuZGxlciA9IGZ1bmN0aW9uIChpbnRlcmFjdGlvblR5cGUsIHJlc3BvbnNlLCByZXNvbHZlKSB7XHJcbiAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIkF1dGhSZXNwb25zZUhhbmRsZXIgaGFzIGJlZW4gY2FsbGVkXCIpO1xyXG4gICAgICAgIGlmIChpbnRlcmFjdGlvblR5cGUgPT09IENvbnN0YW50cy5pbnRlcmFjdGlvblR5cGVSZWRpcmVjdCkge1xyXG4gICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiSW50ZXJhY3Rpb24gdHlwZSBpcyByZWRpcmVjdFwiKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuZXJyb3JSZWNlaXZlZENhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiVHdvIGNhbGxiYWNrcyB3ZXJlIHByb3ZpZGVkIHRvIGhhbmRsZVJlZGlyZWN0Q2FsbGJhY2ssIGNhbGxpbmcgc3VjY2VzcyBjYWxsYmFjayB3aXRoIHJlc3BvbnNlXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50b2tlblJlY2VpdmVkQ2FsbGJhY2socmVzcG9uc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuYXV0aFJlc3BvbnNlQ2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJPbmUgY2FsbGJhY2sgd2FzIHByb3ZpZGVkIHRvIGhhbmRsZVJlZGlyZWN0Q2FsbGJhY2ssIGNhbGxpbmcgYXV0aFJlc3BvbnNlQ2FsbGJhY2sgd2l0aCByZXNwb25zZVwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYXV0aFJlc3BvbnNlQ2FsbGJhY2sobnVsbCwgcmVzcG9uc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGludGVyYWN0aW9uVHlwZSA9PT0gQ29uc3RhbnRzLmludGVyYWN0aW9uVHlwZVBvcHVwKSB7XHJcbiAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJJbnRlcmFjdGlvbiB0eXBlIGlzIHBvcHVwLCByZXNvbHZpbmdcIik7XHJcbiAgICAgICAgICAgIHJlc29sdmUocmVzcG9uc2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgQ2xpZW50QXV0aEVycm9yLmNyZWF0ZUludmFsaWRJbnRlcmFjdGlvblR5cGVFcnJvcigpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBVc2VyQWdlbnRBcHBsaWNhdGlvbi5wcm90b3R5cGUuYXV0aEVycm9ySGFuZGxlciA9IGZ1bmN0aW9uIChpbnRlcmFjdGlvblR5cGUsIGF1dGhFcnIsIHJlc3BvbnNlLCByZWplY3QpIHtcclxuICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiQXV0aEVycm9ySGFuZGxlciBoYXMgYmVlbiBjYWxsZWRcIik7XHJcbiAgICAgICAgLy8gc2V0IGludGVyYWN0aW9uX3N0YXR1cyB0byBjb21wbGV0ZVxyXG4gICAgICAgIHRoaXMuY2FjaGVTdG9yYWdlLnJlbW92ZUl0ZW0oVGVtcG9yYXJ5Q2FjaGVLZXlzLklOVEVSQUNUSU9OX1NUQVRVUyk7XHJcbiAgICAgICAgaWYgKGludGVyYWN0aW9uVHlwZSA9PT0gQ29uc3RhbnRzLmludGVyYWN0aW9uVHlwZVJlZGlyZWN0KSB7XHJcbiAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJJbnRlcmFjdGlvbiB0eXBlIGlzIHJlZGlyZWN0XCIpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5lcnJvclJlY2VpdmVkQ2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJUd28gY2FsbGJhY2tzIHdlcmUgcHJvdmlkZWQgdG8gaGFuZGxlUmVkaXJlY3RDYWxsYmFjaywgY2FsbGluZyBlcnJvciBjYWxsYmFja1wiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZXJyb3JSZWNlaXZlZENhbGxiYWNrKGF1dGhFcnIsIHJlc3BvbnNlLmFjY291bnRTdGF0ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5hdXRoUmVzcG9uc2VDYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIk9uZSBjYWxsYmFjayB3YXMgcHJvdmlkZWQgdG8gaGFuZGxlUmVkaXJlY3RDYWxsYmFjaywgY2FsbGluZyBhdXRoUmVzcG9uc2VDYWxsYmFjayB3aXRoIGVycm9yXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hdXRoUmVzcG9uc2VDYWxsYmFjayhhdXRoRXJyLCByZXNwb25zZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiaGFuZGxlUmVkaXJlY3RDYWxsYmFjayBoYXMgbm90IGJlZW4gY2FsbGVkIGFuZCBubyBjYWxsYmFja3MgYXJlIHJlZ2lzdGVyZWQsIHRocm93aW5nIGVycm9yXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgYXV0aEVycjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChpbnRlcmFjdGlvblR5cGUgPT09IENvbnN0YW50cy5pbnRlcmFjdGlvblR5cGVQb3B1cCkge1xyXG4gICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiSW50ZXJhY3Rpb24gdHlwZSBpcyBwb3B1cCwgcmVqZWN0aW5nXCIpO1xyXG4gICAgICAgICAgICByZWplY3QoYXV0aEVycik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aHJvdyBDbGllbnRBdXRoRXJyb3IuY3JlYXRlSW52YWxpZEludGVyYWN0aW9uVHlwZUVycm9yKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8vICNlbmRyZWdpb25cclxuICAgIC8qKlxyXG4gICAgICogVXNlIHdoZW4gaW5pdGlhdGluZyB0aGUgbG9naW4gcHJvY2VzcyBieSByZWRpcmVjdGluZyB0aGUgdXNlcidzIGJyb3dzZXIgdG8gdGhlIGF1dGhvcml6YXRpb24gZW5kcG9pbnQuXHJcbiAgICAgKiBAcGFyYW0ge0BsaW5rIChBdXRoZW50aWNhdGlvblBhcmFtZXRlcnM6dHlwZSl9XHJcbiAgICAgKi9cclxuICAgIFVzZXJBZ2VudEFwcGxpY2F0aW9uLnByb3RvdHlwZS5sb2dpblJlZGlyZWN0ID0gZnVuY3Rpb24gKHVzZXJSZXF1ZXN0KSB7XHJcbiAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIkxvZ2luUmVkaXJlY3QgaGFzIGJlZW4gY2FsbGVkXCIpO1xyXG4gICAgICAgIC8vIHZhbGlkYXRlIHJlcXVlc3RcclxuICAgICAgICB2YXIgcmVxdWVzdCA9IFJlcXVlc3RVdGlscy52YWxpZGF0ZVJlcXVlc3QodXNlclJlcXVlc3QsIHRydWUsIHRoaXMuY2xpZW50SWQsIENvbnN0YW50cy5pbnRlcmFjdGlvblR5cGVSZWRpcmVjdCk7XHJcbiAgICAgICAgdGhpcy5hY3F1aXJlVG9rZW5JbnRlcmFjdGl2ZShDb25zdGFudHMuaW50ZXJhY3Rpb25UeXBlUmVkaXJlY3QsIHRydWUsIHJlcXVlc3QsIG51bGwsIG51bGwpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogVXNlIHdoZW4geW91IHdhbnQgdG8gb2J0YWluIGFuIGFjY2Vzc190b2tlbiBmb3IgeW91ciBBUEkgYnkgcmVkaXJlY3RpbmcgdGhlIHVzZXIncyBicm93c2VyIHdpbmRvdyB0byB0aGUgYXV0aG9yaXphdGlvbiBlbmRwb2ludC5cclxuICAgICAqIEBwYXJhbSB7QGxpbmsgKEF1dGhlbnRpY2F0aW9uUGFyYW1ldGVyczp0eXBlKX1cclxuICAgICAqXHJcbiAgICAgKiBUbyByZW5ldyBpZFRva2VuLCBwbGVhc2UgcGFzcyBjbGllbnRJZCBhcyB0aGUgb25seSBzY29wZSBpbiB0aGUgQXV0aGVudGljYXRpb24gUGFyYW1ldGVyc1xyXG4gICAgICovXHJcbiAgICBVc2VyQWdlbnRBcHBsaWNhdGlvbi5wcm90b3R5cGUuYWNxdWlyZVRva2VuUmVkaXJlY3QgPSBmdW5jdGlvbiAodXNlclJlcXVlc3QpIHtcclxuICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiQWNxdWlyZVRva2VuUmVkaXJlY3QgaGFzIGJlZW4gY2FsbGVkXCIpO1xyXG4gICAgICAgIC8vIHZhbGlkYXRlIHJlcXVlc3RcclxuICAgICAgICB2YXIgcmVxdWVzdCA9IFJlcXVlc3RVdGlscy52YWxpZGF0ZVJlcXVlc3QodXNlclJlcXVlc3QsIGZhbHNlLCB0aGlzLmNsaWVudElkLCBDb25zdGFudHMuaW50ZXJhY3Rpb25UeXBlUmVkaXJlY3QpO1xyXG4gICAgICAgIHRoaXMuYWNxdWlyZVRva2VuSW50ZXJhY3RpdmUoQ29uc3RhbnRzLmludGVyYWN0aW9uVHlwZVJlZGlyZWN0LCBmYWxzZSwgcmVxdWVzdCwgbnVsbCwgbnVsbCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBVc2Ugd2hlbiBpbml0aWF0aW5nIHRoZSBsb2dpbiBwcm9jZXNzIHZpYSBvcGVuaW5nIGEgcG9wdXAgd2luZG93IGluIHRoZSB1c2VyJ3MgYnJvd3NlclxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB7QGxpbmsgKEF1dGhlbnRpY2F0aW9uUGFyYW1ldGVyczp0eXBlKX1cclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZS48QXV0aFJlc3BvbnNlPn0gLSBhIHByb21pc2UgdGhhdCBpcyBmdWxmaWxsZWQgd2hlbiB0aGlzIGZ1bmN0aW9uIGhhcyBjb21wbGV0ZWQsIG9yIHJlamVjdGVkIGlmIGFuIGVycm9yIHdhcyByYWlzZWQuIFJldHVybnMgdGhlIHtAbGluayBBdXRoUmVzcG9uc2V9IG9iamVjdFxyXG4gICAgICovXHJcbiAgICBVc2VyQWdlbnRBcHBsaWNhdGlvbi5wcm90b3R5cGUubG9naW5Qb3B1cCA9IGZ1bmN0aW9uICh1c2VyUmVxdWVzdCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIkxvZ2luUG9wdXAgaGFzIGJlZW4gY2FsbGVkXCIpO1xyXG4gICAgICAgIC8vIHZhbGlkYXRlIHJlcXVlc3RcclxuICAgICAgICB2YXIgcmVxdWVzdCA9IFJlcXVlc3RVdGlscy52YWxpZGF0ZVJlcXVlc3QodXNlclJlcXVlc3QsIHRydWUsIHRoaXMuY2xpZW50SWQsIENvbnN0YW50cy5pbnRlcmFjdGlvblR5cGVQb3B1cCk7XHJcbiAgICAgICAgdmFyIGFwaUV2ZW50ID0gdGhpcy50ZWxlbWV0cnlNYW5hZ2VyLmNyZWF0ZUFuZFN0YXJ0QXBpRXZlbnQocmVxdWVzdC5jb3JyZWxhdGlvbklkLCBBUElfRVZFTlRfSURFTlRJRklFUi5Mb2dpblBvcHVwKTtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICBfdGhpcy5hY3F1aXJlVG9rZW5JbnRlcmFjdGl2ZShDb25zdGFudHMuaW50ZXJhY3Rpb25UeXBlUG9wdXAsIHRydWUsIHJlcXVlc3QsIHJlc29sdmUsIHJlamVjdCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHtcclxuICAgICAgICAgICAgX3RoaXMubG9nZ2VyLnZlcmJvc2UoXCJTdWNjZXNzZnVsbHkgbG9nZ2VkIGluXCIpO1xyXG4gICAgICAgICAgICBfdGhpcy50ZWxlbWV0cnlNYW5hZ2VyLnN0b3BBbmRGbHVzaEFwaUV2ZW50KHJlcXVlc3QuY29ycmVsYXRpb25JZCwgYXBpRXZlbnQsIHRydWUpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzcDtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgIF90aGlzLmNhY2hlU3RvcmFnZS5yZXNldFRlbXBDYWNoZUl0ZW1zKHJlcXVlc3Quc3RhdGUpO1xyXG4gICAgICAgICAgICBfdGhpcy50ZWxlbWV0cnlNYW5hZ2VyLnN0b3BBbmRGbHVzaEFwaUV2ZW50KHJlcXVlc3QuY29ycmVsYXRpb25JZCwgYXBpRXZlbnQsIGZhbHNlLCBlcnJvci5lcnJvckNvZGUpO1xyXG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFVzZSB3aGVuIHlvdSB3YW50IHRvIG9idGFpbiBhbiBhY2Nlc3NfdG9rZW4gZm9yIHlvdXIgQVBJIHZpYSBvcGVuaW5nIGEgcG9wdXAgd2luZG93IGluIHRoZSB1c2VyJ3MgYnJvd3NlclxyXG4gICAgICogQHBhcmFtIHtAbGluayBBdXRoZW50aWNhdGlvblBhcmFtZXRlcnN9XHJcbiAgICAgKlxyXG4gICAgICogVG8gcmVuZXcgaWRUb2tlbiwgcGxlYXNlIHBhc3MgY2xpZW50SWQgYXMgdGhlIG9ubHkgc2NvcGUgaW4gdGhlIEF1dGhlbnRpY2F0aW9uIFBhcmFtZXRlcnNcclxuICAgICAqIEByZXR1cm5zIHtQcm9taXNlLjxBdXRoUmVzcG9uc2U+fSAtIGEgcHJvbWlzZSB0aGF0IGlzIGZ1bGZpbGxlZCB3aGVuIHRoaXMgZnVuY3Rpb24gaGFzIGNvbXBsZXRlZCwgb3IgcmVqZWN0ZWQgaWYgYW4gZXJyb3Igd2FzIHJhaXNlZC4gUmV0dXJucyB0aGUge0BsaW5rIEF1dGhSZXNwb25zZX0gb2JqZWN0XHJcbiAgICAgKi9cclxuICAgIFVzZXJBZ2VudEFwcGxpY2F0aW9uLnByb3RvdHlwZS5hY3F1aXJlVG9rZW5Qb3B1cCA9IGZ1bmN0aW9uICh1c2VyUmVxdWVzdCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIkFjcXVpcmVUb2tlblBvcHVwIGhhcyBiZWVuIGNhbGxlZFwiKTtcclxuICAgICAgICAvLyB2YWxpZGF0ZSByZXF1ZXN0XHJcbiAgICAgICAgdmFyIHJlcXVlc3QgPSBSZXF1ZXN0VXRpbHMudmFsaWRhdGVSZXF1ZXN0KHVzZXJSZXF1ZXN0LCBmYWxzZSwgdGhpcy5jbGllbnRJZCwgQ29uc3RhbnRzLmludGVyYWN0aW9uVHlwZVBvcHVwKTtcclxuICAgICAgICB2YXIgYXBpRXZlbnQgPSB0aGlzLnRlbGVtZXRyeU1hbmFnZXIuY3JlYXRlQW5kU3RhcnRBcGlFdmVudChyZXF1ZXN0LmNvcnJlbGF0aW9uSWQsIEFQSV9FVkVOVF9JREVOVElGSUVSLkFjcXVpcmVUb2tlblBvcHVwKTtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICBfdGhpcy5hY3F1aXJlVG9rZW5JbnRlcmFjdGl2ZShDb25zdGFudHMuaW50ZXJhY3Rpb25UeXBlUG9wdXAsIGZhbHNlLCByZXF1ZXN0LCByZXNvbHZlLCByZWplY3QpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwKSB7XHJcbiAgICAgICAgICAgIF90aGlzLmxvZ2dlci52ZXJib3NlKFwiU3VjY2Vzc2Z1bGx5IGFjcXVpcmVkIHRva2VuXCIpO1xyXG4gICAgICAgICAgICBfdGhpcy50ZWxlbWV0cnlNYW5hZ2VyLnN0b3BBbmRGbHVzaEFwaUV2ZW50KHJlcXVlc3QuY29ycmVsYXRpb25JZCwgYXBpRXZlbnQsIHRydWUpO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzcDtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgIF90aGlzLmNhY2hlU3RvcmFnZS5yZXNldFRlbXBDYWNoZUl0ZW1zKHJlcXVlc3Quc3RhdGUpO1xyXG4gICAgICAgICAgICBfdGhpcy50ZWxlbWV0cnlNYW5hZ2VyLnN0b3BBbmRGbHVzaEFwaUV2ZW50KHJlcXVlc3QuY29ycmVsYXRpb25JZCwgYXBpRXZlbnQsIGZhbHNlLCBlcnJvci5lcnJvckNvZGUpO1xyXG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvLyAjcmVnaW9uIEFjcXVpcmUgVG9rZW5cclxuICAgIC8qKlxyXG4gICAgICogVXNlIHdoZW4gaW5pdGlhdGluZyB0aGUgbG9naW4gcHJvY2VzcyBvciB3aGVuIHlvdSB3YW50IHRvIG9idGFpbiBhbiBhY2Nlc3NfdG9rZW4gZm9yIHlvdXIgQVBJLFxyXG4gICAgICogZWl0aGVyIGJ5IHJlZGlyZWN0aW5nIHRoZSB1c2VyJ3MgYnJvd3NlciB3aW5kb3cgdG8gdGhlIGF1dGhvcml6YXRpb24gZW5kcG9pbnQgb3IgdmlhIG9wZW5pbmcgYSBwb3B1cCB3aW5kb3cgaW4gdGhlIHVzZXIncyBicm93c2VyLlxyXG4gICAgICogQHBhcmFtIHtAbGluayAoQXV0aGVudGljYXRpb25QYXJhbWV0ZXJzOnR5cGUpfVxyXG4gICAgICpcclxuICAgICAqIFRvIHJlbmV3IGlkVG9rZW4sIHBsZWFzZSBwYXNzIGNsaWVudElkIGFzIHRoZSBvbmx5IHNjb3BlIGluIHRoZSBBdXRoZW50aWNhdGlvbiBQYXJhbWV0ZXJzXHJcbiAgICAgKi9cclxuICAgIFVzZXJBZ2VudEFwcGxpY2F0aW9uLnByb3RvdHlwZS5hY3F1aXJlVG9rZW5JbnRlcmFjdGl2ZSA9IGZ1bmN0aW9uIChpbnRlcmFjdGlvblR5cGUsIGlzTG9naW5DYWxsLCByZXF1ZXN0LCByZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJBY3F1aXJlVG9rZW5JbnRlcmFjdGl2ZSBoYXMgYmVlbiBjYWxsZWRcIik7XHJcbiAgICAgICAgLy8gYmxvY2sgdGhlIHJlcXVlc3QgaWYgbWFkZSBmcm9tIHRoZSBoaWRkZW4gaWZyYW1lXHJcbiAgICAgICAgV2luZG93VXRpbHMuYmxvY2tSZWxvYWRJbkhpZGRlbklmcmFtZXMoKTtcclxuICAgICAgICB2YXIgaW50ZXJhY3Rpb25Qcm9ncmVzcyA9IHRoaXMuY2FjaGVTdG9yYWdlLmdldEl0ZW0oVGVtcG9yYXJ5Q2FjaGVLZXlzLklOVEVSQUNUSU9OX1NUQVRVUyk7XHJcbiAgICAgICAgaWYgKGludGVyYWN0aW9uVHlwZSA9PT0gQ29uc3RhbnRzLmludGVyYWN0aW9uVHlwZVJlZGlyZWN0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FjaGVTdG9yYWdlLnNldEl0ZW0oVGVtcG9yYXJ5Q2FjaGVLZXlzLlJFRElSRUNUX1JFUVVFU1QsIFwiXCIgKyBDb25zdGFudHMuaW5Qcm9ncmVzcyArIENvbnN0YW50cy5yZXNvdXJjZURlbGltaXRlciArIHJlcXVlc3Quc3RhdGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBJZiBhbHJlYWR5IGluIHByb2dyZXNzLCBkbyBub3QgcHJvY2VlZFxyXG4gICAgICAgIGlmIChpbnRlcmFjdGlvblByb2dyZXNzID09PSBDb25zdGFudHMuaW5Qcm9ncmVzcykge1xyXG4gICAgICAgICAgICB2YXIgdGhyb3duRXJyb3IgPSBpc0xvZ2luQ2FsbCA/IENsaWVudEF1dGhFcnJvci5jcmVhdGVMb2dpbkluUHJvZ3Jlc3NFcnJvcigpIDogQ2xpZW50QXV0aEVycm9yLmNyZWF0ZUFjcXVpcmVUb2tlbkluUHJvZ3Jlc3NFcnJvcigpO1xyXG4gICAgICAgICAgICB2YXIgc3RhdGVPbmx5UmVzcG9uc2UgPSBidWlsZFJlc3BvbnNlU3RhdGVPbmx5KHRoaXMuZ2V0QWNjb3VudFN0YXRlKHJlcXVlc3Quc3RhdGUpKTtcclxuICAgICAgICAgICAgdGhpcy5jYWNoZVN0b3JhZ2UucmVzZXRUZW1wQ2FjaGVJdGVtcyhyZXF1ZXN0LnN0YXRlKTtcclxuICAgICAgICAgICAgdGhpcy5hdXRoRXJyb3JIYW5kbGVyKGludGVyYWN0aW9uVHlwZSwgdGhyb3duRXJyb3IsIHN0YXRlT25seVJlc3BvbnNlLCByZWplY3QpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIEdldCB0aGUgYWNjb3VudCBvYmplY3QgaWYgYSBzZXNzaW9uIGV4aXN0c1xyXG4gICAgICAgIHZhciBhY2NvdW50O1xyXG4gICAgICAgIGlmIChyZXF1ZXN0ICYmIHJlcXVlc3QuYWNjb3VudCAmJiAhaXNMb2dpbkNhbGwpIHtcclxuICAgICAgICAgICAgYWNjb3VudCA9IHJlcXVlc3QuYWNjb3VudDtcclxuICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIkFjY291bnQgc2V0IGZyb20gcmVxdWVzdFwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGFjY291bnQgPSB0aGlzLmdldEFjY291bnQoKTtcclxuICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIkFjY291bnQgc2V0IGZyb20gTVNBTCBDYWNoZVwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gSWYgbm8gc2Vzc2lvbiBleGlzdHMsIHByb21wdCB0aGUgdXNlciB0byBsb2dpbi5cclxuICAgICAgICBpZiAoIWFjY291bnQgJiYgIVNlcnZlclJlcXVlc3RQYXJhbWV0ZXJzLmlzU1NPUGFyYW0ocmVxdWVzdCkpIHtcclxuICAgICAgICAgICAgaWYgKGlzTG9naW5DYWxsKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBleHRyYWN0IEFEQUwgaWRfdG9rZW4gaWYgZXhpc3RzXHJcbiAgICAgICAgICAgICAgICB2YXIgYWRhbElkVG9rZW4gPSB0aGlzLmV4dHJhY3RBREFMSWRUb2tlbigpO1xyXG4gICAgICAgICAgICAgICAgLy8gc2lsZW50IGxvZ2luIGlmIEFEQUwgaWRfdG9rZW4gaXMgcmV0cmlldmVkIHN1Y2Nlc3NmdWxseSAtIFNTT1xyXG4gICAgICAgICAgICAgICAgaWYgKGFkYWxJZFRva2VuICYmICFyZXF1ZXN0LnNjb3Blcykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLmluZm8oXCJBREFMJ3MgaWRUb2tlbiBleGlzdHMuIEV4dHJhY3RpbmcgbG9naW4gaW5mb3JtYXRpb24gZnJvbSBBREFMJ3MgaWRUb2tlblwiKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdG9rZW5SZXF1ZXN0ID0gdGhpcy5idWlsZElEVG9rZW5SZXF1ZXN0KHJlcXVlc3QpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2lsZW50TG9naW4gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWNxdWlyZVRva2VuU2lsZW50KHRva2VuUmVxdWVzdCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2lsZW50TG9naW4gPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMubG9nZ2VyLmluZm8oXCJVbmlmaWVkIGNhY2hlIGNhbGwgaXMgc3VjY2Vzc2Z1bFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuYXV0aFJlc3BvbnNlSGFuZGxlcihpbnRlcmFjdGlvblR5cGUsIHJlc3BvbnNlLCByZXNvbHZlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5zaWxlbnRMb2dpbiA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5sb2dnZXIuZXJyb3IoXCJFcnJvciBvY2N1cnJlZCBkdXJpbmcgdW5pZmllZCBjYWNoZSBBVFM6IFwiICsgZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBwcm9jZWVkIHRvIGxvZ2luIHNpbmNlIEFUUyBmYWlsZWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuYWNxdWlyZVRva2VuSGVscGVyKG51bGwsIGludGVyYWN0aW9uVHlwZSwgaXNMb2dpbkNhbGwsIHJlcXVlc3QsIHJlc29sdmUsIHJlamVjdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBObyBBREFMIHRva2VuIGZvdW5kLCBwcm9jZWVkIHRvIGxvZ2luXHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiTG9naW4gY2FsbCBidXQgbm8gdG9rZW4gZm91bmQsIHByb2NlZWQgdG8gbG9naW5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hY3F1aXJlVG9rZW5IZWxwZXIobnVsbCwgaW50ZXJhY3Rpb25UeXBlLCBpc0xvZ2luQ2FsbCwgcmVxdWVzdCwgcmVzb2x2ZSwgcmVqZWN0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBBY3F1aXJlVG9rZW4gY2FsbCwgYnV0IG5vIGFjY291bnQgb3IgY29udGV4dCBnaXZlbiwgc28gdGhyb3cgZXJyb3JcclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiQWNxdWlyZVRva2VuIGNhbGwsIG5vIGNvbnRleHQgb3IgYWNjb3VudCBnaXZlblwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLmluZm8oXCJVc2VyIGxvZ2luIGlzIHJlcXVpcmVkXCIpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHN0YXRlT25seVJlc3BvbnNlID0gYnVpbGRSZXNwb25zZVN0YXRlT25seSh0aGlzLmdldEFjY291bnRTdGF0ZShyZXF1ZXN0LnN0YXRlKSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZS5yZXNldFRlbXBDYWNoZUl0ZW1zKHJlcXVlc3Quc3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hdXRoRXJyb3JIYW5kbGVyKGludGVyYWN0aW9uVHlwZSwgQ2xpZW50QXV0aEVycm9yLmNyZWF0ZVVzZXJMb2dpblJlcXVpcmVkRXJyb3IoKSwgc3RhdGVPbmx5UmVzcG9uc2UsIHJlamVjdCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gVXNlciBzZXNzaW9uIGV4aXN0c1xyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiVXNlciBzZXNzaW9uIGV4aXN0cywgbG9naW4gbm90IHJlcXVpcmVkXCIpO1xyXG4gICAgICAgICAgICB0aGlzLmFjcXVpcmVUb2tlbkhlbHBlcihhY2NvdW50LCBpbnRlcmFjdGlvblR5cGUsIGlzTG9naW5DYWxsLCByZXF1ZXN0LCByZXNvbHZlLCByZWplY3QpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEBoaWRkZW5cclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqIEhlbHBlciBmdW5jdGlvbiB0byBhY3F1aXJlVG9rZW5cclxuICAgICAqXHJcbiAgICAgKi9cclxuICAgIFVzZXJBZ2VudEFwcGxpY2F0aW9uLnByb3RvdHlwZS5hY3F1aXJlVG9rZW5IZWxwZXIgPSBmdW5jdGlvbiAoYWNjb3VudCwgaW50ZXJhY3Rpb25UeXBlLCBpc0xvZ2luQ2FsbCwgcmVxdWVzdCwgcmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciByZXF1ZXN0U2lnbmF0dXJlLCBzZXJ2ZXJBdXRoZW50aWNhdGlvblJlcXVlc3QsIGFjcXVpcmVUb2tlbkF1dGhvcml0eSwgcG9wVXBXaW5kb3csIHJlc3BvbnNlVHlwZSwgbG9naW5TdGFydFBhZ2UsIHVybE5hdmlnYXRlLCBoYXNoLCBlcnJvcl8xLCBuYXZpZ2F0ZSwgZXJyXzE7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYSkge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYS5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIkFjcXVpcmVUb2tlbkhlbHBlciBoYXMgYmVlbiBjYWxsZWRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJJbnRlcmFjdGlvbiB0eXBlOiBcIiArIGludGVyYWN0aW9uVHlwZSArIFwiLiBpc0xvZ2luQ2FsbDogXCIgKyBpc0xvZ2luQ2FsbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRyYWNrIHRoZSBhY3F1aXJlVG9rZW4gcHJvZ3Jlc3NcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jYWNoZVN0b3JhZ2Uuc2V0SXRlbShUZW1wb3JhcnlDYWNoZUtleXMuSU5URVJBQ1RJT05fU1RBVFVTLCBDb25zdGFudHMuaW5Qcm9ncmVzcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RTaWduYXR1cmUgPSByZXF1ZXN0LnNjb3BlcyA/IHJlcXVlc3Quc2NvcGVzLmpvaW4oXCIgXCIpLnRvTG93ZXJDYXNlKCkgOiBDb25zdGFudHMub2lkY1Njb3Blcy5qb2luKFwiIFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZVBpaShcIlJlcXVlc3Qgc2lnbmF0dXJlOiBcIiArIHJlcXVlc3RTaWduYXR1cmUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3F1aXJlVG9rZW5BdXRob3JpdHkgPSAocmVxdWVzdCAmJiByZXF1ZXN0LmF1dGhvcml0eSkgPyBBdXRob3JpdHlGYWN0b3J5LkNyZWF0ZUluc3RhbmNlKHJlcXVlc3QuYXV0aG9yaXR5LCB0aGlzLmNvbmZpZy5hdXRoLnZhbGlkYXRlQXV0aG9yaXR5LCByZXF1ZXN0LmF1dGhvcml0eU1ldGFkYXRhKSA6IHRoaXMuYXV0aG9yaXR5SW5zdGFuY2U7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gMTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLnRyeXMucHVzaChbMSwgMTEsICwgMTJdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhYWNxdWlyZVRva2VuQXV0aG9yaXR5Lmhhc0NhY2hlZE1ldGFkYXRhKCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiTm8gY2FjaGVkIG1ldGFkYXRhIGZvciBhdXRob3JpdHlcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIEF1dGhvcml0eUZhY3Rvcnkuc2F2ZU1ldGFkYXRhRnJvbU5ldHdvcmsoYWNxdWlyZVRva2VuQXV0aG9yaXR5LCB0aGlzLnRlbGVtZXRyeU1hbmFnZXIsIHJlcXVlc3QuY29ycmVsYXRpb25JZCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA0XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJDYWNoZWQgbWV0YWRhdGEgZm91bmQgZm9yIGF1dGhvcml0eVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSA0O1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2VUeXBlID0gaXNMb2dpbkNhbGwgPyBSZXNwb25zZVR5cGVzLmlkX3Rva2VuIDogdGhpcy5nZXRUb2tlblR5cGUoYWNjb3VudCwgcmVxdWVzdC5zY29wZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dpblN0YXJ0UGFnZSA9IHJlcXVlc3QucmVkaXJlY3RTdGFydFBhZ2UgfHwgd2luZG93LmxvY2F0aW9uLmhyZWY7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZlckF1dGhlbnRpY2F0aW9uUmVxdWVzdCA9IG5ldyBTZXJ2ZXJSZXF1ZXN0UGFyYW1ldGVycyhhY3F1aXJlVG9rZW5BdXRob3JpdHksIHRoaXMuY2xpZW50SWQsIHJlc3BvbnNlVHlwZSwgdGhpcy5nZXRSZWRpcmVjdFVyaShyZXF1ZXN0ICYmIHJlcXVlc3QucmVkaXJlY3RVcmkpLCByZXF1ZXN0LnNjb3BlcywgcmVxdWVzdC5zdGF0ZSwgcmVxdWVzdC5jb3JyZWxhdGlvbklkKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIkZpbmlzaGVkIGJ1aWxkaW5nIHNlcnZlciBhdXRoZW50aWNhdGlvbiByZXF1ZXN0XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUNhY2hlRW50cmllcyhzZXJ2ZXJBdXRoZW50aWNhdGlvblJlcXVlc3QsIGFjY291bnQsIGlzTG9naW5DYWxsLCBsb2dpblN0YXJ0UGFnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJVcGRhdGluZyBjYWNoZSBlbnRyaWVzXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBwb3B1bGF0ZSBRdWVyeVBhcmFtZXRlcnMgKHNpZC9sb2dpbl9oaW50KSBhbmQgYW55IG90aGVyIGV4dHJhUXVlcnlQYXJhbWV0ZXJzIHNldCBieSB0aGUgZGV2ZWxvcGVyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZlckF1dGhlbnRpY2F0aW9uUmVxdWVzdC5wb3B1bGF0ZVF1ZXJ5UGFyYW1zKGFjY291bnQsIHJlcXVlc3QpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiUXVlcnkgcGFyYW1ldGVycyBwb3B1bGF0ZWQgZnJvbSBhY2NvdW50XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB1cmxOYXZpZ2F0ZSA9IFVybFV0aWxzLmNyZWF0ZU5hdmlnYXRlVXJsKHNlcnZlckF1dGhlbnRpY2F0aW9uUmVxdWVzdCkgKyBDb25zdGFudHMucmVzcG9uc2VfbW9kZV9mcmFnbWVudDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2V0IHN0YXRlIGluIGNhY2hlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbnRlcmFjdGlvblR5cGUgPT09IENvbnN0YW50cy5pbnRlcmFjdGlvblR5cGVSZWRpcmVjdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0xvZ2luQ2FsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2FjaGVTdG9yYWdlLnNldEl0ZW0oQXV0aENhY2hlLmdlbmVyYXRlVGVtcG9yYXJ5Q2FjaGVLZXkoVGVtcG9yYXJ5Q2FjaGVLZXlzLlNUQVRFX0FDUV9UT0tFTiwgcmVxdWVzdC5zdGF0ZSksIHNlcnZlckF1dGhlbnRpY2F0aW9uUmVxdWVzdC5zdGF0ZSwgdGhpcy5pbkNvb2tpZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIlN0YXRlIGNhY2hlZCBmb3IgcmVkaXJlY3RcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZVBpaShcIlN0YXRlIGNhY2hlZDogXCIgKyBzZXJ2ZXJBdXRoZW50aWNhdGlvblJlcXVlc3Quc3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIkludGVyYWN0aW9uIHR5cGUgcmVkaXJlY3QgYnV0IGxvZ2luIGNhbGwgaXMgdHJ1ZS4gU3RhdGUgbm90IGNhY2hlZFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChpbnRlcmFjdGlvblR5cGUgPT09IENvbnN0YW50cy5pbnRlcmFjdGlvblR5cGVQb3B1cCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnJlbmV3U3RhdGVzLnB1c2goc2VydmVyQXV0aGVudGljYXRpb25SZXF1ZXN0LnN0YXRlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5yZXF1ZXN0VHlwZSA9IGlzTG9naW5DYWxsID8gQ29uc3RhbnRzLmxvZ2luIDogQ29uc3RhbnRzLnJlbmV3VG9rZW47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiU3RhdGUgc2F2ZWQgdG8gd2luZG93XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZVBpaShcIlN0YXRlIHNhdmVkOiBcIiArIHNlcnZlckF1dGhlbnRpY2F0aW9uUmVxdWVzdC5zdGF0ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZWdpc3RlciBjYWxsYmFjayB0byBjYXB0dXJlIHJlc3VsdHMgZnJvbSBzZXJ2ZXJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJDYWxsYmFjayhzZXJ2ZXJBdXRoZW50aWNhdGlvblJlcXVlc3Quc3RhdGUsIHJlcXVlc3RTaWduYXR1cmUsIHJlc29sdmUsIHJlamVjdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiSW52YWxpZCBpbnRlcmFjdGlvbiBlcnJvci4gU3RhdGUgbm90IGNhY2hlZFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IENsaWVudEF1dGhFcnJvci5jcmVhdGVJbnZhbGlkSW50ZXJhY3Rpb25UeXBlRXJyb3IoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShpbnRlcmFjdGlvblR5cGUgPT09IENvbnN0YW50cy5pbnRlcmFjdGlvblR5cGVQb3B1cCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiSW50ZXJhY3Rpb24gdHlwZSBpcyBwb3B1cC4gR2VuZXJhdGluZyBwb3B1cCB3aW5kb3dcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEdlbmVyYXRlIGEgcG9wdXAgd2luZG93XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3BVcFdpbmRvdyA9IHRoaXMub3BlblBvcHVwKHVybE5hdmlnYXRlLCBcIm1zYWxcIiwgQ29uc3RhbnRzLnBvcFVwV2lkdGgsIENvbnN0YW50cy5wb3BVcEhlaWdodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBQdXNoIHBvcHVwIHdpbmRvdyBoYW5kbGUgb250byBzdGFjayBmb3IgdHJhY2tpbmdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFdpbmRvd1V0aWxzLnRyYWNrUG9wdXAocG9wVXBXaW5kb3cpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci5pbmZvKENsaWVudEF1dGhFcnJvck1lc3NhZ2UucG9wVXBXaW5kb3dFcnJvci5jb2RlICsgXCI6XCIgKyBDbGllbnRBdXRoRXJyb3JNZXNzYWdlLnBvcFVwV2luZG93RXJyb3IuZGVzYyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZS5zZXRJdGVtKEVycm9yQ2FjaGVLZXlzLkVSUk9SLCBDbGllbnRBdXRoRXJyb3JNZXNzYWdlLnBvcFVwV2luZG93RXJyb3IuY29kZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZS5zZXRJdGVtKEVycm9yQ2FjaGVLZXlzLkVSUk9SX0RFU0MsIENsaWVudEF1dGhFcnJvck1lc3NhZ2UucG9wVXBXaW5kb3dFcnJvci5kZXNjKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZWplY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoQ2xpZW50QXV0aEVycm9yLmNyZWF0ZVBvcHVwV2luZG93RXJyb3IoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcG9wVXBXaW5kb3cpIHJldHVybiBbMyAvKmJyZWFrKi8sIDhdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDU7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS50cnlzLnB1c2goWzUsIDcsICwgOF0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBXaW5kb3dVdGlscy5tb25pdG9yUG9wdXBGb3JIYXNoKHBvcFVwV2luZG93LCB0aGlzLmNvbmZpZy5zeXN0ZW0ubG9hZEZyYW1lVGltZW91dCwgdXJsTmF2aWdhdGUsIHRoaXMubG9nZ2VyKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA2OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBoYXNoID0gX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUF1dGhlbnRpY2F0aW9uUmVzcG9uc2UoaGFzaCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlcXVlc3QgY29tcGxldGVkIHN1Y2Nlc3NmdWxseSwgc2V0IHRvIGNvbXBsZXRlZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZS5yZW1vdmVJdGVtKFRlbXBvcmFyeUNhY2hlS2V5cy5JTlRFUkFDVElPTl9TVEFUVVMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci5pbmZvKFwiQ2xvc2luZyBwb3B1cCB3aW5kb3dcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IENoZWNrIGhvdyB0aGlzIGNhbiBiZSBleHRyYWN0ZWQgZm9yIGFueSBmcmFtZXdvcmsgc3BlY2lmaWMgY29kZT9cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY29uZmlnLmZyYW1ld29yay5pc0FuZ3VsYXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYnJvYWRjYXN0KFwibXNhbDpwb3BVcEhhc2hDaGFuZ2VkXCIsIGhhc2gpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFdpbmRvd1V0aWxzLmNsb3NlUG9wdXBzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDhdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3JfMSA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yXzEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbmZpZy5mcmFtZXdvcmsuaXNBbmd1bGFyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJyb2FkY2FzdChcIm1zYWw6cG9wVXBDbG9zZWRcIiwgZXJyb3JfMS5lcnJvckNvZGUgKyBDb25zdGFudHMucmVzb3VyY2VEZWxpbWl0ZXIgKyBlcnJvcl8xLmVycm9yTWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXF1ZXN0IGZhaWxlZCwgc2V0IHRvIGNhbmNlbGVkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZS5yZW1vdmVJdGVtKFRlbXBvcmFyeUNhY2hlS2V5cy5JTlRFUkFDVElPTl9TVEFUVVMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9wVXBXaW5kb3cuY2xvc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA4XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDg6IHJldHVybiBbMyAvKmJyZWFrKi8sIDEwXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDk6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIG9uUmVkaXJlY3ROYXZpZ2F0ZSBpcyBpbXBsZW1lbnRlZCwgaW52b2tlIGl0IGFuZCBwcm92aWRlIHVybE5hdmlnYXRlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXF1ZXN0Lm9uUmVkaXJlY3ROYXZpZ2F0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIkludm9raW5nIG9uUmVkaXJlY3ROYXZpZ2F0ZSBjYWxsYmFja1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hdmlnYXRlID0gcmVxdWVzdC5vblJlZGlyZWN0TmF2aWdhdGUodXJsTmF2aWdhdGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmV0dXJuaW5nIGZhbHNlIGZyb20gb25SZWRpcmVjdE5hdmlnYXRlIHdpbGwgc3RvcCBuYXZpZ2F0aW9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobmF2aWdhdGUgIT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIm9uUmVkaXJlY3ROYXZpZ2F0ZSBkaWQgbm90IHJldHVybiBmYWxzZSwgbmF2aWdhdGluZ1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5hdmlnYXRlV2luZG93KHVybE5hdmlnYXRlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJvblJlZGlyZWN0TmF2aWdhdGUgcmV0dXJuZWQgZmFsc2UsIHN0b3BwaW5nIG5hdmlnYXRpb25cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBPdGhlcndpc2UsIHBlcmZvcm0gbmF2aWdhdGlvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIk5hdmlnYXRpbmcgd2luZG93IHRvIHVybE5hdmlnYXRlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5uYXZpZ2F0ZVdpbmRvdyh1cmxOYXZpZ2F0ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EubGFiZWwgPSAxMDtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDEwOiByZXR1cm4gWzMgLypicmVhayovLCAxMl07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyXzEgPSBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLmVycm9yKGVycl8xKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jYWNoZVN0b3JhZ2UucmVzZXRUZW1wQ2FjaGVJdGVtcyhyZXF1ZXN0LnN0YXRlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hdXRoRXJyb3JIYW5kbGVyKGludGVyYWN0aW9uVHlwZSwgQ2xpZW50QXV0aEVycm9yLmNyZWF0ZUVuZHBvaW50UmVzb2x1dGlvbkVycm9yKGVycl8xLnRvU3RyaW5nKSwgYnVpbGRSZXNwb25zZVN0YXRlT25seShyZXF1ZXN0LnN0YXRlKSwgcmVqZWN0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBvcFVwV2luZG93KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3BVcFdpbmRvdy5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDEyXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDEyOiByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQVBJIGludGVyZmFjaW5nIGlkVG9rZW4gcmVxdWVzdCB3aGVuIGFwcGxpY2F0aW9ucyBhbHJlYWR5IGhhdmUgYSBzZXNzaW9uL2hpbnQgYWNxdWlyZWQgYnkgYXV0aG9yaXphdGlvbiBjbGllbnQgYXBwbGljYXRpb25zXHJcbiAgICAgKiBAcGFyYW0gcmVxdWVzdFxyXG4gICAgICovXHJcbiAgICBVc2VyQWdlbnRBcHBsaWNhdGlvbi5wcm90b3R5cGUuc3NvU2lsZW50ID0gZnVuY3Rpb24gKHJlcXVlc3QpIHtcclxuICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwic3NvU2lsZW50IGhhcyBiZWVuIGNhbGxlZFwiKTtcclxuICAgICAgICAvLyB0aHJvdyBhbiBlcnJvciBvbiBhbiBlbXB0eSByZXF1ZXN0XHJcbiAgICAgICAgaWYgKCFyZXF1ZXN0KSB7XHJcbiAgICAgICAgICAgIHRocm93IENsaWVudENvbmZpZ3VyYXRpb25FcnJvci5jcmVhdGVFbXB0eVJlcXVlc3RFcnJvcigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyB0aHJvdyBhbiBlcnJvciBvbiBubyBoaW50cyBwYXNzZWRcclxuICAgICAgICBpZiAoIXJlcXVlc3Quc2lkICYmICFyZXF1ZXN0LmxvZ2luSGludCkge1xyXG4gICAgICAgICAgICB0aHJvdyBDbGllbnRDb25maWd1cmF0aW9uRXJyb3IuY3JlYXRlU3NvU2lsZW50RXJyb3IoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYWNxdWlyZVRva2VuU2lsZW50KHRzbGliXzEuX19hc3NpZ24oe30sIHJlcXVlc3QsIHsgc2NvcGVzOiBDb25zdGFudHMub2lkY1Njb3BlcyB9KSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBVc2UgdGhpcyBmdW5jdGlvbiB0byBvYnRhaW4gYSB0b2tlbiBiZWZvcmUgZXZlcnkgY2FsbCB0byB0aGUgQVBJIC8gcmVzb3VyY2UgcHJvdmlkZXJcclxuICAgICAqXHJcbiAgICAgKiBNU0FMIHJldHVybidzIGEgY2FjaGVkIHRva2VuIHdoZW4gYXZhaWxhYmxlXHJcbiAgICAgKiBPciBpdCBzZW5kJ3MgYSByZXF1ZXN0IHRvIHRoZSBTVFMgdG8gb2J0YWluIGEgbmV3IHRva2VuIHVzaW5nIGEgaGlkZGVuIGlmcmFtZS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge0BsaW5rIEF1dGhlbnRpY2F0aW9uUGFyYW1ldGVyc31cclxuICAgICAqXHJcbiAgICAgKiBUbyByZW5ldyBpZFRva2VuLCBwbGVhc2UgcGFzcyBjbGllbnRJZCBhcyB0aGUgb25seSBzY29wZSBpbiB0aGUgQXV0aGVudGljYXRpb24gUGFyYW1ldGVyc1xyXG4gICAgICogQHJldHVybnMge1Byb21pc2UuPEF1dGhSZXNwb25zZT59IC0gYSBwcm9taXNlIHRoYXQgaXMgZnVsZmlsbGVkIHdoZW4gdGhpcyBmdW5jdGlvbiBoYXMgY29tcGxldGVkLCBvciByZWplY3RlZCBpZiBhbiBlcnJvciB3YXMgcmFpc2VkLiBSZXR1cm5zIHRoZSB7QGxpbmsgQXV0aFJlc3BvbnNlfSBvYmplY3RcclxuICAgICAqXHJcbiAgICAgKi9cclxuICAgIFVzZXJBZ2VudEFwcGxpY2F0aW9uLnByb3RvdHlwZS5hY3F1aXJlVG9rZW5TaWxlbnQgPSBmdW5jdGlvbiAodXNlclJlcXVlc3QpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJBY3F1aXJlVG9rZW5TaWxlbnQgaGFzIGJlZW4gY2FsbGVkXCIpO1xyXG4gICAgICAgIC8vIHZhbGlkYXRlIHRoZSByZXF1ZXN0XHJcbiAgICAgICAgdmFyIHJlcXVlc3QgPSBSZXF1ZXN0VXRpbHMudmFsaWRhdGVSZXF1ZXN0KHVzZXJSZXF1ZXN0LCBmYWxzZSwgdGhpcy5jbGllbnRJZCwgQ29uc3RhbnRzLmludGVyYWN0aW9uVHlwZVNpbGVudCk7XHJcbiAgICAgICAgdmFyIGFwaUV2ZW50ID0gdGhpcy50ZWxlbWV0cnlNYW5hZ2VyLmNyZWF0ZUFuZFN0YXJ0QXBpRXZlbnQocmVxdWVzdC5jb3JyZWxhdGlvbklkLCBBUElfRVZFTlRfSURFTlRJRklFUi5BY3F1aXJlVG9rZW5TaWxlbnQpO1xyXG4gICAgICAgIHZhciByZXF1ZXN0U2lnbmF0dXJlID0gUmVxdWVzdFV0aWxzLmNyZWF0ZVJlcXVlc3RTaWduYXR1cmUocmVxdWVzdCk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKF90aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgc2NvcGUsIGFjY291bnQsIGFkYWxJZFRva2VuLCByZXNwb25zZVR5cGUsIHNlcnZlckF1dGhlbnRpY2F0aW9uUmVxdWVzdCwgYWRhbElkVG9rZW5PYmplY3QsIHVzZXJDb250YWluZWRDbGFpbXMsIGF1dGhFcnIsIGNhY2hlUmVzdWx0UmVzcG9uc2UsIGxvZ01lc3NhZ2UsIGVycl8yO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJsb2NrIHRoZSByZXF1ZXN0IGlmIG1hZGUgZnJvbSB0aGUgaGlkZGVuIGlmcmFtZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBXaW5kb3dVdGlscy5ibG9ja1JlbG9hZEluSGlkZGVuSWZyYW1lcygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZSA9IHJlcXVlc3Quc2NvcGVzLmpvaW4oXCIgXCIpLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2VQaWkoXCJTZXJpYWxpemVkIHNjb3BlczogXCIgKyBzY29wZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXF1ZXN0LmFjY291bnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnQgPSByZXF1ZXN0LmFjY291bnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiQWNjb3VudCBzZXQgZnJvbSByZXF1ZXN0XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3VudCA9IHRoaXMuZ2V0QWNjb3VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIkFjY291bnQgc2V0IGZyb20gTVNBTCBDYWNoZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGFsSWRUb2tlbiA9IHRoaXMuY2FjaGVTdG9yYWdlLmdldEl0ZW0oQ29uc3RhbnRzLmFkYWxJZFRva2VuKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSW4gdGhlIGV2ZW50IG9mIG5vIGFjY291bnQgYmVpbmcgcGFzc2VkIGluIHRoZSBjb25maWcsIG5vIHNlc3Npb24gaWQsIGFuZCBubyBwcmUtZXhpc3RpbmcgYWRhbElkVG9rZW4sIHVzZXIgd2lsbCBuZWVkIHRvIGxvZyBpblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFjY291bnQgJiYgIShyZXF1ZXN0LnNpZCB8fCByZXF1ZXN0LmxvZ2luSGludCkgJiYgU3RyaW5nVXRpbHMuaXNFbXB0eShhZGFsSWRUb2tlbikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLmluZm8oXCJVc2VyIGxvZ2luIGlzIHJlcXVpcmVkXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIHByb21pc2UgcmVqZWN0cyB3aXRoIGEgVXNlckxvZ2luUmVxdWlyZWRFcnJvciwgd2hpY2ggc2hvdWxkIGJlIGNhdWdodCBhbmQgdXNlciBzaG91bGQgYmUgcHJvbXB0ZWQgdG8gbG9nIGluIGludGVyYWN0aXZlbHlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMiAvKnJldHVybiovLCByZWplY3QoQ2xpZW50QXV0aEVycm9yLmNyZWF0ZVVzZXJMb2dpblJlcXVpcmVkRXJyb3IoKSldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlVHlwZSA9IHRoaXMuZ2V0VG9rZW5UeXBlKGFjY291bnQsIHJlcXVlc3Quc2NvcGVzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIlJlc3BvbnNlIHR5cGU6IFwiICsgcmVzcG9uc2VUeXBlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VydmVyQXV0aGVudGljYXRpb25SZXF1ZXN0ID0gbmV3IFNlcnZlclJlcXVlc3RQYXJhbWV0ZXJzKEF1dGhvcml0eUZhY3RvcnkuQ3JlYXRlSW5zdGFuY2UocmVxdWVzdC5hdXRob3JpdHksIHRoaXMuY29uZmlnLmF1dGgudmFsaWRhdGVBdXRob3JpdHksIHJlcXVlc3QuYXV0aG9yaXR5TWV0YWRhdGEpLCB0aGlzLmNsaWVudElkLCByZXNwb25zZVR5cGUsIHRoaXMuZ2V0UmVkaXJlY3RVcmkocmVxdWVzdC5yZWRpcmVjdFVyaSksIHJlcXVlc3Quc2NvcGVzLCByZXF1ZXN0LnN0YXRlLCByZXF1ZXN0LmNvcnJlbGF0aW9uSWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiRmluaXNoZWQgYnVpbGRpbmcgc2VydmVyIGF1dGhlbnRpY2F0aW9uIHJlcXVlc3RcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBvcHVsYXRlIFF1ZXJ5UGFyYW1ldGVycyAoc2lkL2xvZ2luX2hpbnQpIGFuZCBhbnkgb3RoZXIgZXh0cmFRdWVyeVBhcmFtZXRlcnMgc2V0IGJ5IHRoZSBkZXZlbG9wZXJcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFNlcnZlclJlcXVlc3RQYXJhbWV0ZXJzLmlzU1NPUGFyYW0ocmVxdWVzdCkgfHwgYWNjb3VudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VydmVyQXV0aGVudGljYXRpb25SZXF1ZXN0LnBvcHVsYXRlUXVlcnlQYXJhbXMoYWNjb3VudCwgcmVxdWVzdCwgbnVsbCwgdHJ1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiUXVlcnkgcGFyYW1ldGVycyBwb3B1bGF0ZWQgZnJvbSBleGlzdGluZyBTU08gb3IgYWNjb3VudFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiB1c2VyIGRpZG4ndCBwYXNzIGxvZ2luX2hpbnQvc2lkIGFuZCBhZGFsJ3MgaWR0b2tlbiBpcyBwcmVzZW50LCBleHRyYWN0IHRoZSBsb2dpbl9oaW50IGZyb20gdGhlIGFkYWxJZFRva2VuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFhY2NvdW50ICYmICFTdHJpbmdVdGlscy5pc0VtcHR5KGFkYWxJZFRva2VuKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRhbElkVG9rZW5PYmplY3QgPSBUb2tlblV0aWxzLmV4dHJhY3RJZFRva2VuKGFkYWxJZFRva2VuKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJBREFMJ3MgaWRUb2tlbiBleGlzdHMuIEV4dHJhY3RpbmcgbG9naW4gaW5mb3JtYXRpb24gZnJvbSBBREFMJ3MgaWRUb2tlbiB0byBwb3B1bGF0ZSBxdWVyeSBwYXJhbWV0ZXJzXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VydmVyQXV0aGVudGljYXRpb25SZXF1ZXN0LnBvcHVsYXRlUXVlcnlQYXJhbXMoYWNjb3VudCwgbnVsbCwgYWRhbElkVG9rZW5PYmplY3QsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIk5vIGFkZGl0aW9uYWwgcXVlcnkgcGFyYW1ldGVycyBhZGRlZFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VyQ29udGFpbmVkQ2xhaW1zID0gcmVxdWVzdC5jbGFpbXNSZXF1ZXN0IHx8IHNlcnZlckF1dGhlbnRpY2F0aW9uUmVxdWVzdC5jbGFpbXNWYWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgcmVxdWVzdC5mb3JjZVJlZnJlc2ggaXMgc2V0IHRvIHRydWUsIGZvcmNlIGEgcmVxdWVzdCBmb3IgYSBuZXcgdG9rZW4gaW5zdGVhZCBvZiBnZXR0aW5nIGl0IGZyb20gdGhlIGNhY2hlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdXNlckNvbnRhaW5lZENsYWltcyAmJiAhcmVxdWVzdC5mb3JjZVJlZnJlc2gpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGVSZXN1bHRSZXNwb25zZSA9IHRoaXMuZ2V0Q2FjaGVkVG9rZW4oc2VydmVyQXV0aGVudGljYXRpb25SZXF1ZXN0LCBhY2NvdW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0aEVyciA9IGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFjYWNoZVJlc3VsdFJlc3BvbnNlKSByZXR1cm4gWzMgLypicmVhayovLCAxXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIlRva2VuIGZvdW5kIGluIGNhY2hlIGxvb2t1cFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZVBpaShcIlNjb3BlcyBmb3VuZDogXCIgKyBKU09OLnN0cmluZ2lmeShjYWNoZVJlc3VsdFJlc3BvbnNlLnNjb3BlcykpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGNhY2hlUmVzdWx0UmVzcG9uc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qLywgbnVsbF07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWF1dGhFcnIpIHJldHVybiBbMyAvKmJyZWFrKi8sIDJdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci5pbmZvUGlpKGF1dGhFcnIuZXJyb3JDb2RlICsgXCI6XCIgKyBhdXRoRXJyLmVycm9yTWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChhdXRoRXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIG51bGxdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9nTWVzc2FnZSA9IHZvaWQgMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHVzZXJDb250YWluZWRDbGFpbXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ01lc3NhZ2UgPSBcIlNraXBwZWQgY2FjaGUgbG9va3VwIHNpbmNlIGNsYWltcyB3ZXJlIGdpdmVuXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAocmVxdWVzdC5mb3JjZVJlZnJlc2gpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ01lc3NhZ2UgPSBcIlNraXBwZWQgY2FjaGUgbG9va3VwIHNpbmNlIHJlcXVlc3QuZm9yY2VSZWZyZXNoIG9wdGlvbiB3YXMgc2V0IHRvIHRydWVcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvZ01lc3NhZ2UgPSBcIk5vIHZhbGlkIHRva2VuIGZvdW5kIGluIGNhY2hlIGxvb2t1cFwiO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UobG9nTWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENhY2hlIHJlc3VsdCBjYW4gcmV0dXJuIG51bGwgaWYgY2FjaGUgaXMgZW1wdHkuIEluIHRoYXQgY2FzZSwgc2V0IGF1dGhvcml0eSB0byBkZWZhdWx0IHZhbHVlIGlmIG5vIGF1dGhvcml0eSBpcyBwYXNzZWQgdG8gdGhlIEFQSS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzZXJ2ZXJBdXRoZW50aWNhdGlvblJlcXVlc3QuYXV0aG9yaXR5SW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZlckF1dGhlbnRpY2F0aW9uUmVxdWVzdC5hdXRob3JpdHlJbnN0YW5jZSA9IHJlcXVlc3QuYXV0aG9yaXR5ID9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBdXRob3JpdHlGYWN0b3J5LkNyZWF0ZUluc3RhbmNlKHJlcXVlc3QuYXV0aG9yaXR5LCB0aGlzLmNvbmZpZy5hdXRoLnZhbGlkYXRlQXV0aG9yaXR5LCByZXF1ZXN0LmF1dGhvcml0eU1ldGFkYXRhKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdGhpcy5hdXRob3JpdHlJbnN0YW5jZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlUGlpKFwiQXV0aG9yaXR5IGluc3RhbmNlOiBcIiArIHNlcnZlckF1dGhlbnRpY2F0aW9uUmVxdWVzdC5hdXRob3JpdHkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDM7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS50cnlzLnB1c2goWzMsIDcsICwgOF0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISFzZXJ2ZXJBdXRoZW50aWNhdGlvblJlcXVlc3QuYXV0aG9yaXR5SW5zdGFuY2UuaGFzQ2FjaGVkTWV0YWRhdGEoKSkgcmV0dXJuIFszIC8qYnJlYWsqLywgNV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJObyBjYWNoZWQgbWV0YWRhdGEgZm9yIGF1dGhvcml0eVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgQXV0aG9yaXR5RmFjdG9yeS5zYXZlTWV0YWRhdGFGcm9tTmV0d29yayhzZXJ2ZXJBdXRoZW50aWNhdGlvblJlcXVlc3QuYXV0aG9yaXR5SW5zdGFuY2UsIHRoaXMudGVsZW1ldHJ5TWFuYWdlciwgcmVxdWVzdC5jb3JyZWxhdGlvbklkKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJBdXRob3JpdHkgaGFzIGJlZW4gdXBkYXRlZCB3aXRoIGVuZHBvaW50IGRpc2NvdmVyeSByZXNwb25zZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNl07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiQ2FjaGVkIG1ldGFkYXRhIGZvdW5kIGZvciBhdXRob3JpdHlcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hLmxhYmVsID0gNjtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDY6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAqIHJlZnJlc2ggYXR0ZW1wdCB3aXRoIGlmcmFtZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgKiBBbHJlYWR5IHJlbmV3aW5nIGZvciB0aGlzIHNjb3BlLCBjYWxsYmFjayB3aGVuIHdlIGdldCB0aGUgdG9rZW4uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93LmFjdGl2ZVJlbmV3YWxzW3JlcXVlc3RTaWduYXR1cmVdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiUmVuZXdpbmcgdG9rZW4gaW4gcHJvZ3Jlc3MuIFJlZ2lzdGVyaW5nIGNhbGxiYWNrXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWN0aXZlIHJlbmV3YWxzIGNvbnRhaW5zIHRoZSBzdGF0ZSBmb3IgZWFjaCByZW5ld2FsLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWdpc3RlckNhbGxiYWNrKHdpbmRvdy5hY3RpdmVSZW5ld2Fsc1tyZXF1ZXN0U2lnbmF0dXJlXSwgcmVxdWVzdFNpZ25hdHVyZSwgcmVzb2x2ZSwgcmVqZWN0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXF1ZXN0LnNjb3BlcyAmJiBTY29wZVNldC5vbmx5Q29udGFpbnNPaWRjU2NvcGVzKHJlcXVlc3Quc2NvcGVzKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQXBwIHVzZXMgaWRUb2tlbiB0byBzZW5kIHRvIGFwaSBlbmRwb2ludHNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBEZWZhdWx0IHNjb3BlIGlzIHRyYWNrZWQgYXMgT0lEQyBzY29wZXMgdG8gc3RvcmUgdGhpcyB0b2tlblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJPcGVuSUQgQ29ubmVjdCBzY29wZXMgb25seSwgcmVuZXdpbmcgaWRUb2tlblwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNpbGVudExvZ2luID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmV3SWRUb2tlbihyZXF1ZXN0U2lnbmF0dXJlLCByZXNvbHZlLCByZWplY3QsIGFjY291bnQsIHNlcnZlckF1dGhlbnRpY2F0aW9uUmVxdWVzdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyByZW5ldyBhY2Nlc3MgdG9rZW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiUmVuZXdpbmcgYWNjZXNzIHRva2VuXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZXdUb2tlbihyZXF1ZXN0U2lnbmF0dXJlLCByZXNvbHZlLCByZWplY3QsIGFjY291bnQsIHNlcnZlckF1dGhlbnRpY2F0aW9uUmVxdWVzdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgOF07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA3OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJfMiA9IF9hLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoZXJyXzIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoQ2xpZW50QXV0aEVycm9yLmNyZWF0ZUVuZHBvaW50UmVzb2x1dGlvbkVycm9yKGVycl8yLnRvU3RyaW5nKCkpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIG51bGxdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgODogcmV0dXJuIFsyIC8qcmV0dXJuKi9dO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTsgfSlcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlcykge1xyXG4gICAgICAgICAgICBfdGhpcy5sb2dnZXIudmVyYm9zZShcIlN1Y2Nlc3NmdWxseSBhY3F1aXJlZCB0b2tlblwiKTtcclxuICAgICAgICAgICAgX3RoaXMudGVsZW1ldHJ5TWFuYWdlci5zdG9wQW5kRmx1c2hBcGlFdmVudChyZXF1ZXN0LmNvcnJlbGF0aW9uSWQsIGFwaUV2ZW50LCB0cnVlKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcztcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XHJcbiAgICAgICAgICAgIF90aGlzLmNhY2hlU3RvcmFnZS5yZXNldFRlbXBDYWNoZUl0ZW1zKHJlcXVlc3Quc3RhdGUpO1xyXG4gICAgICAgICAgICBfdGhpcy50ZWxlbWV0cnlNYW5hZ2VyLnN0b3BBbmRGbHVzaEFwaUV2ZW50KHJlcXVlc3QuY29ycmVsYXRpb25JZCwgYXBpRXZlbnQsIGZhbHNlLCBlcnJvci5lcnJvckNvZGUpO1xyXG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvLyAjZW5kcmVnaW9uXHJcbiAgICAvLyAjcmVnaW9uIFBvcHVwIFdpbmRvdyBDcmVhdGlvblxyXG4gICAgLyoqXHJcbiAgICAgKiBAaGlkZGVuXHJcbiAgICAgKlxyXG4gICAgICogQ29uZmlndXJlcyBwb3B1cCB3aW5kb3cgZm9yIGxvZ2luLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB1cmxOYXZpZ2F0ZVxyXG4gICAgICogQHBhcmFtIHRpdGxlXHJcbiAgICAgKiBAcGFyYW0gcG9wVXBXaWR0aFxyXG4gICAgICogQHBhcmFtIHBvcFVwSGVpZ2h0XHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiBAaGlkZGVuXHJcbiAgICAgKi9cclxuICAgIFVzZXJBZ2VudEFwcGxpY2F0aW9uLnByb3RvdHlwZS5vcGVuUG9wdXAgPSBmdW5jdGlvbiAodXJsTmF2aWdhdGUsIHRpdGxlLCBwb3BVcFdpZHRoLCBwb3BVcEhlaWdodCkge1xyXG4gICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJPcGVuUG9wdXAgaGFzIGJlZW4gY2FsbGVkXCIpO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIC8qKlxyXG4gICAgICAgICAgICAgKiBhZGRpbmcgd2luTGVmdCBhbmQgd2luVG9wIHRvIGFjY291bnQgZm9yIGR1YWwgbW9uaXRvclxyXG4gICAgICAgICAgICAgKiB1c2luZyBzY3JlZW5MZWZ0IGFuZCBzY3JlZW5Ub3AgZm9yIElFOCBhbmQgZWFybGllclxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgdmFyIHdpbkxlZnQgPSB3aW5kb3cuc2NyZWVuTGVmdCA/IHdpbmRvdy5zY3JlZW5MZWZ0IDogd2luZG93LnNjcmVlblg7XHJcbiAgICAgICAgICAgIHZhciB3aW5Ub3AgPSB3aW5kb3cuc2NyZWVuVG9wID8gd2luZG93LnNjcmVlblRvcCA6IHdpbmRvdy5zY3JlZW5ZO1xyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogd2luZG93LmlubmVyV2lkdGggZGlzcGxheXMgYnJvd3NlciB3aW5kb3dcInMgaGVpZ2h0IGFuZCB3aWR0aCBleGNsdWRpbmcgdG9vbGJhcnNcclxuICAgICAgICAgICAgICogdXNpbmcgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoIGZvciBJRTggYW5kIGVhcmxpZXJcclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHZhciB3aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCB8fCBkb2N1bWVudC5ib2R5LmNsaWVudFdpZHRoO1xyXG4gICAgICAgICAgICB2YXIgaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQgfHwgZG9jdW1lbnQuYm9keS5jbGllbnRIZWlnaHQ7XHJcbiAgICAgICAgICAgIHZhciBsZWZ0ID0gKCh3aWR0aCAvIDIpIC0gKHBvcFVwV2lkdGggLyAyKSkgKyB3aW5MZWZ0O1xyXG4gICAgICAgICAgICB2YXIgdG9wXzEgPSAoKGhlaWdodCAvIDIpIC0gKHBvcFVwSGVpZ2h0IC8gMikpICsgd2luVG9wO1xyXG4gICAgICAgICAgICAvLyBvcGVuIHRoZSB3aW5kb3dcclxuICAgICAgICAgICAgdmFyIHBvcHVwV2luZG93ID0gd2luZG93Lm9wZW4odXJsTmF2aWdhdGUsIHRpdGxlLCBcIndpZHRoPVwiICsgcG9wVXBXaWR0aCArIFwiLCBoZWlnaHQ9XCIgKyBwb3BVcEhlaWdodCArIFwiLCB0b3A9XCIgKyB0b3BfMSArIFwiLCBsZWZ0PVwiICsgbGVmdCArIFwiLCBzY3JvbGxiYXJzPXllc1wiKTtcclxuICAgICAgICAgICAgaWYgKCFwb3B1cFdpbmRvdykge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgQ2xpZW50QXV0aEVycm9yLmNyZWF0ZVBvcHVwV2luZG93RXJyb3IoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAocG9wdXBXaW5kb3cuZm9jdXMpIHtcclxuICAgICAgICAgICAgICAgIHBvcHVwV2luZG93LmZvY3VzKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHBvcHVwV2luZG93O1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZS5yZW1vdmVJdGVtKFRlbXBvcmFyeUNhY2hlS2V5cy5JTlRFUkFDVElPTl9TVEFUVVMpO1xyXG4gICAgICAgICAgICB0aHJvdyBDbGllbnRBdXRoRXJyb3IuY3JlYXRlUG9wdXBXaW5kb3dFcnJvcihlLnRvU3RyaW5nKCkpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvLyAjZW5kcmVnaW9uXHJcbiAgICAvLyAjcmVnaW9uIElmcmFtZSBNYW5hZ2VtZW50XHJcbiAgICAvKipcclxuICAgICAqIEBoaWRkZW5cclxuICAgICAqIENhbGxpbmcgX2xvYWRGcmFtZSBidXQgd2l0aCBhIHRpbWVvdXQgdG8gc2lnbmFsIGZhaWx1cmUgaW4gbG9hZGZyYW1lU3RhdHVzLiBDYWxsYmFja3MgYXJlIGxlZnQuXHJcbiAgICAgKiByZWdpc3RlcmVkIHdoZW4gbmV0d29yayBlcnJvcnMgb2NjdXIgYW5kIHN1YnNlcXVlbnQgdG9rZW4gcmVxdWVzdHMgZm9yIHNhbWUgcmVzb3VyY2UgYXJlIHJlZ2lzdGVyZWQgdG8gdGhlIHBlbmRpbmcgcmVxdWVzdC5cclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqL1xyXG4gICAgVXNlckFnZW50QXBwbGljYXRpb24ucHJvdG90eXBlLmxvYWRJZnJhbWVUaW1lb3V0ID0gZnVuY3Rpb24gKHVybE5hdmlnYXRlLCBmcmFtZU5hbWUsIHJlcXVlc3RTaWduYXR1cmUpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIGV4cGVjdGVkU3RhdGUsIGlmcmFtZSwgX2EsIGhhc2gsIGVycm9yXzI7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYikge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYi5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXhwZWN0ZWRTdGF0ZSA9IHdpbmRvdy5hY3RpdmVSZW5ld2Fsc1tyZXF1ZXN0U2lnbmF0dXJlXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZVBpaShcIlNldCBsb2FkaW5nIHN0YXRlIHRvIHBlbmRpbmcgZm9yOiBcIiArIHJlcXVlc3RTaWduYXR1cmUgKyBcIjpcIiArIGV4cGVjdGVkU3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZS5zZXRJdGVtKEF1dGhDYWNoZS5nZW5lcmF0ZVRlbXBvcmFyeUNhY2hlS2V5KFRlbXBvcmFyeUNhY2hlS2V5cy5SRU5FV19TVEFUVVMsIGV4cGVjdGVkU3RhdGUpLCBDb25zdGFudHMuaW5Qcm9ncmVzcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5jb25maWcuc3lzdGVtLm5hdmlnYXRlRnJhbWVXYWl0KSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgV2luZG93VXRpbHMubG9hZEZyYW1lKHVybE5hdmlnYXRlLCBmcmFtZU5hbWUsIHRoaXMuY29uZmlnLnN5c3RlbS5uYXZpZ2F0ZUZyYW1lV2FpdCwgdGhpcy5sb2dnZXIpXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gX2Iuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCAzXTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9hID0gV2luZG93VXRpbHMubG9hZEZyYW1lU3luYyh1cmxOYXZpZ2F0ZSwgZnJhbWVOYW1lLCB0aGlzLmxvZ2dlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gMztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmcmFtZSA9IF9hO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5sYWJlbCA9IDQ7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYi50cnlzLnB1c2goWzQsIDYsICwgN10pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCBXaW5kb3dVdGlscy5tb25pdG9ySWZyYW1lRm9ySGFzaChpZnJhbWUuY29udGVudFdpbmRvdywgdGhpcy5jb25maWcuc3lzdGVtLmxvYWRGcmFtZVRpbWVvdXQsIHVybE5hdmlnYXRlLCB0aGlzLmxvZ2dlcildO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgNTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGFzaCA9IF9iLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhhc2gpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlQXV0aGVudGljYXRpb25SZXNwb25zZShoYXNoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA3XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDY6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yXzIgPSBfYi5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNhY2hlU3RvcmFnZS5nZXRJdGVtKEF1dGhDYWNoZS5nZW5lcmF0ZVRlbXBvcmFyeUNhY2hlS2V5KFRlbXBvcmFyeUNhY2hlS2V5cy5SRU5FV19TVEFUVVMsIGV4cGVjdGVkU3RhdGUpKSA9PT0gQ29uc3RhbnRzLmluUHJvZ3Jlc3MpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZhaWwgdGhlIGlmcmFtZSBzZXNzaW9uIGlmIGl0J3MgaW4gcGVuZGluZyBzdGF0ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIkxvYWRpbmcgZnJhbWUgaGFzIHRpbWVkIG91dCBhZnRlcjogXCIgKyAodGhpcy5jb25maWcuc3lzdGVtLmxvYWRGcmFtZVRpbWVvdXQgLyAxMDAwKSArIFwiIHNlY29uZHMgZm9yIHNjb3BlL2F1dGhvcml0eSBcIiArIHJlcXVlc3RTaWduYXR1cmUgKyBcIjpcIiArIGV4cGVjdGVkU3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRXJyb3IgYWZ0ZXIgdGltZW91dFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4cGVjdGVkU3RhdGUgJiYgd2luZG93LmNhbGxiYWNrTWFwcGVkVG9SZW5ld1N0YXRlc1tleHBlY3RlZFN0YXRlXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jYWxsYmFja01hcHBlZFRvUmVuZXdTdGF0ZXNbZXhwZWN0ZWRTdGF0ZV0obnVsbCwgZXJyb3JfMik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZS5yZW1vdmVJdGVtKEF1dGhDYWNoZS5nZW5lcmF0ZVRlbXBvcmFyeUNhY2hlS2V5KFRlbXBvcmFyeUNhY2hlS2V5cy5SRU5FV19TVEFUVVMsIGV4cGVjdGVkU3RhdGUpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBXaW5kb3dVdGlscy5yZW1vdmVIaWRkZW5JZnJhbWUoaWZyYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyb3JfMjtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFdpbmRvd1V0aWxzLnJlbW92ZUhpZGRlbklmcmFtZShpZnJhbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8vICNlbmRyZWdpb25cclxuICAgIC8vICNyZWdpb24gR2VuZXJhbCBIZWxwZXJzXHJcbiAgICAvKipcclxuICAgICAqIEBoaWRkZW5cclxuICAgICAqIFVzZWQgdG8gcmVkaXJlY3QgdGhlIGJyb3dzZXIgdG8gdGhlIFNUUyBhdXRob3JpemF0aW9uIGVuZHBvaW50XHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdXJsTmF2aWdhdGUgLSBVUkwgb2YgdGhlIGF1dGhvcml6YXRpb24gZW5kcG9pbnRcclxuICAgICAqL1xyXG4gICAgVXNlckFnZW50QXBwbGljYXRpb24ucHJvdG90eXBlLm5hdmlnYXRlV2luZG93ID0gZnVuY3Rpb24gKHVybE5hdmlnYXRlLCBwb3B1cFdpbmRvdykge1xyXG4gICAgICAgIC8vIE5hdmlnYXRlIGlmIHZhbGlkIFVSTFxyXG4gICAgICAgIGlmICh1cmxOYXZpZ2F0ZSAmJiAhU3RyaW5nVXRpbHMuaXNFbXB0eSh1cmxOYXZpZ2F0ZSkpIHtcclxuICAgICAgICAgICAgdmFyIG5hdmlnYXRlV2luZG93ID0gcG9wdXBXaW5kb3cgPyBwb3B1cFdpbmRvdyA6IHdpbmRvdztcclxuICAgICAgICAgICAgdmFyIGxvZ01lc3NhZ2UgPSBwb3B1cFdpbmRvdyA/IFwiTmF2aWdhdGVkIFBvcHVwIHdpbmRvdyB0bzpcIiArIHVybE5hdmlnYXRlIDogXCJOYXZpZ2F0ZSB0bzpcIiArIHVybE5hdmlnYXRlO1xyXG4gICAgICAgICAgICB0aGlzLmxvZ2dlci5pbmZvUGlpKGxvZ01lc3NhZ2UpO1xyXG4gICAgICAgICAgICBuYXZpZ2F0ZVdpbmRvdy5sb2NhdGlvbi5hc3NpZ24odXJsTmF2aWdhdGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5sb2dnZXIuaW5mbyhcIk5hdmlnYXRlIHVybCBpcyBlbXB0eVwiKTtcclxuICAgICAgICAgICAgdGhyb3cgQXV0aEVycm9yLmNyZWF0ZVVuZXhwZWN0ZWRFcnJvcihcIk5hdmlnYXRlIHVybCBpcyBlbXB0eVwiKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaGlkZGVuXHJcbiAgICAgKiBVc2VkIHRvIGFkZCB0aGUgZGV2ZWxvcGVyIHJlcXVlc3RlZCBjYWxsYmFjayB0byB0aGUgYXJyYXkgb2YgY2FsbGJhY2tzIGZvciB0aGUgc3BlY2lmaWVkIHNjb3Blcy4gVGhlIHVwZGF0ZWQgYXJyYXkgaXMgc3RvcmVkIG9uIHRoZSB3aW5kb3cgb2JqZWN0XHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gZXhwZWN0ZWRTdGF0ZSAtIFVuaXF1ZSBzdGF0ZSBpZGVudGlmaWVyIChndWlkKS5cclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzY29wZSAtIERldmVsb3BlciByZXF1ZXN0ZWQgcGVybWlzc2lvbnMuIE5vdCBhbGwgc2NvcGVzIGFyZSBndWFyYW50ZWVkIHRvIGJlIGluY2x1ZGVkIGluIHRoZSBhY2Nlc3MgdG9rZW4gcmV0dXJuZWQuXHJcbiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSByZXNvbHZlIC0gVGhlIHJlc29sdmUgZnVuY3Rpb24gb2YgdGhlIHByb21pc2Ugb2JqZWN0LlxyXG4gICAgICogQHBhcmFtIHtGdW5jdGlvbn0gcmVqZWN0IC0gVGhlIHJlamVjdCBmdW5jdGlvbiBvZiB0aGUgcHJvbWlzZSBvYmplY3QuXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKi9cclxuICAgIFVzZXJBZ2VudEFwcGxpY2F0aW9uLnByb3RvdHlwZS5yZWdpc3RlckNhbGxiYWNrID0gZnVuY3Rpb24gKGV4cGVjdGVkU3RhdGUsIHJlcXVlc3RTaWduYXR1cmUsIHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgLy8gdHJhY2sgYWN0aXZlIHJlbmV3YWxzXHJcbiAgICAgICAgd2luZG93LmFjdGl2ZVJlbmV3YWxzW3JlcXVlc3RTaWduYXR1cmVdID0gZXhwZWN0ZWRTdGF0ZTtcclxuICAgICAgICAvLyBpbml0aWFsaXplIGNhbGxiYWNrcyBtYXBwZWQgYXJyYXlcclxuICAgICAgICBpZiAoIXdpbmRvdy5wcm9taXNlTWFwcGVkVG9SZW5ld1N0YXRlc1tleHBlY3RlZFN0YXRlXSkge1xyXG4gICAgICAgICAgICB3aW5kb3cucHJvbWlzZU1hcHBlZFRvUmVuZXdTdGF0ZXNbZXhwZWN0ZWRTdGF0ZV0gPSBbXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gaW5kZXhpbmcgb24gdGhlIGN1cnJlbnQgc3RhdGUsIHB1c2ggdGhlIGNhbGxiYWNrIHBhcmFtcyB0byBjYWxsYmFja3MgbWFwcGVkXHJcbiAgICAgICAgd2luZG93LnByb21pc2VNYXBwZWRUb1JlbmV3U3RhdGVzW2V4cGVjdGVkU3RhdGVdLnB1c2goeyByZXNvbHZlOiByZXNvbHZlLCByZWplY3Q6IHJlamVjdCB9KTtcclxuICAgICAgICAvLyBTdG9yZSB0aGUgc2VydmVyIHJlc3BvbnNlIGluIHRoZSBjdXJyZW50IHdpbmRvdz8/XHJcbiAgICAgICAgaWYgKCF3aW5kb3cuY2FsbGJhY2tNYXBwZWRUb1JlbmV3U3RhdGVzW2V4cGVjdGVkU3RhdGVdKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5jYWxsYmFja01hcHBlZFRvUmVuZXdTdGF0ZXNbZXhwZWN0ZWRTdGF0ZV0gPSBmdW5jdGlvbiAocmVzcG9uc2UsIGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAvLyByZXNldCBhY3RpdmUgcmVuZXdhbHNcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5hY3RpdmVSZW5ld2Fsc1tyZXF1ZXN0U2lnbmF0dXJlXSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAvLyBmb3IgYWxsIHByb21pc2VNYXBwZWR0b1JlbmV3U3RhdGVzIGZvciBhIGdpdmVuICdzdGF0ZScgLSBjYWxsIHRoZSByZWplY3QvcmVzb2x2ZSB3aXRoIGVycm9yL3Rva2VuIHJlc3BlY3RpdmVseVxyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB3aW5kb3cucHJvbWlzZU1hcHBlZFRvUmVuZXdTdGF0ZXNbZXhwZWN0ZWRTdGF0ZV0ubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5wcm9taXNlTWFwcGVkVG9SZW5ld1N0YXRlc1tleHBlY3RlZFN0YXRlXVtpXS5yZWplY3QoZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cucHJvbWlzZU1hcHBlZFRvUmVuZXdTdGF0ZXNbZXhwZWN0ZWRTdGF0ZV1baV0ucmVzb2x2ZShyZXNwb25zZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5jYWNoZVN0b3JhZ2UucmVzZXRUZW1wQ2FjaGVJdGVtcyhleHBlY3RlZFN0YXRlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IEF1dGhFcnJvci5jcmVhdGVVbmV4cGVjdGVkRXJyb3IoXCJFcnJvciBhbmQgcmVzcG9uc2UgYXJlIGJvdGggbnVsbFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5sb2dnZXIud2FybmluZyhlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyByZXNldFxyXG4gICAgICAgICAgICAgICAgd2luZG93LnByb21pc2VNYXBwZWRUb1JlbmV3U3RhdGVzW2V4cGVjdGVkU3RhdGVdID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5jYWxsYmFja01hcHBlZFRvUmVuZXdTdGF0ZXNbZXhwZWN0ZWRTdGF0ZV0gPSBudWxsO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvLyAjZW5kcmVnaW9uXHJcbiAgICAvLyAjcmVnaW9uIExvZ291dFxyXG4gICAgLyoqXHJcbiAgICAgKiBVc2UgdG8gbG9nIG91dCB0aGUgY3VycmVudCB1c2VyLCBhbmQgcmVkaXJlY3QgdGhlIHVzZXIgdG8gdGhlIHBvc3RMb2dvdXRSZWRpcmVjdFVyaS5cclxuICAgICAqIERlZmF1bHQgYmVoYXZpb3VyIGlzIHRvIHJlZGlyZWN0IHRoZSB1c2VyIHRvIGB3aW5kb3cubG9jYXRpb24uaHJlZmAuXHJcbiAgICAgKi9cclxuICAgIFVzZXJBZ2VudEFwcGxpY2F0aW9uLnByb3RvdHlwZS5sb2dvdXQgPSBmdW5jdGlvbiAoY29ycmVsYXRpb25JZCkge1xyXG4gICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJMb2dvdXQgaGFzIGJlZW4gY2FsbGVkXCIpO1xyXG4gICAgICAgIHRoaXMubG9nb3V0QXN5bmMoY29ycmVsYXRpb25JZCk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBBc3luYyB2ZXJzaW9uIG9mIGxvZ291dCgpLiBVc2UgdG8gbG9nIG91dCB0aGUgY3VycmVudCB1c2VyLlxyXG4gICAgICogQHBhcmFtIGNvcnJlbGF0aW9uSWQgUmVxdWVzdCBjb3JyZWxhdGlvbklkXHJcbiAgICAgKi9cclxuICAgIFVzZXJBZ2VudEFwcGxpY2F0aW9uLnByb3RvdHlwZS5sb2dvdXRBc3luYyA9IGZ1bmN0aW9uIChjb3JyZWxhdGlvbklkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciByZXF1ZXN0Q29ycmVsYXRpb25JZCwgYXBpRXZlbnQsIGNvcnJlbGF0aW9uSWRQYXJhbSwgcG9zdExvZ291dFF1ZXJ5UGFyYW0sIHVybE5hdmlnYXRlLCBlcnJvcl8zO1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RDb3JyZWxhdGlvbklkID0gY29ycmVsYXRpb25JZCB8fCBDcnlwdG9VdGlscy5jcmVhdGVOZXdHdWlkKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFwaUV2ZW50ID0gdGhpcy50ZWxlbWV0cnlNYW5hZ2VyLmNyZWF0ZUFuZFN0YXJ0QXBpRXZlbnQocmVxdWVzdENvcnJlbGF0aW9uSWQsIEFQSV9FVkVOVF9JREVOVElGSUVSLkxvZ291dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJDYWNoZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFjY291bnQgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS50cnlzLnB1c2goWzEsIDUsICwgNl0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISF0aGlzLmF1dGhvcml0eUluc3RhbmNlLmhhc0NhY2hlZE1ldGFkYXRhKCkpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiTm8gY2FjaGVkIG1ldGFkYXRhIGZvciBhdXRob3JpdHlcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbNCAvKnlpZWxkKi8sIEF1dGhvcml0eUZhY3Rvcnkuc2F2ZU1ldGFkYXRhRnJvbU5ldHdvcmsodGhpcy5hdXRob3JpdHlJbnN0YW5jZSwgdGhpcy50ZWxlbWV0cnlNYW5hZ2VyLCBjb3JyZWxhdGlvbklkKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMyAvKmJyZWFrKi8sIDRdO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIkNhY2hlZCBtZXRhZGF0YSBmb3VuZCBmb3IgYXV0aG9yaXR5XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS5sYWJlbCA9IDQ7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3JyZWxhdGlvbklkUGFyYW0gPSBcImNsaWVudC1yZXF1ZXN0LWlkPVwiICsgcmVxdWVzdENvcnJlbGF0aW9uSWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc3RMb2dvdXRRdWVyeVBhcmFtID0gdm9pZCAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5nZXRQb3N0TG9nb3V0UmVkaXJlY3RVcmkoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zdExvZ291dFF1ZXJ5UGFyYW0gPSBcIiZwb3N0X2xvZ291dF9yZWRpcmVjdF91cmk9XCIgKyBlbmNvZGVVUklDb21wb25lbnQodGhpcy5nZXRQb3N0TG9nb3V0UmVkaXJlY3RVcmkoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwicmVkaXJlY3RVcmkgZm91bmQgYW5kIHNldFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc3RMb2dvdXRRdWVyeVBhcmFtID0gXCJcIjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJObyByZWRpcmVjdFVyaSBzZXQgZm9yIGFwcC4gcG9zdExvZ291dFF1ZXJ5UGFyYW0gaXMgZW1wdHlcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgdXJsTmF2aWdhdGUgPSB2b2lkIDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmF1dGhvcml0eUluc3RhbmNlLkVuZFNlc3Npb25FbmRwb2ludCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsTmF2aWdhdGUgPSB0aGlzLmF1dGhvcml0eUluc3RhbmNlLkVuZFNlc3Npb25FbmRwb2ludCArIFwiP1wiICsgY29ycmVsYXRpb25JZFBhcmFtICsgcG9zdExvZ291dFF1ZXJ5UGFyYW07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiRW5kU2Vzc2lvbkVuZHBvaW50IGZvdW5kIGFuZCB1cmxOYXZpZ2F0ZSBzZXRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlUGlpKFwidXJsTmF2aWdhdGUgc2V0IHRvOiBcIiArIHRoaXMuYXV0aG9yaXR5SW5zdGFuY2UuRW5kU2Vzc2lvbkVuZHBvaW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybE5hdmlnYXRlID0gdGhpcy5hdXRob3JpdHkgKyBcIm9hdXRoMi92Mi4wL2xvZ291dD9cIiArIGNvcnJlbGF0aW9uSWRQYXJhbSArIHBvc3RMb2dvdXRRdWVyeVBhcmFtO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIk5vIGVuZHBvaW50LCB1cmxOYXZpZ2F0ZSBzZXQgdG8gZGVmYXVsdFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRlbGVtZXRyeU1hbmFnZXIuc3RvcEFuZEZsdXNoQXBpRXZlbnQocmVxdWVzdENvcnJlbGF0aW9uSWQsIGFwaUV2ZW50LCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIk5hdmlnYXRpbmcgd2luZG93IHRvIHVybE5hdmlnYXRlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm5hdmlnYXRlV2luZG93KHVybE5hdmlnYXRlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFszIC8qYnJlYWsqLywgNl07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA1OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcl8zID0gX2Euc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRlbGVtZXRyeU1hbmFnZXIuc3RvcEFuZEZsdXNoQXBpRXZlbnQocmVxdWVzdENvcnJlbGF0aW9uSWQsIGFwaUV2ZW50LCBmYWxzZSwgZXJyb3JfMy5lcnJvckNvZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzMgLypicmVhayovLCA2XTtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDY6IHJldHVybiBbMiAvKnJldHVybiovXTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaGlkZGVuXHJcbiAgICAgKiBDbGVhciBhbGwgYWNjZXNzIHRva2VucyBhbmQgSUQgdG9rZW5zIGluIHRoZSBjYWNoZS5cclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqL1xyXG4gICAgVXNlckFnZW50QXBwbGljYXRpb24ucHJvdG90eXBlLmNsZWFyQ2FjaGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIkNsZWFyaW5nIGNhY2hlXCIpO1xyXG4gICAgICAgIHdpbmRvdy5yZW5ld1N0YXRlcyA9IFtdO1xyXG4gICAgICAgIHZhciB0b2tlbkNhY2hlSXRlbXMgPSB0aGlzLmNhY2hlU3RvcmFnZS5nZXRBbGxUb2tlbnMoQ29uc3RhbnRzLmNsaWVudElkLCBDb25zdGFudHMuaG9tZUFjY291bnRJZGVudGlmaWVyKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRva2VuQ2FjaGVJdGVtcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZS5yZW1vdmVJdGVtKEpTT04uc3RyaW5naWZ5KHRva2VuQ2FjaGVJdGVtc1tpXS5rZXkpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jYWNoZVN0b3JhZ2UucmVzZXRDYWNoZUl0ZW1zKCk7XHJcbiAgICAgICAgdGhpcy5jYWNoZVN0b3JhZ2UuY2xlYXJNc2FsQ29va2llKCk7XHJcbiAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIkNhY2hlIGNsZWFyZWRcIik7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaGlkZGVuXHJcbiAgICAgKiBDbGVhciBhIGdpdmVuIGFjY2VzcyB0b2tlbiBmcm9tIHRoZSBjYWNoZS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gYWNjZXNzVG9rZW5cclxuICAgICAqL1xyXG4gICAgVXNlckFnZW50QXBwbGljYXRpb24ucHJvdG90eXBlLmNsZWFyQ2FjaGVGb3JTY29wZSA9IGZ1bmN0aW9uIChhY2Nlc3NUb2tlbikge1xyXG4gICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJDbGVhcmluZyBhY2Nlc3MgdG9rZW4gZnJvbSBjYWNoZVwiKTtcclxuICAgICAgICB2YXIgYWNjZXNzVG9rZW5JdGVtcyA9IHRoaXMuY2FjaGVTdG9yYWdlLmdldEFsbEFjY2Vzc1Rva2VucyhDb25zdGFudHMuY2xpZW50SWQsIENvbnN0YW50cy5ob21lQWNjb3VudElkZW50aWZpZXIpO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYWNjZXNzVG9rZW5JdGVtcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgdG9rZW4gPSBhY2Nlc3NUb2tlbkl0ZW1zW2ldO1xyXG4gICAgICAgICAgICBpZiAodG9rZW4udmFsdWUuYWNjZXNzVG9rZW4gPT09IGFjY2Vzc1Rva2VuKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZS5yZW1vdmVJdGVtKEpTT04uc3RyaW5naWZ5KHRva2VuLmtleSkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZVBpaShcIkFjY2VzcyB0b2tlbiByZW1vdmVkOiBcIiArIHRva2VuLmtleSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgLy8gI2VuZHJlZ2lvblxyXG4gICAgLy8gI3JlZ2lvbiBSZXNwb25zZVxyXG4gICAgLyoqXHJcbiAgICAgKiBAaGlkZGVuXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiBDaGVja3MgaWYgdGhlIHJlZGlyZWN0IHJlc3BvbnNlIGlzIHJlY2VpdmVkIGZyb20gdGhlIFNUUy4gSW4gY2FzZSBvZiByZWRpcmVjdCwgdGhlIHVybCBmcmFnbWVudCBoYXMgZWl0aGVyIGlkX3Rva2VuLCBhY2Nlc3NfdG9rZW4gb3IgZXJyb3IuXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gaGFzaCAtIEhhc2ggcGFzc2VkIGZyb20gcmVkaXJlY3QgcGFnZS5cclxuICAgICAqIEByZXR1cm5zIHtCb29sZWFufSAtIHRydWUgaWYgcmVzcG9uc2UgY29udGFpbnMgaWRfdG9rZW4sIGFjY2Vzc190b2tlbiBvciBlcnJvciwgZmFsc2Ugb3RoZXJ3aXNlLlxyXG4gICAgICovXHJcbiAgICBVc2VyQWdlbnRBcHBsaWNhdGlvbi5wcm90b3R5cGUuaXNDYWxsYmFjayA9IGZ1bmN0aW9uIChoYXNoKSB7XHJcbiAgICAgICAgdGhpcy5sb2dnZXIuaW5mbyhcImlzQ2FsbGJhY2sgd2lsbCBiZSBkZXByZWNhdGVkIGluIGZhdm9yIG9mIHVybENvbnRhaW5zSGFzaCBpbiBNU0FMLmpzIHYyLjAuXCIpO1xyXG4gICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJpc0NhbGxiYWNrIGhhcyBiZWVuIGNhbGxlZFwiKTtcclxuICAgICAgICByZXR1cm4gVXJsVXRpbHMudXJsQ29udGFpbnNIYXNoKGhhc2gpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQGhpZGRlblxyXG4gICAgICogVXNlZCB0byBjYWxsIHRoZSBjb25zdHJ1Y3RvciBjYWxsYmFjayB3aXRoIHRoZSB0b2tlbi9lcnJvclxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtoYXNoPXdpbmRvdy5sb2NhdGlvbi5oYXNoXSAtIEhhc2ggZnJhZ21lbnQgb2YgVXJsLlxyXG4gICAgICovXHJcbiAgICBVc2VyQWdlbnRBcHBsaWNhdGlvbi5wcm90b3R5cGUucHJvY2Vzc0NhbGxCYWNrID0gZnVuY3Rpb24gKGhhc2gsIHN0YXRlSW5mbywgcGFyZW50Q2FsbGJhY2spIHtcclxuICAgICAgICB0aGlzLmxvZ2dlci5pbmZvKFwiUHJvY2Vzc0NhbGxCYWNrIGhhcyBiZWVuIGNhbGxlZC4gUHJvY2Vzc2luZyBjYWxsYmFjayBmcm9tIHJlZGlyZWN0IHJlc3BvbnNlXCIpO1xyXG4gICAgICAgIC8vIGdldCB0aGUgc3RhdGUgaW5mbyBmcm9tIHRoZSBoYXNoXHJcbiAgICAgICAgaWYgKCFzdGF0ZUluZm8pIHtcclxuICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIlN0YXRlSW5mbyBpcyBudWxsLCBnZXR0aW5nIHN0YXRlSW5mbyBmcm9tIGhhc2hcIik7XHJcbiAgICAgICAgICAgIHN0YXRlSW5mbyA9IHRoaXMuZ2V0UmVzcG9uc2VTdGF0ZShoYXNoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHJlc3BvbnNlO1xyXG4gICAgICAgIHZhciBhdXRoRXJyO1xyXG4gICAgICAgIC8vIFNhdmUgdGhlIHRva2VuIGluZm8gZnJvbSB0aGUgaGFzaFxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHJlc3BvbnNlID0gdGhpcy5zYXZlVG9rZW5Gcm9tSGFzaChoYXNoLCBzdGF0ZUluZm8pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgIGF1dGhFcnIgPSBlcnI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIC8vIENsZWFyIHRoZSBjb29raWUgaW4gdGhlIGhhc2hcclxuICAgICAgICAgICAgdGhpcy5jYWNoZVN0b3JhZ2UuY2xlYXJNc2FsQ29va2llKHN0YXRlSW5mby5zdGF0ZSk7XHJcbiAgICAgICAgICAgIHZhciBhY2NvdW50U3RhdGUgPSB0aGlzLmdldEFjY291bnRTdGF0ZShzdGF0ZUluZm8uc3RhdGUpO1xyXG4gICAgICAgICAgICBpZiAocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgIGlmICgoc3RhdGVJbmZvLnJlcXVlc3RUeXBlID09PSBDb25zdGFudHMucmVuZXdUb2tlbikgfHwgcmVzcG9uc2UuYWNjZXNzVG9rZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAod2luZG93LnBhcmVudCAhPT0gd2luZG93KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJXaW5kb3cgaXMgaW4gaWZyYW1lLCBhY3F1aXJpbmcgdG9rZW4gc2lsZW50bHlcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiQWNxdWlyaW5nIHRva2VuIGludGVyYWN0aXZlIGluIHByb2dyZXNzXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiUmVzcG9uc2UgdG9rZW5UeXBlIHNldCB0byBcIiArIFNlcnZlckhhc2hQYXJhbUtleXMuQUNDRVNTX1RPS0VOKTtcclxuICAgICAgICAgICAgICAgICAgICByZXNwb25zZS50b2tlblR5cGUgPSBTZXJ2ZXJIYXNoUGFyYW1LZXlzLkFDQ0VTU19UT0tFTjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHN0YXRlSW5mby5yZXF1ZXN0VHlwZSA9PT0gQ29uc3RhbnRzLmxvZ2luKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIlJlc3BvbnNlIHRva2VuVHlwZSBzZXQgdG8gXCIgKyBTZXJ2ZXJIYXNoUGFyYW1LZXlzLklEX1RPS0VOKTtcclxuICAgICAgICAgICAgICAgICAgICByZXNwb25zZS50b2tlblR5cGUgPSBTZXJ2ZXJIYXNoUGFyYW1LZXlzLklEX1RPS0VOO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCFwYXJlbnRDYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJTZXR0aW5nIHJlZGlyZWN0UmVzcG9uc2VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWRpcmVjdFJlc3BvbnNlID0gcmVzcG9uc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKCFwYXJlbnRDYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIlJlc3BvbnNlIGlzIG51bGwsIHNldHRpbmcgcmVkaXJlY3RSZXNwb25zZSB3aXRoIHN0YXRlXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZWRpcmVjdFJlc3BvbnNlID0gYnVpbGRSZXNwb25zZVN0YXRlT25seShhY2NvdW50U3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yZWRpcmVjdEVycm9yID0gYXV0aEVycjtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FjaGVTdG9yYWdlLnJlc2V0VGVtcENhY2hlSXRlbXMoc3RhdGVJbmZvLnN0YXRlKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiQ2FsbGluZyBjYWxsYmFjayBwcm92aWRlZCB0byBwcm9jZXNzQ2FsbGJhY2tcIik7XHJcbiAgICAgICAgICAgIHBhcmVudENhbGxiYWNrKHJlc3BvbnNlLCBhdXRoRXJyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgICB0aGlzLmxvZ2dlci5lcnJvcihcIkVycm9yIG9jY3VycmVkIGluIHRva2VuIHJlY2VpdmVkIGNhbGxiYWNrIGZ1bmN0aW9uOiBcIiArIGVycik7XHJcbiAgICAgICAgICAgIHRocm93IENsaWVudEF1dGhFcnJvci5jcmVhdGVFcnJvckluQ2FsbGJhY2tGdW5jdGlvbihlcnIudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQGhpZGRlblxyXG4gICAgICogVGhpcyBtZXRob2QgbXVzdCBiZSBjYWxsZWQgZm9yIHByb2Nlc3NpbmcgdGhlIHJlc3BvbnNlIHJlY2VpdmVkIGZyb20gdGhlIFNUUyBpZiB1c2luZyBwb3B1cHMgb3IgaWZyYW1lcy4gSXQgZXh0cmFjdHMgdGhlIGhhc2gsIHByb2Nlc3NlcyB0aGUgdG9rZW4gb3IgZXJyb3JcclxuICAgICAqIGluZm9ybWF0aW9uIGFuZCBzYXZlcyBpdCBpbiB0aGUgY2FjaGUuIEl0IHRoZW4gcmVzb2x2ZXMgdGhlIHByb21pc2VzIHdpdGggdGhlIHJlc3VsdC5cclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbaGFzaD13aW5kb3cubG9jYXRpb24uaGFzaF0gLSBIYXNoIGZyYWdtZW50IG9mIFVybC5cclxuICAgICAqL1xyXG4gICAgVXNlckFnZW50QXBwbGljYXRpb24ucHJvdG90eXBlLmhhbmRsZUF1dGhlbnRpY2F0aW9uUmVzcG9uc2UgPSBmdW5jdGlvbiAoaGFzaCkge1xyXG4gICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJIYW5kbGVBdXRoZW50aWNhdGlvblJlc3BvbnNlIGhhcyBiZWVuIGNhbGxlZFwiKTtcclxuICAgICAgICAvLyByZXRyaWV2ZSB0aGUgaGFzaFxyXG4gICAgICAgIHZhciBsb2NhdGlvbkhhc2ggPSBoYXNoIHx8IHdpbmRvdy5sb2NhdGlvbi5oYXNoO1xyXG4gICAgICAgIC8vIGlmICh3aW5kb3cucGFyZW50ICE9PSB3aW5kb3cpLCBieSB1c2luZyBzZWxmLCB3aW5kb3cucGFyZW50IGJlY29tZXMgZXF1YWwgdG8gd2luZG93IGluIGdldFJlc3BvbnNlU3RhdGUgbWV0aG9kIHNwZWNpZmljYWxseVxyXG4gICAgICAgIHZhciBzdGF0ZUluZm8gPSB0aGlzLmdldFJlc3BvbnNlU3RhdGUobG9jYXRpb25IYXNoKTtcclxuICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiT2J0YWluZWQgc3RhdGUgZnJvbSByZXNwb25zZVwiKTtcclxuICAgICAgICB2YXIgdG9rZW5SZXNwb25zZUNhbGxiYWNrID0gd2luZG93LmNhbGxiYWNrTWFwcGVkVG9SZW5ld1N0YXRlc1tzdGF0ZUluZm8uc3RhdGVdO1xyXG4gICAgICAgIHRoaXMucHJvY2Vzc0NhbGxCYWNrKGxvY2F0aW9uSGFzaCwgc3RhdGVJbmZvLCB0b2tlblJlc3BvbnNlQ2FsbGJhY2spO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQGhpZGRlblxyXG4gICAgICogVGhpcyBtZXRob2QgbXVzdCBiZSBjYWxsZWQgZm9yIHByb2Nlc3NpbmcgdGhlIHJlc3BvbnNlIHJlY2VpdmVkIGZyb20gdGhlIFNUUyB3aGVuIHVzaW5nIHJlZGlyZWN0IGZsb3dzLiBJdCBleHRyYWN0cyB0aGUgaGFzaCwgcHJvY2Vzc2VzIHRoZSB0b2tlbiBvciBlcnJvclxyXG4gICAgICogaW5mb3JtYXRpb24gYW5kIHNhdmVzIGl0IGluIHRoZSBjYWNoZS4gVGhlIHJlc3VsdCBjYW4gdGhlbiBiZSBhY2Nlc3NlZCBieSB1c2VyIHJlZ2lzdGVyZWQgY2FsbGJhY2tzLlxyXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtoYXNoPXdpbmRvdy5sb2NhdGlvbi5oYXNoXSAtIEhhc2ggZnJhZ21lbnQgb2YgVXJsLlxyXG4gICAgICovXHJcbiAgICBVc2VyQWdlbnRBcHBsaWNhdGlvbi5wcm90b3R5cGUuaGFuZGxlUmVkaXJlY3RBdXRoZW50aWNhdGlvblJlc3BvbnNlID0gZnVuY3Rpb24gKGhhc2gpIHtcclxuICAgICAgICB0aGlzLmxvZ2dlci5pbmZvKFwiUmV0dXJuZWQgZnJvbSByZWRpcmVjdCB1cmxcIik7XHJcbiAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIkhhbmRsZVJlZGlyZWN0QXV0aGVudGljYXRpb25SZXNwb25zZSBoYXMgYmVlbiBjYWxsZWRcIik7XHJcbiAgICAgICAgLy8gY2xlYXIgaGFzaCBmcm9tIHdpbmRvd1xyXG4gICAgICAgIFdpbmRvd1V0aWxzLmNsZWFyVXJsRnJhZ21lbnQoKTtcclxuICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiV2luZG93LmxvY2F0aW9uLmhhc2ggY2xlYXJlZFwiKTtcclxuICAgICAgICAvLyBpZiAod2luZG93LnBhcmVudCAhPT0gd2luZG93KSwgYnkgdXNpbmcgc2VsZiwgd2luZG93LnBhcmVudCBiZWNvbWVzIGVxdWFsIHRvIHdpbmRvdyBpbiBnZXRSZXNwb25zZVN0YXRlIG1ldGhvZCBzcGVjaWZpY2FsbHlcclxuICAgICAgICB2YXIgc3RhdGVJbmZvID0gdGhpcy5nZXRSZXNwb25zZVN0YXRlKGhhc2gpO1xyXG4gICAgICAgIC8vIGlmIHNldCB0byBuYXZpZ2F0ZSB0byBsb2dpblJlcXVlc3QgcGFnZSBwb3N0IGxvZ2luXHJcbiAgICAgICAgaWYgKHRoaXMuY29uZmlnLmF1dGgubmF2aWdhdGVUb0xvZ2luUmVxdWVzdFVybCAmJiB3aW5kb3cucGFyZW50ID09PSB3aW5kb3cpIHtcclxuICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIldpbmRvdy5wYXJlbnQgaXMgZXF1YWwgdG8gd2luZG93LCBub3QgaW4gcG9wdXAgb3IgaWZyYW1lLiBOYXZpZ2F0aW9uIHRvIGxvZ2luIHJlcXVlc3QgdXJsIGFmdGVyIGxvZ2luIHR1cm5lZCBvblwiKTtcclxuICAgICAgICAgICAgdmFyIGxvZ2luUmVxdWVzdFVybCA9IHRoaXMuY2FjaGVTdG9yYWdlLmdldEl0ZW0oQXV0aENhY2hlLmdlbmVyYXRlVGVtcG9yYXJ5Q2FjaGVLZXkoVGVtcG9yYXJ5Q2FjaGVLZXlzLkxPR0lOX1JFUVVFU1QsIHN0YXRlSW5mby5zdGF0ZSksIHRoaXMuaW5Db29raWUpO1xyXG4gICAgICAgICAgICAvLyBSZWRpcmVjdCB0byBob21lIHBhZ2UgaWYgbG9naW4gcmVxdWVzdCB1cmwgaXMgbnVsbCAocmVhbCBudWxsIG9yIHRoZSBzdHJpbmcgbnVsbClcclxuICAgICAgICAgICAgaWYgKCFsb2dpblJlcXVlc3RVcmwgfHwgbG9naW5SZXF1ZXN0VXJsID09PSBcIm51bGxcIikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoXCJVbmFibGUgdG8gZ2V0IHZhbGlkIGxvZ2luIHJlcXVlc3QgdXJsIGZyb20gY2FjaGUsIHJlZGlyZWN0aW5nIHRvIGhvbWUgcGFnZVwiKTtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5hc3NpZ24oXCIvXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIlZhbGlkIGxvZ2luIHJlcXVlc3QgdXJsIG9idGFpbmVkIGZyb20gY2FjaGVcIik7XHJcbiAgICAgICAgICAgICAgICB2YXIgY3VycmVudFVybCA9IFVybFV0aWxzLnJlbW92ZUhhc2hGcm9tVXJsKHdpbmRvdy5sb2NhdGlvbi5ocmVmKTtcclxuICAgICAgICAgICAgICAgIHZhciBmaW5hbFJlZGlyZWN0VXJsID0gVXJsVXRpbHMucmVtb3ZlSGFzaEZyb21VcmwobG9naW5SZXF1ZXN0VXJsKTtcclxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50VXJsICE9PSBmaW5hbFJlZGlyZWN0VXJsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIkN1cnJlbnQgdXJsIGlzIG5vdCBsb2dpbiByZXF1ZXN0IHVybCwgbmF2aWdhdGluZ1wiKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlUGlpKFwiQ3VycmVudFVybDogXCIgKyBjdXJyZW50VXJsICsgXCIsIGZpbmFsUmVkaXJlY3RVcmw6IFwiICsgZmluYWxSZWRpcmVjdFVybCk7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmFzc2lnbihcIlwiICsgZmluYWxSZWRpcmVjdFVybCArIGhhc2gpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJDdXJyZW50IHVybCBtYXRjaGVzIGxvZ2luIHJlcXVlc3QgdXJsXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBsb2dpblJlcXVlc3RVcmxDb21wb25lbnRzID0gVXJsVXRpbHMuR2V0VXJsQ29tcG9uZW50cyhsb2dpblJlcXVlc3RVcmwpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChsb2dpblJlcXVlc3RVcmxDb21wb25lbnRzLkhhc2gpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIkxvZ2luIHJlcXVlc3QgdXJsIGNvbnRhaW5zIGhhc2gsIHJlc2V0dGluZyBub24tbXNhbCBoYXNoXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaGFzaCA9IGxvZ2luUmVxdWVzdFVybENvbXBvbmVudHMuSGFzaDtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoIXRoaXMuY29uZmlnLmF1dGgubmF2aWdhdGVUb0xvZ2luUmVxdWVzdFVybCkge1xyXG4gICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiRGVmYXVsdCBuYXZpZ2F0aW9uIHRvIHN0YXJ0IHBhZ2UgYWZ0ZXIgbG9naW4gdHVybmVkIG9mZlwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5wcm9jZXNzQ2FsbEJhY2soaGFzaCwgc3RhdGVJbmZvLCBudWxsKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEBoaWRkZW5cclxuICAgICAqIENyZWF0ZXMgYSBzdGF0ZUluZm8gb2JqZWN0IGZyb20gdGhlIFVSTCBmcmFnbWVudCBhbmQgcmV0dXJucyBpdC5cclxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBoYXNoICAtICBIYXNoIHBhc3NlZCBmcm9tIHJlZGlyZWN0IHBhZ2VcclxuICAgICAqIEByZXR1cm5zIHtUb2tlblJlc3BvbnNlfSBhbiBvYmplY3QgY3JlYXRlZCBmcm9tIHRoZSByZWRpcmVjdCByZXNwb25zZSBmcm9tIEFBRCBjb21wcmlzaW5nIG9mIHRoZSBrZXlzIC0gcGFyYW1ldGVycywgcmVxdWVzdFR5cGUsIHN0YXRlTWF0Y2gsIHN0YXRlUmVzcG9uc2UgYW5kIHZhbGlkLlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICovXHJcbiAgICBVc2VyQWdlbnRBcHBsaWNhdGlvbi5wcm90b3R5cGUuZ2V0UmVzcG9uc2VTdGF0ZSA9IGZ1bmN0aW9uIChoYXNoKSB7XHJcbiAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIkdldFJlc3BvbnNlU3RhdGUgaGFzIGJlZW4gY2FsbGVkXCIpO1xyXG4gICAgICAgIHZhciBwYXJhbWV0ZXJzID0gVXJsVXRpbHMuZGVzZXJpYWxpemVIYXNoKGhhc2gpO1xyXG4gICAgICAgIHZhciBzdGF0ZVJlc3BvbnNlO1xyXG4gICAgICAgIGlmICghcGFyYW1ldGVycykge1xyXG4gICAgICAgICAgICB0aHJvdyBBdXRoRXJyb3IuY3JlYXRlVW5leHBlY3RlZEVycm9yKFwiSGFzaCB3YXMgbm90IHBhcnNlZCBjb3JyZWN0bHkuXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocGFyYW1ldGVycy5oYXNPd25Qcm9wZXJ0eShTZXJ2ZXJIYXNoUGFyYW1LZXlzLlNUQVRFKSkge1xyXG4gICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiSGFzaCBjb250YWlucyBzdGF0ZS4gQ3JlYXRpbmcgc3RhdGVJbmZvIG9iamVjdFwiKTtcclxuICAgICAgICAgICAgdmFyIHBhcnNlZFN0YXRlID0gUmVxdWVzdFV0aWxzLnBhcnNlTGlicmFyeVN0YXRlKHBhcmFtZXRlcnMuc3RhdGUpO1xyXG4gICAgICAgICAgICBzdGF0ZVJlc3BvbnNlID0ge1xyXG4gICAgICAgICAgICAgICAgcmVxdWVzdFR5cGU6IENvbnN0YW50cy51bmtub3duLFxyXG4gICAgICAgICAgICAgICAgc3RhdGU6IHBhcmFtZXRlcnMuc3RhdGUsXHJcbiAgICAgICAgICAgICAgICB0aW1lc3RhbXA6IHBhcnNlZFN0YXRlLnRzLFxyXG4gICAgICAgICAgICAgICAgbWV0aG9kOiBwYXJzZWRTdGF0ZS5tZXRob2QsXHJcbiAgICAgICAgICAgICAgICBzdGF0ZU1hdGNoOiBmYWxzZVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhyb3cgQXV0aEVycm9yLmNyZWF0ZVVuZXhwZWN0ZWRFcnJvcihcIkhhc2ggZG9lcyBub3QgY29udGFpbiBzdGF0ZS5cIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8qXHJcbiAgICAgICAgICogYXN5bmMgY2FsbHMgY2FuIGZpcmUgaWZyYW1lIGFuZCBsb2dpbiByZXF1ZXN0IGF0IHRoZSBzYW1lIHRpbWUgaWYgZGV2ZWxvcGVyIGRvZXMgbm90IHVzZSB0aGUgQVBJIGFzIGV4cGVjdGVkXHJcbiAgICAgICAgICogaW5jb21pbmcgY2FsbGJhY2sgbmVlZHMgdG8gYmUgbG9va2VkIHVwIHRvIGZpbmQgdGhlIHJlcXVlc3QgdHlwZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIC8vIGxvZ2luUmVkaXJlY3RcclxuICAgICAgICBpZiAoc3RhdGVSZXNwb25zZS5zdGF0ZSA9PT0gdGhpcy5jYWNoZVN0b3JhZ2UuZ2V0SXRlbShBdXRoQ2FjaGUuZ2VuZXJhdGVUZW1wb3JhcnlDYWNoZUtleShUZW1wb3JhcnlDYWNoZUtleXMuU1RBVEVfTE9HSU4sIHN0YXRlUmVzcG9uc2Uuc3RhdGUpLCB0aGlzLmluQ29va2llKSB8fCBzdGF0ZVJlc3BvbnNlLnN0YXRlID09PSB0aGlzLnNpbGVudEF1dGhlbnRpY2F0aW9uU3RhdGUpIHtcclxuICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIlN0YXRlIG1hdGNoZXMgY2FjaGVkIHN0YXRlLCBzZXR0aW5nIHJlcXVlc3RUeXBlIHRvIGxvZ2luXCIpO1xyXG4gICAgICAgICAgICBzdGF0ZVJlc3BvbnNlLnJlcXVlc3RUeXBlID0gQ29uc3RhbnRzLmxvZ2luO1xyXG4gICAgICAgICAgICBzdGF0ZVJlc3BvbnNlLnN0YXRlTWF0Y2ggPSB0cnVlO1xyXG4gICAgICAgICAgICByZXR1cm4gc3RhdGVSZXNwb25zZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gYWNxdWlyZVRva2VuUmVkaXJlY3RcclxuICAgICAgICBlbHNlIGlmIChzdGF0ZVJlc3BvbnNlLnN0YXRlID09PSB0aGlzLmNhY2hlU3RvcmFnZS5nZXRJdGVtKEF1dGhDYWNoZS5nZW5lcmF0ZVRlbXBvcmFyeUNhY2hlS2V5KFRlbXBvcmFyeUNhY2hlS2V5cy5TVEFURV9BQ1FfVE9LRU4sIHN0YXRlUmVzcG9uc2Uuc3RhdGUpLCB0aGlzLmluQ29va2llKSkge1xyXG4gICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiU3RhdGUgbWF0Y2hlcyBjYWNoZWQgc3RhdGUsIHNldHRpbmcgcmVxdWVzdFR5cGUgdG8gcmVuZXdUb2tlblwiKTtcclxuICAgICAgICAgICAgc3RhdGVSZXNwb25zZS5yZXF1ZXN0VHlwZSA9IENvbnN0YW50cy5yZW5ld1Rva2VuO1xyXG4gICAgICAgICAgICBzdGF0ZVJlc3BvbnNlLnN0YXRlTWF0Y2ggPSB0cnVlO1xyXG4gICAgICAgICAgICByZXR1cm4gc3RhdGVSZXNwb25zZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gZXh0ZXJuYWwgYXBpIHJlcXVlc3RzIG1heSBoYXZlIG1hbnkgcmVuZXd0b2tlbiByZXF1ZXN0cyBmb3IgZGlmZmVyZW50IHJlc291cmNlXHJcbiAgICAgICAgaWYgKCFzdGF0ZVJlc3BvbnNlLnN0YXRlTWF0Y2gpIHtcclxuICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIlN0YXRlIGRvZXMgbm90IG1hdGNoIGNhY2hlZCBzdGF0ZSwgc2V0dGluZyByZXF1ZXN0VHlwZSB0byB0eXBlIGZyb20gd2luZG93XCIpO1xyXG4gICAgICAgICAgICBzdGF0ZVJlc3BvbnNlLnJlcXVlc3RUeXBlID0gd2luZG93LnJlcXVlc3RUeXBlO1xyXG4gICAgICAgICAgICB2YXIgc3RhdGVzSW5QYXJlbnRDb250ZXh0ID0gd2luZG93LnJlbmV3U3RhdGVzO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN0YXRlc0luUGFyZW50Q29udGV4dC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlc0luUGFyZW50Q29udGV4dFtpXSA9PT0gc3RhdGVSZXNwb25zZS5zdGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJNYXRjaGluZyBzdGF0ZSBmb3VuZCBmb3IgcmVxdWVzdFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBzdGF0ZVJlc3BvbnNlLnN0YXRlTWF0Y2ggPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICghc3RhdGVSZXNwb25zZS5zdGF0ZU1hdGNoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiTWF0Y2hpbmcgc3RhdGUgbm90IGZvdW5kIGZvciByZXF1ZXN0XCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBzdGF0ZVJlc3BvbnNlO1xyXG4gICAgfTtcclxuICAgIC8vICNlbmRyZWdpb25cclxuICAgIC8vICNyZWdpb24gVG9rZW4gUHJvY2Vzc2luZyAoRXh0cmFjdCB0byBUb2tlblByb2Nlc3NpbmcudHMpXHJcbiAgICAvKipcclxuICAgICAqIEBoaWRkZW5cclxuICAgICAqIFVzZWQgdG8gZ2V0IHRva2VuIGZvciB0aGUgc3BlY2lmaWVkIHNldCBvZiBzY29wZXMgZnJvbSB0aGUgY2FjaGVcclxuICAgICAqIEBwYXJhbSB7QGxpbmsgU2VydmVyUmVxdWVzdFBhcmFtZXRlcnN9IC0gUmVxdWVzdCBzZW50IHRvIHRoZSBTVFMgdG8gb2J0YWluIGFuIGlkX3Rva2VuL2FjY2Vzc190b2tlblxyXG4gICAgICogQHBhcmFtIHtBY2NvdW50fSBhY2NvdW50IC0gQWNjb3VudCBmb3Igd2hpY2ggdGhlIHNjb3BlcyB3ZXJlIHJlcXVlc3RlZFxyXG4gICAgICovXHJcbiAgICBVc2VyQWdlbnRBcHBsaWNhdGlvbi5wcm90b3R5cGUuZ2V0Q2FjaGVkVG9rZW4gPSBmdW5jdGlvbiAoc2VydmVyQXV0aGVudGljYXRpb25SZXF1ZXN0LCBhY2NvdW50KSB7XHJcbiAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIkdldENhY2hlZFRva2VuIGhhcyBiZWVuIGNhbGxlZFwiKTtcclxuICAgICAgICB2YXIgc2NvcGVzID0gc2VydmVyQXV0aGVudGljYXRpb25SZXF1ZXN0LnNjb3BlcztcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBJZCBUb2tlbiBzaG91bGQgYmUgcmV0dXJuZWQgaW4gZXZlcnkgYWNxdWlyZVRva2VuU2lsZW50IGNhbGwuIFRoZSBvbmx5IGV4Y2VwdGlvbiBpcyBhIHJlc3BvbnNlX3R5cGUgPSB0b2tlblxyXG4gICAgICAgICAqIHJlcXVlc3Qgd2hlbiBhIHZhbGlkIElEIFRva2VuIGlzIG5vdCBwcmVzZW50IGluIHRoZSBjYWNoZS5cclxuICAgICAgICAgKi9cclxuICAgICAgICB2YXIgaWRUb2tlbiA9IHRoaXMuZ2V0Q2FjaGVkSWRUb2tlbihzZXJ2ZXJBdXRoZW50aWNhdGlvblJlcXVlc3QsIGFjY291bnQpO1xyXG4gICAgICAgIHZhciBhdXRoUmVzcG9uc2UgPSB0aGlzLmdldENhY2hlZEFjY2Vzc1Rva2VuKHNlcnZlckF1dGhlbnRpY2F0aW9uUmVxdWVzdCwgYWNjb3VudCwgc2NvcGVzKTtcclxuICAgICAgICB2YXIgYWNjb3VudFN0YXRlID0gdGhpcy5nZXRBY2NvdW50U3RhdGUoc2VydmVyQXV0aGVudGljYXRpb25SZXF1ZXN0LnN0YXRlKTtcclxuICAgICAgICByZXR1cm4gUmVzcG9uc2VVdGlscy5idWlsZEF1dGhSZXNwb25zZShpZFRva2VuLCBhdXRoUmVzcG9uc2UsIHNlcnZlckF1dGhlbnRpY2F0aW9uUmVxdWVzdCwgYWNjb3VudCwgc2NvcGVzLCBhY2NvdW50U3RhdGUpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQGhpZGRlblxyXG4gICAgICpcclxuICAgICAqIFVzZXMgcGFzc2VkIGluIGF1dGhvcml0eSB0byBmdXJ0aGVyIGZpbHRlciBhbiBhcnJheSBvZiB0b2tlbkNhY2hlSXRlbXMgdW50aWwgb25seSB0aGUgdG9rZW4gYmVpbmcgc2VhcmNoZWQgZm9yIHJlbWFpbnMsIHRoZW4gcmV0dXJucyB0aGF0IHRva2VuQ2FjaGVJdGVtLlxyXG4gICAgICogVGhpcyBtZXRob2Qgd2lsbCB0aHJvdyBpZiBhdXRob3JpdHkgZmlsdGVyaW5nIHN0aWxsIHlpZWxkcyBtdWx0aXBsZSBtYXRjaGluZyB0b2tlbnMgYW5kIHdpbGwgcmV0dXJuIG51bGwgaWYgbm90IHRva2VucyBtYXRjaCB0aGUgYXV0aG9yaXR5IHBhc3NlZCBpbi5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gYXV0aG9yaXR5XHJcbiAgICAgKiBAcGFyYW0gdG9rZW5DYWNoZUl0ZW1zXHJcbiAgICAgKiBAcGFyYW0gcmVxdWVzdFxyXG4gICAgICogQHBhcmFtIHJlcXVlc3RTY29wZXNcclxuICAgICAqIEBwYXJhbSB0b2tlblR5cGVcclxuICAgICAqL1xyXG4gICAgVXNlckFnZW50QXBwbGljYXRpb24ucHJvdG90eXBlLmdldFRva2VuQ2FjaGVJdGVtQnlBdXRob3JpdHkgPSBmdW5jdGlvbiAoYXV0aG9yaXR5LCB0b2tlbkNhY2hlSXRlbXMsIHJlcXVlc3RTY29wZXMsIHRva2VuVHlwZSkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIGZpbHRlcmVkQXV0aG9yaXR5SXRlbXM7XHJcbiAgICAgICAgaWYgKFVybFV0aWxzLmlzQ29tbW9uQXV0aG9yaXR5KGF1dGhvcml0eSkgfHwgVXJsVXRpbHMuaXNPcmdhbml6YXRpb25zQXV0aG9yaXR5KGF1dGhvcml0eSkpIHtcclxuICAgICAgICAgICAgZmlsdGVyZWRBdXRob3JpdHlJdGVtcyA9IEF1dGhDYWNoZVV0aWxzLmZpbHRlclRva2VuQ2FjaGVJdGVtc0J5RG9tYWluKHRva2VuQ2FjaGVJdGVtcywgVXJsVXRpbHMuR2V0VXJsQ29tcG9uZW50cyhhdXRob3JpdHkpLkhvc3ROYW1lQW5kUG9ydCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBmaWx0ZXJlZEF1dGhvcml0eUl0ZW1zID0gQXV0aENhY2hlVXRpbHMuZmlsdGVyVG9rZW5DYWNoZUl0ZW1zQnlBdXRob3JpdHkodG9rZW5DYWNoZUl0ZW1zLCBhdXRob3JpdHkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZmlsdGVyZWRBdXRob3JpdHlJdGVtcy5sZW5ndGggPT09IDEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZpbHRlcmVkQXV0aG9yaXR5SXRlbXNbMF07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGZpbHRlcmVkQXV0aG9yaXR5SXRlbXMubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICB0aGlzLmxvZ2dlci53YXJuaW5nKFwiTXVsdGlwbGUgbWF0Y2hpbmcgdG9rZW5zIGZvdW5kLiBDbGVhbmluZyBjYWNoZSBhbmQgcmVxdWVzdGluZyBhIG5ldyB0b2tlbi5cIik7XHJcbiAgICAgICAgICAgIGZpbHRlcmVkQXV0aG9yaXR5SXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoYWNjZXNzVG9rZW5DYWNoZUl0ZW0pIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLmNhY2hlU3RvcmFnZS5yZW1vdmVJdGVtKEpTT04uc3RyaW5naWZ5KGFjY2Vzc1Rva2VuQ2FjaGVJdGVtLmtleSkpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiTm8gbWF0Y2hpbmcgdG9rZW5zIG9mIHR5cGUgXCIgKyB0b2tlblR5cGUgKyBcIiBmb3VuZFwiKTtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICpcclxuICAgICAqIEBoaWRkZW5cclxuICAgICAqXHJcbiAgICAgKiBTZWFyY2hlcyB0aGUgdG9rZW4gY2FjaGUgZm9yIGFuIElEIFRva2VuIHRoYXQgbWF0Y2hlcyB0aGUgcmVxdWVzdCBwYXJhbWV0ZXIgYW5kIHJldHVybnMgaXQgYXMgYW4gSWRUb2tlbiBvYmplY3QuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHNlcnZlckF1dGhlbnRpY2F0aW9uUmVxdWVzdFxyXG4gICAgICogQHBhcmFtIGFjY291bnRcclxuICAgICAqL1xyXG4gICAgVXNlckFnZW50QXBwbGljYXRpb24ucHJvdG90eXBlLmdldENhY2hlZElkVG9rZW4gPSBmdW5jdGlvbiAoc2VydmVyQXV0aGVudGljYXRpb25SZXF1ZXN0LCBhY2NvdW50KSB7XHJcbiAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIkdldHRpbmcgYWxsIGNhY2hlZCB0b2tlbnMgb2YgdHlwZSBJRCBUb2tlblwiKTtcclxuICAgICAgICB2YXIgaWRUb2tlbkNhY2hlSXRlbXMgPSB0aGlzLmNhY2hlU3RvcmFnZS5nZXRBbGxJZFRva2Vucyh0aGlzLmNsaWVudElkLCBhY2NvdW50ID8gYWNjb3VudC5ob21lQWNjb3VudElkZW50aWZpZXIgOiBudWxsKTtcclxuICAgICAgICB2YXIgbWF0Y2hBdXRob3JpdHkgPSBzZXJ2ZXJBdXRoZW50aWNhdGlvblJlcXVlc3QuYXV0aG9yaXR5IHx8IHRoaXMuYXV0aG9yaXR5O1xyXG4gICAgICAgIHZhciBpZFRva2VuQ2FjaGVJdGVtID0gdGhpcy5nZXRUb2tlbkNhY2hlSXRlbUJ5QXV0aG9yaXR5KG1hdGNoQXV0aG9yaXR5LCBpZFRva2VuQ2FjaGVJdGVtcywgbnVsbCwgU2VydmVySGFzaFBhcmFtS2V5cy5JRF9UT0tFTik7XHJcbiAgICAgICAgaWYgKGlkVG9rZW5DYWNoZUl0ZW0pIHtcclxuICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIkV2YWx1YXRpbmcgSUQgdG9rZW4gZm91bmRcIik7XHJcbiAgICAgICAgICAgIHZhciBpZFRva2VuSXNTdGlsbFZhbGlkID0gdGhpcy5ldmFsdWF0ZVRva2VuRXhwaXJhdGlvbihpZFRva2VuQ2FjaGVJdGVtKTtcclxuICAgICAgICAgICAgaWYgKGlkVG9rZW5Jc1N0aWxsVmFsaWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJJRCB0b2tlbiBleHBpcmF0aW9uIGlzIHdpdGhpbiBvZmZzZXQsIHVzaW5nIElEIHRva2VuIGZvdW5kIGluIGNhY2hlXCIpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGlkVG9rZW5WYWx1ZSA9IGlkVG9rZW5DYWNoZUl0ZW0udmFsdWU7XHJcbiAgICAgICAgICAgICAgICBpZiAoaWRUb2tlblZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIklEIFRva2VuIGZvdW5kIGluIGNhY2hlIGlzIHZhbGlkIGFuZCB1bmV4cGlyZWRcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiSUQgVG9rZW4gZm91bmQgaW4gY2FjaGUgaXMgaW52YWxpZFwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiAoaWRUb2tlblZhbHVlKSA/IG5ldyBJZFRva2VuKGlkVG9rZW5WYWx1ZS5pZFRva2VuKSA6IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiQ2FjaGVkIElEIHRva2VuIGlzIGV4cGlyZWQsIHJlbW92aW5nIGZyb20gY2FjaGVcIik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZS5yZW1vdmVJdGVtKEpTT04uc3RyaW5naWZ5KGlkVG9rZW5DYWNoZUl0ZW0ua2V5KSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIk5vIHRva2VucyBmb3VuZFwiKTtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICpcclxuICAgICAqIEBoaWRkZW5cclxuICAgICAqXHJcbiAgICAgKiBTZWFyY2hlcyB0aGUgdG9rZW4gY2FjaGUgZm9yIGFuIGFjY2VzcyB0b2tlbiB0aGF0IG1hdGNoZXMgdGhlIHJlcXVlc3QgcGFyYW1ldGVycyBhbmQgcmV0dXJucyBpdCBhcyBhbiBBdXRoUmVzcG9uc2UuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHNlcnZlckF1dGhlbnRpY2F0aW9uUmVxdWVzdFxyXG4gICAgICogQHBhcmFtIGFjY291bnRcclxuICAgICAqIEBwYXJhbSBzY29wZXNcclxuICAgICAqL1xyXG4gICAgVXNlckFnZW50QXBwbGljYXRpb24ucHJvdG90eXBlLmdldENhY2hlZEFjY2Vzc1Rva2VuID0gZnVuY3Rpb24gKHNlcnZlckF1dGhlbnRpY2F0aW9uUmVxdWVzdCwgYWNjb3VudCwgc2NvcGVzKSB7XHJcbiAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIkdldHRpbmcgYWxsIGNhY2hlZCB0b2tlbnMgb2YgdHlwZSBBY2Nlc3MgVG9rZW5cIik7XHJcbiAgICAgICAgdmFyIHRva2VuQ2FjaGVJdGVtcyA9IHRoaXMuY2FjaGVTdG9yYWdlLmdldEFsbEFjY2Vzc1Rva2Vucyh0aGlzLmNsaWVudElkLCBhY2NvdW50ID8gYWNjb3VudC5ob21lQWNjb3VudElkZW50aWZpZXIgOiBudWxsKTtcclxuICAgICAgICB2YXIgc2NvcGVGaWx0ZXJlZFRva2VuQ2FjaGVJdGVtcyA9IEF1dGhDYWNoZVV0aWxzLmZpbHRlclRva2VuQ2FjaGVJdGVtc0J5U2NvcGUodG9rZW5DYWNoZUl0ZW1zLCBzY29wZXMpO1xyXG4gICAgICAgIHZhciBtYXRjaEF1dGhvcml0eSA9IHNlcnZlckF1dGhlbnRpY2F0aW9uUmVxdWVzdC5hdXRob3JpdHkgfHwgdGhpcy5hdXRob3JpdHk7XHJcbiAgICAgICAgLy8gc2VydmVyQXV0aGVudGljYXRpb25SZXF1ZXN0LmF1dGhvcml0eSBjYW4gb25seSBiZSBjb21tb24gb3Igb3JnYW5pemF0aW9ucyBpZiBub3QgbnVsbFxyXG4gICAgICAgIHZhciBhY2Nlc3NUb2tlbkNhY2hlSXRlbSA9IHRoaXMuZ2V0VG9rZW5DYWNoZUl0ZW1CeUF1dGhvcml0eShtYXRjaEF1dGhvcml0eSwgc2NvcGVGaWx0ZXJlZFRva2VuQ2FjaGVJdGVtcywgc2NvcGVzLCBTZXJ2ZXJIYXNoUGFyYW1LZXlzLkFDQ0VTU19UT0tFTik7XHJcbiAgICAgICAgaWYgKCFhY2Nlc3NUb2tlbkNhY2hlSXRlbSkge1xyXG4gICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiTm8gbWF0Y2hpbmcgdG9rZW4gZm91bmQgd2hlbiBmaWx0ZXJpbmcgYnkgc2NvcGUgYW5kIGF1dGhvcml0eVwiKTtcclxuICAgICAgICAgICAgdmFyIGF1dGhvcml0eUxpc3QgPSB0aGlzLmdldFVuaXF1ZUF1dGhvcml0eSh0b2tlbkNhY2hlSXRlbXMsIFwiYXV0aG9yaXR5XCIpO1xyXG4gICAgICAgICAgICBpZiAoYXV0aG9yaXR5TGlzdC5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBDbGllbnRBdXRoRXJyb3IuY3JlYXRlTXVsdGlwbGVBdXRob3JpdGllc0luQ2FjaGVFcnJvcihzY29wZXMudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIlNpbmdsZSBhdXRob3JpdHkgdXNlZCwgc2V0dGluZyBhdXRob3JpdHlJbnN0YW5jZVwiKTtcclxuICAgICAgICAgICAgc2VydmVyQXV0aGVudGljYXRpb25SZXF1ZXN0LmF1dGhvcml0eUluc3RhbmNlID0gQXV0aG9yaXR5RmFjdG9yeS5DcmVhdGVJbnN0YW5jZShhdXRob3JpdHlMaXN0WzBdLCB0aGlzLmNvbmZpZy5hdXRoLnZhbGlkYXRlQXV0aG9yaXR5KTtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBzZXJ2ZXJBdXRoZW50aWNhdGlvblJlcXVlc3QuYXV0aG9yaXR5SW5zdGFuY2UgPSBBdXRob3JpdHlGYWN0b3J5LkNyZWF0ZUluc3RhbmNlKGFjY2Vzc1Rva2VuQ2FjaGVJdGVtLmtleS5hdXRob3JpdHksIHRoaXMuY29uZmlnLmF1dGgudmFsaWRhdGVBdXRob3JpdHkpO1xyXG4gICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiRXZhbHVhdGluZyBhY2Nlc3MgdG9rZW4gZm91bmRcIik7XHJcbiAgICAgICAgICAgIHZhciB0b2tlbklzU3RpbGxWYWxpZCA9IHRoaXMuZXZhbHVhdGVUb2tlbkV4cGlyYXRpb24oYWNjZXNzVG9rZW5DYWNoZUl0ZW0pO1xyXG4gICAgICAgICAgICAvLyBUaGUgcmVzcG9uc2UgdmFsdWUgd2lsbCBzdGF5IG51bGwgaWYgdG9rZW4gcmV0cmlldmVkIGZyb20gdGhlIGNhY2hlIGlzIGV4cGlyZWQsIG90aGVyd2lzZSBpdCB3aWxsIGJlIHBvcHVsYXRlZCB3aXRoIHNhaWQgdG9rZW4ncyBkYXRhXHJcbiAgICAgICAgICAgIGlmICh0b2tlbklzU3RpbGxWYWxpZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIkFjY2VzcyB0b2tlbiBleHBpcmF0aW9uIGlzIHdpdGhpbiBvZmZzZXQsIHVzaW5nIGFjY2VzcyB0b2tlbiBmb3VuZCBpbiBjYWNoZVwiKTtcclxuICAgICAgICAgICAgICAgIGlmICghYWNjb3VudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFjY291bnQgPSB0aGlzLmdldEFjY291bnQoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWFjY291bnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgQXV0aEVycm9yLmNyZWF0ZVVuZXhwZWN0ZWRFcnJvcihcIkFjY291bnQgc2hvdWxkIG5vdCBiZSBudWxsIGhlcmUuXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHZhciBhU3RhdGUgPSB0aGlzLmdldEFjY291bnRTdGF0ZShzZXJ2ZXJBdXRoZW50aWNhdGlvblJlcXVlc3Quc3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHVuaXF1ZUlkOiBcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRlbmFudElkOiBcIlwiLFxyXG4gICAgICAgICAgICAgICAgICAgIHRva2VuVHlwZTogU2VydmVySGFzaFBhcmFtS2V5cy5BQ0NFU1NfVE9LRU4sXHJcbiAgICAgICAgICAgICAgICAgICAgaWRUb2tlbjogbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBpZFRva2VuQ2xhaW1zOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiBhY2Nlc3NUb2tlbkNhY2hlSXRlbS52YWx1ZS5hY2Nlc3NUb2tlbixcclxuICAgICAgICAgICAgICAgICAgICBzY29wZXM6IGFjY2Vzc1Rva2VuQ2FjaGVJdGVtLmtleS5zY29wZXMuc3BsaXQoXCIgXCIpLFxyXG4gICAgICAgICAgICAgICAgICAgIGV4cGlyZXNPbjogbmV3IERhdGUoTnVtYmVyKGFjY2Vzc1Rva2VuQ2FjaGVJdGVtLnZhbHVlLmV4cGlyZXNJbikgKiAxMDAwKSxcclxuICAgICAgICAgICAgICAgICAgICBhY2NvdW50OiBhY2NvdW50LFxyXG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRTdGF0ZTogYVN0YXRlLFxyXG4gICAgICAgICAgICAgICAgICAgIGZyb21DYWNoZTogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJBY2Nlc3MgdG9rZW4gZXhwaXJlZCwgcmVtb3ZpbmcgZnJvbSBjYWNoZVwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FjaGVTdG9yYWdlLnJlbW92ZUl0ZW0oSlNPTi5zdHJpbmdpZnkoYWNjZXNzVG9rZW5DYWNoZUl0ZW0ua2V5KSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgdG9rZW4gcGFzc2VkIGluIGlzIHdpdGhpbiB0aGUgYWNjZXB0YWJsZSBleHBpcmF0aW9uIHRpbWUgb2Zmc2V0LCBmYWxzZSBpZiBpdCBpcyBleHBpcmVkLlxyXG4gICAgICogQHBhcmFtIHRva2VuQ2FjaGVJdGVtXHJcbiAgICAgKiBAcGFyYW0gc2VydmVyQXV0aGVudGljYXRpb25SZXF1ZXN0XHJcbiAgICAgKi9cclxuICAgIFVzZXJBZ2VudEFwcGxpY2F0aW9uLnByb3RvdHlwZS5ldmFsdWF0ZVRva2VuRXhwaXJhdGlvbiA9IGZ1bmN0aW9uICh0b2tlbkNhY2hlSXRlbSkge1xyXG4gICAgICAgIHZhciBleHBpcmF0aW9uID0gTnVtYmVyKHRva2VuQ2FjaGVJdGVtLnZhbHVlLmV4cGlyZXNJbik7XHJcbiAgICAgICAgcmV0dXJuIFRva2VuVXRpbHMudmFsaWRhdGVFeHBpcmF0aW9uSXNXaXRoaW5PZmZzZXQoZXhwaXJhdGlvbiwgdGhpcy5jb25maWcuc3lzdGVtLnRva2VuUmVuZXdhbE9mZnNldFNlY29uZHMpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQGhpZGRlblxyXG4gICAgICogVXNlZCB0byBnZXQgYSB1bmlxdWUgbGlzdCBvZiBhdXRob3JpdGllcyBmcm9tIHRoZSBjYWNoZVxyXG4gICAgICogQHBhcmFtIHtBcnJheTxBY2Nlc3NUb2tlbkNhY2hlSXRlbT59ICBhY2Nlc3NUb2tlbkNhY2hlSXRlbXMgLSBhY2Nlc3NUb2tlbkNhY2hlSXRlbXMgc2F2ZWQgaW4gdGhlIGNhY2hlXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKi9cclxuICAgIFVzZXJBZ2VudEFwcGxpY2F0aW9uLnByb3RvdHlwZS5nZXRVbmlxdWVBdXRob3JpdHkgPSBmdW5jdGlvbiAoYWNjZXNzVG9rZW5DYWNoZUl0ZW1zLCBwcm9wZXJ0eSkge1xyXG4gICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJHZXRVbmlxdWVBdXRob3JpdHkgaGFzIGJlZW4gY2FsbGVkXCIpO1xyXG4gICAgICAgIHZhciBhdXRob3JpdHlMaXN0ID0gW107XHJcbiAgICAgICAgdmFyIGZsYWdzID0gW107XHJcbiAgICAgICAgYWNjZXNzVG9rZW5DYWNoZUl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGVsZW1lbnQpIHtcclxuICAgICAgICAgICAgaWYgKGVsZW1lbnQua2V5Lmhhc093blByb3BlcnR5KHByb3BlcnR5KSAmJiAoZmxhZ3MuaW5kZXhPZihlbGVtZW50LmtleVtwcm9wZXJ0eV0pID09PSAtMSkpIHtcclxuICAgICAgICAgICAgICAgIGZsYWdzLnB1c2goZWxlbWVudC5rZXlbcHJvcGVydHldKTtcclxuICAgICAgICAgICAgICAgIGF1dGhvcml0eUxpc3QucHVzaChlbGVtZW50LmtleVtwcm9wZXJ0eV0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGF1dGhvcml0eUxpc3Q7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaGlkZGVuXHJcbiAgICAgKiBDaGVjayBpZiBBREFMIGlkX3Rva2VuIGV4aXN0cyBhbmQgcmV0dXJuIGlmIGV4aXN0cy5cclxuICAgICAqXHJcbiAgICAgKi9cclxuICAgIFVzZXJBZ2VudEFwcGxpY2F0aW9uLnByb3RvdHlwZS5leHRyYWN0QURBTElkVG9rZW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIkV4dHJhY3RBREFMSWRUb2tlbiBoYXMgYmVlbiBjYWxsZWRcIik7XHJcbiAgICAgICAgdmFyIGFkYWxJZFRva2VuID0gdGhpcy5jYWNoZVN0b3JhZ2UuZ2V0SXRlbShDb25zdGFudHMuYWRhbElkVG9rZW4pO1xyXG4gICAgICAgIHJldHVybiAoIVN0cmluZ1V0aWxzLmlzRW1wdHkoYWRhbElkVG9rZW4pKSA/IFRva2VuVXRpbHMuZXh0cmFjdElkVG9rZW4oYWRhbElkVG9rZW4pIDogbnVsbDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEBoaWRkZW5cclxuICAgICAqIEFjcXVpcmVzIGFjY2VzcyB0b2tlbiB1c2luZyBhIGhpZGRlbiBpZnJhbWUuXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKi9cclxuICAgIFVzZXJBZ2VudEFwcGxpY2F0aW9uLnByb3RvdHlwZS5yZW5ld1Rva2VuID0gZnVuY3Rpb24gKHJlcXVlc3RTaWduYXR1cmUsIHJlc29sdmUsIHJlamVjdCwgYWNjb3VudCwgc2VydmVyQXV0aGVudGljYXRpb25SZXF1ZXN0KSB7XHJcbiAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIlJlbmV3VG9rZW4gaGFzIGJlZW4gY2FsbGVkXCIpO1xyXG4gICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2VQaWkoXCJSZW5ld1Rva2VuIHNjb3BlIGFuZCBhdXRob3JpdHk6IFwiICsgcmVxdWVzdFNpZ25hdHVyZSk7XHJcbiAgICAgICAgdmFyIGZyYW1lTmFtZSA9IFdpbmRvd1V0aWxzLmdlbmVyYXRlRnJhbWVOYW1lKEZyYW1lUHJlZml4LlRPS0VOX0ZSQU1FLCByZXF1ZXN0U2lnbmF0dXJlKTtcclxuICAgICAgICBXaW5kb3dVdGlscy5hZGRIaWRkZW5JRnJhbWUoZnJhbWVOYW1lLCB0aGlzLmxvZ2dlcik7XHJcbiAgICAgICAgdGhpcy51cGRhdGVDYWNoZUVudHJpZXMoc2VydmVyQXV0aGVudGljYXRpb25SZXF1ZXN0LCBhY2NvdW50LCBmYWxzZSk7XHJcbiAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZVBpaShcIlJlbmV3VG9rZW4gZXhwZWN0ZWQgc3RhdGU6IFwiICsgc2VydmVyQXV0aGVudGljYXRpb25SZXF1ZXN0LnN0YXRlKTtcclxuICAgICAgICAvLyBCdWlsZCB1cmxOYXZpZ2F0ZSB3aXRoIFwicHJvbXB0PW5vbmVcIiBhbmQgbmF2aWdhdGUgdG8gVVJMIGluIGhpZGRlbiBpRnJhbWVcclxuICAgICAgICB2YXIgdXJsTmF2aWdhdGUgPSBVcmxVdGlscy51cmxSZW1vdmVRdWVyeVN0cmluZ1BhcmFtZXRlcihVcmxVdGlscy5jcmVhdGVOYXZpZ2F0ZVVybChzZXJ2ZXJBdXRoZW50aWNhdGlvblJlcXVlc3QpLCBDb25zdGFudHMucHJvbXB0KSArIENvbnN0YW50cy5wcm9tcHRfbm9uZSArIENvbnN0YW50cy5yZXNwb25zZV9tb2RlX2ZyYWdtZW50O1xyXG4gICAgICAgIHdpbmRvdy5yZW5ld1N0YXRlcy5wdXNoKHNlcnZlckF1dGhlbnRpY2F0aW9uUmVxdWVzdC5zdGF0ZSk7XHJcbiAgICAgICAgd2luZG93LnJlcXVlc3RUeXBlID0gQ29uc3RhbnRzLnJlbmV3VG9rZW47XHJcbiAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIlNldCB3aW5kb3cucmVuZXdTdGF0ZSBhbmQgcmVxdWVzdFR5cGVcIik7XHJcbiAgICAgICAgdGhpcy5yZWdpc3RlckNhbGxiYWNrKHNlcnZlckF1dGhlbnRpY2F0aW9uUmVxdWVzdC5zdGF0ZSwgcmVxdWVzdFNpZ25hdHVyZSwgcmVzb2x2ZSwgcmVqZWN0KTtcclxuICAgICAgICB0aGlzLmxvZ2dlci5pbmZvUGlpKFwiTmF2aWdhdGUgdG86IFwiICsgdXJsTmF2aWdhdGUpO1xyXG4gICAgICAgIHRoaXMubG9hZElmcmFtZVRpbWVvdXQodXJsTmF2aWdhdGUsIGZyYW1lTmFtZSwgcmVxdWVzdFNpZ25hdHVyZSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7IHJldHVybiByZWplY3QoZXJyb3IpOyB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEBoaWRkZW5cclxuICAgICAqIFJlbmV3cyBpZHRva2VuIGZvciBhcHAncyBvd24gYmFja2VuZCB3aGVuIGNsaWVudElkIGlzIHBhc3NlZCBhcyBhIHNpbmdsZSBzY29wZSBpbiB0aGUgc2NvcGVzIGFycmF5LlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICovXHJcbiAgICBVc2VyQWdlbnRBcHBsaWNhdGlvbi5wcm90b3R5cGUucmVuZXdJZFRva2VuID0gZnVuY3Rpb24gKHJlcXVlc3RTaWduYXR1cmUsIHJlc29sdmUsIHJlamVjdCwgYWNjb3VudCwgc2VydmVyQXV0aGVudGljYXRpb25SZXF1ZXN0KSB7XHJcbiAgICAgICAgdGhpcy5sb2dnZXIuaW5mbyhcIlJlbmV3SWRUb2tlbiBoYXMgYmVlbiBjYWxsZWRcIik7XHJcbiAgICAgICAgdmFyIGZyYW1lTmFtZSA9IFdpbmRvd1V0aWxzLmdlbmVyYXRlRnJhbWVOYW1lKEZyYW1lUHJlZml4LklEX1RPS0VOX0ZSQU1FLCByZXF1ZXN0U2lnbmF0dXJlKTtcclxuICAgICAgICBXaW5kb3dVdGlscy5hZGRIaWRkZW5JRnJhbWUoZnJhbWVOYW1lLCB0aGlzLmxvZ2dlcik7XHJcbiAgICAgICAgdGhpcy51cGRhdGVDYWNoZUVudHJpZXMoc2VydmVyQXV0aGVudGljYXRpb25SZXF1ZXN0LCBhY2NvdW50LCBmYWxzZSk7XHJcbiAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIlJlbmV3SWRUb2tlbiBleHBlY3RlZCBzdGF0ZTogXCIgKyBzZXJ2ZXJBdXRoZW50aWNhdGlvblJlcXVlc3Quc3RhdGUpO1xyXG4gICAgICAgIC8vIEJ1aWxkIHVybE5hdmlnYXRlIHdpdGggXCJwcm9tcHQ9bm9uZVwiIGFuZCBuYXZpZ2F0ZSB0byBVUkwgaW4gaGlkZGVuIGlGcmFtZVxyXG4gICAgICAgIHZhciB1cmxOYXZpZ2F0ZSA9IFVybFV0aWxzLnVybFJlbW92ZVF1ZXJ5U3RyaW5nUGFyYW1ldGVyKFVybFV0aWxzLmNyZWF0ZU5hdmlnYXRlVXJsKHNlcnZlckF1dGhlbnRpY2F0aW9uUmVxdWVzdCksIENvbnN0YW50cy5wcm9tcHQpICsgQ29uc3RhbnRzLnByb21wdF9ub25lICsgQ29uc3RhbnRzLnJlc3BvbnNlX21vZGVfZnJhZ21lbnQ7XHJcbiAgICAgICAgaWYgKHRoaXMuc2lsZW50TG9naW4pIHtcclxuICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIlNpbGVudCBsb2dpbiBpcyB0cnVlLCBzZXQgc2lsZW50QXV0aGVudGljYXRpb25TdGF0ZVwiKTtcclxuICAgICAgICAgICAgd2luZG93LnJlcXVlc3RUeXBlID0gQ29uc3RhbnRzLmxvZ2luO1xyXG4gICAgICAgICAgICB0aGlzLnNpbGVudEF1dGhlbnRpY2F0aW9uU3RhdGUgPSBzZXJ2ZXJBdXRoZW50aWNhdGlvblJlcXVlc3Quc3RhdGU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiTm90IHNpbGVudCBsb2dpbiwgc2V0IHdpbmRvdy5yZW5ld1N0YXRlIGFuZCByZXF1ZXN0VHlwZVwiKTtcclxuICAgICAgICAgICAgd2luZG93LnJlcXVlc3RUeXBlID0gQ29uc3RhbnRzLnJlbmV3VG9rZW47XHJcbiAgICAgICAgICAgIHdpbmRvdy5yZW5ld1N0YXRlcy5wdXNoKHNlcnZlckF1dGhlbnRpY2F0aW9uUmVxdWVzdC5zdGF0ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIG5vdGU6IHNjb3BlIGhlcmUgaXMgY2xpZW50SWRcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyQ2FsbGJhY2soc2VydmVyQXV0aGVudGljYXRpb25SZXF1ZXN0LnN0YXRlLCByZXF1ZXN0U2lnbmF0dXJlLCByZXNvbHZlLCByZWplY3QpO1xyXG4gICAgICAgIHRoaXMubG9nZ2VyLmluZm9QaWkoXCJOYXZpZ2F0ZSB0bzpcXFwiIFwiICsgdXJsTmF2aWdhdGUpO1xyXG4gICAgICAgIHRoaXMubG9hZElmcmFtZVRpbWVvdXQodXJsTmF2aWdhdGUsIGZyYW1lTmFtZSwgcmVxdWVzdFNpZ25hdHVyZSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7IHJldHVybiByZWplY3QoZXJyb3IpOyB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEBoaWRkZW5cclxuICAgICAqXHJcbiAgICAgKiBUaGlzIG1ldGhvZCBidWlsZHMgYW4gQWNjZXNzIFRva2VuIENhY2hlIGl0ZW0gYW5kIHNhdmVzIGl0IHRvIHRoZSBjYWNoZSwgcmV0dXJuaW5nIHRoZSBvcmlnaW5hbFxyXG4gICAgICogQXV0aFJlc3BvbnNlIGF1Z21lbnRlZCB3aXRoIGEgcGFyc2VkIGV4cGlyZXNPbiBhdHRyaWJ1dGUuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHJlc3BvbnNlIFRoZSBBdXRoUmVzcG9uc2Ugb2JqZWN0IHRoYXQgY29udGFpbnMgdGhlIHRva2VuIHRvIGJlIHNhdmVkXHJcbiAgICAgKiBAcGFyYW0gYXV0aG9yaXR5IFRoZSBhdXRob3JpdHkgdW5kZXIgd2hpY2ggdGhlIElEIHRva2VuIHdpbGwgYmUgY2FjaGVkXHJcbiAgICAgKiBAcGFyYW0gc2NvcGVzIFRoZSBzY29wZXMgdG8gYmUgYWRkZWQgdG8gdGhlIGNhY2hlIGl0ZW0ga2V5ICh1bmRlZmluZWQgZm9yIElEIHRva2VuIGNhY2hlIGl0ZW1zKVxyXG4gICAgICogQHBhcmFtIGNsaWVudEluZm8gQ2xpZW50IEluZm8gb2JqZWN0IHRoYXQgaXMgdXNlZCB0byBnZW5lcmF0ZSB0aGUgaG9tZUFjY291bnRJZGVudGlmaWVyXHJcbiAgICAgKiBAcGFyYW0gZXhwaXJhdGlvbiBUb2tlbiBleHBpcmF0aW9uIHRpbWVzdGFtcFxyXG4gICAgICovXHJcbiAgICBVc2VyQWdlbnRBcHBsaWNhdGlvbi5wcm90b3R5cGUuc2F2ZVRva2VuID0gZnVuY3Rpb24gKHJlc3BvbnNlLCBhdXRob3JpdHksIHNjb3BlcywgY2xpZW50SW5mbywgZXhwaXJhdGlvbikge1xyXG4gICAgICAgIHZhciBhY2Nlc3NUb2tlbktleSA9IG5ldyBBY2Nlc3NUb2tlbktleShhdXRob3JpdHksIHRoaXMuY2xpZW50SWQsIHNjb3BlcywgY2xpZW50SW5mby51aWQsIGNsaWVudEluZm8udXRpZCk7XHJcbiAgICAgICAgdmFyIGFjY2Vzc1Rva2VuVmFsdWUgPSBuZXcgQWNjZXNzVG9rZW5WYWx1ZShyZXNwb25zZS5hY2Nlc3NUb2tlbiwgcmVzcG9uc2UuaWRUb2tlbi5yYXdJZFRva2VuLCBleHBpcmF0aW9uLnRvU3RyaW5nKCksIGNsaWVudEluZm8uZW5jb2RlQ2xpZW50SW5mbygpKTtcclxuICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZS5zZXRJdGVtKEpTT04uc3RyaW5naWZ5KGFjY2Vzc1Rva2VuS2V5KSwgSlNPTi5zdHJpbmdpZnkoYWNjZXNzVG9rZW5WYWx1ZSkpO1xyXG4gICAgICAgIGlmIChleHBpcmF0aW9uKSB7XHJcbiAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJOZXcgZXhwaXJhdGlvbiBzZXQgZm9yIHRva2VuXCIpO1xyXG4gICAgICAgICAgICByZXNwb25zZS5leHBpcmVzT24gPSBuZXcgRGF0ZShleHBpcmF0aW9uICogMTAwMCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmxvZ2dlci5lcnJvcihcIkNvdWxkIG5vdCBwYXJzZSBleHBpcmVzSW4gcGFyYW1ldGVyIGZvciBhY2Nlc3MgdG9rZW5cIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXNwb25zZTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEBoaWRkZW5cclxuICAgICAqXHJcbiAgICAgKiBUaGlzIG1ldGhvZCBzZXRzIHVwIHRoZSBlbGVtZW50cyBvZiBhbiBJRCBUb2tlbiBjYWNoZSBpdGVtIGFuZCBjYWxscyBzYXZlVG9rZW4gdG8gc2F2ZSBpdCBpblxyXG4gICAgICogQWNjZXNzIFRva2VuIENhY2hlIGl0ZW0gZm9ybWF0IGZvciB0aGUgY2xpZW50IGFwcGxpY2F0aW9uIHRvIHVzZS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gcmVzcG9uc2UgVGhlIEF1dGhSZXNwb25zZSBvYmplY3QgdGhhdCB3aWxsIGJlIHVzZWQgdG8gYnVpbGQgdGhlIGNhY2hlIGl0ZW1cclxuICAgICAqIEBwYXJhbSBhdXRob3JpdHkgVGhlIGF1dGhvcml0eSB1bmRlciB3aGljaCB0aGUgSUQgdG9rZW4gd2lsbCBiZSBjYWNoZWRcclxuICAgICAqIEBwYXJhbSBwYXJhbWV0ZXJzIFRoZSByZXNwb25zZSdzIEhhc2ggUGFyYW1zLCB3aGljaCBjb250YWluIHRoZSBJRCB0b2tlbiByZXR1cm5lZCBmcm9tIHRoZSBzZXJ2ZXJcclxuICAgICAqIEBwYXJhbSBjbGllbnRJbmZvIENsaWVudCBJbmZvIG9iamVjdCB0aGF0IGlzIHVzZWQgdG8gZ2VuZXJhdGUgdGhlIGhvbWVBY2NvdW50SWRlbnRpZmllclxyXG4gICAgICogQHBhcmFtIGlkVG9rZW5PYmogSUQgVG9rZW4gb2JqZWN0IGZyb20gd2hpY2ggdGhlIElEIHRva2VuJ3MgZXhwaXJhdGlvbiBpcyBleHRyYWN0ZWRcclxuICAgICAqL1xyXG4gICAgLyogdHNsaW50OmRpc2FibGU6bm8tc3RyaW5nLWxpdGVyYWwgKi9cclxuICAgIFVzZXJBZ2VudEFwcGxpY2F0aW9uLnByb3RvdHlwZS5zYXZlSWRUb2tlbiA9IGZ1bmN0aW9uIChyZXNwb25zZSwgYXV0aG9yaXR5LCBwYXJhbWV0ZXJzLCBjbGllbnRJbmZvLCBpZFRva2VuT2JqKSB7XHJcbiAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIlNhdmVJZFRva2VuIGhhcyBiZWVuIGNhbGxlZFwiKTtcclxuICAgICAgICB2YXIgaWRUb2tlblJlc3BvbnNlID0gdHNsaWJfMS5fX2Fzc2lnbih7fSwgcmVzcG9uc2UpO1xyXG4gICAgICAgIC8vIFNjb3BlcyBhcmUgdW5kZWZpbmVkIHNvIHRoZXkgZG9uJ3Qgc2hvdyB1cCBpbiBJRCB0b2tlbiBjYWNoZSBrZXlcclxuICAgICAgICB2YXIgc2NvcGVzO1xyXG4gICAgICAgIGlkVG9rZW5SZXNwb25zZS5zY29wZXMgPSBDb25zdGFudHMub2lkY1Njb3BlcztcclxuICAgICAgICBpZFRva2VuUmVzcG9uc2UuYWNjZXNzVG9rZW4gPSBwYXJhbWV0ZXJzW1NlcnZlckhhc2hQYXJhbUtleXMuSURfVE9LRU5dO1xyXG4gICAgICAgIHZhciBleHBpcmF0aW9uID0gTnVtYmVyKGlkVG9rZW5PYmouZXhwaXJhdGlvbik7XHJcbiAgICAgICAgLy8gU2V0IElEIFRva2VuIGl0ZW0gaW4gY2FjaGVcclxuICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiU2F2aW5nIElEIHRva2VuIHRvIGNhY2hlXCIpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNhdmVUb2tlbihpZFRva2VuUmVzcG9uc2UsIGF1dGhvcml0eSwgc2NvcGVzLCBjbGllbnRJbmZvLCBleHBpcmF0aW9uKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEBoaWRkZW5cclxuICAgICAqXHJcbiAgICAgKiBUaGlzIG1ldGhvZCBzZXRzIHVwIHRoZSBlbGVtZW50cyBvZiBhbiBBY2Nlc3MgVG9rZW4gY2FjaGUgaXRlbSBhbmQgY2FsbHMgc2F2ZVRva2VuIHRvIHNhdmUgaXQgdG8gdGhlIGNhY2hlXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHJlc3BvbnNlIFRoZSBBdXRoUmVzcG9uc2Ugb2JqZWN0IHRoYXQgd2lsbCBiZSB1c2VkIHRvIGJ1aWxkIHRoZSBjYWNoZSBpdGVtXHJcbiAgICAgKiBAcGFyYW0gYXV0aG9yaXR5IFRoZSBhdXRob3JpdHkgdW5kZXIgd2hpY2ggdGhlIGFjY2VzcyB0b2tlbiB3aWxsIGJlIGNhY2hlZFxyXG4gICAgICogQHBhcmFtIHBhcmFtZXRlcnMgVGhlIHJlc3BvbnNlJ3MgSGFzaCBQYXJhbXMsIHdoaWNoIGNvbnRhaW4gdGhlIGFjY2VzcyB0b2tlbiByZXR1cm5lZCBmcm9tIHRoZSBzZXJ2ZXJcclxuICAgICAqIEBwYXJhbSBjbGllbnRJbmZvIENsaWVudCBJbmZvIG9iamVjdCB0aGF0IGlzIHVzZWQgdG8gZ2VuZXJhdGUgdGhlIGhvbWVBY2NvdW50SWRlbnRpZmllclxyXG4gICAgICovXHJcbiAgICAvKiB0c2xpbnQ6ZGlzYWJsZTpuby1zdHJpbmctbGl0ZXJhbCAqL1xyXG4gICAgVXNlckFnZW50QXBwbGljYXRpb24ucHJvdG90eXBlLnNhdmVBY2Nlc3NUb2tlbiA9IGZ1bmN0aW9uIChyZXNwb25zZSwgYXV0aG9yaXR5LCBwYXJhbWV0ZXJzLCBjbGllbnRJbmZvKSB7XHJcbiAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIlNhdmVBY2Nlc3NUb2tlbiBoYXMgYmVlbiBjYWxsZWRcIik7XHJcbiAgICAgICAgdmFyIGFjY2Vzc1Rva2VuUmVzcG9uc2UgPSB0c2xpYl8xLl9fYXNzaWduKHt9LCByZXNwb25zZSk7XHJcbiAgICAgICAgLy8gcmVhZCB0aGUgc2NvcGVzXHJcbiAgICAgICAgdmFyIHNjb3BlID0gcGFyYW1ldGVyc1tTZXJ2ZXJIYXNoUGFyYW1LZXlzLlNDT1BFXTtcclxuICAgICAgICB2YXIgY29uc2VudGVkU2NvcGVzID0gc2NvcGUuc3BsaXQoXCIgXCIpO1xyXG4gICAgICAgIC8vIHJldHJpZXZlIGFsbCBhY2Nlc3MgdG9rZW5zIGZyb20gdGhlIGNhY2hlLCByZW1vdmUgdGhlIGR1cCBzY29wZXNcclxuICAgICAgICB2YXIgYWNjZXNzVG9rZW5DYWNoZUl0ZW1zID0gdGhpcy5jYWNoZVN0b3JhZ2UuZ2V0QWxsQWNjZXNzVG9rZW5zKHRoaXMuY2xpZW50SWQsIGF1dGhvcml0eSk7XHJcbiAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIlJldHJpZXZpbmcgYWxsIGFjY2VzcyB0b2tlbnMgZnJvbSBjYWNoZSBhbmQgcmVtb3ZpbmcgZHVwbGljYXRlc1wiKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFjY2Vzc1Rva2VuQ2FjaGVJdGVtcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgYWNjZXNzVG9rZW5DYWNoZUl0ZW0gPSBhY2Nlc3NUb2tlbkNhY2hlSXRlbXNbaV07XHJcbiAgICAgICAgICAgIGlmIChhY2Nlc3NUb2tlbkNhY2hlSXRlbS5rZXkuaG9tZUFjY291bnRJZGVudGlmaWVyID09PSByZXNwb25zZS5hY2NvdW50LmhvbWVBY2NvdW50SWRlbnRpZmllcikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNhY2hlZFNjb3BlcyA9IGFjY2Vzc1Rva2VuQ2FjaGVJdGVtLmtleS5zY29wZXMuc3BsaXQoXCIgXCIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKFNjb3BlU2V0LmlzSW50ZXJzZWN0aW5nU2NvcGVzKGNhY2hlZFNjb3BlcywgY29uc2VudGVkU2NvcGVzKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2FjaGVTdG9yYWdlLnJlbW92ZUl0ZW0oSlNPTi5zdHJpbmdpZnkoYWNjZXNzVG9rZW5DYWNoZUl0ZW0ua2V5KSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgYWNjZXNzVG9rZW5SZXNwb25zZS5hY2Nlc3NUb2tlbiA9IHBhcmFtZXRlcnNbU2VydmVySGFzaFBhcmFtS2V5cy5BQ0NFU1NfVE9LRU5dO1xyXG4gICAgICAgIGFjY2Vzc1Rva2VuUmVzcG9uc2Uuc2NvcGVzID0gY29uc2VudGVkU2NvcGVzO1xyXG4gICAgICAgIHZhciBleHBpcmVzSW4gPSBUaW1lVXRpbHMucGFyc2VFeHBpcmVzSW4ocGFyYW1ldGVyc1tTZXJ2ZXJIYXNoUGFyYW1LZXlzLkVYUElSRVNfSU5dKTtcclxuICAgICAgICB2YXIgcGFyc2VkU3RhdGUgPSBSZXF1ZXN0VXRpbHMucGFyc2VMaWJyYXJ5U3RhdGUocGFyYW1ldGVyc1tTZXJ2ZXJIYXNoUGFyYW1LZXlzLlNUQVRFXSk7XHJcbiAgICAgICAgdmFyIGV4cGlyYXRpb24gPSBwYXJzZWRTdGF0ZS50cyArIGV4cGlyZXNJbjtcclxuICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiU2F2aW5nIGFjY2VzcyB0b2tlbiB0byBjYWNoZVwiKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5zYXZlVG9rZW4oYWNjZXNzVG9rZW5SZXNwb25zZSwgYXV0aG9yaXR5LCBzY29wZSwgY2xpZW50SW5mbywgZXhwaXJhdGlvbik7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaGlkZGVuXHJcbiAgICAgKiBTYXZlcyB0b2tlbiBvciBlcnJvciByZWNlaXZlZCBpbiB0aGUgcmVzcG9uc2UgZnJvbSBBQUQgaW4gdGhlIGNhY2hlLiBJbiBjYXNlIG9mIGlkX3Rva2VuLCBpdCBhbHNvIGNyZWF0ZXMgdGhlIGFjY291bnQgb2JqZWN0LlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICovXHJcbiAgICBVc2VyQWdlbnRBcHBsaWNhdGlvbi5wcm90b3R5cGUuc2F2ZVRva2VuRnJvbUhhc2ggPSBmdW5jdGlvbiAoaGFzaCwgc3RhdGVJbmZvKSB7XHJcbiAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIlNhdmVUb2tlbkZyb21IYXNoIGhhcyBiZWVuIGNhbGxlZFwiKTtcclxuICAgICAgICB0aGlzLmxvZ2dlci5pbmZvKFwiU3RhdGUgc3RhdHVzOiBcIiArIHN0YXRlSW5mby5zdGF0ZU1hdGNoICsgXCI7IFJlcXVlc3QgdHlwZTogXCIgKyBzdGF0ZUluZm8ucmVxdWVzdFR5cGUpO1xyXG4gICAgICAgIHZhciByZXNwb25zZSA9IHtcclxuICAgICAgICAgICAgdW5pcXVlSWQ6IFwiXCIsXHJcbiAgICAgICAgICAgIHRlbmFudElkOiBcIlwiLFxyXG4gICAgICAgICAgICB0b2tlblR5cGU6IFwiXCIsXHJcbiAgICAgICAgICAgIGlkVG9rZW46IG51bGwsXHJcbiAgICAgICAgICAgIGlkVG9rZW5DbGFpbXM6IG51bGwsXHJcbiAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiBudWxsLFxyXG4gICAgICAgICAgICBzY29wZXM6IFtdLFxyXG4gICAgICAgICAgICBleHBpcmVzT246IG51bGwsXHJcbiAgICAgICAgICAgIGFjY291bnQ6IG51bGwsXHJcbiAgICAgICAgICAgIGFjY291bnRTdGF0ZTogXCJcIixcclxuICAgICAgICAgICAgZnJvbUNhY2hlOiBmYWxzZVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdmFyIGVycm9yO1xyXG4gICAgICAgIHZhciBoYXNoUGFyYW1zID0gVXJsVXRpbHMuZGVzZXJpYWxpemVIYXNoKGhhc2gpO1xyXG4gICAgICAgIHZhciBhdXRob3JpdHlLZXkgPSBcIlwiO1xyXG4gICAgICAgIHZhciBhY3F1aXJlVG9rZW5BY2NvdW50S2V5ID0gXCJcIjtcclxuICAgICAgICB2YXIgaWRUb2tlbk9iaiA9IG51bGw7XHJcbiAgICAgICAgLy8gSWYgc2VydmVyIHJldHVybnMgYW4gZXJyb3JcclxuICAgICAgICBpZiAoaGFzaFBhcmFtcy5oYXNPd25Qcm9wZXJ0eShTZXJ2ZXJIYXNoUGFyYW1LZXlzLkVSUk9SX0RFU0NSSVBUSU9OKSB8fCBoYXNoUGFyYW1zLmhhc093blByb3BlcnR5KFNlcnZlckhhc2hQYXJhbUtleXMuRVJST1IpKSB7XHJcbiAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJTZXJ2ZXIgcmV0dXJuZWQgYW4gZXJyb3JcIik7XHJcbiAgICAgICAgICAgIHRoaXMubG9nZ2VyLmluZm9QaWkoXCJFcnJvciA6IFwiICsgaGFzaFBhcmFtc1tTZXJ2ZXJIYXNoUGFyYW1LZXlzLkVSUk9SXSArIFwiOyBFcnJvciBkZXNjcmlwdGlvbjogXCIgKyBoYXNoUGFyYW1zW1NlcnZlckhhc2hQYXJhbUtleXMuRVJST1JfREVTQ1JJUFRJT05dKTtcclxuICAgICAgICAgICAgdGhpcy5jYWNoZVN0b3JhZ2Uuc2V0SXRlbShFcnJvckNhY2hlS2V5cy5FUlJPUiwgaGFzaFBhcmFtc1tTZXJ2ZXJIYXNoUGFyYW1LZXlzLkVSUk9SXSk7XHJcbiAgICAgICAgICAgIHRoaXMuY2FjaGVTdG9yYWdlLnNldEl0ZW0oRXJyb3JDYWNoZUtleXMuRVJST1JfREVTQywgaGFzaFBhcmFtc1tTZXJ2ZXJIYXNoUGFyYW1LZXlzLkVSUk9SX0RFU0NSSVBUSU9OXSk7XHJcbiAgICAgICAgICAgIC8vIGxvZ2luXHJcbiAgICAgICAgICAgIGlmIChzdGF0ZUluZm8ucmVxdWVzdFR5cGUgPT09IENvbnN0YW50cy5sb2dpbikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIlJlcXVlc3RUeXBlIGlzIGxvZ2luLCBjYWNoaW5nIGxvZ2luIGVycm9yLCBnZW5lcmF0aW5nIGF1dGhvcml0eUtleVwiKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FjaGVTdG9yYWdlLnNldEl0ZW0oRXJyb3JDYWNoZUtleXMuTE9HSU5fRVJST1IsIGhhc2hQYXJhbXNbU2VydmVySGFzaFBhcmFtS2V5cy5FUlJPUl9ERVNDUklQVElPTl0gKyBcIjpcIiArIGhhc2hQYXJhbXNbU2VydmVySGFzaFBhcmFtS2V5cy5FUlJPUl0pO1xyXG4gICAgICAgICAgICAgICAgYXV0aG9yaXR5S2V5ID0gQXV0aENhY2hlLmdlbmVyYXRlQXV0aG9yaXR5S2V5KHN0YXRlSW5mby5zdGF0ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gYWNxdWlyZVRva2VuXHJcbiAgICAgICAgICAgIGlmIChzdGF0ZUluZm8ucmVxdWVzdFR5cGUgPT09IENvbnN0YW50cy5yZW5ld1Rva2VuKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiUmVxdWVzdFR5cGUgaXMgcmVuZXdUb2tlbiwgZ2VuZXJhdGluZyBhY3F1aXJlVG9rZW5BY2NvdW50S2V5XCIpO1xyXG4gICAgICAgICAgICAgICAgYXV0aG9yaXR5S2V5ID0gQXV0aENhY2hlLmdlbmVyYXRlQXV0aG9yaXR5S2V5KHN0YXRlSW5mby5zdGF0ZSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgYWNjb3VudCA9IHRoaXMuZ2V0QWNjb3VudCgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGFjY291bnRJZCA9IHZvaWQgMDtcclxuICAgICAgICAgICAgICAgIGlmIChhY2NvdW50ICYmICFTdHJpbmdVdGlscy5pc0VtcHR5KGFjY291bnQuaG9tZUFjY291bnRJZGVudGlmaWVyKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFjY291bnRJZCA9IGFjY291bnQuaG9tZUFjY291bnRJZGVudGlmaWVyO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJBY2NvdW50SWQgaXMgc2V0XCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkID0gQ29uc3RhbnRzLm5vX2FjY291bnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIkFjY291bnRJZCBpcyBzZXQgYXMgbm9fYWNjb3VudFwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGFjcXVpcmVUb2tlbkFjY291bnRLZXkgPSBBdXRoQ2FjaGUuZ2VuZXJhdGVBY3F1aXJlVG9rZW5BY2NvdW50S2V5KGFjY291bnRJZCwgc3RhdGVJbmZvLnN0YXRlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB2YXIgX2EgPSBTZXJ2ZXJIYXNoUGFyYW1LZXlzLkVSUk9SLCBoYXNoRXJyID0gaGFzaFBhcmFtc1tfYV0sIF9iID0gU2VydmVySGFzaFBhcmFtS2V5cy5FUlJPUl9ERVNDUklQVElPTiwgaGFzaEVyckRlc2MgPSBoYXNoUGFyYW1zW19iXTtcclxuICAgICAgICAgICAgaWYgKEludGVyYWN0aW9uUmVxdWlyZWRBdXRoRXJyb3IuaXNJbnRlcmFjdGlvblJlcXVpcmVkRXJyb3IoaGFzaEVycikgfHxcclxuICAgICAgICAgICAgICAgIEludGVyYWN0aW9uUmVxdWlyZWRBdXRoRXJyb3IuaXNJbnRlcmFjdGlvblJlcXVpcmVkRXJyb3IoaGFzaEVyckRlc2MpKSB7XHJcbiAgICAgICAgICAgICAgICBlcnJvciA9IG5ldyBJbnRlcmFjdGlvblJlcXVpcmVkQXV0aEVycm9yKGhhc2hQYXJhbXNbU2VydmVySGFzaFBhcmFtS2V5cy5FUlJPUl0sIGhhc2hQYXJhbXNbU2VydmVySGFzaFBhcmFtS2V5cy5FUlJPUl9ERVNDUklQVElPTl0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZXJyb3IgPSBuZXcgU2VydmVyRXJyb3IoaGFzaFBhcmFtc1tTZXJ2ZXJIYXNoUGFyYW1LZXlzLkVSUk9SXSwgaGFzaFBhcmFtc1tTZXJ2ZXJIYXNoUGFyYW1LZXlzLkVSUk9SX0RFU0NSSVBUSU9OXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gSWYgdGhlIHNlcnZlciByZXR1cm5zIFwiU3VjY2Vzc1wiXHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJTZXJ2ZXIgcmV0dXJucyBzdWNjZXNzXCIpO1xyXG4gICAgICAgICAgICAvLyBWZXJpZnkgdGhlIHN0YXRlIGZyb20gcmVkaXJlY3QgYW5kIHJlY29yZCB0b2tlbnMgdG8gc3RvcmFnZSBpZiBleGlzdHNcclxuICAgICAgICAgICAgaWYgKHN0YXRlSW5mby5zdGF0ZU1hdGNoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci5pbmZvKFwiU3RhdGUgaXMgcmlnaHRcIik7XHJcbiAgICAgICAgICAgICAgICBpZiAoaGFzaFBhcmFtcy5oYXNPd25Qcm9wZXJ0eShTZXJ2ZXJIYXNoUGFyYW1LZXlzLlNFU1NJT05fU1RBVEUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIkZyYWdtZW50IGhhcyBzZXNzaW9uIHN0YXRlLCBjYWNoaW5nXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2FjaGVTdG9yYWdlLnNldEl0ZW0oQXV0aENhY2hlLmdlbmVyYXRlVGVtcG9yYXJ5Q2FjaGVLZXkoVGVtcG9yYXJ5Q2FjaGVLZXlzLlNFU1NJT05fU1RBVEUsIHN0YXRlSW5mby5zdGF0ZSksIGhhc2hQYXJhbXNbU2VydmVySGFzaFBhcmFtS2V5cy5TRVNTSU9OX1NUQVRFXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXNwb25zZS5hY2NvdW50U3RhdGUgPSB0aGlzLmdldEFjY291bnRTdGF0ZShzdGF0ZUluZm8uc3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGNsaWVudEluZm8gPSB2b2lkIDA7XHJcbiAgICAgICAgICAgICAgICAvLyBQcm9jZXNzIGFjY2Vzc190b2tlblxyXG4gICAgICAgICAgICAgICAgaWYgKGhhc2hQYXJhbXMuaGFzT3duUHJvcGVydHkoU2VydmVySGFzaFBhcmFtS2V5cy5BQ0NFU1NfVE9LRU4pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIuaW5mbyhcIkZyYWdtZW50IGhhcyBhY2Nlc3MgdG9rZW5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UuYWNjZXNzVG9rZW4gPSBoYXNoUGFyYW1zW1NlcnZlckhhc2hQYXJhbUtleXMuQUNDRVNTX1RPS0VOXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaGFzaFBhcmFtcy5oYXNPd25Qcm9wZXJ0eShTZXJ2ZXJIYXNoUGFyYW1LZXlzLlNDT1BFKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNwb25zZS5zY29wZXMgPSBoYXNoUGFyYW1zW1NlcnZlckhhc2hQYXJhbUtleXMuU0NPUEVdLnNwbGl0KFwiIFwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcmV0cmlldmUgdGhlIGlkX3Rva2VuIGZyb20gcmVzcG9uc2UgaWYgcHJlc2VudFxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChoYXNoUGFyYW1zLmhhc093blByb3BlcnR5KFNlcnZlckhhc2hQYXJhbUtleXMuSURfVE9LRU4pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJGcmFnbWVudCBoYXMgaWRfdG9rZW5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkVG9rZW5PYmogPSBuZXcgSWRUb2tlbihoYXNoUGFyYW1zW1NlcnZlckhhc2hQYXJhbUtleXMuSURfVE9LRU5dKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJObyBpZFRva2VuIG9uIGZyYWdtZW50LCBnZXR0aW5nIGlkVG9rZW4gZnJvbSBjYWNoZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWRUb2tlbk9iaiA9IG5ldyBJZFRva2VuKHRoaXMuY2FjaGVTdG9yYWdlLmdldEl0ZW0oUGVyc2lzdGVudENhY2hlS2V5cy5JRFRPS0VOKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gUmVzcG9uc2VVdGlscy5zZXRSZXNwb25zZUlkVG9rZW4ocmVzcG9uc2UsIGlkVG9rZW5PYmopO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHNldCBhdXRob3JpdHlcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYXV0aG9yaXR5ID0gdGhpcy5wb3B1bGF0ZUF1dGhvcml0eShzdGF0ZUluZm8uc3RhdGUsIHRoaXMuaW5Db29raWUsIHRoaXMuY2FjaGVTdG9yYWdlLCBpZFRva2VuT2JqKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiR290IGF1dGhvcml0eSBmcm9tIGNhY2hlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHJldHJpZXZlIGNsaWVudF9pbmZvIC0gaWYgaXQgaXMgbm90IGZvdW5kLCBnZW5lcmF0ZSB0aGUgdWlkIGFuZCB1dGlkIGZyb20gaWRUb2tlblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChoYXNoUGFyYW1zLmhhc093blByb3BlcnR5KFNlcnZlckhhc2hQYXJhbUtleXMuQ0xJRU5UX0lORk8pKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJGcmFnbWVudCBoYXMgY2xpZW50SW5mb1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xpZW50SW5mbyA9IG5ldyBDbGllbnRJbmZvKGhhc2hQYXJhbXNbU2VydmVySGFzaFBhcmFtS2V5cy5DTElFTlRfSU5GT10sIGF1dGhvcml0eSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuYXV0aG9yaXR5SW5zdGFuY2UuQXV0aG9yaXR5VHlwZSA9PT0gQXV0aG9yaXR5VHlwZS5BZGZzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsaWVudEluZm8gPSBDbGllbnRJbmZvLmNyZWF0ZUNsaWVudEluZm9Gcm9tSWRUb2tlbihpZFRva2VuT2JqLCBhdXRob3JpdHkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIud2FybmluZyhcIkNsaWVudEluZm8gbm90IHJlY2VpdmVkIGluIHRoZSByZXNwb25zZSBmcm9tIEFBRFwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UuYWNjb3VudCA9IEFjY291bnQuY3JlYXRlQWNjb3VudChpZFRva2VuT2JqLCBjbGllbnRJbmZvKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiQWNjb3VudCBvYmplY3QgY3JlYXRlZCBmcm9tIHJlc3BvbnNlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBhY2NvdW50S2V5ID0gdm9pZCAwO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5hY2NvdW50ICYmICFTdHJpbmdVdGlscy5pc0VtcHR5KHJlc3BvbnNlLmFjY291bnQuaG9tZUFjY291bnRJZGVudGlmaWVyKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiQWNjb3VudEtleSBzZXRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY291bnRLZXkgPSByZXNwb25zZS5hY2NvdW50LmhvbWVBY2NvdW50SWRlbnRpZmllcjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJBY2NvdW50S2V5IHNldCBhcyBub19hY2NvdW50XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50S2V5ID0gQ29uc3RhbnRzLm5vX2FjY291bnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGFjcXVpcmVUb2tlbkFjY291bnRLZXkgPSBBdXRoQ2FjaGUuZ2VuZXJhdGVBY3F1aXJlVG9rZW5BY2NvdW50S2V5KGFjY291bnRLZXksIHN0YXRlSW5mby5zdGF0ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFjcXVpcmVUb2tlbkFjY291bnRLZXlfbm9hY2NvdW50ID0gQXV0aENhY2hlLmdlbmVyYXRlQWNxdWlyZVRva2VuQWNjb3VudEtleShDb25zdGFudHMubm9fYWNjb3VudCwgc3RhdGVJbmZvLnN0YXRlKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiQWNxdWlyZVRva2VuQWNjb3VudEtleSBnZW5lcmF0ZWRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNhY2hlZEFjY291bnQgPSB0aGlzLmNhY2hlU3RvcmFnZS5nZXRJdGVtKGFjcXVpcmVUb2tlbkFjY291bnRLZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBhY3F1aXJlVG9rZW5BY2NvdW50ID0gdm9pZCAwO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIENoZWNrIHdpdGggdGhlIGFjY291bnQgaW4gdGhlIENhY2hlXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFTdHJpbmdVdGlscy5pc0VtcHR5KGNhY2hlZEFjY291bnQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjcXVpcmVUb2tlbkFjY291bnQgPSBKU09OLnBhcnNlKGNhY2hlZEFjY291bnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiQWNxdWlyZVRva2VuIHJlcXVlc3QgYWNjb3VudCByZXRyaWV2ZWQgZnJvbSBjYWNoZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmFjY291bnQgJiYgYWNxdWlyZVRva2VuQWNjb3VudCAmJiBBY2NvdW50LmNvbXBhcmVBY2NvdW50cyhyZXNwb25zZS5hY2NvdW50LCBhY3F1aXJlVG9rZW5BY2NvdW50KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2UgPSB0aGlzLnNhdmVBY2Nlc3NUb2tlbihyZXNwb25zZSwgYXV0aG9yaXR5LCBoYXNoUGFyYW1zLCBjbGllbnRJbmZvKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLmluZm8oXCJUaGUgdXNlciBvYmplY3QgcmVjZWl2ZWQgaW4gdGhlIHJlc3BvbnNlIGlzIHRoZSBzYW1lIGFzIHRoZSBvbmUgcGFzc2VkIGluIHRoZSBhY3F1aXJlVG9rZW4gcmVxdWVzdFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLndhcm5pbmcoXCJUaGUgYWNjb3VudCBvYmplY3QgY3JlYXRlZCBmcm9tIHRoZSByZXNwb25zZSBpcyBub3QgdGhlIHNhbWUgYXMgdGhlIG9uZSBwYXNzZWQgaW4gdGhlIGFjcXVpcmVUb2tlbiByZXF1ZXN0XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFTdHJpbmdVdGlscy5pc0VtcHR5KHRoaXMuY2FjaGVTdG9yYWdlLmdldEl0ZW0oYWNxdWlyZVRva2VuQWNjb3VudEtleV9ub2FjY291bnQpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiTm8gYWNxdWlyZVRva2VuIGFjY291bnQgcmV0cmlldmVkIGZyb20gY2FjaGVcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlID0gdGhpcy5zYXZlQWNjZXNzVG9rZW4ocmVzcG9uc2UsIGF1dGhvcml0eSwgaGFzaFBhcmFtcywgY2xpZW50SW5mbyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gUHJvY2VzcyBpZF90b2tlblxyXG4gICAgICAgICAgICAgICAgaWYgKGhhc2hQYXJhbXMuaGFzT3duUHJvcGVydHkoU2VydmVySGFzaFBhcmFtS2V5cy5JRF9UT0tFTikpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci5pbmZvKFwiRnJhZ21lbnQgaGFzIGlkVG9rZW5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gc2V0IHRoZSBpZFRva2VuXHJcbiAgICAgICAgICAgICAgICAgICAgaWRUb2tlbk9iaiA9IG5ldyBJZFRva2VuKGhhc2hQYXJhbXNbU2VydmVySGFzaFBhcmFtS2V5cy5JRF9UT0tFTl0pO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHNldCBhdXRob3JpdHlcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYXV0aG9yaXR5ID0gdGhpcy5wb3B1bGF0ZUF1dGhvcml0eShzdGF0ZUluZm8uc3RhdGUsIHRoaXMuaW5Db29raWUsIHRoaXMuY2FjaGVTdG9yYWdlLCBpZFRva2VuT2JqKTtcclxuICAgICAgICAgICAgICAgICAgICByZXNwb25zZSA9IFJlc3BvbnNlVXRpbHMuc2V0UmVzcG9uc2VJZFRva2VuKHJlc3BvbnNlLCBpZFRva2VuT2JqKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaGFzaFBhcmFtcy5oYXNPd25Qcm9wZXJ0eShTZXJ2ZXJIYXNoUGFyYW1LZXlzLkNMSUVOVF9JTkZPKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiRnJhZ21lbnQgaGFzIGNsaWVudEluZm9cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsaWVudEluZm8gPSBuZXcgQ2xpZW50SW5mbyhoYXNoUGFyYW1zW1NlcnZlckhhc2hQYXJhbUtleXMuQ0xJRU5UX0lORk9dLCBhdXRob3JpdHkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLmF1dGhvcml0eUluc3RhbmNlLkF1dGhvcml0eVR5cGUgPT09IEF1dGhvcml0eVR5cGUuQWRmcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGllbnRJbmZvID0gQ2xpZW50SW5mby5jcmVhdGVDbGllbnRJbmZvRnJvbUlkVG9rZW4oaWRUb2tlbk9iaiwgYXV0aG9yaXR5KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLndhcm5pbmcoXCJDbGllbnRJbmZvIG5vdCByZWNlaXZlZCBpbiB0aGUgcmVzcG9uc2UgZnJvbSBBQURcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWNjb3VudCA9IEFjY291bnQuY3JlYXRlQWNjb3VudChpZFRva2VuT2JqLCBjbGllbnRJbmZvKTtcclxuICAgICAgICAgICAgICAgICAgICByZXNwb25zZS5hY2NvdW50ID0gdGhpcy5hY2NvdW50O1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJBY2NvdW50IG9iamVjdCBjcmVhdGVkIGZyb20gcmVzcG9uc2VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlkVG9rZW5PYmogJiYgaWRUb2tlbk9iai5ub25jZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiSWRUb2tlbiBoYXMgbm9uY2VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIG5vbmNlIGludGVncml0eSBpZiBpZFRva2VuIGhhcyBub25jZSAtIHRocm93IGFuIGVycm9yIGlmIG5vdCBtYXRjaGVkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjYWNoZWROb25jZSA9IHRoaXMuY2FjaGVTdG9yYWdlLmdldEl0ZW0oQXV0aENhY2hlLmdlbmVyYXRlVGVtcG9yYXJ5Q2FjaGVLZXkoVGVtcG9yYXJ5Q2FjaGVLZXlzLk5PTkNFX0lEVE9LRU4sIHN0YXRlSW5mby5zdGF0ZSksIHRoaXMuaW5Db29raWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaWRUb2tlbk9iai5ub25jZSAhPT0gY2FjaGVkTm9uY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWNjb3VudCA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZS5zZXRJdGVtKEVycm9yQ2FjaGVLZXlzLkxPR0lOX0VSUk9SLCBcIk5vbmNlIE1pc21hdGNoLiBFeHBlY3RlZCBOb25jZTogXCIgKyBjYWNoZWROb25jZSArIFwiLFwiICsgXCJBY3R1YWwgTm9uY2U6IFwiICsgaWRUb2tlbk9iai5ub25jZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxvZ2dlci5lcnJvcihcIk5vbmNlIE1pc21hdGNoLiBFeHBlY3RlZCBOb25jZTogXCIgKyBjYWNoZWROb25jZSArIFwiLCBBY3R1YWwgTm9uY2U6IFwiICsgaWRUb2tlbk9iai5ub25jZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvciA9IENsaWVudEF1dGhFcnJvci5jcmVhdGVOb25jZU1pc21hdGNoRXJyb3IoY2FjaGVkTm9uY2UsIGlkVG9rZW5PYmoubm9uY2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNhdmUgdGhlIHRva2VuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIudmVyYm9zZShcIk5vbmNlIG1hdGNoZXMsIHNhdmluZyBpZFRva2VuIHRvIGNhY2hlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jYWNoZVN0b3JhZ2Uuc2V0SXRlbShQZXJzaXN0ZW50Q2FjaGVLZXlzLklEVE9LRU4sIGhhc2hQYXJhbXNbU2VydmVySGFzaFBhcmFtS2V5cy5JRF9UT0tFTl0sIHRoaXMuaW5Db29raWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jYWNoZVN0b3JhZ2Uuc2V0SXRlbShQZXJzaXN0ZW50Q2FjaGVLZXlzLkNMSUVOVF9JTkZPLCBjbGllbnRJbmZvLmVuY29kZUNsaWVudEluZm8oKSwgdGhpcy5pbkNvb2tpZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTYXZlIGlkVG9rZW4gYXMgYWNjZXNzIHRva2VuIGl0ZW0gZm9yIGFwcCBpdHNlbGZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2F2ZUlkVG9rZW4ocmVzcG9uc2UsIGF1dGhvcml0eSwgaGFzaFBhcmFtcywgY2xpZW50SW5mbywgaWRUb2tlbk9iaik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJObyBpZFRva2VuIG9yIG5vIG5vbmNlLiBDYWNoZSBrZXkgZm9yIEF1dGhvcml0eSBzZXQgYXMgc3RhdGVcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhvcml0eUtleSA9IHN0YXRlSW5mby5zdGF0ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWNxdWlyZVRva2VuQWNjb3VudEtleSA9IHN0YXRlSW5mby5zdGF0ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2dnZXIuZXJyb3IoXCJJbnZhbGlkIGlkX3Rva2VuIHJlY2VpdmVkIGluIHRoZSByZXNwb25zZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSBDbGllbnRBdXRoRXJyb3IuY3JlYXRlSW52YWxpZElkVG9rZW5FcnJvcihpZFRva2VuT2JqKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jYWNoZVN0b3JhZ2Uuc2V0SXRlbShFcnJvckNhY2hlS2V5cy5FUlJPUiwgZXJyb3IuZXJyb3JDb2RlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jYWNoZVN0b3JhZ2Uuc2V0SXRlbShFcnJvckNhY2hlS2V5cy5FUlJPUl9ERVNDLCBlcnJvci5lcnJvck1lc3NhZ2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBTdGF0ZSBtaXNtYXRjaCAtIHVuZXhwZWN0ZWQvaW52YWxpZCBzdGF0ZVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJTdGF0ZSBtaXNtYXRjaFwiKTtcclxuICAgICAgICAgICAgICAgIGF1dGhvcml0eUtleSA9IHN0YXRlSW5mby5zdGF0ZTtcclxuICAgICAgICAgICAgICAgIGFjcXVpcmVUb2tlbkFjY291bnRLZXkgPSBzdGF0ZUluZm8uc3RhdGU7XHJcbiAgICAgICAgICAgICAgICB2YXIgZXhwZWN0ZWRTdGF0ZSA9IHRoaXMuY2FjaGVTdG9yYWdlLmdldEl0ZW0oQXV0aENhY2hlLmdlbmVyYXRlVGVtcG9yYXJ5Q2FjaGVLZXkoVGVtcG9yYXJ5Q2FjaGVLZXlzLlNUQVRFX0xPR0lOLCBzdGF0ZUluZm8uc3RhdGUpLCB0aGlzLmluQ29va2llKTtcclxuICAgICAgICAgICAgICAgIHRoaXMubG9nZ2VyLmVycm9yKFwiU3RhdGUgTWlzbWF0Y2guIEV4cGVjdGVkIFN0YXRlOiBcIiArIGV4cGVjdGVkU3RhdGUgKyBcIiwgQWN0dWFsIFN0YXRlOiBcIiArIHN0YXRlSW5mby5zdGF0ZSk7XHJcbiAgICAgICAgICAgICAgICBlcnJvciA9IENsaWVudEF1dGhFcnJvci5jcmVhdGVJbnZhbGlkU3RhdGVFcnJvcihzdGF0ZUluZm8uc3RhdGUsIGV4cGVjdGVkU3RhdGUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jYWNoZVN0b3JhZ2Uuc2V0SXRlbShFcnJvckNhY2hlS2V5cy5FUlJPUiwgZXJyb3IuZXJyb3JDb2RlKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FjaGVTdG9yYWdlLnNldEl0ZW0oRXJyb3JDYWNoZUtleXMuRVJST1JfREVTQywgZXJyb3IuZXJyb3JNZXNzYWdlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBTZXQgc3RhdHVzIHRvIGNvbXBsZXRlZFxyXG4gICAgICAgIHRoaXMuY2FjaGVTdG9yYWdlLnJlbW92ZUl0ZW0oQXV0aENhY2hlLmdlbmVyYXRlVGVtcG9yYXJ5Q2FjaGVLZXkoVGVtcG9yYXJ5Q2FjaGVLZXlzLlJFTkVXX1NUQVRVUywgc3RhdGVJbmZvLnN0YXRlKSk7XHJcbiAgICAgICAgdGhpcy5jYWNoZVN0b3JhZ2UucmVzZXRUZW1wQ2FjaGVJdGVtcyhzdGF0ZUluZm8uc3RhdGUpO1xyXG4gICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJTdGF0dXMgc2V0IHRvIGNvbXBsZXRlLCB0ZW1wb3JhcnkgY2FjaGUgY2xlYXJlZFwiKTtcclxuICAgICAgICAvLyB0aGlzIGlzIHJlcXVpcmVkIGlmIG5hdmlnYXRlVG9Mb2dpblJlcXVlc3RVcmw9ZmFsc2VcclxuICAgICAgICBpZiAodGhpcy5pbkNvb2tpZSkge1xyXG4gICAgICAgICAgICB0aGlzLmxvZ2dlci52ZXJib3NlKFwiSW5Db29raWUgaXMgdHJ1ZSwgc2V0dGluZyBhdXRob3JpdHlLZXkgaW4gY29va2llXCIpO1xyXG4gICAgICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZS5zZXRJdGVtQ29va2llKGF1dGhvcml0eUtleSwgXCJcIiwgLTEpO1xyXG4gICAgICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZS5jbGVhck1zYWxDb29raWUoc3RhdGVJbmZvLnN0YXRlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgICAgIC8vIEVycm9yIGNhc2UsIHNldCBzdGF0dXMgdG8gY2FuY2VsbGVkXHJcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgIHRocm93IEF1dGhFcnJvci5jcmVhdGVVbmV4cGVjdGVkRXJyb3IoXCJSZXNwb25zZSBpcyBudWxsXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzcG9uc2U7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBTZXQgQXV0aG9yaXR5IHdoZW4gc2F2aW5nIFRva2VuIGZyb20gdGhlIGhhc2hcclxuICAgICAqIEBwYXJhbSBzdGF0ZVxyXG4gICAgICogQHBhcmFtIGluQ29va2llXHJcbiAgICAgKiBAcGFyYW0gY2FjaGVTdG9yYWdlXHJcbiAgICAgKiBAcGFyYW0gaWRUb2tlbk9ialxyXG4gICAgICogQHBhcmFtIHJlc3BvbnNlXHJcbiAgICAgKi9cclxuICAgIFVzZXJBZ2VudEFwcGxpY2F0aW9uLnByb3RvdHlwZS5wb3B1bGF0ZUF1dGhvcml0eSA9IGZ1bmN0aW9uIChzdGF0ZSwgaW5Db29raWUsIGNhY2hlU3RvcmFnZSwgaWRUb2tlbk9iaikge1xyXG4gICAgICAgIHRoaXMubG9nZ2VyLnZlcmJvc2UoXCJQb3B1bGF0ZUF1dGhvcml0eSBoYXMgYmVlbiBjYWxsZWRcIik7XHJcbiAgICAgICAgdmFyIGF1dGhvcml0eUtleSA9IEF1dGhDYWNoZS5nZW5lcmF0ZUF1dGhvcml0eUtleShzdGF0ZSk7XHJcbiAgICAgICAgdmFyIGNhY2hlZEF1dGhvcml0eSA9IGNhY2hlU3RvcmFnZS5nZXRJdGVtKGF1dGhvcml0eUtleSwgaW5Db29raWUpO1xyXG4gICAgICAgIC8vIHJldHJpZXZlIHRoZSBhdXRob3JpdHkgZnJvbSBjYWNoZSBhbmQgcmVwbGFjZSB3aXRoIHRlbmFudElEXHJcbiAgICAgICAgcmV0dXJuIFN0cmluZ1V0aWxzLmlzRW1wdHkoY2FjaGVkQXV0aG9yaXR5KSA/IGNhY2hlZEF1dGhvcml0eSA6IFVybFV0aWxzLnJlcGxhY2VUZW5hbnRQYXRoKGNhY2hlZEF1dGhvcml0eSwgaWRUb2tlbk9iai50ZW5hbnRJZCk7XHJcbiAgICB9O1xyXG4gICAgLyogdHNsaW50OmVuYWJsZTpuby1zdHJpbmctbGl0ZXJhbCAqL1xyXG4gICAgLy8gI2VuZHJlZ2lvblxyXG4gICAgLy8gI3JlZ2lvbiBBY2NvdW50XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdGhlIHNpZ25lZCBpbiBhY2NvdW50XHJcbiAgICAgKiAodGhlIGFjY291bnQgb2JqZWN0IGlzIGNyZWF0ZWQgYXQgdGhlIHRpbWUgb2Ygc3VjY2Vzc2Z1bCBsb2dpbilcclxuICAgICAqIG9yIG51bGwgd2hlbiBubyBzdGF0ZSBpcyBmb3VuZFxyXG4gICAgICogQHJldHVybnMge0BsaW5rIEFjY291bnR9IC0gdGhlIGFjY291bnQgb2JqZWN0IHN0b3JlZCBpbiBNU0FMXHJcbiAgICAgKi9cclxuICAgIFVzZXJBZ2VudEFwcGxpY2F0aW9uLnByb3RvdHlwZS5nZXRBY2NvdW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIC8vIGlmIGEgc2Vzc2lvbiBhbHJlYWR5IGV4aXN0cywgZ2V0IHRoZSBhY2NvdW50IGZyb20gdGhlIHNlc3Npb25cclxuICAgICAgICBpZiAodGhpcy5hY2NvdW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFjY291bnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGZyYW1lIGlzIHVzZWQgdG8gZ2V0IGlkVG9rZW4gYW5kIHBvcHVsYXRlIHRoZSBhY2NvdW50IGZvciB0aGUgZ2l2ZW4gc2Vzc2lvblxyXG4gICAgICAgIHZhciByYXdJZFRva2VuID0gdGhpcy5jYWNoZVN0b3JhZ2UuZ2V0SXRlbShQZXJzaXN0ZW50Q2FjaGVLZXlzLklEVE9LRU4sIHRoaXMuaW5Db29raWUpO1xyXG4gICAgICAgIHZhciByYXdDbGllbnRJbmZvID0gdGhpcy5jYWNoZVN0b3JhZ2UuZ2V0SXRlbShQZXJzaXN0ZW50Q2FjaGVLZXlzLkNMSUVOVF9JTkZPLCB0aGlzLmluQ29va2llKTtcclxuICAgICAgICBpZiAoIVN0cmluZ1V0aWxzLmlzRW1wdHkocmF3SWRUb2tlbikgJiYgIVN0cmluZ1V0aWxzLmlzRW1wdHkocmF3Q2xpZW50SW5mbykpIHtcclxuICAgICAgICAgICAgdmFyIGlkVG9rZW4gPSBuZXcgSWRUb2tlbihyYXdJZFRva2VuKTtcclxuICAgICAgICAgICAgdmFyIGNsaWVudEluZm8gPSBuZXcgQ2xpZW50SW5mbyhyYXdDbGllbnRJbmZvLCBcIlwiKTtcclxuICAgICAgICAgICAgdGhpcy5hY2NvdW50ID0gQWNjb3VudC5jcmVhdGVBY2NvdW50KGlkVG9rZW4sIGNsaWVudEluZm8pO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hY2NvdW50O1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBpZiBsb2dpbiBub3QgeWV0IGRvbmUsIHJldHVybiBudWxsXHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaGlkZGVuXHJcbiAgICAgKlxyXG4gICAgICogRXh0cmFjdHMgc3RhdGUgdmFsdWUgZnJvbSB0aGUgYWNjb3VudFN0YXRlIHNlbnQgd2l0aCB0aGUgYXV0aGVudGljYXRpb24gcmVxdWVzdC5cclxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IHNjb3BlLlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICovXHJcbiAgICBVc2VyQWdlbnRBcHBsaWNhdGlvbi5wcm90b3R5cGUuZ2V0QWNjb3VudFN0YXRlID0gZnVuY3Rpb24gKHN0YXRlKSB7XHJcbiAgICAgICAgaWYgKHN0YXRlKSB7XHJcbiAgICAgICAgICAgIHZhciBzcGxpdEluZGV4ID0gc3RhdGUuaW5kZXhPZihDb25zdGFudHMucmVzb3VyY2VEZWxpbWl0ZXIpO1xyXG4gICAgICAgICAgICBpZiAoc3BsaXRJbmRleCA+IC0xICYmIHNwbGl0SW5kZXggKyAxIDwgc3RhdGUubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RhdGUuc3Vic3RyaW5nKHNwbGl0SW5kZXggKyAxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gc3RhdGU7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBVc2UgdG8gZ2V0IGEgbGlzdCBvZiB1bmlxdWUgYWNjb3VudHMgaW4gTVNBTCBjYWNoZSBiYXNlZCBvbiBob21lQWNjb3VudElkZW50aWZpZXIuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtAbGluayBBcnJheTxBY2NvdW50Pn0gQWNjb3VudCAtIGFsbCB1bmlxdWUgYWNjb3VudHMgaW4gTVNBTCBjYWNoZS5cclxuICAgICAqL1xyXG4gICAgVXNlckFnZW50QXBwbGljYXRpb24ucHJvdG90eXBlLmdldEFsbEFjY291bnRzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBhY2NvdW50cyA9IFtdO1xyXG4gICAgICAgIHZhciBhY2Nlc3NUb2tlbkNhY2hlSXRlbXMgPSB0aGlzLmNhY2hlU3RvcmFnZS5nZXRBbGxBY2Nlc3NUb2tlbnMoQ29uc3RhbnRzLmNsaWVudElkLCBDb25zdGFudHMuaG9tZUFjY291bnRJZGVudGlmaWVyKTtcclxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFjY2Vzc1Rva2VuQ2FjaGVJdGVtcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB2YXIgaWRUb2tlbiA9IG5ldyBJZFRva2VuKGFjY2Vzc1Rva2VuQ2FjaGVJdGVtc1tpXS52YWx1ZS5pZFRva2VuKTtcclxuICAgICAgICAgICAgdmFyIGNsaWVudEluZm8gPSBuZXcgQ2xpZW50SW5mbyhhY2Nlc3NUb2tlbkNhY2hlSXRlbXNbaV0udmFsdWUuaG9tZUFjY291bnRJZGVudGlmaWVyLCBcIlwiKTtcclxuICAgICAgICAgICAgdmFyIGFjY291bnQgPSBBY2NvdW50LmNyZWF0ZUFjY291bnQoaWRUb2tlbiwgY2xpZW50SW5mbyk7XHJcbiAgICAgICAgICAgIGFjY291bnRzLnB1c2goYWNjb3VudCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmdldFVuaXF1ZUFjY291bnRzKGFjY291bnRzKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEBoaWRkZW5cclxuICAgICAqXHJcbiAgICAgKiBVc2VkIHRvIGZpbHRlciBhY2NvdW50cyBiYXNlZCBvbiBob21lQWNjb3VudElkZW50aWZpZXJcclxuICAgICAqIEBwYXJhbSB7QXJyYXk8QWNjb3VudD59ICBBY2NvdW50cyAtIGFjY291bnRzIHNhdmVkIGluIHRoZSBjYWNoZVxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICovXHJcbiAgICBVc2VyQWdlbnRBcHBsaWNhdGlvbi5wcm90b3R5cGUuZ2V0VW5pcXVlQWNjb3VudHMgPSBmdW5jdGlvbiAoYWNjb3VudHMpIHtcclxuICAgICAgICBpZiAoIWFjY291bnRzIHx8IGFjY291bnRzLmxlbmd0aCA8PSAxKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhY2NvdW50cztcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGZsYWdzID0gW107XHJcbiAgICAgICAgdmFyIHVuaXF1ZUFjY291bnRzID0gW107XHJcbiAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IGFjY291bnRzLmxlbmd0aDsgKytpbmRleCkge1xyXG4gICAgICAgICAgICBpZiAoYWNjb3VudHNbaW5kZXhdLmhvbWVBY2NvdW50SWRlbnRpZmllciAmJiBmbGFncy5pbmRleE9mKGFjY291bnRzW2luZGV4XS5ob21lQWNjb3VudElkZW50aWZpZXIpID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgZmxhZ3MucHVzaChhY2NvdW50c1tpbmRleF0uaG9tZUFjY291bnRJZGVudGlmaWVyKTtcclxuICAgICAgICAgICAgICAgIHVuaXF1ZUFjY291bnRzLnB1c2goYWNjb3VudHNbaW5kZXhdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdW5pcXVlQWNjb3VudHM7XHJcbiAgICB9O1xyXG4gICAgLy8gI2VuZHJlZ2lvblxyXG4gICAgLy8gI3JlZ2lvbiBBbmd1bGFyXHJcbiAgICAvKipcclxuICAgICAqIEBoaWRkZW5cclxuICAgICAqXHJcbiAgICAgKiBCcm9hZGNhc3QgbWVzc2FnZXMgLSBVc2VkIG9ubHkgZm9yIEFuZ3VsYXI/ICAqXHJcbiAgICAgKiBAcGFyYW0gZXZlbnROYW1lXHJcbiAgICAgKiBAcGFyYW0gZGF0YVxyXG4gICAgICovXHJcbiAgICBVc2VyQWdlbnRBcHBsaWNhdGlvbi5wcm90b3R5cGUuYnJvYWRjYXN0ID0gZnVuY3Rpb24gKGV2ZW50TmFtZSwgZGF0YSkge1xyXG4gICAgICAgIHZhciBldnQgPSBuZXcgQ3VzdG9tRXZlbnQoZXZlbnROYW1lLCB7IGRldGFpbDogZGF0YSB9KTtcclxuICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChldnQpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQGhpZGRlblxyXG4gICAgICpcclxuICAgICAqIEhlbHBlciBmdW5jdGlvbiB0byByZXRyaWV2ZSB0aGUgY2FjaGVkIHRva2VuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHNjb3Blc1xyXG4gICAgICogQHBhcmFtIHtAbGluayBBY2NvdW50fSBhY2NvdW50XHJcbiAgICAgKiBAcGFyYW0gc3RhdGVcclxuICAgICAqIEByZXR1cm4ge0BsaW5rIEF1dGhSZXNwb25zZX0gQXV0aFJlc3BvbnNlXHJcbiAgICAgKi9cclxuICAgIFVzZXJBZ2VudEFwcGxpY2F0aW9uLnByb3RvdHlwZS5nZXRDYWNoZWRUb2tlbkludGVybmFsID0gZnVuY3Rpb24gKHNjb3BlcywgYWNjb3VudCwgc3RhdGUsIGNvcnJlbGF0aW9uSWQpIHtcclxuICAgICAgICAvLyBHZXQgdGhlIGN1cnJlbnQgc2Vzc2lvbidzIGFjY291bnQgb2JqZWN0XHJcbiAgICAgICAgdmFyIGFjY291bnRPYmplY3QgPSBhY2NvdW50IHx8IHRoaXMuZ2V0QWNjb3VudCgpO1xyXG4gICAgICAgIGlmICghYWNjb3VudE9iamVjdCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gQ29uc3RydWN0IEF1dGhlbnRpY2F0aW9uUmVxdWVzdCBiYXNlZCBvbiByZXNwb25zZSB0eXBlOyBzZXQgXCJyZWRpcmVjdFVyaVwiIGZyb20gdGhlIFwicmVxdWVzdFwiIHdoaWNoIG1ha2VzIHRoaXMgY2FsbCBmcm9tIEFuZ3VsYXIgLSBmb3IgdGhpcy5nZXRSZWRpcmVjdFVyaSgpXHJcbiAgICAgICAgdmFyIG5ld0F1dGhvcml0eSA9IHRoaXMuYXV0aG9yaXR5SW5zdGFuY2UgPyB0aGlzLmF1dGhvcml0eUluc3RhbmNlIDogQXV0aG9yaXR5RmFjdG9yeS5DcmVhdGVJbnN0YW5jZSh0aGlzLmF1dGhvcml0eSwgdGhpcy5jb25maWcuYXV0aC52YWxpZGF0ZUF1dGhvcml0eSk7XHJcbiAgICAgICAgdmFyIHJlc3BvbnNlVHlwZSA9IHRoaXMuZ2V0VG9rZW5UeXBlKGFjY291bnRPYmplY3QsIHNjb3Blcyk7XHJcbiAgICAgICAgdmFyIHNlcnZlckF1dGhlbnRpY2F0aW9uUmVxdWVzdCA9IG5ldyBTZXJ2ZXJSZXF1ZXN0UGFyYW1ldGVycyhuZXdBdXRob3JpdHksIHRoaXMuY2xpZW50SWQsIHJlc3BvbnNlVHlwZSwgdGhpcy5nZXRSZWRpcmVjdFVyaSgpLCBzY29wZXMsIHN0YXRlLCBjb3JyZWxhdGlvbklkKTtcclxuICAgICAgICAvLyBnZXQgY2FjaGVkIHRva2VuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Q2FjaGVkVG9rZW4oc2VydmVyQXV0aGVudGljYXRpb25SZXF1ZXN0LCBhY2NvdW50KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEBoaWRkZW5cclxuICAgICAqXHJcbiAgICAgKiBHZXQgc2NvcGVzIGZvciB0aGUgRW5kcG9pbnQgLSBVc2VkIGluIEFuZ3VsYXIgdG8gdHJhY2sgcHJvdGVjdGVkIGFuZCB1bnByb3RlY3RlZCByZXNvdXJjZXMgd2l0aG91dCBpbnRlcmFjdGlvbiBmcm9tIHRoZSBkZXZlbG9wZXIgYXBwXHJcbiAgICAgKiBOb3RlOiBQbGVhc2UgY2hlY2sgaWYgd2UgbmVlZCB0byBzZXQgdGhlIFwicmVkaXJlY3RVcmlcIiBmcm9tIHRoZSBcInJlcXVlc3RcIiB3aGljaCBtYWtlcyB0aGlzIGNhbGwgZnJvbSBBbmd1bGFyIC0gZm9yIHRoaXMuZ2V0UmVkaXJlY3RVcmkoKVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBlbmRwb2ludFxyXG4gICAgICovXHJcbiAgICBVc2VyQWdlbnRBcHBsaWNhdGlvbi5wcm90b3R5cGUuZ2V0U2NvcGVzRm9yRW5kcG9pbnQgPSBmdW5jdGlvbiAoZW5kcG9pbnQpIHtcclxuICAgICAgICAvLyBpZiB1c2VyIHNwZWNpZmllZCBsaXN0IG9mIHVucHJvdGVjdGVkUmVzb3VyY2VzLCBubyBuZWVkIHRvIHNlbmQgdG9rZW4gdG8gdGhlc2UgZW5kcG9pbnRzLCByZXR1cm4gbnVsbC5cclxuICAgICAgICBpZiAodGhpcy5jb25maWcuZnJhbWV3b3JrLnVucHJvdGVjdGVkUmVzb3VyY2VzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmNvbmZpZy5mcmFtZXdvcmsudW5wcm90ZWN0ZWRSZXNvdXJjZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmIChlbmRwb2ludC5pbmRleE9mKHRoaXMuY29uZmlnLmZyYW1ld29yay51bnByb3RlY3RlZFJlc291cmNlc1tpXSkgPiAtMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIHByb2Nlc3MgYWxsIHByb3RlY3RlZCByZXNvdXJjZXMgYW5kIHNlbmQgdGhlIG1hdGNoZWQgb25lXHJcbiAgICAgICAgaWYgKHRoaXMuY29uZmlnLmZyYW1ld29yay5wcm90ZWN0ZWRSZXNvdXJjZU1hcC5zaXplID4gMCkge1xyXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gQXJyYXkuZnJvbSh0aGlzLmNvbmZpZy5mcmFtZXdvcmsucHJvdGVjdGVkUmVzb3VyY2VNYXAua2V5cygpKTsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBrZXkgPSBfYVtfaV07XHJcbiAgICAgICAgICAgICAgICAvLyBjb25maWdFbmRwb2ludCBpcyBsaWtlIC9hcGkvVG9kbyByZXF1ZXN0ZWQgZW5kcG9pbnQgY2FuIGJlIC9hcGkvVG9kby8xXHJcbiAgICAgICAgICAgICAgICBpZiAoZW5kcG9pbnQuaW5kZXhPZihrZXkpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jb25maWcuZnJhbWV3b3JrLnByb3RlY3RlZFJlc291cmNlTWFwLmdldChrZXkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8qXHJcbiAgICAgICAgICogZGVmYXVsdCByZXNvdXJjZSB3aWxsIGJlIGNsaWVudGlkIGlmIG5vdGhpbmcgc3BlY2lmaWVkXHJcbiAgICAgICAgICogQXBwIHdpbGwgdXNlIGlkdG9rZW4gZm9yIGNhbGxzIHRvIGl0c2VsZlxyXG4gICAgICAgICAqIGNoZWNrIGlmIGl0J3Mgc3RhcmluZyBmcm9tIGh0dHAgb3IgaHR0cHMsIG5lZWRzIHRvIG1hdGNoIHdpdGggYXBwIGhvc3RcclxuICAgICAgICAgKi9cclxuICAgICAgICBpZiAoZW5kcG9pbnQuaW5kZXhPZihcImh0dHA6Ly9cIikgPiAtMSB8fCBlbmRwb2ludC5pbmRleE9mKFwiaHR0cHM6Ly9cIikgPiAtMSkge1xyXG4gICAgICAgICAgICBpZiAoVXJsVXRpbHMuZ2V0SG9zdEZyb21VcmkoZW5kcG9pbnQpID09PSBVcmxVdGlscy5nZXRIb3N0RnJvbVVyaSh0aGlzLmdldFJlZGlyZWN0VXJpKCkpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFycmF5KHRoaXMuY2xpZW50SWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvKlxyXG4gICAgICAgICAgICAgKiBpbiBhbmd1bGFyIGxldmVsLCB0aGUgdXJsIGZvciAkaHR0cCBpbnRlcmNlcHRvciBjYWxsIGNvdWxkIGJlIHJlbGF0aXZlIHVybCxcclxuICAgICAgICAgICAgICogaWYgaXQncyByZWxhdGl2ZSBjYWxsLCB3ZSdsbCB0cmVhdCBpdCBhcyBhcHAgYmFja2VuZCBjYWxsLlxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBBcnJheSh0aGlzLmNsaWVudElkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gaWYgbm90IHRoZSBhcHAncyBvd24gYmFja2VuZCBvciBub3QgYSBkb21haW4gbGlzdGVkIGluIHRoZSBlbmRwb2ludHMgc3RydWN0dXJlXHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm4gYm9vbGVhbiBmbGFnIHRvIGRldmVsb3BlciB0byBoZWxwIGluZm9ybSBpZiBsb2dpbiBpcyBpbiBwcm9ncmVzc1xyXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IHRydWUvZmFsc2VcclxuICAgICAqL1xyXG4gICAgVXNlckFnZW50QXBwbGljYXRpb24ucHJvdG90eXBlLmdldExvZ2luSW5Qcm9ncmVzcyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jYWNoZVN0b3JhZ2UuZ2V0SXRlbShUZW1wb3JhcnlDYWNoZUtleXMuSU5URVJBQ1RJT05fU1RBVFVTKSA9PT0gQ29uc3RhbnRzLmluUHJvZ3Jlc3M7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaGlkZGVuXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGxvZ2luSW5Qcm9ncmVzc1xyXG4gICAgICovXHJcbiAgICBVc2VyQWdlbnRBcHBsaWNhdGlvbi5wcm90b3R5cGUuc2V0SW50ZXJhY3Rpb25JblByb2dyZXNzID0gZnVuY3Rpb24gKGluUHJvZ3Jlc3MpIHtcclxuICAgICAgICBpZiAoaW5Qcm9ncmVzcykge1xyXG4gICAgICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZS5zZXRJdGVtKFRlbXBvcmFyeUNhY2hlS2V5cy5JTlRFUkFDVElPTl9TVEFUVVMsIENvbnN0YW50cy5pblByb2dyZXNzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FjaGVTdG9yYWdlLnJlbW92ZUl0ZW0oVGVtcG9yYXJ5Q2FjaGVLZXlzLklOVEVSQUNUSU9OX1NUQVRVUyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQGhpZGRlblxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBsb2dpbkluUHJvZ3Jlc3NcclxuICAgICAqL1xyXG4gICAgVXNlckFnZW50QXBwbGljYXRpb24ucHJvdG90eXBlLnNldGxvZ2luSW5Qcm9ncmVzcyA9IGZ1bmN0aW9uIChsb2dpbkluUHJvZ3Jlc3MpIHtcclxuICAgICAgICB0aGlzLnNldEludGVyYWN0aW9uSW5Qcm9ncmVzcyhsb2dpbkluUHJvZ3Jlc3MpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQGhpZGRlblxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICpcclxuICAgICAqIHJldHVybnMgdGhlIHN0YXR1cyBvZiBhY3F1aXJlVG9rZW5JblByb2dyZXNzXHJcbiAgICAgKi9cclxuICAgIFVzZXJBZ2VudEFwcGxpY2F0aW9uLnByb3RvdHlwZS5nZXRBY3F1aXJlVG9rZW5JblByb2dyZXNzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNhY2hlU3RvcmFnZS5nZXRJdGVtKFRlbXBvcmFyeUNhY2hlS2V5cy5JTlRFUkFDVElPTl9TVEFUVVMpID09PSBDb25zdGFudHMuaW5Qcm9ncmVzcztcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEBoaWRkZW5cclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gYWNxdWlyZVRva2VuSW5Qcm9ncmVzc1xyXG4gICAgICovXHJcbiAgICBVc2VyQWdlbnRBcHBsaWNhdGlvbi5wcm90b3R5cGUuc2V0QWNxdWlyZVRva2VuSW5Qcm9ncmVzcyA9IGZ1bmN0aW9uIChhY3F1aXJlVG9rZW5JblByb2dyZXNzKSB7XHJcbiAgICAgICAgdGhpcy5zZXRJbnRlcmFjdGlvbkluUHJvZ3Jlc3MoYWNxdWlyZVRva2VuSW5Qcm9ncmVzcyk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaGlkZGVuXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKlxyXG4gICAgICogcmV0dXJucyB0aGUgbG9nZ2VyIGhhbmRsZVxyXG4gICAgICovXHJcbiAgICBVc2VyQWdlbnRBcHBsaWNhdGlvbi5wcm90b3R5cGUuZ2V0TG9nZ2VyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmxvZ2dlcjtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFNldHMgdGhlIGxvZ2dlciBjYWxsYmFjay5cclxuICAgICAqIEBwYXJhbSBsb2dnZXIgTG9nZ2VyIGNhbGxiYWNrXHJcbiAgICAgKi9cclxuICAgIFVzZXJBZ2VudEFwcGxpY2F0aW9uLnByb3RvdHlwZS5zZXRMb2dnZXIgPSBmdW5jdGlvbiAobG9nZ2VyKSB7XHJcbiAgICAgICAgdGhpcy5sb2dnZXIgPSBsb2dnZXI7XHJcbiAgICB9O1xyXG4gICAgLy8gI2VuZHJlZ2lvblxyXG4gICAgLy8gI3JlZ2lvbiBHZXR0ZXJzIGFuZCBTZXR0ZXJzXHJcbiAgICAvKipcclxuICAgICAqIFVzZSB0byBnZXQgdGhlIHJlZGlyZWN0IHVyaSBjb25maWd1cmVkIGluIE1TQUwgb3IgbnVsbC5cclxuICAgICAqIEV2YWx1YXRlcyByZWRpcmVjdFVyaSBpZiBpdHMgYSBmdW5jdGlvbiwgb3RoZXJ3aXNlIHNpbXBseSByZXR1cm5zIGl0cyB2YWx1ZS5cclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSByZWRpcmVjdCBVUkxcclxuICAgICAqL1xyXG4gICAgVXNlckFnZW50QXBwbGljYXRpb24ucHJvdG90eXBlLmdldFJlZGlyZWN0VXJpID0gZnVuY3Rpb24gKHJlcVJlZGlyZWN0VXJpKSB7XHJcbiAgICAgICAgaWYgKHJlcVJlZGlyZWN0VXJpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXFSZWRpcmVjdFVyaTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIHRoaXMuY29uZmlnLmF1dGgucmVkaXJlY3RVcmkgPT09IFwiZnVuY3Rpb25cIikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb25maWcuYXV0aC5yZWRpcmVjdFVyaSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5jb25maWcuYXV0aC5yZWRpcmVjdFVyaTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFVzZSB0byBnZXQgdGhlIHBvc3QgbG9nb3V0IHJlZGlyZWN0IHVyaSBjb25maWd1cmVkIGluIE1TQUwgb3IgbnVsbC5cclxuICAgICAqIEV2YWx1YXRlcyBwb3N0TG9nb3V0cmVkaXJlY3RVcmkgaWYgaXRzIGEgZnVuY3Rpb24sIG90aGVyd2lzZSBzaW1wbHkgcmV0dXJucyBpdHMgdmFsdWUuXHJcbiAgICAgKlxyXG4gICAgICogQHJldHVybnMge3N0cmluZ30gcG9zdCBsb2dvdXQgcmVkaXJlY3QgVVJMXHJcbiAgICAgKi9cclxuICAgIFVzZXJBZ2VudEFwcGxpY2F0aW9uLnByb3RvdHlwZS5nZXRQb3N0TG9nb3V0UmVkaXJlY3RVcmkgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmNvbmZpZy5hdXRoLnBvc3RMb2dvdXRSZWRpcmVjdFVyaSA9PT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbmZpZy5hdXRoLnBvc3RMb2dvdXRSZWRpcmVjdFVyaSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5jb25maWcuYXV0aC5wb3N0TG9nb3V0UmVkaXJlY3RVcmk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBVc2UgdG8gZ2V0IHRoZSBjdXJyZW50IHtAbGluayBDb25maWd1cmF0aW9ufSBvYmplY3QgaW4gTVNBTFxyXG4gICAgICpcclxuICAgICAqIEByZXR1cm5zIHtAbGluayBDb25maWd1cmF0aW9ufVxyXG4gICAgICovXHJcbiAgICBVc2VyQWdlbnRBcHBsaWNhdGlvbi5wcm90b3R5cGUuZ2V0Q3VycmVudENvbmZpZ3VyYXRpb24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmNvbmZpZykge1xyXG4gICAgICAgICAgICB0aHJvdyBDbGllbnRDb25maWd1cmF0aW9uRXJyb3IuY3JlYXRlTm9TZXRDb25maWd1cmF0aW9uRXJyb3IoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29uZmlnO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICpcclxuICAgICAqIFV0aWxzIGZ1bmN0aW9uIHRvIGNyZWF0ZSB0aGUgQXV0aGVudGljYXRpb25cclxuICAgICAqIEBwYXJhbSB7QGxpbmsgYWNjb3VudH0gYWNjb3VudCBvYmplY3RcclxuICAgICAqIEBwYXJhbSBzY29wZXNcclxuICAgICAqXHJcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSB0b2tlbiB0eXBlOiB0b2tlbiwgaWRfdG9rZW4gb3IgaWRfdG9rZW4gdG9rZW5cclxuICAgICAqXHJcbiAgICAgKi9cclxuICAgIFVzZXJBZ2VudEFwcGxpY2F0aW9uLnByb3RvdHlwZS5nZXRUb2tlblR5cGUgPSBmdW5jdGlvbiAoYWNjb3VudE9iamVjdCwgc2NvcGVzKSB7XHJcbiAgICAgICAgdmFyIGFjY291bnRzTWF0Y2ggPSBBY2NvdW50LmNvbXBhcmVBY2NvdW50cyhhY2NvdW50T2JqZWN0LCB0aGlzLmdldEFjY291bnQoKSk7XHJcbiAgICAgICAgcmV0dXJuIFNlcnZlclJlcXVlc3RQYXJhbWV0ZXJzLmRldGVybWluZVJlc3BvbnNlVHlwZShhY2NvdW50c01hdGNoLCBzY29wZXMpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQGhpZGRlblxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICpcclxuICAgICAqIFNldHMgdGhlIGNhY2hla2V5cyBmb3IgYW5kIHN0b3JlcyB0aGUgYWNjb3VudCBpbmZvcm1hdGlvbiBpbiBjYWNoZVxyXG4gICAgICogQHBhcmFtIGFjY291bnRcclxuICAgICAqIEBwYXJhbSBzdGF0ZVxyXG4gICAgICogQGhpZGRlblxyXG4gICAgICovXHJcbiAgICBVc2VyQWdlbnRBcHBsaWNhdGlvbi5wcm90b3R5cGUuc2V0QWNjb3VudENhY2hlID0gZnVuY3Rpb24gKGFjY291bnQsIHN0YXRlKSB7XHJcbiAgICAgICAgLy8gQ2FjaGUgYWNxdWlyZVRva2VuQWNjb3VudEtleVxyXG4gICAgICAgIHZhciBhY2NvdW50SWQgPSBhY2NvdW50ID8gdGhpcy5nZXRBY2NvdW50SWQoYWNjb3VudCkgOiBDb25zdGFudHMubm9fYWNjb3VudDtcclxuICAgICAgICB2YXIgYWNxdWlyZVRva2VuQWNjb3VudEtleSA9IEF1dGhDYWNoZS5nZW5lcmF0ZUFjcXVpcmVUb2tlbkFjY291bnRLZXkoYWNjb3VudElkLCBzdGF0ZSk7XHJcbiAgICAgICAgdGhpcy5jYWNoZVN0b3JhZ2Uuc2V0SXRlbShhY3F1aXJlVG9rZW5BY2NvdW50S2V5LCBKU09OLnN0cmluZ2lmeShhY2NvdW50KSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaGlkZGVuXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKlxyXG4gICAgICogU2V0cyB0aGUgY2FjaGVLZXkgZm9yIGFuZCBzdG9yZXMgdGhlIGF1dGhvcml0eSBpbmZvcm1hdGlvbiBpbiBjYWNoZVxyXG4gICAgICogQHBhcmFtIHN0YXRlXHJcbiAgICAgKiBAcGFyYW0gYXV0aG9yaXR5XHJcbiAgICAgKiBAaGlkZGVuXHJcbiAgICAgKi9cclxuICAgIFVzZXJBZ2VudEFwcGxpY2F0aW9uLnByb3RvdHlwZS5zZXRBdXRob3JpdHlDYWNoZSA9IGZ1bmN0aW9uIChzdGF0ZSwgYXV0aG9yaXR5KSB7XHJcbiAgICAgICAgLy8gQ2FjaGUgYXV0aG9yaXR5S2V5XHJcbiAgICAgICAgdmFyIGF1dGhvcml0eUtleSA9IEF1dGhDYWNoZS5nZW5lcmF0ZUF1dGhvcml0eUtleShzdGF0ZSk7XHJcbiAgICAgICAgdGhpcy5jYWNoZVN0b3JhZ2Uuc2V0SXRlbShhdXRob3JpdHlLZXksIFVybFV0aWxzLkNhbm9uaWNhbGl6ZVVyaShhdXRob3JpdHkpLCB0aGlzLmluQ29va2llKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFVwZGF0ZXMgYWNjb3VudCwgYXV0aG9yaXR5LCBhbmQgbm9uY2UgaW4gY2FjaGVcclxuICAgICAqIEBwYXJhbSBzZXJ2ZXJBdXRoZW50aWNhdGlvblJlcXVlc3RcclxuICAgICAqIEBwYXJhbSBhY2NvdW50XHJcbiAgICAgKiBAaGlkZGVuXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKi9cclxuICAgIFVzZXJBZ2VudEFwcGxpY2F0aW9uLnByb3RvdHlwZS51cGRhdGVDYWNoZUVudHJpZXMgPSBmdW5jdGlvbiAoc2VydmVyQXV0aGVudGljYXRpb25SZXF1ZXN0LCBhY2NvdW50LCBpc0xvZ2luQ2FsbCwgbG9naW5TdGFydFBhZ2UpIHtcclxuICAgICAgICAvLyBDYWNoZSBSZXF1ZXN0IE9yaWdpbmF0b3IgUGFnZVxyXG4gICAgICAgIGlmIChsb2dpblN0YXJ0UGFnZSkge1xyXG4gICAgICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZS5zZXRJdGVtKEF1dGhDYWNoZS5nZW5lcmF0ZVRlbXBvcmFyeUNhY2hlS2V5KFRlbXBvcmFyeUNhY2hlS2V5cy5MT0dJTl9SRVFVRVNULCBzZXJ2ZXJBdXRoZW50aWNhdGlvblJlcXVlc3Quc3RhdGUpLCBsb2dpblN0YXJ0UGFnZSwgdGhpcy5pbkNvb2tpZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIENhY2hlIGFjY291bnQgYW5kIGF1dGhvcml0eVxyXG4gICAgICAgIGlmIChpc0xvZ2luQ2FsbCkge1xyXG4gICAgICAgICAgICAvLyBDYWNoZSB0aGUgc3RhdGVcclxuICAgICAgICAgICAgdGhpcy5jYWNoZVN0b3JhZ2Uuc2V0SXRlbShBdXRoQ2FjaGUuZ2VuZXJhdGVUZW1wb3JhcnlDYWNoZUtleShUZW1wb3JhcnlDYWNoZUtleXMuU1RBVEVfTE9HSU4sIHNlcnZlckF1dGhlbnRpY2F0aW9uUmVxdWVzdC5zdGF0ZSksIHNlcnZlckF1dGhlbnRpY2F0aW9uUmVxdWVzdC5zdGF0ZSwgdGhpcy5pbkNvb2tpZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnNldEFjY291bnRDYWNoZShhY2NvdW50LCBzZXJ2ZXJBdXRoZW50aWNhdGlvblJlcXVlc3Quc3RhdGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBDYWNoZSBhdXRob3JpdHlLZXlcclxuICAgICAgICB0aGlzLnNldEF1dGhvcml0eUNhY2hlKHNlcnZlckF1dGhlbnRpY2F0aW9uUmVxdWVzdC5zdGF0ZSwgc2VydmVyQXV0aGVudGljYXRpb25SZXF1ZXN0LmF1dGhvcml0eSk7XHJcbiAgICAgICAgLy8gQ2FjaGUgbm9uY2VcclxuICAgICAgICB0aGlzLmNhY2hlU3RvcmFnZS5zZXRJdGVtKEF1dGhDYWNoZS5nZW5lcmF0ZVRlbXBvcmFyeUNhY2hlS2V5KFRlbXBvcmFyeUNhY2hlS2V5cy5OT05DRV9JRFRPS0VOLCBzZXJ2ZXJBdXRoZW50aWNhdGlvblJlcXVlc3Quc3RhdGUpLCBzZXJ2ZXJBdXRoZW50aWNhdGlvblJlcXVlc3Qubm9uY2UsIHRoaXMuaW5Db29raWUpO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0aGUgdW5pcXVlIGlkZW50aWZpZXIgZm9yIHRoZSBsb2dnZWQgaW4gYWNjb3VudFxyXG4gICAgICogQHBhcmFtIGFjY291bnRcclxuICAgICAqIEBoaWRkZW5cclxuICAgICAqIEBpZ25vcmVcclxuICAgICAqL1xyXG4gICAgVXNlckFnZW50QXBwbGljYXRpb24ucHJvdG90eXBlLmdldEFjY291bnRJZCA9IGZ1bmN0aW9uIChhY2NvdW50KSB7XHJcbiAgICAgICAgLy8gcmV0dXJuIGAke2FjY291bnQuYWNjb3VudElkZW50aWZpZXJ9YCArIENvbnN0YW50cy5yZXNvdXJjZURlbGltaXRlciArIGAke2FjY291bnQuaG9tZUFjY291bnRJZGVudGlmaWVyfWA7XHJcbiAgICAgICAgdmFyIGFjY291bnRJZDtcclxuICAgICAgICBpZiAoIVN0cmluZ1V0aWxzLmlzRW1wdHkoYWNjb3VudC5ob21lQWNjb3VudElkZW50aWZpZXIpKSB7XHJcbiAgICAgICAgICAgIGFjY291bnRJZCA9IGFjY291bnQuaG9tZUFjY291bnRJZGVudGlmaWVyO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgYWNjb3VudElkID0gQ29uc3RhbnRzLm5vX2FjY291bnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBhY2NvdW50SWQ7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKiBAcGFyYW0gZXh0cmFRdWVyeVBhcmFtZXRlcnNcclxuICAgICAqXHJcbiAgICAgKiBDb25zdHJ1Y3QgJ3Rva2VuUmVxdWVzdCcgZnJvbSB0aGUgYXZhaWxhYmxlIGRhdGEgaW4gYWRhbElkVG9rZW5cclxuICAgICAqL1xyXG4gICAgVXNlckFnZW50QXBwbGljYXRpb24ucHJvdG90eXBlLmJ1aWxkSURUb2tlblJlcXVlc3QgPSBmdW5jdGlvbiAocmVxdWVzdCkge1xyXG4gICAgICAgIHZhciB0b2tlblJlcXVlc3QgPSB7XHJcbiAgICAgICAgICAgIHNjb3BlczogQ29uc3RhbnRzLm9pZGNTY29wZXMsXHJcbiAgICAgICAgICAgIGF1dGhvcml0eTogdGhpcy5hdXRob3JpdHksXHJcbiAgICAgICAgICAgIGFjY291bnQ6IHRoaXMuZ2V0QWNjb3VudCgpLFxyXG4gICAgICAgICAgICBleHRyYVF1ZXJ5UGFyYW1ldGVyczogcmVxdWVzdC5leHRyYVF1ZXJ5UGFyYW1ldGVycyxcclxuICAgICAgICAgICAgY29ycmVsYXRpb25JZDogcmVxdWVzdC5jb3JyZWxhdGlvbklkXHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gdG9rZW5SZXF1ZXN0O1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICogQHBhcmFtIGNvbmZpZ1xyXG4gICAgICogQHBhcmFtIGNsaWVudElkXHJcbiAgICAgKlxyXG4gICAgICogQ29uc3RydWN0IFRlbGVtZXRyeU1hbmFnZXIgZnJvbSBDb25maWd1cmF0aW9uXHJcbiAgICAgKi9cclxuICAgIFVzZXJBZ2VudEFwcGxpY2F0aW9uLnByb3RvdHlwZS5nZXRUZWxlbWV0cnlNYW5hZ2VyRnJvbUNvbmZpZyA9IGZ1bmN0aW9uIChjb25maWcsIGNsaWVudElkKSB7XHJcbiAgICAgICAgaWYgKCFjb25maWcpIHsgLy8gaWYgdW5zZXRcclxuICAgICAgICAgICAgcmV0dXJuIFRlbGVtZXRyeU1hbmFnZXIuZ2V0VGVsZW1ldHJ5bWFuYWdlclN0dWIoY2xpZW50SWQsIHRoaXMubG9nZ2VyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gaWYgc2V0IHRoZW4gdmFsaWRhdGVcclxuICAgICAgICB2YXIgYXBwbGljYXRpb25OYW1lID0gY29uZmlnLmFwcGxpY2F0aW9uTmFtZSwgYXBwbGljYXRpb25WZXJzaW9uID0gY29uZmlnLmFwcGxpY2F0aW9uVmVyc2lvbiwgdGVsZW1ldHJ5RW1pdHRlciA9IGNvbmZpZy50ZWxlbWV0cnlFbWl0dGVyO1xyXG4gICAgICAgIGlmICghYXBwbGljYXRpb25OYW1lIHx8ICFhcHBsaWNhdGlvblZlcnNpb24gfHwgIXRlbGVtZXRyeUVtaXR0ZXIpIHtcclxuICAgICAgICAgICAgdGhyb3cgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yLmNyZWF0ZVRlbGVtZXRyeUNvbmZpZ0Vycm9yKGNvbmZpZyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGlmIHZhbGlkIHRoZW4gY29uc3RydWN0XHJcbiAgICAgICAgdmFyIHRlbGVtZXRyeVBsYXRmb3JtID0ge1xyXG4gICAgICAgICAgICBhcHBsaWNhdGlvbk5hbWU6IGFwcGxpY2F0aW9uTmFtZSxcclxuICAgICAgICAgICAgYXBwbGljYXRpb25WZXJzaW9uOiBhcHBsaWNhdGlvblZlcnNpb25cclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciB0ZWxlbWV0cnlNYW5hZ2VyQ29uZmlnID0ge1xyXG4gICAgICAgICAgICBwbGF0Zm9ybTogdGVsZW1ldHJ5UGxhdGZvcm0sXHJcbiAgICAgICAgICAgIGNsaWVudElkOiBjbGllbnRJZFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIG5ldyBUZWxlbWV0cnlNYW5hZ2VyKHRlbGVtZXRyeU1hbmFnZXJDb25maWcsIHRlbGVtZXRyeUVtaXR0ZXIsIHRoaXMubG9nZ2VyKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gVXNlckFnZW50QXBwbGljYXRpb247XHJcbn0oKSk7XHJcbmV4cG9ydCB7IFVzZXJBZ2VudEFwcGxpY2F0aW9uIH07XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVVzZXJBZ2VudEFwcGxpY2F0aW9uLmpzLm1hcCJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///ZES5\n");

/***/ }),

/***/ "bro/":
/*!**********************************************************!*\
  !*** ./node_modules/msal/lib-es6/authority/Authority.js ***!
  \**********************************************************/
/*! exports provided: AuthorityType, Authority */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AuthorityType\", function() { return AuthorityType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Authority\", function() { return Authority; });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ \"mrSG\");\n/* harmony import */ var _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../error/ClientConfigurationError */ \"ZEID\");\n/* harmony import */ var _XHRClient__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../XHRClient */ \"5wbO\");\n/* harmony import */ var _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/UrlUtils */ \"JB7q\");\n/* harmony import */ var _TrustedAuthority__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./TrustedAuthority */ \"wwyH\");\n/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../utils/Constants */ \"wmgs\");\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * @hidden\r\n */\r\nvar AuthorityType;\r\n(function (AuthorityType) {\r\n    AuthorityType[AuthorityType[\"Default\"] = 0] = \"Default\";\r\n    AuthorityType[AuthorityType[\"Adfs\"] = 1] = \"Adfs\";\r\n})(AuthorityType || (AuthorityType = {}));\r\n/**\r\n * @hidden\r\n */\r\nvar Authority = /** @class */ (function () {\r\n    function Authority(authority, validateAuthority, authorityMetadata) {\r\n        this.IsValidationEnabled = validateAuthority;\r\n        this.CanonicalAuthority = authority;\r\n        this.validateAsUri();\r\n        this.tenantDiscoveryResponse = authorityMetadata;\r\n    }\r\n    Authority.isAdfs = function (authorityUrl) {\r\n        var components = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_3__[\"UrlUtils\"].GetUrlComponents(authorityUrl);\r\n        var pathSegments = components.PathSegments;\r\n        return (pathSegments.length && pathSegments[0].toLowerCase() === _utils_Constants__WEBPACK_IMPORTED_MODULE_5__[\"Constants\"].ADFS);\r\n    };\r\n    Object.defineProperty(Authority.prototype, \"AuthorityType\", {\r\n        get: function () {\r\n            return Authority.isAdfs(this.canonicalAuthority) ? AuthorityType.Adfs : AuthorityType.Default;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Authority.prototype, \"Tenant\", {\r\n        get: function () {\r\n            return this.CanonicalAuthorityUrlComponents.PathSegments[0];\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Authority.prototype, \"AuthorizationEndpoint\", {\r\n        get: function () {\r\n            this.validateResolved();\r\n            return this.tenantDiscoveryResponse.AuthorizationEndpoint.replace(/{tenant}|{tenantid}/g, this.Tenant);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Authority.prototype, \"EndSessionEndpoint\", {\r\n        get: function () {\r\n            this.validateResolved();\r\n            return this.tenantDiscoveryResponse.EndSessionEndpoint.replace(/{tenant}|{tenantid}/g, this.Tenant);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Authority.prototype, \"SelfSignedJwtAudience\", {\r\n        get: function () {\r\n            this.validateResolved();\r\n            return this.tenantDiscoveryResponse.Issuer.replace(/{tenant}|{tenantid}/g, this.Tenant);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Authority.prototype.validateResolved = function () {\r\n        if (!this.hasCachedMetadata()) {\r\n            throw \"Please call ResolveEndpointsAsync first\";\r\n        }\r\n    };\r\n    Object.defineProperty(Authority.prototype, \"CanonicalAuthority\", {\r\n        /**\r\n         * A URL that is the authority set by the developer\r\n         */\r\n        get: function () {\r\n            return this.canonicalAuthority;\r\n        },\r\n        set: function (url) {\r\n            this.canonicalAuthority = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_3__[\"UrlUtils\"].CanonicalizeUri(url);\r\n            this.canonicalAuthorityUrlComponents = null;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Authority.prototype, \"CanonicalAuthorityUrlComponents\", {\r\n        get: function () {\r\n            if (!this.canonicalAuthorityUrlComponents) {\r\n                this.canonicalAuthorityUrlComponents = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_3__[\"UrlUtils\"].GetUrlComponents(this.CanonicalAuthority);\r\n            }\r\n            return this.canonicalAuthorityUrlComponents;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Authority.prototype, \"DefaultOpenIdConfigurationEndpoint\", {\r\n        // http://openid.net/specs/openid-connect-discovery-1_0.html#ProviderMetadata\r\n        get: function () {\r\n            return (this.AuthorityType === AuthorityType.Adfs) ? \"\" + this.CanonicalAuthority + _utils_Constants__WEBPACK_IMPORTED_MODULE_5__[\"WELL_KNOWN_SUFFIX\"] : this.CanonicalAuthority + \"v2.0/\" + _utils_Constants__WEBPACK_IMPORTED_MODULE_5__[\"WELL_KNOWN_SUFFIX\"];\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Given a string, validate that it is of the form https://domain/path\r\n     */\r\n    Authority.prototype.validateAsUri = function () {\r\n        var components;\r\n        try {\r\n            components = this.CanonicalAuthorityUrlComponents;\r\n        }\r\n        catch (e) {\r\n            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_1__[\"ClientConfigurationErrorMessage\"].invalidAuthorityType;\r\n        }\r\n        if (!components.Protocol || components.Protocol.toLowerCase() !== \"https:\") {\r\n            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_1__[\"ClientConfigurationErrorMessage\"].authorityUriInsecure;\r\n        }\r\n        if (!components.PathSegments || components.PathSegments.length < 1) {\r\n            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_1__[\"ClientConfigurationErrorMessage\"].authorityUriInvalidPath;\r\n        }\r\n    };\r\n    /**\r\n     * Calls the OIDC endpoint and returns the response\r\n     */\r\n    Authority.prototype.DiscoverEndpoints = function (openIdConfigurationEndpoint, telemetryManager, correlationId) {\r\n        var client = new _XHRClient__WEBPACK_IMPORTED_MODULE_2__[\"XhrClient\"]();\r\n        var httpMethod = _utils_Constants__WEBPACK_IMPORTED_MODULE_5__[\"NetworkRequestType\"].GET;\r\n        var httpEvent = telemetryManager.createAndStartHttpEvent(correlationId, httpMethod, openIdConfigurationEndpoint, \"openIdConfigurationEndpoint\");\r\n        return client.sendRequestAsync(openIdConfigurationEndpoint, httpMethod, /* enableCaching: */ true)\r\n            .then(function (response) {\r\n            httpEvent.httpResponseStatus = response.statusCode;\r\n            telemetryManager.stopEvent(httpEvent);\r\n            return {\r\n                AuthorizationEndpoint: response.body.authorization_endpoint,\r\n                EndSessionEndpoint: response.body.end_session_endpoint,\r\n                Issuer: response.body.issuer\r\n            };\r\n        })\r\n            .catch(function (err) {\r\n            httpEvent.serverErrorCode = err;\r\n            telemetryManager.stopEvent(httpEvent);\r\n            throw err;\r\n        });\r\n    };\r\n    /**\r\n     * Returns a promise.\r\n     * Checks to see if the authority is in the cache\r\n     * Discover endpoints via openid-configuration\r\n     * If successful, caches the endpoint for later use in OIDC\r\n     */\r\n    Authority.prototype.resolveEndpointsAsync = function (telemetryManager, correlationId) {\r\n        return tslib__WEBPACK_IMPORTED_MODULE_0__[\"__awaiter\"](this, void 0, void 0, function () {\r\n            var host, openIdConfigurationEndpointResponse, _a;\r\n            return tslib__WEBPACK_IMPORTED_MODULE_0__[\"__generator\"](this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        if (!this.IsValidationEnabled) return [3 /*break*/, 3];\r\n                        host = this.canonicalAuthorityUrlComponents.HostNameAndPort;\r\n                        if (!(_TrustedAuthority__WEBPACK_IMPORTED_MODULE_4__[\"TrustedAuthority\"].getTrustedHostList().length === 0)) return [3 /*break*/, 2];\r\n                        return [4 /*yield*/, _TrustedAuthority__WEBPACK_IMPORTED_MODULE_4__[\"TrustedAuthority\"].setTrustedAuthoritiesFromNetwork(this.canonicalAuthority, telemetryManager, correlationId)];\r\n                    case 1:\r\n                        _b.sent();\r\n                        _b.label = 2;\r\n                    case 2:\r\n                        if (!_TrustedAuthority__WEBPACK_IMPORTED_MODULE_4__[\"TrustedAuthority\"].IsInTrustedHostList(host)) {\r\n                            throw _error_ClientConfigurationError__WEBPACK_IMPORTED_MODULE_1__[\"ClientConfigurationError\"].createUntrustedAuthorityError(host);\r\n                        }\r\n                        _b.label = 3;\r\n                    case 3:\r\n                        openIdConfigurationEndpointResponse = this.GetOpenIdConfigurationEndpoint();\r\n                        _a = this;\r\n                        return [4 /*yield*/, this.DiscoverEndpoints(openIdConfigurationEndpointResponse, telemetryManager, correlationId)];\r\n                    case 4:\r\n                        _a.tenantDiscoveryResponse = _b.sent();\r\n                        return [2 /*return*/, this.tenantDiscoveryResponse];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * Checks if there is a cached tenant discovery response with required fields.\r\n     */\r\n    Authority.prototype.hasCachedMetadata = function () {\r\n        return !!(this.tenantDiscoveryResponse &&\r\n            this.tenantDiscoveryResponse.AuthorizationEndpoint &&\r\n            this.tenantDiscoveryResponse.EndSessionEndpoint &&\r\n            this.tenantDiscoveryResponse.Issuer);\r\n    };\r\n    /**\r\n     * Returns a promise which resolves to the OIDC endpoint\r\n     * Only responds with the endpoint\r\n     */\r\n    Authority.prototype.GetOpenIdConfigurationEndpoint = function () {\r\n        return this.DefaultOpenIdConfigurationEndpoint;\r\n    };\r\n    return Authority;\r\n}());\r\n\r\n//# sourceMappingURL=Authority.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnJvLy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tc2FsL2xpYi1lczYvYXV0aG9yaXR5L0F1dGhvcml0eS5qcz82ZWJhIl0sInNvdXJjZXNDb250ZW50IjpbIi8qXHJcbiAqIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXHJcbiAqL1xyXG5pbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gXCJ0c2xpYlwiO1xyXG5pbXBvcnQgeyBDbGllbnRDb25maWd1cmF0aW9uRXJyb3JNZXNzYWdlLCBDbGllbnRDb25maWd1cmF0aW9uRXJyb3IgfSBmcm9tIFwiLi4vZXJyb3IvQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yXCI7XHJcbmltcG9ydCB7IFhockNsaWVudCB9IGZyb20gXCIuLi9YSFJDbGllbnRcIjtcclxuaW1wb3J0IHsgVXJsVXRpbHMgfSBmcm9tIFwiLi4vdXRpbHMvVXJsVXRpbHNcIjtcclxuaW1wb3J0IHsgVHJ1c3RlZEF1dGhvcml0eSB9IGZyb20gXCIuL1RydXN0ZWRBdXRob3JpdHlcIjtcclxuaW1wb3J0IHsgTmV0d29ya1JlcXVlc3RUeXBlLCBDb25zdGFudHMsIFdFTExfS05PV05fU1VGRklYIH0gZnJvbSBcIi4uL3V0aWxzL0NvbnN0YW50c1wiO1xyXG4vKipcclxuICogQGhpZGRlblxyXG4gKi9cclxuZXhwb3J0IHZhciBBdXRob3JpdHlUeXBlO1xyXG4oZnVuY3Rpb24gKEF1dGhvcml0eVR5cGUpIHtcclxuICAgIEF1dGhvcml0eVR5cGVbQXV0aG9yaXR5VHlwZVtcIkRlZmF1bHRcIl0gPSAwXSA9IFwiRGVmYXVsdFwiO1xyXG4gICAgQXV0aG9yaXR5VHlwZVtBdXRob3JpdHlUeXBlW1wiQWRmc1wiXSA9IDFdID0gXCJBZGZzXCI7XHJcbn0pKEF1dGhvcml0eVR5cGUgfHwgKEF1dGhvcml0eVR5cGUgPSB7fSkpO1xyXG4vKipcclxuICogQGhpZGRlblxyXG4gKi9cclxudmFyIEF1dGhvcml0eSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEF1dGhvcml0eShhdXRob3JpdHksIHZhbGlkYXRlQXV0aG9yaXR5LCBhdXRob3JpdHlNZXRhZGF0YSkge1xyXG4gICAgICAgIHRoaXMuSXNWYWxpZGF0aW9uRW5hYmxlZCA9IHZhbGlkYXRlQXV0aG9yaXR5O1xyXG4gICAgICAgIHRoaXMuQ2Fub25pY2FsQXV0aG9yaXR5ID0gYXV0aG9yaXR5O1xyXG4gICAgICAgIHRoaXMudmFsaWRhdGVBc1VyaSgpO1xyXG4gICAgICAgIHRoaXMudGVuYW50RGlzY292ZXJ5UmVzcG9uc2UgPSBhdXRob3JpdHlNZXRhZGF0YTtcclxuICAgIH1cclxuICAgIEF1dGhvcml0eS5pc0FkZnMgPSBmdW5jdGlvbiAoYXV0aG9yaXR5VXJsKSB7XHJcbiAgICAgICAgdmFyIGNvbXBvbmVudHMgPSBVcmxVdGlscy5HZXRVcmxDb21wb25lbnRzKGF1dGhvcml0eVVybCk7XHJcbiAgICAgICAgdmFyIHBhdGhTZWdtZW50cyA9IGNvbXBvbmVudHMuUGF0aFNlZ21lbnRzO1xyXG4gICAgICAgIHJldHVybiAocGF0aFNlZ21lbnRzLmxlbmd0aCAmJiBwYXRoU2VnbWVudHNbMF0udG9Mb3dlckNhc2UoKSA9PT0gQ29uc3RhbnRzLkFERlMpO1xyXG4gICAgfTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBdXRob3JpdHkucHJvdG90eXBlLCBcIkF1dGhvcml0eVR5cGVcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gQXV0aG9yaXR5LmlzQWRmcyh0aGlzLmNhbm9uaWNhbEF1dGhvcml0eSkgPyBBdXRob3JpdHlUeXBlLkFkZnMgOiBBdXRob3JpdHlUeXBlLkRlZmF1bHQ7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXV0aG9yaXR5LnByb3RvdHlwZSwgXCJUZW5hbnRcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5DYW5vbmljYWxBdXRob3JpdHlVcmxDb21wb25lbnRzLlBhdGhTZWdtZW50c1swXTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBdXRob3JpdHkucHJvdG90eXBlLCBcIkF1dGhvcml6YXRpb25FbmRwb2ludFwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMudmFsaWRhdGVSZXNvbHZlZCgpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy50ZW5hbnREaXNjb3ZlcnlSZXNwb25zZS5BdXRob3JpemF0aW9uRW5kcG9pbnQucmVwbGFjZSgve3RlbmFudH18e3RlbmFudGlkfS9nLCB0aGlzLlRlbmFudCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxyXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxyXG4gICAgfSk7XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXV0aG9yaXR5LnByb3RvdHlwZSwgXCJFbmRTZXNzaW9uRW5kcG9pbnRcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLnZhbGlkYXRlUmVzb2x2ZWQoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudGVuYW50RGlzY292ZXJ5UmVzcG9uc2UuRW5kU2Vzc2lvbkVuZHBvaW50LnJlcGxhY2UoL3t0ZW5hbnR9fHt0ZW5hbnRpZH0vZywgdGhpcy5UZW5hbnQpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEF1dGhvcml0eS5wcm90b3R5cGUsIFwiU2VsZlNpZ25lZEp3dEF1ZGllbmNlXCIsIHtcclxuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhpcy52YWxpZGF0ZVJlc29sdmVkKCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnRlbmFudERpc2NvdmVyeVJlc3BvbnNlLklzc3Vlci5yZXBsYWNlKC97dGVuYW50fXx7dGVuYW50aWR9L2csIHRoaXMuVGVuYW50KTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIEF1dGhvcml0eS5wcm90b3R5cGUudmFsaWRhdGVSZXNvbHZlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuaGFzQ2FjaGVkTWV0YWRhdGEoKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBcIlBsZWFzZSBjYWxsIFJlc29sdmVFbmRwb2ludHNBc3luYyBmaXJzdFwiO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQXV0aG9yaXR5LnByb3RvdHlwZSwgXCJDYW5vbmljYWxBdXRob3JpdHlcIiwge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEEgVVJMIHRoYXQgaXMgdGhlIGF1dGhvcml0eSBzZXQgYnkgdGhlIGRldmVsb3BlclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jYW5vbmljYWxBdXRob3JpdHk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh1cmwpIHtcclxuICAgICAgICAgICAgdGhpcy5jYW5vbmljYWxBdXRob3JpdHkgPSBVcmxVdGlscy5DYW5vbmljYWxpemVVcmkodXJsKTtcclxuICAgICAgICAgICAgdGhpcy5jYW5vbmljYWxBdXRob3JpdHlVcmxDb21wb25lbnRzID0gbnVsbDtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBdXRob3JpdHkucHJvdG90eXBlLCBcIkNhbm9uaWNhbEF1dGhvcml0eVVybENvbXBvbmVudHNcIiwge1xyXG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuY2Fub25pY2FsQXV0aG9yaXR5VXJsQ29tcG9uZW50cykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jYW5vbmljYWxBdXRob3JpdHlVcmxDb21wb25lbnRzID0gVXJsVXRpbHMuR2V0VXJsQ29tcG9uZW50cyh0aGlzLkNhbm9uaWNhbEF1dGhvcml0eSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2Fub25pY2FsQXV0aG9yaXR5VXJsQ29tcG9uZW50cztcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXHJcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXHJcbiAgICB9KTtcclxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBdXRob3JpdHkucHJvdG90eXBlLCBcIkRlZmF1bHRPcGVuSWRDb25maWd1cmF0aW9uRW5kcG9pbnRcIiwge1xyXG4gICAgICAgIC8vIGh0dHA6Ly9vcGVuaWQubmV0L3NwZWNzL29wZW5pZC1jb25uZWN0LWRpc2NvdmVyeS0xXzAuaHRtbCNQcm92aWRlck1ldGFkYXRhXHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAodGhpcy5BdXRob3JpdHlUeXBlID09PSBBdXRob3JpdHlUeXBlLkFkZnMpID8gXCJcIiArIHRoaXMuQ2Fub25pY2FsQXV0aG9yaXR5ICsgV0VMTF9LTk9XTl9TVUZGSVggOiB0aGlzLkNhbm9uaWNhbEF1dGhvcml0eSArIFwidjIuMC9cIiArIFdFTExfS05PV05fU1VGRklYO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiBHaXZlbiBhIHN0cmluZywgdmFsaWRhdGUgdGhhdCBpdCBpcyBvZiB0aGUgZm9ybSBodHRwczovL2RvbWFpbi9wYXRoXHJcbiAgICAgKi9cclxuICAgIEF1dGhvcml0eS5wcm90b3R5cGUudmFsaWRhdGVBc1VyaSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgY29tcG9uZW50cztcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb21wb25lbnRzID0gdGhpcy5DYW5vbmljYWxBdXRob3JpdHlVcmxDb21wb25lbnRzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICB0aHJvdyBDbGllbnRDb25maWd1cmF0aW9uRXJyb3JNZXNzYWdlLmludmFsaWRBdXRob3JpdHlUeXBlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWNvbXBvbmVudHMuUHJvdG9jb2wgfHwgY29tcG9uZW50cy5Qcm90b2NvbC50b0xvd2VyQ2FzZSgpICE9PSBcImh0dHBzOlwiKSB7XHJcbiAgICAgICAgICAgIHRocm93IENsaWVudENvbmZpZ3VyYXRpb25FcnJvck1lc3NhZ2UuYXV0aG9yaXR5VXJpSW5zZWN1cmU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghY29tcG9uZW50cy5QYXRoU2VnbWVudHMgfHwgY29tcG9uZW50cy5QYXRoU2VnbWVudHMubGVuZ3RoIDwgMSkge1xyXG4gICAgICAgICAgICB0aHJvdyBDbGllbnRDb25maWd1cmF0aW9uRXJyb3JNZXNzYWdlLmF1dGhvcml0eVVyaUludmFsaWRQYXRoO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENhbGxzIHRoZSBPSURDIGVuZHBvaW50IGFuZCByZXR1cm5zIHRoZSByZXNwb25zZVxyXG4gICAgICovXHJcbiAgICBBdXRob3JpdHkucHJvdG90eXBlLkRpc2NvdmVyRW5kcG9pbnRzID0gZnVuY3Rpb24gKG9wZW5JZENvbmZpZ3VyYXRpb25FbmRwb2ludCwgdGVsZW1ldHJ5TWFuYWdlciwgY29ycmVsYXRpb25JZCkge1xyXG4gICAgICAgIHZhciBjbGllbnQgPSBuZXcgWGhyQ2xpZW50KCk7XHJcbiAgICAgICAgdmFyIGh0dHBNZXRob2QgPSBOZXR3b3JrUmVxdWVzdFR5cGUuR0VUO1xyXG4gICAgICAgIHZhciBodHRwRXZlbnQgPSB0ZWxlbWV0cnlNYW5hZ2VyLmNyZWF0ZUFuZFN0YXJ0SHR0cEV2ZW50KGNvcnJlbGF0aW9uSWQsIGh0dHBNZXRob2QsIG9wZW5JZENvbmZpZ3VyYXRpb25FbmRwb2ludCwgXCJvcGVuSWRDb25maWd1cmF0aW9uRW5kcG9pbnRcIik7XHJcbiAgICAgICAgcmV0dXJuIGNsaWVudC5zZW5kUmVxdWVzdEFzeW5jKG9wZW5JZENvbmZpZ3VyYXRpb25FbmRwb2ludCwgaHR0cE1ldGhvZCwgLyogZW5hYmxlQ2FjaGluZzogKi8gdHJ1ZSlcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgIGh0dHBFdmVudC5odHRwUmVzcG9uc2VTdGF0dXMgPSByZXNwb25zZS5zdGF0dXNDb2RlO1xyXG4gICAgICAgICAgICB0ZWxlbWV0cnlNYW5hZ2VyLnN0b3BFdmVudChodHRwRXZlbnQpO1xyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbkVuZHBvaW50OiByZXNwb25zZS5ib2R5LmF1dGhvcml6YXRpb25fZW5kcG9pbnQsXHJcbiAgICAgICAgICAgICAgICBFbmRTZXNzaW9uRW5kcG9pbnQ6IHJlc3BvbnNlLmJvZHkuZW5kX3Nlc3Npb25fZW5kcG9pbnQsXHJcbiAgICAgICAgICAgICAgICBJc3N1ZXI6IHJlc3BvbnNlLmJvZHkuaXNzdWVyXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgaHR0cEV2ZW50LnNlcnZlckVycm9yQ29kZSA9IGVycjtcclxuICAgICAgICAgICAgdGVsZW1ldHJ5TWFuYWdlci5zdG9wRXZlbnQoaHR0cEV2ZW50KTtcclxuICAgICAgICAgICAgdGhyb3cgZXJyO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyBhIHByb21pc2UuXHJcbiAgICAgKiBDaGVja3MgdG8gc2VlIGlmIHRoZSBhdXRob3JpdHkgaXMgaW4gdGhlIGNhY2hlXHJcbiAgICAgKiBEaXNjb3ZlciBlbmRwb2ludHMgdmlhIG9wZW5pZC1jb25maWd1cmF0aW9uXHJcbiAgICAgKiBJZiBzdWNjZXNzZnVsLCBjYWNoZXMgdGhlIGVuZHBvaW50IGZvciBsYXRlciB1c2UgaW4gT0lEQ1xyXG4gICAgICovXHJcbiAgICBBdXRob3JpdHkucHJvdG90eXBlLnJlc29sdmVFbmRwb2ludHNBc3luYyA9IGZ1bmN0aW9uICh0ZWxlbWV0cnlNYW5hZ2VyLCBjb3JyZWxhdGlvbklkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBob3N0LCBvcGVuSWRDb25maWd1cmF0aW9uRW5kcG9pbnRSZXNwb25zZSwgX2E7XHJcbiAgICAgICAgICAgIHJldHVybiB0c2xpYl8xLl9fZ2VuZXJhdG9yKHRoaXMsIGZ1bmN0aW9uIChfYikge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChfYi5sYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLklzVmFsaWRhdGlvbkVuYWJsZWQpIHJldHVybiBbMyAvKmJyZWFrKi8sIDNdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBob3N0ID0gdGhpcy5jYW5vbmljYWxBdXRob3JpdHlVcmxDb21wb25lbnRzLkhvc3ROYW1lQW5kUG9ydDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoVHJ1c3RlZEF1dGhvcml0eS5nZXRUcnVzdGVkSG9zdExpc3QoKS5sZW5ndGggPT09IDApKSByZXR1cm4gWzMgLypicmVhayovLCAyXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0IC8qeWllbGQqLywgVHJ1c3RlZEF1dGhvcml0eS5zZXRUcnVzdGVkQXV0aG9yaXRpZXNGcm9tTmV0d29yayh0aGlzLmNhbm9uaWNhbEF1dGhvcml0eSwgdGVsZW1ldHJ5TWFuYWdlciwgY29ycmVsYXRpb25JZCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2Iuc2VudCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYi5sYWJlbCA9IDI7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIVRydXN0ZWRBdXRob3JpdHkuSXNJblRydXN0ZWRIb3N0TGlzdChob3N0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgQ2xpZW50Q29uZmlndXJhdGlvbkVycm9yLmNyZWF0ZVVudHJ1c3RlZEF1dGhvcml0eUVycm9yKGhvc3QpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF9iLmxhYmVsID0gMztcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wZW5JZENvbmZpZ3VyYXRpb25FbmRwb2ludFJlc3BvbnNlID0gdGhpcy5HZXRPcGVuSWRDb25maWd1cmF0aW9uRW5kcG9pbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgX2EgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzQgLyp5aWVsZCovLCB0aGlzLkRpc2NvdmVyRW5kcG9pbnRzKG9wZW5JZENvbmZpZ3VyYXRpb25FbmRwb2ludFJlc3BvbnNlLCB0ZWxlbWV0cnlNYW5hZ2VyLCBjb3JyZWxhdGlvbklkKV07XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBfYS50ZW5hbnREaXNjb3ZlcnlSZXNwb25zZSA9IF9iLnNlbnQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIHRoaXMudGVuYW50RGlzY292ZXJ5UmVzcG9uc2VdO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENoZWNrcyBpZiB0aGVyZSBpcyBhIGNhY2hlZCB0ZW5hbnQgZGlzY292ZXJ5IHJlc3BvbnNlIHdpdGggcmVxdWlyZWQgZmllbGRzLlxyXG4gICAgICovXHJcbiAgICBBdXRob3JpdHkucHJvdG90eXBlLmhhc0NhY2hlZE1ldGFkYXRhID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiAhISh0aGlzLnRlbmFudERpc2NvdmVyeVJlc3BvbnNlICYmXHJcbiAgICAgICAgICAgIHRoaXMudGVuYW50RGlzY292ZXJ5UmVzcG9uc2UuQXV0aG9yaXphdGlvbkVuZHBvaW50ICYmXHJcbiAgICAgICAgICAgIHRoaXMudGVuYW50RGlzY292ZXJ5UmVzcG9uc2UuRW5kU2Vzc2lvbkVuZHBvaW50ICYmXHJcbiAgICAgICAgICAgIHRoaXMudGVuYW50RGlzY292ZXJ5UmVzcG9uc2UuSXNzdWVyKTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgYSBwcm9taXNlIHdoaWNoIHJlc29sdmVzIHRvIHRoZSBPSURDIGVuZHBvaW50XHJcbiAgICAgKiBPbmx5IHJlc3BvbmRzIHdpdGggdGhlIGVuZHBvaW50XHJcbiAgICAgKi9cclxuICAgIEF1dGhvcml0eS5wcm90b3R5cGUuR2V0T3BlbklkQ29uZmlndXJhdGlvbkVuZHBvaW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLkRlZmF1bHRPcGVuSWRDb25maWd1cmF0aW9uRW5kcG9pbnQ7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEF1dGhvcml0eTtcclxufSgpKTtcclxuZXhwb3J0IHsgQXV0aG9yaXR5IH07XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUF1dGhvcml0eS5qcy5tYXAiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///bro/\n");

/***/ }),

/***/ "iV3A":
/*!*****************************************************************!*\
  !*** ./node_modules/msal/lib-es6/cache/AccessTokenCacheItem.js ***!
  \*****************************************************************/
/*! exports provided: AccessTokenCacheItem */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AccessTokenCacheItem\", function() { return AccessTokenCacheItem; });\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n/**\r\n * @hidden\r\n */\r\nvar AccessTokenCacheItem = /** @class */ (function () {\r\n    function AccessTokenCacheItem(key, value) {\r\n        this.key = key;\r\n        this.value = value;\r\n    }\r\n    return AccessTokenCacheItem;\r\n}());\r\n\r\n//# sourceMappingURL=AccessTokenCacheItem.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaVYzQS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tc2FsL2xpYi1lczYvY2FjaGUvQWNjZXNzVG9rZW5DYWNoZUl0ZW0uanM/ODk1ZCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEBoaWRkZW5cclxuICovXHJcbnZhciBBY2Nlc3NUb2tlbkNhY2hlSXRlbSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIEFjY2Vzc1Rva2VuQ2FjaGVJdGVtKGtleSwgdmFsdWUpIHtcclxuICAgICAgICB0aGlzLmtleSA9IGtleTtcclxuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gQWNjZXNzVG9rZW5DYWNoZUl0ZW07XHJcbn0oKSk7XHJcbmV4cG9ydCB7IEFjY2Vzc1Rva2VuQ2FjaGVJdGVtIH07XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPUFjY2Vzc1Rva2VuQ2FjaGVJdGVtLmpzLm1hcCJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///iV3A\n");

/***/ }),

/***/ "wwyH":
/*!*****************************************************************!*\
  !*** ./node_modules/msal/lib-es6/authority/TrustedAuthority.js ***!
  \*****************************************************************/
/*! exports provided: TrustedAuthority */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TrustedAuthority\", function() { return TrustedAuthority; });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ \"mrSG\");\n/* harmony import */ var _XHRClient__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../XHRClient */ \"5wbO\");\n/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils/Constants */ \"wmgs\");\n/* harmony import */ var _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils/UrlUtils */ \"JB7q\");\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\n\r\n\r\n\r\nvar TrustedAuthority = /** @class */ (function () {\r\n    function TrustedAuthority() {\r\n    }\r\n    /**\r\n     *\r\n     * @param validateAuthority\r\n     * @param knownAuthorities\r\n     */\r\n    TrustedAuthority.setTrustedAuthoritiesFromConfig = function (validateAuthority, knownAuthorities) {\r\n        if (validateAuthority && !this.getTrustedHostList().length) {\r\n            knownAuthorities.forEach(function (authority) {\r\n                TrustedAuthority.TrustedHostList.push(authority.toLowerCase());\r\n            });\r\n        }\r\n    };\r\n    /**\r\n     *\r\n     * @param telemetryManager\r\n     * @param correlationId\r\n     */\r\n    TrustedAuthority.getAliases = function (authorityToVerify, telemetryManager, correlationId) {\r\n        return tslib__WEBPACK_IMPORTED_MODULE_0__[\"__awaiter\"](this, void 0, void 0, function () {\r\n            var client, httpMethod, instanceDiscoveryEndpoint, httpEvent;\r\n            return tslib__WEBPACK_IMPORTED_MODULE_0__[\"__generator\"](this, function (_a) {\r\n                client = new _XHRClient__WEBPACK_IMPORTED_MODULE_1__[\"XhrClient\"]();\r\n                httpMethod = _utils_Constants__WEBPACK_IMPORTED_MODULE_2__[\"NetworkRequestType\"].GET;\r\n                instanceDiscoveryEndpoint = \"\" + _utils_Constants__WEBPACK_IMPORTED_MODULE_2__[\"AAD_INSTANCE_DISCOVERY_ENDPOINT\"] + authorityToVerify + \"oauth2/v2.0/authorize\";\r\n                httpEvent = telemetryManager.createAndStartHttpEvent(correlationId, httpMethod, instanceDiscoveryEndpoint, \"getAliases\");\r\n                return [2 /*return*/, client.sendRequestAsync(instanceDiscoveryEndpoint, httpMethod, true)\r\n                        .then(function (response) {\r\n                        httpEvent.httpResponseStatus = response.statusCode;\r\n                        telemetryManager.stopEvent(httpEvent);\r\n                        return response.body.metadata;\r\n                    })\r\n                        .catch(function (err) {\r\n                        httpEvent.serverErrorCode = err;\r\n                        telemetryManager.stopEvent(httpEvent);\r\n                        throw err;\r\n                    })];\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     *\r\n     * @param telemetryManager\r\n     * @param correlationId\r\n     */\r\n    TrustedAuthority.setTrustedAuthoritiesFromNetwork = function (authorityToVerify, telemetryManager, correlationId) {\r\n        return tslib__WEBPACK_IMPORTED_MODULE_0__[\"__awaiter\"](this, void 0, void 0, function () {\r\n            var metadata, host;\r\n            return tslib__WEBPACK_IMPORTED_MODULE_0__[\"__generator\"](this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0: return [4 /*yield*/, this.getAliases(authorityToVerify, telemetryManager, correlationId)];\r\n                    case 1:\r\n                        metadata = _a.sent();\r\n                        metadata.forEach(function (entry) {\r\n                            var authorities = entry.aliases;\r\n                            authorities.forEach(function (authority) {\r\n                                TrustedAuthority.TrustedHostList.push(authority.toLowerCase());\r\n                            });\r\n                        });\r\n                        host = _utils_UrlUtils__WEBPACK_IMPORTED_MODULE_3__[\"UrlUtils\"].GetUrlComponents(authorityToVerify).HostNameAndPort;\r\n                        if (TrustedAuthority.getTrustedHostList().length && !TrustedAuthority.IsInTrustedHostList(host)) {\r\n                            // Custom Domain scenario, host is trusted because Instance Discovery call succeeded\r\n                            TrustedAuthority.TrustedHostList.push(host.toLowerCase());\r\n                        }\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    TrustedAuthority.getTrustedHostList = function () {\r\n        return this.TrustedHostList;\r\n    };\r\n    /**\r\n     * Checks to see if the host is in a list of trusted hosts\r\n     * @param host\r\n     */\r\n    TrustedAuthority.IsInTrustedHostList = function (host) {\r\n        return this.TrustedHostList.indexOf(host.toLowerCase()) > -1;\r\n    };\r\n    TrustedAuthority.TrustedHostList = [];\r\n    return TrustedAuthority;\r\n}());\r\n\r\n//# sourceMappingURL=TrustedAuthority.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid3d5SC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tc2FsL2xpYi1lczYvYXV0aG9yaXR5L1RydXN0ZWRBdXRob3JpdHkuanM/YzMwYyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKi9cclxuaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tIFwidHNsaWJcIjtcclxuaW1wb3J0IHsgWGhyQ2xpZW50IH0gZnJvbSBcIi4uL1hIUkNsaWVudFwiO1xyXG5pbXBvcnQgeyBBQURfSU5TVEFOQ0VfRElTQ09WRVJZX0VORFBPSU5ULCBOZXR3b3JrUmVxdWVzdFR5cGUgfSBmcm9tIFwiLi4vdXRpbHMvQ29uc3RhbnRzXCI7XHJcbmltcG9ydCB7IFVybFV0aWxzIH0gZnJvbSBcIi4uL3V0aWxzL1VybFV0aWxzXCI7XHJcbnZhciBUcnVzdGVkQXV0aG9yaXR5ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xyXG4gICAgZnVuY3Rpb24gVHJ1c3RlZEF1dGhvcml0eSgpIHtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSB2YWxpZGF0ZUF1dGhvcml0eVxyXG4gICAgICogQHBhcmFtIGtub3duQXV0aG9yaXRpZXNcclxuICAgICAqL1xyXG4gICAgVHJ1c3RlZEF1dGhvcml0eS5zZXRUcnVzdGVkQXV0aG9yaXRpZXNGcm9tQ29uZmlnID0gZnVuY3Rpb24gKHZhbGlkYXRlQXV0aG9yaXR5LCBrbm93bkF1dGhvcml0aWVzKSB7XHJcbiAgICAgICAgaWYgKHZhbGlkYXRlQXV0aG9yaXR5ICYmICF0aGlzLmdldFRydXN0ZWRIb3N0TGlzdCgpLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBrbm93bkF1dGhvcml0aWVzLmZvckVhY2goZnVuY3Rpb24gKGF1dGhvcml0eSkge1xyXG4gICAgICAgICAgICAgICAgVHJ1c3RlZEF1dGhvcml0eS5UcnVzdGVkSG9zdExpc3QucHVzaChhdXRob3JpdHkudG9Mb3dlckNhc2UoKSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gdGVsZW1ldHJ5TWFuYWdlclxyXG4gICAgICogQHBhcmFtIGNvcnJlbGF0aW9uSWRcclxuICAgICAqL1xyXG4gICAgVHJ1c3RlZEF1dGhvcml0eS5nZXRBbGlhc2VzID0gZnVuY3Rpb24gKGF1dGhvcml0eVRvVmVyaWZ5LCB0ZWxlbWV0cnlNYW5hZ2VyLCBjb3JyZWxhdGlvbklkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRzbGliXzEuX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZhciBjbGllbnQsIGh0dHBNZXRob2QsIGluc3RhbmNlRGlzY292ZXJ5RW5kcG9pbnQsIGh0dHBFdmVudDtcclxuICAgICAgICAgICAgcmV0dXJuIHRzbGliXzEuX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7XHJcbiAgICAgICAgICAgICAgICBjbGllbnQgPSBuZXcgWGhyQ2xpZW50KCk7XHJcbiAgICAgICAgICAgICAgICBodHRwTWV0aG9kID0gTmV0d29ya1JlcXVlc3RUeXBlLkdFVDtcclxuICAgICAgICAgICAgICAgIGluc3RhbmNlRGlzY292ZXJ5RW5kcG9pbnQgPSBcIlwiICsgQUFEX0lOU1RBTkNFX0RJU0NPVkVSWV9FTkRQT0lOVCArIGF1dGhvcml0eVRvVmVyaWZ5ICsgXCJvYXV0aDIvdjIuMC9hdXRob3JpemVcIjtcclxuICAgICAgICAgICAgICAgIGh0dHBFdmVudCA9IHRlbGVtZXRyeU1hbmFnZXIuY3JlYXRlQW5kU3RhcnRIdHRwRXZlbnQoY29ycmVsYXRpb25JZCwgaHR0cE1ldGhvZCwgaW5zdGFuY2VEaXNjb3ZlcnlFbmRwb2ludCwgXCJnZXRBbGlhc2VzXCIpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFsyIC8qcmV0dXJuKi8sIGNsaWVudC5zZW5kUmVxdWVzdEFzeW5jKGluc3RhbmNlRGlzY292ZXJ5RW5kcG9pbnQsIGh0dHBNZXRob2QsIHRydWUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBodHRwRXZlbnQuaHR0cFJlc3BvbnNlU3RhdHVzID0gcmVzcG9uc2Uuc3RhdHVzQ29kZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGVsZW1ldHJ5TWFuYWdlci5zdG9wRXZlbnQoaHR0cEV2ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmJvZHkubWV0YWRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaHR0cEV2ZW50LnNlcnZlckVycm9yQ29kZSA9IGVycjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGVsZW1ldHJ5TWFuYWdlci5zdG9wRXZlbnQoaHR0cEV2ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHRlbGVtZXRyeU1hbmFnZXJcclxuICAgICAqIEBwYXJhbSBjb3JyZWxhdGlvbklkXHJcbiAgICAgKi9cclxuICAgIFRydXN0ZWRBdXRob3JpdHkuc2V0VHJ1c3RlZEF1dGhvcml0aWVzRnJvbU5ldHdvcmsgPSBmdW5jdGlvbiAoYXV0aG9yaXR5VG9WZXJpZnksIHRlbGVtZXRyeU1hbmFnZXIsIGNvcnJlbGF0aW9uSWQpIHtcclxuICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmFyIG1ldGFkYXRhLCBob3N0O1xyXG4gICAgICAgICAgICByZXR1cm4gdHNsaWJfMS5fX2dlbmVyYXRvcih0aGlzLCBmdW5jdGlvbiAoX2EpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IHJldHVybiBbNCAvKnlpZWxkKi8sIHRoaXMuZ2V0QWxpYXNlcyhhdXRob3JpdHlUb1ZlcmlmeSwgdGVsZW1ldHJ5TWFuYWdlciwgY29ycmVsYXRpb25JZCldO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWV0YWRhdGEgPSBfYS5zZW50KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGFkYXRhLmZvckVhY2goZnVuY3Rpb24gKGVudHJ5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXV0aG9yaXRpZXMgPSBlbnRyeS5hbGlhc2VzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0aG9yaXRpZXMuZm9yRWFjaChmdW5jdGlvbiAoYXV0aG9yaXR5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVHJ1c3RlZEF1dGhvcml0eS5UcnVzdGVkSG9zdExpc3QucHVzaChhdXRob3JpdHkudG9Mb3dlckNhc2UoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhvc3QgPSBVcmxVdGlscy5HZXRVcmxDb21wb25lbnRzKGF1dGhvcml0eVRvVmVyaWZ5KS5Ib3N0TmFtZUFuZFBvcnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChUcnVzdGVkQXV0aG9yaXR5LmdldFRydXN0ZWRIb3N0TGlzdCgpLmxlbmd0aCAmJiAhVHJ1c3RlZEF1dGhvcml0eS5Jc0luVHJ1c3RlZEhvc3RMaXN0KGhvc3QpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDdXN0b20gRG9tYWluIHNjZW5hcmlvLCBob3N0IGlzIHRydXN0ZWQgYmVjYXVzZSBJbnN0YW5jZSBEaXNjb3ZlcnkgY2FsbCBzdWNjZWVkZWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRydXN0ZWRBdXRob3JpdHkuVHJ1c3RlZEhvc3RMaXN0LnB1c2goaG9zdC50b0xvd2VyQ2FzZSgpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gWzIgLypyZXR1cm4qL107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuICAgIFRydXN0ZWRBdXRob3JpdHkuZ2V0VHJ1c3RlZEhvc3RMaXN0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLlRydXN0ZWRIb3N0TGlzdDtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIENoZWNrcyB0byBzZWUgaWYgdGhlIGhvc3QgaXMgaW4gYSBsaXN0IG9mIHRydXN0ZWQgaG9zdHNcclxuICAgICAqIEBwYXJhbSBob3N0XHJcbiAgICAgKi9cclxuICAgIFRydXN0ZWRBdXRob3JpdHkuSXNJblRydXN0ZWRIb3N0TGlzdCA9IGZ1bmN0aW9uIChob3N0KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuVHJ1c3RlZEhvc3RMaXN0LmluZGV4T2YoaG9zdC50b0xvd2VyQ2FzZSgpKSA+IC0xO1xyXG4gICAgfTtcclxuICAgIFRydXN0ZWRBdXRob3JpdHkuVHJ1c3RlZEhvc3RMaXN0ID0gW107XHJcbiAgICByZXR1cm4gVHJ1c3RlZEF1dGhvcml0eTtcclxufSgpKTtcclxuZXhwb3J0IHsgVHJ1c3RlZEF1dGhvcml0eSB9O1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1UcnVzdGVkQXV0aG9yaXR5LmpzLm1hcCJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///wwyH\n");

/***/ }),

/***/ "z2Jz":
/*!**************************************************************!*\
  !*** ./node_modules/msal/lib-es6/ServerRequestParameters.js ***!
  \**************************************************************/
/*! exports provided: ServerRequestParameters */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ServerRequestParameters\", function() { return ServerRequestParameters; });\n/* harmony import */ var _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils/CryptoUtils */ \"jUVH\");\n/* harmony import */ var _utils_Constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils/Constants */ \"wmgs\");\n/* harmony import */ var _utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils/StringUtils */ \"Emp/\");\n/* harmony import */ var _ScopeSet__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ScopeSet */ \"8ImU\");\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\n\r\n\r\n\r\n/**\r\n * Nonce: OIDC Nonce definition: https://openid.net/specs/openid-connect-core-1_0.html#IDToken\r\n * State: OAuth Spec: https://tools.ietf.org/html/rfc6749#section-10.12\r\n * @hidden\r\n */\r\nvar ServerRequestParameters = /** @class */ (function () {\r\n    /**\r\n     * Constructor\r\n     * @param authority\r\n     * @param clientId\r\n     * @param scope\r\n     * @param responseType\r\n     * @param redirectUri\r\n     * @param state\r\n     */\r\n    function ServerRequestParameters(authority, clientId, responseType, redirectUri, scopes, state, correlationId) {\r\n        this.authorityInstance = authority;\r\n        this.clientId = clientId;\r\n        this.nonce = _utils_CryptoUtils__WEBPACK_IMPORTED_MODULE_0__[\"CryptoUtils\"].createNewGuid();\r\n        // set scope to clientId if null\r\n        this.scopes = scopes ? scopes.slice() : _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].oidcScopes;\r\n        this.scopes = _ScopeSet__WEBPACK_IMPORTED_MODULE_3__[\"ScopeSet\"].trimScopes(this.scopes);\r\n        // set state (already set at top level)\r\n        this.state = state;\r\n        // set correlationId\r\n        this.correlationId = correlationId;\r\n        // telemetry information\r\n        this.xClientSku = \"MSAL.JS\";\r\n        this.xClientVer = Object(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"libraryVersion\"])();\r\n        this.responseType = responseType;\r\n        this.redirectUri = redirectUri;\r\n    }\r\n    Object.defineProperty(ServerRequestParameters.prototype, \"authority\", {\r\n        get: function () {\r\n            return this.authorityInstance ? this.authorityInstance.CanonicalAuthority : null;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * @hidden\r\n     * @ignore\r\n     *\r\n     * Utility to populate QueryParameters and ExtraQueryParameters to ServerRequestParamerers\r\n     * @param request\r\n     * @param serverAuthenticationRequest\r\n     */\r\n    ServerRequestParameters.prototype.populateQueryParams = function (account, request, adalIdTokenObject, silentCall) {\r\n        var queryParameters = {};\r\n        if (request) {\r\n            // add the prompt parameter to serverRequestParameters if passed\r\n            if (request.prompt) {\r\n                this.promptValue = request.prompt;\r\n            }\r\n            // Add claims challenge to serverRequestParameters if passed\r\n            if (request.claimsRequest) {\r\n                this.claimsValue = request.claimsRequest;\r\n            }\r\n            // if the developer provides one of these, give preference to developer choice\r\n            if (ServerRequestParameters.isSSOParam(request)) {\r\n                queryParameters = this.constructUnifiedCacheQueryParameter(request, null);\r\n            }\r\n        }\r\n        if (adalIdTokenObject) {\r\n            queryParameters = this.constructUnifiedCacheQueryParameter(null, adalIdTokenObject);\r\n        }\r\n        /*\r\n         * adds sid/login_hint if not populated\r\n         * this.logger.verbose(\"Calling addHint parameters\");\r\n         */\r\n        queryParameters = this.addHintParameters(account, queryParameters);\r\n        // sanity check for developer passed extraQueryParameters\r\n        var eQParams = request ? request.extraQueryParameters : null;\r\n        // Populate the extraQueryParameters to be sent to the server\r\n        this.queryParameters = ServerRequestParameters.generateQueryParametersString(queryParameters);\r\n        this.extraQueryParameters = ServerRequestParameters.generateQueryParametersString(eQParams, silentCall);\r\n    };\r\n    // #region QueryParam helpers\r\n    /**\r\n     * Constructs extraQueryParameters to be sent to the server for the AuthenticationParameters set by the developer\r\n     * in any login() or acquireToken() calls\r\n     * @param idTokenObject\r\n     * @param extraQueryParameters\r\n     * @param sid\r\n     * @param loginHint\r\n     */\r\n    // TODO: check how this behaves when domain_hint only is sent in extraparameters and idToken has no upn.\r\n    ServerRequestParameters.prototype.constructUnifiedCacheQueryParameter = function (request, idTokenObject) {\r\n        // preference order: account > sid > login_hint\r\n        var ssoType;\r\n        var ssoData;\r\n        var serverReqParam = {};\r\n        // if account info is passed, account.sid > account.login_hint\r\n        if (request) {\r\n            if (request.account) {\r\n                var account = request.account;\r\n                if (account.sid) {\r\n                    ssoType = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"SSOTypes\"].SID;\r\n                    ssoData = account.sid;\r\n                }\r\n                else if (account.userName) {\r\n                    ssoType = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"SSOTypes\"].LOGIN_HINT;\r\n                    ssoData = account.userName;\r\n                }\r\n            }\r\n            // sid from request\r\n            else if (request.sid) {\r\n                ssoType = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"SSOTypes\"].SID;\r\n                ssoData = request.sid;\r\n            }\r\n            // loginHint from request\r\n            else if (request.loginHint) {\r\n                ssoType = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"SSOTypes\"].LOGIN_HINT;\r\n                ssoData = request.loginHint;\r\n            }\r\n        }\r\n        // adalIdToken retrieved from cache\r\n        else if (idTokenObject) {\r\n            if (idTokenObject.hasOwnProperty(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].upn)) {\r\n                ssoType = _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"SSOTypes\"].ID_TOKEN;\r\n                ssoData = idTokenObject.upn;\r\n            }\r\n        }\r\n        serverReqParam = this.addSSOParameter(ssoType, ssoData);\r\n        return serverReqParam;\r\n    };\r\n    /**\r\n     * @hidden\r\n     *\r\n     * Adds login_hint to authorization URL which is used to pre-fill the username field of sign in page for the user if known ahead of time\r\n     * domain_hint if added skips the email based discovery process of the user - only supported for interactive calls in implicit_flow\r\n     * domain_req utid received as part of the clientInfo\r\n     * login_req uid received as part of clientInfo\r\n     * Also does a sanity check for extraQueryParameters passed by the user to ensure no repeat queryParameters\r\n     *\r\n     * @param {@link Account} account - Account for which the token is requested\r\n     * @param queryparams\r\n     * @param {@link ServerRequestParameters}\r\n     * @ignore\r\n     */\r\n    ServerRequestParameters.prototype.addHintParameters = function (account, qParams) {\r\n        /*\r\n         * This is a final check for all queryParams added so far; preference order: sid > login_hint\r\n         * sid cannot be passed along with login_hint or domain_hint, hence we check both are not populated yet in queryParameters\r\n         */\r\n        if (account && !qParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"SSOTypes\"].SID]) {\r\n            // sid - populate only if login_hint is not already populated and the account has sid\r\n            var populateSID = !qParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"SSOTypes\"].LOGIN_HINT] && account.sid && this.promptValue === _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"PromptState\"].NONE;\r\n            if (populateSID) {\r\n                qParams = this.addSSOParameter(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"SSOTypes\"].SID, account.sid, qParams);\r\n            }\r\n            // login_hint - account.userName\r\n            else {\r\n                var populateLoginHint = !qParams[_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"SSOTypes\"].LOGIN_HINT] && account.userName && !_utils_StringUtils__WEBPACK_IMPORTED_MODULE_2__[\"StringUtils\"].isEmpty(account.userName);\r\n                if (populateLoginHint) {\r\n                    qParams = this.addSSOParameter(_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"SSOTypes\"].LOGIN_HINT, account.userName, qParams);\r\n                }\r\n            }\r\n        }\r\n        return qParams;\r\n    };\r\n    /**\r\n     * Add SID to extraQueryParameters\r\n     * @param sid\r\n     */\r\n    ServerRequestParameters.prototype.addSSOParameter = function (ssoType, ssoData, ssoParam) {\r\n        if (!ssoParam) {\r\n            ssoParam = {};\r\n        }\r\n        if (!ssoData) {\r\n            return ssoParam;\r\n        }\r\n        switch (ssoType) {\r\n            case _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"SSOTypes\"].SID: {\r\n                ssoParam[_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"SSOTypes\"].SID] = ssoData;\r\n                break;\r\n            }\r\n            case _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"SSOTypes\"].ID_TOKEN: {\r\n                ssoParam[_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"SSOTypes\"].LOGIN_HINT] = ssoData;\r\n                break;\r\n            }\r\n            case _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"SSOTypes\"].LOGIN_HINT: {\r\n                ssoParam[_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"SSOTypes\"].LOGIN_HINT] = ssoData;\r\n                break;\r\n            }\r\n        }\r\n        return ssoParam;\r\n    };\r\n    /**\r\n     * Utility to generate a QueryParameterString from a Key-Value mapping of extraQueryParameters passed\r\n     * @param extraQueryParameters\r\n     */\r\n    ServerRequestParameters.generateQueryParametersString = function (queryParameters, silentCall) {\r\n        var paramsString = null;\r\n        if (queryParameters) {\r\n            Object.keys(queryParameters).forEach(function (key) {\r\n                // sid cannot be passed along with login_hint or domain_hint\r\n                if (key === _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"Constants\"].domain_hint && (silentCall || queryParameters[_utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"SSOTypes\"].SID])) {\r\n                    return;\r\n                }\r\n                if (paramsString == null) {\r\n                    paramsString = key + \"=\" + encodeURIComponent(queryParameters[key]);\r\n                }\r\n                else {\r\n                    paramsString += \"&\" + key + \"=\" + encodeURIComponent(queryParameters[key]);\r\n                }\r\n            });\r\n        }\r\n        return paramsString;\r\n    };\r\n    // #endregion\r\n    /**\r\n     * Check to see if there are SSO params set in the Request\r\n     * @param request\r\n     */\r\n    ServerRequestParameters.isSSOParam = function (request) {\r\n        return request && (request.account || request.sid || request.loginHint);\r\n    };\r\n    /**\r\n     * Returns the correct response_type string attribute for an acquireToken request configuration\r\n     * @param accountsMatch boolean: Determines whether the account in the request matches the cached account\r\n     * @param scopes Array<string>: AuthenticationRequest scopes configuration\r\n     * @param loginScopesOnly boolean: True if the scopes array ONLY contains the clientId or any combination of OIDC scopes, without resource scopes\r\n     */\r\n    ServerRequestParameters.determineResponseType = function (accountsMatch, scopes) {\r\n        // Supports getting an id_token by sending in clientId as only scope or OIDC scopes as only scopes\r\n        if (_ScopeSet__WEBPACK_IMPORTED_MODULE_3__[\"ScopeSet\"].onlyContainsOidcScopes(scopes)) {\r\n            return _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"ResponseTypes\"].id_token;\r\n        }\r\n        // If accounts match, check if OIDC scopes are included, otherwise return id_token_token\r\n        return (accountsMatch) ? this.responseTypeForMatchingAccounts(scopes) : _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"ResponseTypes\"].id_token_token;\r\n    };\r\n    /**\r\n     * Returns the correct response_type string attribute for an acquireToken request configuration that contains an\r\n     * account that matches the account in the MSAL cache.\r\n     * @param scopes Array<string>: AuthenticationRequest scopes configuration\r\n     */\r\n    ServerRequestParameters.responseTypeForMatchingAccounts = function (scopes) {\r\n        // Opt-into also requesting an ID token by sending in 'openid', 'profile' or both along with resource scopes when login is not necessary.\r\n        return (_ScopeSet__WEBPACK_IMPORTED_MODULE_3__[\"ScopeSet\"].containsAnyOidcScopes(scopes)) ? _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"ResponseTypes\"].id_token_token : _utils_Constants__WEBPACK_IMPORTED_MODULE_1__[\"ResponseTypes\"].token;\r\n    };\r\n    return ServerRequestParameters;\r\n}());\r\n\r\n//# sourceMappingURL=ServerRequestParameters.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiejJKei5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tc2FsL2xpYi1lczYvU2VydmVyUmVxdWVzdFBhcmFtZXRlcnMuanM/Y2Y2MiJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxyXG4gKiBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4gKi9cclxuaW1wb3J0IHsgQ3J5cHRvVXRpbHMgfSBmcm9tIFwiLi91dGlscy9DcnlwdG9VdGlsc1wiO1xyXG5pbXBvcnQgeyBTU09UeXBlcywgQ29uc3RhbnRzLCBQcm9tcHRTdGF0ZSwgbGlicmFyeVZlcnNpb24sIFJlc3BvbnNlVHlwZXMgfSBmcm9tIFwiLi91dGlscy9Db25zdGFudHNcIjtcclxuaW1wb3J0IHsgU3RyaW5nVXRpbHMgfSBmcm9tIFwiLi91dGlscy9TdHJpbmdVdGlsc1wiO1xyXG5pbXBvcnQgeyBTY29wZVNldCB9IGZyb20gXCIuL1Njb3BlU2V0XCI7XHJcbi8qKlxyXG4gKiBOb25jZTogT0lEQyBOb25jZSBkZWZpbml0aW9uOiBodHRwczovL29wZW5pZC5uZXQvc3BlY3Mvb3BlbmlkLWNvbm5lY3QtY29yZS0xXzAuaHRtbCNJRFRva2VuXHJcbiAqIFN0YXRlOiBPQXV0aCBTcGVjOiBodHRwczovL3Rvb2xzLmlldGYub3JnL2h0bWwvcmZjNjc0OSNzZWN0aW9uLTEwLjEyXHJcbiAqIEBoaWRkZW5cclxuICovXHJcbnZhciBTZXJ2ZXJSZXF1ZXN0UGFyYW1ldGVycyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcclxuICAgIC8qKlxyXG4gICAgICogQ29uc3RydWN0b3JcclxuICAgICAqIEBwYXJhbSBhdXRob3JpdHlcclxuICAgICAqIEBwYXJhbSBjbGllbnRJZFxyXG4gICAgICogQHBhcmFtIHNjb3BlXHJcbiAgICAgKiBAcGFyYW0gcmVzcG9uc2VUeXBlXHJcbiAgICAgKiBAcGFyYW0gcmVkaXJlY3RVcmlcclxuICAgICAqIEBwYXJhbSBzdGF0ZVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBTZXJ2ZXJSZXF1ZXN0UGFyYW1ldGVycyhhdXRob3JpdHksIGNsaWVudElkLCByZXNwb25zZVR5cGUsIHJlZGlyZWN0VXJpLCBzY29wZXMsIHN0YXRlLCBjb3JyZWxhdGlvbklkKSB7XHJcbiAgICAgICAgdGhpcy5hdXRob3JpdHlJbnN0YW5jZSA9IGF1dGhvcml0eTtcclxuICAgICAgICB0aGlzLmNsaWVudElkID0gY2xpZW50SWQ7XHJcbiAgICAgICAgdGhpcy5ub25jZSA9IENyeXB0b1V0aWxzLmNyZWF0ZU5ld0d1aWQoKTtcclxuICAgICAgICAvLyBzZXQgc2NvcGUgdG8gY2xpZW50SWQgaWYgbnVsbFxyXG4gICAgICAgIHRoaXMuc2NvcGVzID0gc2NvcGVzID8gc2NvcGVzLnNsaWNlKCkgOiBDb25zdGFudHMub2lkY1Njb3BlcztcclxuICAgICAgICB0aGlzLnNjb3BlcyA9IFNjb3BlU2V0LnRyaW1TY29wZXModGhpcy5zY29wZXMpO1xyXG4gICAgICAgIC8vIHNldCBzdGF0ZSAoYWxyZWFkeSBzZXQgYXQgdG9wIGxldmVsKVxyXG4gICAgICAgIHRoaXMuc3RhdGUgPSBzdGF0ZTtcclxuICAgICAgICAvLyBzZXQgY29ycmVsYXRpb25JZFxyXG4gICAgICAgIHRoaXMuY29ycmVsYXRpb25JZCA9IGNvcnJlbGF0aW9uSWQ7XHJcbiAgICAgICAgLy8gdGVsZW1ldHJ5IGluZm9ybWF0aW9uXHJcbiAgICAgICAgdGhpcy54Q2xpZW50U2t1ID0gXCJNU0FMLkpTXCI7XHJcbiAgICAgICAgdGhpcy54Q2xpZW50VmVyID0gbGlicmFyeVZlcnNpb24oKTtcclxuICAgICAgICB0aGlzLnJlc3BvbnNlVHlwZSA9IHJlc3BvbnNlVHlwZTtcclxuICAgICAgICB0aGlzLnJlZGlyZWN0VXJpID0gcmVkaXJlY3RVcmk7XHJcbiAgICB9XHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU2VydmVyUmVxdWVzdFBhcmFtZXRlcnMucHJvdG90eXBlLCBcImF1dGhvcml0eVwiLCB7XHJcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmF1dGhvcml0eUluc3RhbmNlID8gdGhpcy5hdXRob3JpdHlJbnN0YW5jZS5DYW5vbmljYWxBdXRob3JpdHkgOiBudWxsO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcclxuICAgIH0pO1xyXG4gICAgLyoqXHJcbiAgICAgKiBAaGlkZGVuXHJcbiAgICAgKiBAaWdub3JlXHJcbiAgICAgKlxyXG4gICAgICogVXRpbGl0eSB0byBwb3B1bGF0ZSBRdWVyeVBhcmFtZXRlcnMgYW5kIEV4dHJhUXVlcnlQYXJhbWV0ZXJzIHRvIFNlcnZlclJlcXVlc3RQYXJhbWVyZXJzXHJcbiAgICAgKiBAcGFyYW0gcmVxdWVzdFxyXG4gICAgICogQHBhcmFtIHNlcnZlckF1dGhlbnRpY2F0aW9uUmVxdWVzdFxyXG4gICAgICovXHJcbiAgICBTZXJ2ZXJSZXF1ZXN0UGFyYW1ldGVycy5wcm90b3R5cGUucG9wdWxhdGVRdWVyeVBhcmFtcyA9IGZ1bmN0aW9uIChhY2NvdW50LCByZXF1ZXN0LCBhZGFsSWRUb2tlbk9iamVjdCwgc2lsZW50Q2FsbCkge1xyXG4gICAgICAgIHZhciBxdWVyeVBhcmFtZXRlcnMgPSB7fTtcclxuICAgICAgICBpZiAocmVxdWVzdCkge1xyXG4gICAgICAgICAgICAvLyBhZGQgdGhlIHByb21wdCBwYXJhbWV0ZXIgdG8gc2VydmVyUmVxdWVzdFBhcmFtZXRlcnMgaWYgcGFzc2VkXHJcbiAgICAgICAgICAgIGlmIChyZXF1ZXN0LnByb21wdCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wcm9tcHRWYWx1ZSA9IHJlcXVlc3QucHJvbXB0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIEFkZCBjbGFpbXMgY2hhbGxlbmdlIHRvIHNlcnZlclJlcXVlc3RQYXJhbWV0ZXJzIGlmIHBhc3NlZFxyXG4gICAgICAgICAgICBpZiAocmVxdWVzdC5jbGFpbXNSZXF1ZXN0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsYWltc1ZhbHVlID0gcmVxdWVzdC5jbGFpbXNSZXF1ZXN0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIGlmIHRoZSBkZXZlbG9wZXIgcHJvdmlkZXMgb25lIG9mIHRoZXNlLCBnaXZlIHByZWZlcmVuY2UgdG8gZGV2ZWxvcGVyIGNob2ljZVxyXG4gICAgICAgICAgICBpZiAoU2VydmVyUmVxdWVzdFBhcmFtZXRlcnMuaXNTU09QYXJhbShyZXF1ZXN0KSkge1xyXG4gICAgICAgICAgICAgICAgcXVlcnlQYXJhbWV0ZXJzID0gdGhpcy5jb25zdHJ1Y3RVbmlmaWVkQ2FjaGVRdWVyeVBhcmFtZXRlcihyZXF1ZXN0LCBudWxsKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYWRhbElkVG9rZW5PYmplY3QpIHtcclxuICAgICAgICAgICAgcXVlcnlQYXJhbWV0ZXJzID0gdGhpcy5jb25zdHJ1Y3RVbmlmaWVkQ2FjaGVRdWVyeVBhcmFtZXRlcihudWxsLCBhZGFsSWRUb2tlbk9iamVjdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8qXHJcbiAgICAgICAgICogYWRkcyBzaWQvbG9naW5faGludCBpZiBub3QgcG9wdWxhdGVkXHJcbiAgICAgICAgICogdGhpcy5sb2dnZXIudmVyYm9zZShcIkNhbGxpbmcgYWRkSGludCBwYXJhbWV0ZXJzXCIpO1xyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHF1ZXJ5UGFyYW1ldGVycyA9IHRoaXMuYWRkSGludFBhcmFtZXRlcnMoYWNjb3VudCwgcXVlcnlQYXJhbWV0ZXJzKTtcclxuICAgICAgICAvLyBzYW5pdHkgY2hlY2sgZm9yIGRldmVsb3BlciBwYXNzZWQgZXh0cmFRdWVyeVBhcmFtZXRlcnNcclxuICAgICAgICB2YXIgZVFQYXJhbXMgPSByZXF1ZXN0ID8gcmVxdWVzdC5leHRyYVF1ZXJ5UGFyYW1ldGVycyA6IG51bGw7XHJcbiAgICAgICAgLy8gUG9wdWxhdGUgdGhlIGV4dHJhUXVlcnlQYXJhbWV0ZXJzIHRvIGJlIHNlbnQgdG8gdGhlIHNlcnZlclxyXG4gICAgICAgIHRoaXMucXVlcnlQYXJhbWV0ZXJzID0gU2VydmVyUmVxdWVzdFBhcmFtZXRlcnMuZ2VuZXJhdGVRdWVyeVBhcmFtZXRlcnNTdHJpbmcocXVlcnlQYXJhbWV0ZXJzKTtcclxuICAgICAgICB0aGlzLmV4dHJhUXVlcnlQYXJhbWV0ZXJzID0gU2VydmVyUmVxdWVzdFBhcmFtZXRlcnMuZ2VuZXJhdGVRdWVyeVBhcmFtZXRlcnNTdHJpbmcoZVFQYXJhbXMsIHNpbGVudENhbGwpO1xyXG4gICAgfTtcclxuICAgIC8vICNyZWdpb24gUXVlcnlQYXJhbSBoZWxwZXJzXHJcbiAgICAvKipcclxuICAgICAqIENvbnN0cnVjdHMgZXh0cmFRdWVyeVBhcmFtZXRlcnMgdG8gYmUgc2VudCB0byB0aGUgc2VydmVyIGZvciB0aGUgQXV0aGVudGljYXRpb25QYXJhbWV0ZXJzIHNldCBieSB0aGUgZGV2ZWxvcGVyXHJcbiAgICAgKiBpbiBhbnkgbG9naW4oKSBvciBhY3F1aXJlVG9rZW4oKSBjYWxsc1xyXG4gICAgICogQHBhcmFtIGlkVG9rZW5PYmplY3RcclxuICAgICAqIEBwYXJhbSBleHRyYVF1ZXJ5UGFyYW1ldGVyc1xyXG4gICAgICogQHBhcmFtIHNpZFxyXG4gICAgICogQHBhcmFtIGxvZ2luSGludFxyXG4gICAgICovXHJcbiAgICAvLyBUT0RPOiBjaGVjayBob3cgdGhpcyBiZWhhdmVzIHdoZW4gZG9tYWluX2hpbnQgb25seSBpcyBzZW50IGluIGV4dHJhcGFyYW1ldGVycyBhbmQgaWRUb2tlbiBoYXMgbm8gdXBuLlxyXG4gICAgU2VydmVyUmVxdWVzdFBhcmFtZXRlcnMucHJvdG90eXBlLmNvbnN0cnVjdFVuaWZpZWRDYWNoZVF1ZXJ5UGFyYW1ldGVyID0gZnVuY3Rpb24gKHJlcXVlc3QsIGlkVG9rZW5PYmplY3QpIHtcclxuICAgICAgICAvLyBwcmVmZXJlbmNlIG9yZGVyOiBhY2NvdW50ID4gc2lkID4gbG9naW5faGludFxyXG4gICAgICAgIHZhciBzc29UeXBlO1xyXG4gICAgICAgIHZhciBzc29EYXRhO1xyXG4gICAgICAgIHZhciBzZXJ2ZXJSZXFQYXJhbSA9IHt9O1xyXG4gICAgICAgIC8vIGlmIGFjY291bnQgaW5mbyBpcyBwYXNzZWQsIGFjY291bnQuc2lkID4gYWNjb3VudC5sb2dpbl9oaW50XHJcbiAgICAgICAgaWYgKHJlcXVlc3QpIHtcclxuICAgICAgICAgICAgaWYgKHJlcXVlc3QuYWNjb3VudCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGFjY291bnQgPSByZXF1ZXN0LmFjY291bnQ7XHJcbiAgICAgICAgICAgICAgICBpZiAoYWNjb3VudC5zaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBzc29UeXBlID0gU1NPVHlwZXMuU0lEO1xyXG4gICAgICAgICAgICAgICAgICAgIHNzb0RhdGEgPSBhY2NvdW50LnNpZDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFjY291bnQudXNlck5hbWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBzc29UeXBlID0gU1NPVHlwZXMuTE9HSU5fSElOVDtcclxuICAgICAgICAgICAgICAgICAgICBzc29EYXRhID0gYWNjb3VudC51c2VyTmFtZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBzaWQgZnJvbSByZXF1ZXN0XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHJlcXVlc3Quc2lkKSB7XHJcbiAgICAgICAgICAgICAgICBzc29UeXBlID0gU1NPVHlwZXMuU0lEO1xyXG4gICAgICAgICAgICAgICAgc3NvRGF0YSA9IHJlcXVlc3Quc2lkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIGxvZ2luSGludCBmcm9tIHJlcXVlc3RcclxuICAgICAgICAgICAgZWxzZSBpZiAocmVxdWVzdC5sb2dpbkhpbnQpIHtcclxuICAgICAgICAgICAgICAgIHNzb1R5cGUgPSBTU09UeXBlcy5MT0dJTl9ISU5UO1xyXG4gICAgICAgICAgICAgICAgc3NvRGF0YSA9IHJlcXVlc3QubG9naW5IaW50O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGFkYWxJZFRva2VuIHJldHJpZXZlZCBmcm9tIGNhY2hlXHJcbiAgICAgICAgZWxzZSBpZiAoaWRUb2tlbk9iamVjdCkge1xyXG4gICAgICAgICAgICBpZiAoaWRUb2tlbk9iamVjdC5oYXNPd25Qcm9wZXJ0eShDb25zdGFudHMudXBuKSkge1xyXG4gICAgICAgICAgICAgICAgc3NvVHlwZSA9IFNTT1R5cGVzLklEX1RPS0VOO1xyXG4gICAgICAgICAgICAgICAgc3NvRGF0YSA9IGlkVG9rZW5PYmplY3QudXBuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHNlcnZlclJlcVBhcmFtID0gdGhpcy5hZGRTU09QYXJhbWV0ZXIoc3NvVHlwZSwgc3NvRGF0YSk7XHJcbiAgICAgICAgcmV0dXJuIHNlcnZlclJlcVBhcmFtO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQGhpZGRlblxyXG4gICAgICpcclxuICAgICAqIEFkZHMgbG9naW5faGludCB0byBhdXRob3JpemF0aW9uIFVSTCB3aGljaCBpcyB1c2VkIHRvIHByZS1maWxsIHRoZSB1c2VybmFtZSBmaWVsZCBvZiBzaWduIGluIHBhZ2UgZm9yIHRoZSB1c2VyIGlmIGtub3duIGFoZWFkIG9mIHRpbWVcclxuICAgICAqIGRvbWFpbl9oaW50IGlmIGFkZGVkIHNraXBzIHRoZSBlbWFpbCBiYXNlZCBkaXNjb3ZlcnkgcHJvY2VzcyBvZiB0aGUgdXNlciAtIG9ubHkgc3VwcG9ydGVkIGZvciBpbnRlcmFjdGl2ZSBjYWxscyBpbiBpbXBsaWNpdF9mbG93XHJcbiAgICAgKiBkb21haW5fcmVxIHV0aWQgcmVjZWl2ZWQgYXMgcGFydCBvZiB0aGUgY2xpZW50SW5mb1xyXG4gICAgICogbG9naW5fcmVxIHVpZCByZWNlaXZlZCBhcyBwYXJ0IG9mIGNsaWVudEluZm9cclxuICAgICAqIEFsc28gZG9lcyBhIHNhbml0eSBjaGVjayBmb3IgZXh0cmFRdWVyeVBhcmFtZXRlcnMgcGFzc2VkIGJ5IHRoZSB1c2VyIHRvIGVuc3VyZSBubyByZXBlYXQgcXVlcnlQYXJhbWV0ZXJzXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIHtAbGluayBBY2NvdW50fSBhY2NvdW50IC0gQWNjb3VudCBmb3Igd2hpY2ggdGhlIHRva2VuIGlzIHJlcXVlc3RlZFxyXG4gICAgICogQHBhcmFtIHF1ZXJ5cGFyYW1zXHJcbiAgICAgKiBAcGFyYW0ge0BsaW5rIFNlcnZlclJlcXVlc3RQYXJhbWV0ZXJzfVxyXG4gICAgICogQGlnbm9yZVxyXG4gICAgICovXHJcbiAgICBTZXJ2ZXJSZXF1ZXN0UGFyYW1ldGVycy5wcm90b3R5cGUuYWRkSGludFBhcmFtZXRlcnMgPSBmdW5jdGlvbiAoYWNjb3VudCwgcVBhcmFtcykge1xyXG4gICAgICAgIC8qXHJcbiAgICAgICAgICogVGhpcyBpcyBhIGZpbmFsIGNoZWNrIGZvciBhbGwgcXVlcnlQYXJhbXMgYWRkZWQgc28gZmFyOyBwcmVmZXJlbmNlIG9yZGVyOiBzaWQgPiBsb2dpbl9oaW50XHJcbiAgICAgICAgICogc2lkIGNhbm5vdCBiZSBwYXNzZWQgYWxvbmcgd2l0aCBsb2dpbl9oaW50IG9yIGRvbWFpbl9oaW50LCBoZW5jZSB3ZSBjaGVjayBib3RoIGFyZSBub3QgcG9wdWxhdGVkIHlldCBpbiBxdWVyeVBhcmFtZXRlcnNcclxuICAgICAgICAgKi9cclxuICAgICAgICBpZiAoYWNjb3VudCAmJiAhcVBhcmFtc1tTU09UeXBlcy5TSURdKSB7XHJcbiAgICAgICAgICAgIC8vIHNpZCAtIHBvcHVsYXRlIG9ubHkgaWYgbG9naW5faGludCBpcyBub3QgYWxyZWFkeSBwb3B1bGF0ZWQgYW5kIHRoZSBhY2NvdW50IGhhcyBzaWRcclxuICAgICAgICAgICAgdmFyIHBvcHVsYXRlU0lEID0gIXFQYXJhbXNbU1NPVHlwZXMuTE9HSU5fSElOVF0gJiYgYWNjb3VudC5zaWQgJiYgdGhpcy5wcm9tcHRWYWx1ZSA9PT0gUHJvbXB0U3RhdGUuTk9ORTtcclxuICAgICAgICAgICAgaWYgKHBvcHVsYXRlU0lEKSB7XHJcbiAgICAgICAgICAgICAgICBxUGFyYW1zID0gdGhpcy5hZGRTU09QYXJhbWV0ZXIoU1NPVHlwZXMuU0lELCBhY2NvdW50LnNpZCwgcVBhcmFtcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gbG9naW5faGludCAtIGFjY291bnQudXNlck5hbWVcclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcG9wdWxhdGVMb2dpbkhpbnQgPSAhcVBhcmFtc1tTU09UeXBlcy5MT0dJTl9ISU5UXSAmJiBhY2NvdW50LnVzZXJOYW1lICYmICFTdHJpbmdVdGlscy5pc0VtcHR5KGFjY291bnQudXNlck5hbWUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHBvcHVsYXRlTG9naW5IaW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcVBhcmFtcyA9IHRoaXMuYWRkU1NPUGFyYW1ldGVyKFNTT1R5cGVzLkxPR0lOX0hJTlQsIGFjY291bnQudXNlck5hbWUsIHFQYXJhbXMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBxUGFyYW1zO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogQWRkIFNJRCB0byBleHRyYVF1ZXJ5UGFyYW1ldGVyc1xyXG4gICAgICogQHBhcmFtIHNpZFxyXG4gICAgICovXHJcbiAgICBTZXJ2ZXJSZXF1ZXN0UGFyYW1ldGVycy5wcm90b3R5cGUuYWRkU1NPUGFyYW1ldGVyID0gZnVuY3Rpb24gKHNzb1R5cGUsIHNzb0RhdGEsIHNzb1BhcmFtKSB7XHJcbiAgICAgICAgaWYgKCFzc29QYXJhbSkge1xyXG4gICAgICAgICAgICBzc29QYXJhbSA9IHt9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXNzb0RhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHNzb1BhcmFtO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzd2l0Y2ggKHNzb1R5cGUpIHtcclxuICAgICAgICAgICAgY2FzZSBTU09UeXBlcy5TSUQ6IHtcclxuICAgICAgICAgICAgICAgIHNzb1BhcmFtW1NTT1R5cGVzLlNJRF0gPSBzc29EYXRhO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2FzZSBTU09UeXBlcy5JRF9UT0tFTjoge1xyXG4gICAgICAgICAgICAgICAgc3NvUGFyYW1bU1NPVHlwZXMuTE9HSU5fSElOVF0gPSBzc29EYXRhO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2FzZSBTU09UeXBlcy5MT0dJTl9ISU5UOiB7XHJcbiAgICAgICAgICAgICAgICBzc29QYXJhbVtTU09UeXBlcy5MT0dJTl9ISU5UXSA9IHNzb0RhdGE7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gc3NvUGFyYW07XHJcbiAgICB9O1xyXG4gICAgLyoqXHJcbiAgICAgKiBVdGlsaXR5IHRvIGdlbmVyYXRlIGEgUXVlcnlQYXJhbWV0ZXJTdHJpbmcgZnJvbSBhIEtleS1WYWx1ZSBtYXBwaW5nIG9mIGV4dHJhUXVlcnlQYXJhbWV0ZXJzIHBhc3NlZFxyXG4gICAgICogQHBhcmFtIGV4dHJhUXVlcnlQYXJhbWV0ZXJzXHJcbiAgICAgKi9cclxuICAgIFNlcnZlclJlcXVlc3RQYXJhbWV0ZXJzLmdlbmVyYXRlUXVlcnlQYXJhbWV0ZXJzU3RyaW5nID0gZnVuY3Rpb24gKHF1ZXJ5UGFyYW1ldGVycywgc2lsZW50Q2FsbCkge1xyXG4gICAgICAgIHZhciBwYXJhbXNTdHJpbmcgPSBudWxsO1xyXG4gICAgICAgIGlmIChxdWVyeVBhcmFtZXRlcnMpIHtcclxuICAgICAgICAgICAgT2JqZWN0LmtleXMocXVlcnlQYXJhbWV0ZXJzKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcclxuICAgICAgICAgICAgICAgIC8vIHNpZCBjYW5ub3QgYmUgcGFzc2VkIGFsb25nIHdpdGggbG9naW5faGludCBvciBkb21haW5faGludFxyXG4gICAgICAgICAgICAgICAgaWYgKGtleSA9PT0gQ29uc3RhbnRzLmRvbWFpbl9oaW50ICYmIChzaWxlbnRDYWxsIHx8IHF1ZXJ5UGFyYW1ldGVyc1tTU09UeXBlcy5TSURdKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChwYXJhbXNTdHJpbmcgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtc1N0cmluZyA9IGtleSArIFwiPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KHF1ZXJ5UGFyYW1ldGVyc1trZXldKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhcmFtc1N0cmluZyArPSBcIiZcIiArIGtleSArIFwiPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KHF1ZXJ5UGFyYW1ldGVyc1trZXldKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwYXJhbXNTdHJpbmc7XHJcbiAgICB9O1xyXG4gICAgLy8gI2VuZHJlZ2lvblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVjayB0byBzZWUgaWYgdGhlcmUgYXJlIFNTTyBwYXJhbXMgc2V0IGluIHRoZSBSZXF1ZXN0XHJcbiAgICAgKiBAcGFyYW0gcmVxdWVzdFxyXG4gICAgICovXHJcbiAgICBTZXJ2ZXJSZXF1ZXN0UGFyYW1ldGVycy5pc1NTT1BhcmFtID0gZnVuY3Rpb24gKHJlcXVlc3QpIHtcclxuICAgICAgICByZXR1cm4gcmVxdWVzdCAmJiAocmVxdWVzdC5hY2NvdW50IHx8IHJlcXVlc3Quc2lkIHx8IHJlcXVlc3QubG9naW5IaW50KTtcclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdGhlIGNvcnJlY3QgcmVzcG9uc2VfdHlwZSBzdHJpbmcgYXR0cmlidXRlIGZvciBhbiBhY3F1aXJlVG9rZW4gcmVxdWVzdCBjb25maWd1cmF0aW9uXHJcbiAgICAgKiBAcGFyYW0gYWNjb3VudHNNYXRjaCBib29sZWFuOiBEZXRlcm1pbmVzIHdoZXRoZXIgdGhlIGFjY291bnQgaW4gdGhlIHJlcXVlc3QgbWF0Y2hlcyB0aGUgY2FjaGVkIGFjY291bnRcclxuICAgICAqIEBwYXJhbSBzY29wZXMgQXJyYXk8c3RyaW5nPjogQXV0aGVudGljYXRpb25SZXF1ZXN0IHNjb3BlcyBjb25maWd1cmF0aW9uXHJcbiAgICAgKiBAcGFyYW0gbG9naW5TY29wZXNPbmx5IGJvb2xlYW46IFRydWUgaWYgdGhlIHNjb3BlcyBhcnJheSBPTkxZIGNvbnRhaW5zIHRoZSBjbGllbnRJZCBvciBhbnkgY29tYmluYXRpb24gb2YgT0lEQyBzY29wZXMsIHdpdGhvdXQgcmVzb3VyY2Ugc2NvcGVzXHJcbiAgICAgKi9cclxuICAgIFNlcnZlclJlcXVlc3RQYXJhbWV0ZXJzLmRldGVybWluZVJlc3BvbnNlVHlwZSA9IGZ1bmN0aW9uIChhY2NvdW50c01hdGNoLCBzY29wZXMpIHtcclxuICAgICAgICAvLyBTdXBwb3J0cyBnZXR0aW5nIGFuIGlkX3Rva2VuIGJ5IHNlbmRpbmcgaW4gY2xpZW50SWQgYXMgb25seSBzY29wZSBvciBPSURDIHNjb3BlcyBhcyBvbmx5IHNjb3Blc1xyXG4gICAgICAgIGlmIChTY29wZVNldC5vbmx5Q29udGFpbnNPaWRjU2NvcGVzKHNjb3BlcykpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFJlc3BvbnNlVHlwZXMuaWRfdG9rZW47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIElmIGFjY291bnRzIG1hdGNoLCBjaGVjayBpZiBPSURDIHNjb3BlcyBhcmUgaW5jbHVkZWQsIG90aGVyd2lzZSByZXR1cm4gaWRfdG9rZW5fdG9rZW5cclxuICAgICAgICByZXR1cm4gKGFjY291bnRzTWF0Y2gpID8gdGhpcy5yZXNwb25zZVR5cGVGb3JNYXRjaGluZ0FjY291bnRzKHNjb3BlcykgOiBSZXNwb25zZVR5cGVzLmlkX3Rva2VuX3Rva2VuO1xyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0aGUgY29ycmVjdCByZXNwb25zZV90eXBlIHN0cmluZyBhdHRyaWJ1dGUgZm9yIGFuIGFjcXVpcmVUb2tlbiByZXF1ZXN0IGNvbmZpZ3VyYXRpb24gdGhhdCBjb250YWlucyBhblxyXG4gICAgICogYWNjb3VudCB0aGF0IG1hdGNoZXMgdGhlIGFjY291bnQgaW4gdGhlIE1TQUwgY2FjaGUuXHJcbiAgICAgKiBAcGFyYW0gc2NvcGVzIEFycmF5PHN0cmluZz46IEF1dGhlbnRpY2F0aW9uUmVxdWVzdCBzY29wZXMgY29uZmlndXJhdGlvblxyXG4gICAgICovXHJcbiAgICBTZXJ2ZXJSZXF1ZXN0UGFyYW1ldGVycy5yZXNwb25zZVR5cGVGb3JNYXRjaGluZ0FjY291bnRzID0gZnVuY3Rpb24gKHNjb3Blcykge1xyXG4gICAgICAgIC8vIE9wdC1pbnRvIGFsc28gcmVxdWVzdGluZyBhbiBJRCB0b2tlbiBieSBzZW5kaW5nIGluICdvcGVuaWQnLCAncHJvZmlsZScgb3IgYm90aCBhbG9uZyB3aXRoIHJlc291cmNlIHNjb3BlcyB3aGVuIGxvZ2luIGlzIG5vdCBuZWNlc3NhcnkuXHJcbiAgICAgICAgcmV0dXJuIChTY29wZVNldC5jb250YWluc0FueU9pZGNTY29wZXMoc2NvcGVzKSkgPyBSZXNwb25zZVR5cGVzLmlkX3Rva2VuX3Rva2VuIDogUmVzcG9uc2VUeXBlcy50b2tlbjtcclxuICAgIH07XHJcbiAgICByZXR1cm4gU2VydmVyUmVxdWVzdFBhcmFtZXRlcnM7XHJcbn0oKSk7XHJcbmV4cG9ydCB7IFNlcnZlclJlcXVlc3RQYXJhbWV0ZXJzIH07XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPVNlcnZlclJlcXVlc3RQYXJhbWV0ZXJzLmpzLm1hcCJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///z2Jz\n");

/***/ })

}]);